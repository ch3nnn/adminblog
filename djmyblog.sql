/*
 Navicat Premium Data Transfer

 Source Server         : localhost
 Source Server Type    : MySQL
 Source Server Version : 50734
 Source Host           : localhost:3306
 Source Schema         : djmyblog

 Target Server Type    : MySQL
 Target Server Version : 50734
 File Encoding         : 65001

 Date: 31/08/2021 18:58:05
*/

SET NAMES utf8mb4;
SET FOREIGN_KEY_CHECKS = 0;

-- ----------------------------
-- Table structure for account_emailaddress
-- ----------------------------
DROP TABLE IF EXISTS `account_emailaddress`;
CREATE TABLE `account_emailaddress`
(
    `id`       int(11)      NOT NULL AUTO_INCREMENT,
    `email`    varchar(254) NOT NULL,
    `verified` tinyint(1)   NOT NULL,
    `primary`  tinyint(1)   NOT NULL,
    `user_id`  int(11)      NOT NULL,
    PRIMARY KEY (`id`) USING BTREE,
    UNIQUE KEY `email` (`email`) USING BTREE,
    KEY `account_emailaddress_user_id_2c513194_fk_user_user_id` (`user_id`) USING BTREE,
    CONSTRAINT `account_emailaddress_user_id_2c513194_fk_user_user_id` FOREIGN KEY (`user_id`) REFERENCES `user_user` (`id`)
) ENGINE = InnoDB
  AUTO_INCREMENT = 2
  DEFAULT CHARSET = utf8;

-- ----------------------------
-- Records of account_emailaddress
-- ----------------------------
BEGIN;
INSERT INTO `account_emailaddress`
VALUES (1, 'chen@chen.com', 0, 0, 1);
COMMIT;

-- ----------------------------
-- Table structure for account_emailconfirmation
-- ----------------------------
DROP TABLE IF EXISTS `account_emailconfirmation`;
CREATE TABLE `account_emailconfirmation`
(
    `id`               int(11)     NOT NULL AUTO_INCREMENT,
    `created`          datetime(6) NOT NULL,
    `sent`             datetime(6) DEFAULT NULL,
    `key`              varchar(64) NOT NULL,
    `email_address_id` int(11)     NOT NULL,
    PRIMARY KEY (`id`) USING BTREE,
    UNIQUE KEY `key` (`key`) USING BTREE,
    KEY `account_emailconfirm_email_address_id_5b7f8c58_fk_account_e` (`email_address_id`) USING BTREE,
    CONSTRAINT `account_emailconfirm_email_address_id_5b7f8c58_fk_account_e` FOREIGN KEY (`email_address_id`) REFERENCES `account_emailaddress` (`id`)
) ENGINE = InnoDB
  DEFAULT CHARSET = utf8;

-- ----------------------------
-- Records of account_emailconfirmation
-- ----------------------------
BEGIN;
COMMIT;

-- ----------------------------
-- Table structure for auth_group
-- ----------------------------
DROP TABLE IF EXISTS `auth_group`;
CREATE TABLE `auth_group`
(
    `id`   int(11)     NOT NULL AUTO_INCREMENT,
    `name` varchar(80) NOT NULL,
    PRIMARY KEY (`id`) USING BTREE,
    UNIQUE KEY `name` (`name`) USING BTREE
) ENGINE = InnoDB
  DEFAULT CHARSET = utf8;

-- ----------------------------
-- Records of auth_group
-- ----------------------------
BEGIN;
COMMIT;

-- ----------------------------
-- Table structure for auth_group_permissions
-- ----------------------------
DROP TABLE IF EXISTS `auth_group_permissions`;
CREATE TABLE `auth_group_permissions`
(
    `id`            int(11) NOT NULL AUTO_INCREMENT,
    `group_id`      int(11) NOT NULL,
    `permission_id` int(11) NOT NULL,
    PRIMARY KEY (`id`) USING BTREE,
    UNIQUE KEY `auth_group_permissions_group_id_permission_id_0cd325b0_uniq` (`group_id`, `permission_id`) USING BTREE,
    KEY `auth_group_permissio_permission_id_84c5c92e_fk_auth_perm` (`permission_id`) USING BTREE,
    CONSTRAINT `auth_group_permissio_permission_id_84c5c92e_fk_auth_perm` FOREIGN KEY (`permission_id`) REFERENCES `auth_permission` (`id`),
    CONSTRAINT `auth_group_permissions_group_id_b120cbf9_fk_auth_group_id` FOREIGN KEY (`group_id`) REFERENCES `auth_group` (`id`)
) ENGINE = InnoDB
  DEFAULT CHARSET = utf8;

-- ----------------------------
-- Records of auth_group_permissions
-- ----------------------------
BEGIN;
COMMIT;

-- ----------------------------
-- Table structure for auth_permission
-- ----------------------------
DROP TABLE IF EXISTS `auth_permission`;
CREATE TABLE `auth_permission`
(
    `id`              int(11)      NOT NULL AUTO_INCREMENT,
    `name`            varchar(255) NOT NULL,
    `content_type_id` int(11)      NOT NULL,
    `codename`        varchar(100) NOT NULL,
    PRIMARY KEY (`id`) USING BTREE,
    UNIQUE KEY `auth_permission_content_type_id_codename_01ab375a_uniq` (`content_type_id`, `codename`) USING BTREE,
    CONSTRAINT `auth_permission_content_type_id_2f476e4b_fk_django_co` FOREIGN KEY (`content_type_id`) REFERENCES `django_content_type` (`id`)
) ENGINE = InnoDB
  AUTO_INCREMENT = 82
  DEFAULT CHARSET = utf8;

-- ----------------------------
-- Records of auth_permission
-- ----------------------------
BEGIN;
INSERT INTO `auth_permission`
VALUES (1, 'Can add log entry', 1, 'add_logentry');
INSERT INTO `auth_permission`
VALUES (2, 'Can change log entry', 1, 'change_logentry');
INSERT INTO `auth_permission`
VALUES (3, 'Can delete log entry', 1, 'delete_logentry');
INSERT INTO `auth_permission`
VALUES (4, 'Can view log entry', 1, 'view_logentry');
INSERT INTO `auth_permission`
VALUES (5, 'Can add permission', 2, 'add_permission');
INSERT INTO `auth_permission`
VALUES (6, 'Can change permission', 2, 'change_permission');
INSERT INTO `auth_permission`
VALUES (7, 'Can delete permission', 2, 'delete_permission');
INSERT INTO `auth_permission`
VALUES (8, 'Can view permission', 2, 'view_permission');
INSERT INTO `auth_permission`
VALUES (9, 'Can add group', 3, 'add_group');
INSERT INTO `auth_permission`
VALUES (10, 'Can change group', 3, 'change_group');
INSERT INTO `auth_permission`
VALUES (11, 'Can delete group', 3, 'delete_group');
INSERT INTO `auth_permission`
VALUES (12, 'Can view group', 3, 'view_group');
INSERT INTO `auth_permission`
VALUES (13, 'Can add content type', 4, 'add_contenttype');
INSERT INTO `auth_permission`
VALUES (14, 'Can change content type', 4, 'change_contenttype');
INSERT INTO `auth_permission`
VALUES (15, 'Can delete content type', 4, 'delete_contenttype');
INSERT INTO `auth_permission`
VALUES (16, 'Can view content type', 4, 'view_contenttype');
INSERT INTO `auth_permission`
VALUES (17, 'Can add session', 5, 'add_session');
INSERT INTO `auth_permission`
VALUES (18, 'Can change session', 5, 'change_session');
INSERT INTO `auth_permission`
VALUES (19, 'Can delete session', 5, 'delete_session');
INSERT INTO `auth_permission`
VALUES (20, 'Can view session', 5, 'view_session');
INSERT INTO `auth_permission`
VALUES (21, 'Can add 分类', 6, 'add_category');
INSERT INTO `auth_permission`
VALUES (22, 'Can change 分类', 6, 'change_category');
INSERT INTO `auth_permission`
VALUES (23, 'Can delete 分类', 6, 'delete_category');
INSERT INTO `auth_permission`
VALUES (24, 'Can view 分类', 6, 'view_category');
INSERT INTO `auth_permission`
VALUES (25, 'Can add 文章内容', 7, 'add_post');
INSERT INTO `auth_permission`
VALUES (26, 'Can change 文章内容', 7, 'change_post');
INSERT INTO `auth_permission`
VALUES (27, 'Can delete 文章内容', 7, 'delete_post');
INSERT INTO `auth_permission`
VALUES (28, 'Can view 文章内容', 7, 'view_post');
INSERT INTO `auth_permission`
VALUES (29, 'Can add 文章评论', 8, 'add_comments');
INSERT INTO `auth_permission`
VALUES (30, 'Can change 文章评论', 8, 'change_comments');
INSERT INTO `auth_permission`
VALUES (31, 'Can delete 文章评论', 8, 'delete_comments');
INSERT INTO `auth_permission`
VALUES (32, 'Can view 文章评论', 8, 'view_comments');
INSERT INTO `auth_permission`
VALUES (33, 'Can add 标签', 9, 'add_tag');
INSERT INTO `auth_permission`
VALUES (34, 'Can change 标签', 9, 'change_tag');
INSERT INTO `auth_permission`
VALUES (35, 'Can delete 标签', 9, 'delete_tag');
INSERT INTO `auth_permission`
VALUES (36, 'Can view 标签', 9, 'view_tag');
INSERT INTO `auth_permission`
VALUES (37, 'Can add 友链', 10, 'add_friendlink');
INSERT INTO `auth_permission`
VALUES (38, 'Can change 友链', 10, 'change_friendlink');
INSERT INTO `auth_permission`
VALUES (39, 'Can delete 友链', 10, 'delete_friendlink');
INSERT INTO `auth_permission`
VALUES (40, 'Can view 友链', 10, 'view_friendlink');
INSERT INTO `auth_permission`
VALUES (41, 'Can add 书签连接', 11, 'add_bookmark');
INSERT INTO `auth_permission`
VALUES (42, 'Can change 书签连接', 11, 'change_bookmark');
INSERT INTO `auth_permission`
VALUES (43, 'Can delete 书签连接', 11, 'delete_bookmark');
INSERT INTO `auth_permission`
VALUES (44, 'Can view 书签连接', 11, 'view_bookmark');
INSERT INTO `auth_permission`
VALUES (45, 'Can add 公告', 12, 'add_bulletin');
INSERT INTO `auth_permission`
VALUES (46, 'Can change 公告', 12, 'change_bulletin');
INSERT INTO `auth_permission`
VALUES (47, 'Can delete 公告', 12, 'delete_bulletin');
INSERT INTO `auth_permission`
VALUES (48, 'Can view 公告', 12, 'view_bulletin');
INSERT INTO `auth_permission`
VALUES (49, 'Can add 用户信息', 13, 'add_user');
INSERT INTO `auth_permission`
VALUES (50, 'Can change 用户信息', 13, 'change_user');
INSERT INTO `auth_permission`
VALUES (51, 'Can delete 用户信息', 13, 'delete_user');
INSERT INTO `auth_permission`
VALUES (52, 'Can view 用户信息', 13, 'view_user');
INSERT INTO `auth_permission`
VALUES (53, 'Can add captcha store', 14, 'add_captchastore');
INSERT INTO `auth_permission`
VALUES (54, 'Can change captcha store', 14, 'change_captchastore');
INSERT INTO `auth_permission`
VALUES (55, 'Can delete captcha store', 14, 'delete_captchastore');
INSERT INTO `auth_permission`
VALUES (56, 'Can view captcha store', 14, 'view_captchastore');
INSERT INTO `auth_permission`
VALUES (57, 'Can add site', 15, 'add_site');
INSERT INTO `auth_permission`
VALUES (58, 'Can change site', 15, 'change_site');
INSERT INTO `auth_permission`
VALUES (59, 'Can delete site', 15, 'delete_site');
INSERT INTO `auth_permission`
VALUES (60, 'Can view site', 15, 'view_site');
INSERT INTO `auth_permission`
VALUES (61, 'Can add email address', 16, 'add_emailaddress');
INSERT INTO `auth_permission`
VALUES (62, 'Can change email address', 16, 'change_emailaddress');
INSERT INTO `auth_permission`
VALUES (63, 'Can delete email address', 16, 'delete_emailaddress');
INSERT INTO `auth_permission`
VALUES (64, 'Can view email address', 16, 'view_emailaddress');
INSERT INTO `auth_permission`
VALUES (65, 'Can add email confirmation', 17, 'add_emailconfirmation');
INSERT INTO `auth_permission`
VALUES (66, 'Can change email confirmation', 17, 'change_emailconfirmation');
INSERT INTO `auth_permission`
VALUES (67, 'Can delete email confirmation', 17, 'delete_emailconfirmation');
INSERT INTO `auth_permission`
VALUES (68, 'Can view email confirmation', 17, 'view_emailconfirmation');
INSERT INTO `auth_permission`
VALUES (69, 'Can add social application', 18, 'add_socialapp');
INSERT INTO `auth_permission`
VALUES (70, 'Can change social application', 18, 'change_socialapp');
INSERT INTO `auth_permission`
VALUES (71, 'Can delete social application', 18, 'delete_socialapp');
INSERT INTO `auth_permission`
VALUES (72, 'Can view social application', 18, 'view_socialapp');
INSERT INTO `auth_permission`
VALUES (73, 'Can add social account', 19, 'add_socialaccount');
INSERT INTO `auth_permission`
VALUES (74, 'Can change social account', 19, 'change_socialaccount');
INSERT INTO `auth_permission`
VALUES (75, 'Can delete social account', 19, 'delete_socialaccount');
INSERT INTO `auth_permission`
VALUES (76, 'Can view social account', 19, 'view_socialaccount');
INSERT INTO `auth_permission`
VALUES (77, 'Can add social application token', 20, 'add_socialtoken');
INSERT INTO `auth_permission`
VALUES (78, 'Can change social application token', 20, 'change_socialtoken');
INSERT INTO `auth_permission`
VALUES (79, 'Can delete social application token', 20, 'delete_socialtoken');
INSERT INTO `auth_permission`
VALUES (80, 'Can view social application token', 20, 'view_socialtoken');
INSERT INTO `auth_permission`
VALUES (81, '123', 20, '123');
COMMIT;

-- ----------------------------
-- Table structure for captcha_captchastore
-- ----------------------------
DROP TABLE IF EXISTS `captcha_captchastore`;
CREATE TABLE `captcha_captchastore`
(
    `id`         int(11)     NOT NULL AUTO_INCREMENT,
    `challenge`  varchar(32) NOT NULL,
    `response`   varchar(32) NOT NULL,
    `hashkey`    varchar(40) NOT NULL,
    `expiration` datetime(6) NOT NULL,
    PRIMARY KEY (`id`) USING BTREE,
    UNIQUE KEY `hashkey` (`hashkey`) USING BTREE
) ENGINE = InnoDB
  DEFAULT CHARSET = utf8;

-- ----------------------------
-- Records of captcha_captchastore
-- ----------------------------
BEGIN;
COMMIT;

-- ----------------------------
-- Table structure for django_admin_log
-- ----------------------------
DROP TABLE IF EXISTS `django_admin_log`;
CREATE TABLE `django_admin_log`
(
    `id`              int(11)              NOT NULL AUTO_INCREMENT,
    `action_time`     datetime(6)          NOT NULL,
    `object_id`       longtext,
    `object_repr`     varchar(200)         NOT NULL,
    `action_flag`     smallint(5) unsigned NOT NULL,
    `change_message`  longtext             NOT NULL,
    `content_type_id` int(11) DEFAULT NULL,
    `user_id`         int(11)              NOT NULL,
    PRIMARY KEY (`id`) USING BTREE,
    KEY `django_admin_log_content_type_id_c4bce8eb_fk_django_co` (`content_type_id`) USING BTREE,
    KEY `django_admin_log_user_id_c564eba6_fk_user_user_id` (`user_id`) USING BTREE,
    CONSTRAINT `django_admin_log_content_type_id_c4bce8eb_fk_django_co` FOREIGN KEY (`content_type_id`) REFERENCES `django_content_type` (`id`),
    CONSTRAINT `django_admin_log_user_id_c564eba6_fk_user_user_id` FOREIGN KEY (`user_id`) REFERENCES `user_user` (`id`)
) ENGINE = InnoDB
  AUTO_INCREMENT = 109
  DEFAULT CHARSET = utf8;

-- ----------------------------
-- Records of django_admin_log
-- ----------------------------
BEGIN;
INSERT INTO `django_admin_log`
VALUES (17, '2020-06-18 08:44:31.027446', '9', '陳陳陳通', 3, '', 13, 1);
INSERT INTO `django_admin_log`
VALUES (18, '2020-06-18 08:44:31.038928', '8', 'ct437383389', 3, '', 13, 1);
INSERT INTO `django_admin_log`
VALUES (19, '2020-06-18 08:45:44.379157', '7', '【搜索功能】从Mysql替换为elasticsearch。赶紧去试试吧, 输入关键字会有错误纠正、关键字高亮偶 ！！', 1,
        '[{\"added\": {}}]', 12, 1);
INSERT INTO `django_admin_log`
VALUES (20, '2020-07-04 14:10:42.212143', '114', '简洁的 Mac 图床客户端 uPic', 1, '[{\"added\": {}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (21, '2020-07-04 14:14:38.056945', '114', '简洁的 Mac 图床客户端 uPic', 2,
        '[{\"changed\": {\"fields\": [\"body\", \"views\"]}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (22, '2020-07-04 14:17:56.288561', '114', '简洁的 Mac 图床客户端 uPic', 2,
        '[{\"changed\": {\"fields\": [\"created_time\", \"modified_time\"]}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (23, '2020-07-04 14:19:03.248645', '114', '简洁的 Mac 图床客户端 uPic', 2,
        '[{\"changed\": {\"fields\": [\"created_time\", \"modified_time\"]}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (24, '2020-07-04 14:25:15.417707', '114', '简洁的 Mac 图床客户端 uPic', 2, '[{\"changed\": {\"fields\": [\"body\"]}}]',
        7, 1);
INSERT INTO `django_admin_log`
VALUES (25, '2020-07-04 15:00:35.766623', '114', '简洁的 Mac 图床客户端 uPic', 2,
        '[{\"changed\": {\"fields\": [\"modified_time\"]}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (26, '2020-07-04 15:26:51.865300', '24', '使用Docker部署Django应用的过程和心得', 2,
        '[{\"changed\": {\"fields\": [\"top\"]}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (27, '2020-07-04 15:27:02.877475', '24', '使用Docker部署Django应用的过程和心得', 2,
        '[{\"changed\": {\"fields\": [\"top\"]}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (28, '2020-07-04 15:27:21.406927', '68', 'celery 定时任务 后台守护进程 多进程任务-实战踩坑', 2,
        '[{\"changed\": {\"fields\": [\"body\", \"created_time\", \"modified_time\", \"views\"]}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (29, '2020-07-04 15:31:56.516966', '102', '关于博客', 2,
        '[{\"changed\": {\"fields\": [\"views\", \"is_private\"]}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (30, '2020-07-04 15:41:38.756695', '87', 'Mysql插入emoji表情符号错误 ???❤????', 2,
        '[{\"changed\": {\"fields\": [\"created_time\", \"modified_time\", \"views\"]}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (31, '2020-07-04 15:42:16.788719', '62', '稳定易用的 Django 分页库，完善分页功能', 2,
        '[{\"changed\": {\"fields\": [\"body\", \"views\"]}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (32, '2020-07-04 15:42:54.472155', '87', 'Mysql插入emoji表情符号错误 ???❤????', 2,
        '[{\"changed\": {\"fields\": [\"views\"]}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (33, '2020-07-04 15:43:42.158361', '87', 'Mysql插入emoji表情符号错误 ???❤????', 2,
        '[{\"changed\": {\"fields\": [\"views\"]}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (34, '2020-07-05 04:15:47.247437', '102', '关于博客', 2, '[{\"changed\": {\"fields\": [\"is_private\"]}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (35, '2020-07-05 04:17:25.494957', '102', '关于博客', 2, '[{\"changed\": {\"fields\": [\"top\", \"is_private\"]}}]',
        7, 1);
INSERT INTO `django_admin_log`
VALUES (36, '2020-07-05 04:30:45.615958', '27', '观摩观摩', 3, '', 8, 1);
INSERT INTO `django_admin_log`
VALUES (37, '2020-07-05 04:30:45.625921', '26', '观摩观摩', 3, '', 8, 1);
INSERT INTO `django_admin_log`
VALUES (38, '2020-07-05 04:30:45.633109', '25', '观摩观摩', 3, '', 8, 1);
INSERT INTO `django_admin_log`
VALUES (39, '2020-07-05 04:30:45.646309', '24', '观摩观摩', 3, '', 8, 1);
INSERT INTO `django_admin_log`
VALUES (40, '2020-07-20 01:53:48.839519', '116', 'Pandas中groupby的这些用法', 1, '[{\"added\": {}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (41, '2020-07-23 01:36:17.538862', '117', 'mysql查询group_concat()数据不全导致数据被截断问题', 1, '[{\"added\": {}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (42, '2020-07-24 09:28:24.350583', '52', 'SQL语句中----删除表数据drop、truncate和delete的用法', 2,
        '[{\"changed\": {\"fields\": [\"tag\"]}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (43, '2020-07-24 09:29:32.504517', '103', '如何在移动端不加载不必要的js和动画等', 2, '[{\"changed\": {\"fields\": [\"tag\"]}}]',
        7, 1);
INSERT INTO `django_admin_log`
VALUES (44, '2020-09-14 04:39:41.037170', '119', 'Zeal——好用的离线 API 文档大全！', 1, '[{\"added\": {}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (45, '2020-09-16 01:15:33.172538', '120', 'Python ASGI 框架 快如闪电的异步服务器Uvicorn', 1, '[{\"added\": {}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (46, '2020-09-16 01:20:03.145953', '120', 'Python ASGI 框架 快如闪电的异步服务器Uvicorn', 2,
        '[{\"changed\": {\"fields\": [\"body\"]}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (47, '2020-09-16 01:33:57.619719', '120', 'Python ASGI 框架 快如闪电的异步服务器Uvicorn', 2,
        '[{\"changed\": {\"fields\": [\"body\"]}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (48, '2020-10-26 15:04:54.200373', '121', '「超级右键」Mac上最强的右键菜单工具，让你效率飞起！', 1, '[{\"added\": {}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (49, '2020-11-09 10:58:19.348853', '122', 'Navicat Premium 15.0.22 中文语言包', 1, '[{\"added\": {}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (50, '2020-11-27 14:43:19.324402', '123', 'Java中静态代码块、构造代码块、构造函数、普通代码块', 1, '[{\"added\": {}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (51, '2020-11-27 15:00:01.296408', '123', 'Java中静态代码块、构造代码块、构造函数、普通代码块', 2,
        '[{\"changed\": {\"fields\": [\"body\"]}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (52, '2020-11-27 15:05:00.176749', '123', 'Java中静态代码块、构造代码块、构造函数、普通代码块', 2,
        '[{\"changed\": {\"fields\": [\"body\"]}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (53, '2020-11-27 15:15:22.087917', '123', 'Java中静态代码块、构造代码块、构造函数、普通代码块', 2,
        '[{\"changed\": {\"fields\": [\"body\"]}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (54, '2020-12-01 03:06:02.546533', '124', 'macOS 开启外接显示器 HiDPI', 1, '[{\"added\": {}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (55, '2020-12-01 03:06:58.870394', '124', 'macOS 开启外接显示器 HiDPI', 2, '[{\"changed\": {\"fields\": [\"body\"]}}]',
        7, 1);
INSERT INTO `django_admin_log`
VALUES (56, '2020-12-01 03:15:37.788773', '124', 'macOS 开启外接显示器 HiDPI⚡️', 2,
        '[{\"changed\": {\"fields\": [\"title\"]}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (57, '2020-12-07 03:57:27.636093', '2', '彭于晏济南分晏的记事本', 1, '[{\"added\": {}}]', 10, 1);
INSERT INTO `django_admin_log`
VALUES (58, '2020-12-08 10:14:33.581332', '122', 'Navicat Premium 15.0.22 中文语言包', 2,
        '[{\"changed\": {\"fields\": [\"body\"]}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (59, '2020-12-08 10:16:57.300395', '91', 'Locust：简介和基本用法', 2, '[{\"changed\": {\"fields\": [\"body\"]}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (60, '2020-12-08 10:18:07.534467', '98', 'elasticsearch之建议器简介', 2, '[{\"changed\": {\"fields\": [\"body\"]}}]',
        7, 1);
INSERT INTO `django_admin_log`
VALUES (61, '2020-12-08 10:18:53.080974', '34', '实现机器远程跳转的两种自动化方式', 2, '[{\"changed\": {\"fields\": [\"body\"]}}]', 7,
        1);
INSERT INTO `django_admin_log`
VALUES (62, '2020-12-08 14:47:10.989659', '124', 'macOS 开启外接显示器 HiDPI⚡️', 2,
        '[{\"changed\": {\"fields\": [\"body\"]}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (63, '2020-12-21 08:31:07.770236', '125', 'PostmanCn: Postman中文版', 1, '[{\"added\": {}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (64, '2020-12-21 08:34:03.401231', '125', 'PostmanCn: Postman中文版', 2,
        '[{\"changed\": {\"fields\": [\"body\"]}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (65, '2020-12-21 08:34:49.333685', '125', 'PostmanCn: Postman中文版', 2,
        '[{\"changed\": {\"fields\": [\"body\"]}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (66, '2020-12-21 08:37:02.770876', '125', 'PostmanCn: Postman中文版', 2,
        '[{\"changed\": {\"fields\": [\"body\"]}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (67, '2020-12-24 09:06:09.708170', '126', 'gRPC详解', 1, '[{\"added\": {}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (68, '2020-12-24 09:10:15.461976', '126', 'gRPC详解', 2, '[{\"changed\": {\"fields\": [\"body\"]}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (69, '2020-12-24 09:11:11.783683', '126', 'gRPC详解', 2, '[{\"changed\": {\"fields\": [\"body\"]}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (70, '2021-01-15 02:26:41.181000', '127', 'Django Elasticsearch DSL', 1, '[{\"added\": {}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (71, '2021-01-15 02:27:58.473917', '127', 'Django Elasticsearch DSL', 2,
        '[{\"changed\": {\"fields\": [\"body\"]}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (72, '2021-01-25 05:41:04.460915', '128', 'Django gRPC 应用', 1, '[{\"added\": {}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (73, '2021-01-25 05:42:08.192975', '128', 'Django gRPC 应用', 2, '[{\"changed\": {\"fields\": [\"body\"]}}]', 7,
        1);
INSERT INTO `django_admin_log`
VALUES (74, '2021-01-25 05:57:24.234472', '128', 'Django gRPC 应用', 2, '[{\"changed\": {\"fields\": [\"body\"]}}]', 7,
        1);
INSERT INTO `django_admin_log`
VALUES (75, '2021-01-25 05:58:44.502473', '128', 'Django gRPC 应用', 2, '[{\"changed\": {\"fields\": [\"body\"]}}]', 7,
        1);
INSERT INTO `django_admin_log`
VALUES (76, '2021-02-22 03:09:48.345690', '129', '更换（Pypi）pip源到国内镜像', 1, '[{\"added\": {}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (77, '2021-02-22 03:36:27.356771', '129', '更换（Pypi）pip源到国内镜像', 2, '[{\"changed\": {\"fields\": [\"body\"]}}]', 7,
        1);
INSERT INTO `django_admin_log`
VALUES (78, '2021-02-23 08:16:24.415329', '1', 'chen', 2,
        '[{\"changed\": {\"fields\": [\"password\", \"last_login\"]}}]', 13, 1);
INSERT INTO `django_admin_log`
VALUES (79, '2021-02-23 08:17:26.881288', '3', 'http://62.234.99.85/', 3, '', 15, 1);
INSERT INTO `django_admin_log`
VALUES (80, '2021-02-23 08:17:36.439969', '2', 'https://ch3nnn.cn/', 2,
        '[{\"changed\": {\"fields\": [\"domain\", \"name\"]}}]', 15, 1);
INSERT INTO `django_admin_log`
VALUES (81, '2021-04-15 14:30:46.495619', '126', 'gRPC详解', 2, '[{\"changed\": {\"fields\": [\"body\"]}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (82, '2021-04-15 14:37:23.908413', '130', '升级了bigsur，虚拟机VMWARE打不开了', 1, '[{\"added\": {}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (83, '2021-04-15 14:43:17.640922', '131', '规范python代码风格检查工具库', 1, '[{\"added\": {}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (84, '2021-04-15 14:43:53.244461', '2', 'Ch3nnnnnnnnn博客', 2, '[{\"changed\": {\"fields\": [\"url\"]}}]', 11, 1);
INSERT INTO `django_admin_log`
VALUES (85, '2021-05-21 01:27:57.811425', '3', 'syh blog', 1, '[{\"added\": {}}]', 10, 1);
INSERT INTO `django_admin_log`
VALUES (86, '2021-05-26 01:21:34.051366', '132', 'Google 内部的 Python 代码风格指南（译）', 1, '[{\"added\": {}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (87, '2021-06-03 09:22:32.129754', '4', 'Hokyee Jau', 1, '[{\"added\": {}}]', 10, 1);
INSERT INTO `django_admin_log`
VALUES (88, '2021-06-15 02:26:43.806310', '133', '[ 推荐 ] - mac精品软件汇总', 1, '[{\"added\": {}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (89, '2021-06-22 03:04:09.035549', '133', '[ 推荐 ] - mac精品软件汇总', 2, '[{\"changed\": {\"fields\": [\"body\"]}}]',
        7, 1);
INSERT INTO `django_admin_log`
VALUES (90, '2021-06-22 03:04:50.990071', '133', '[ 推荐 ] - mac精品软件汇总', 2, '[{\"changed\": {\"fields\": [\"body\"]}}]',
        7, 1);
INSERT INTO `django_admin_log`
VALUES (91, '2021-06-22 03:13:07.107958', '133', '[ 推荐 ] - mac精品软件汇总', 2,
        '[{\"changed\": {\"fields\": [\"body\", \"modified_time\"]}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (92, '2021-06-22 03:16:15.347031', '133', '[ 推荐 ] - mac精品软件汇总', 2, '[{\"changed\": {\"fields\": [\"body\"]}}]',
        7, 1);
INSERT INTO `django_admin_log`
VALUES (93, '2021-07-02 07:58:07.792395', '1', 'chen', 2, '[{\"changed\": {\"fields\": [\"last_login\", \"text\"]}}]',
        13, 1);
INSERT INTO `django_admin_log`
VALUES (94, '2021-07-02 08:05:47.371691', '1', 'chen', 2, '[{\"changed\": {\"fields\": [\"text\"]}}]', 13, 1);
INSERT INTO `django_admin_log`
VALUES (95, '2021-07-02 08:08:28.784321', '1', 'chen', 2, '[{\"changed\": {\"fields\": [\"text\"]}}]', 13, 1);
INSERT INTO `django_admin_log`
VALUES (96, '2021-07-02 08:23:52.053397', '1', 'chen', 2, '[{\"changed\": {\"fields\": [\"text\"]}}]', 13, 1);
INSERT INTO `django_admin_log`
VALUES (97, '2021-07-02 08:25:58.113948', '1', 'chen', 2, '[{\"changed\": {\"fields\": [\"nickname\", \"link\"]}}]', 13,
        1);
INSERT INTO `django_admin_log`
VALUES (98, '2021-07-05 09:28:51.644448', '134', 'Mac Pycharm 打不开的解决方法(亲测有效)', 1, '[{\"added\": {}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (99, '2021-07-06 09:05:47.855952', '135', 'Github标星34K+Star，这款开源项目助你秒建Git服务！', 1, '[{\"added\": {}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (100, '2021-07-06 09:34:37.504330', '135', 'Github标星34K+Star，这款开源项目助你秒建Git服务！', 2,
        '[{\"changed\": {\"fields\": [\"body\"]}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (101, '2021-07-07 06:17:18.931856', '136', '性能测试——Jmeter（ Mac & Cent OS )', 1, '[{\"added\": {}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (102, '2021-07-07 06:20:18.787671', '136', '性能测试——Jmeter（ Mac & Cent OS )', 2,
        '[{\"changed\": {\"fields\": [\"body\"]}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (103, '2021-07-07 06:22:10.608092', '135', 'Github标星34K+Star，这款开源项目助你秒建Git服务！', 2,
        '[{\"changed\": {\"fields\": [\"body\"]}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (104, '2021-07-07 06:23:13.609341', '128', 'Django gRPC 应用', 2, '[{\"changed\": {\"fields\": [\"body\"]}}]', 7,
        1);
INSERT INTO `django_admin_log`
VALUES (105, '2021-07-07 06:23:14.900038', '128', 'Django gRPC 应用', 2, '[]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (106, '2021-07-07 06:24:20.295182', '125', 'PostmanCn: Postman中文版', 2,
        '[{\"changed\": {\"fields\": [\"body\"]}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (107, '2021-07-07 06:24:41.385990', '122', 'Navicat Premium 15.0.22 中文语言包', 2,
        '[{\"changed\": {\"fields\": [\"body\"]}}]', 7, 1);
INSERT INTO `django_admin_log`
VALUES (108, '2021-07-15 01:51:16.340036', '86', 'jQuery弹出窗口插件 FancyBox', 2,
        '[{\"changed\": {\"fields\": [\"body\"]}}]', 7, 1);
COMMIT;

-- ----------------------------
-- Table structure for django_content_type
-- ----------------------------
DROP TABLE IF EXISTS `django_content_type`;
CREATE TABLE `django_content_type`
(
    `id`        int(11)      NOT NULL AUTO_INCREMENT,
    `app_label` varchar(100) NOT NULL,
    `model`     varchar(100) NOT NULL,
    PRIMARY KEY (`id`) USING BTREE,
    UNIQUE KEY `django_content_type_app_label_model_76bd3d3b_uniq` (`app_label`, `model`) USING BTREE
) ENGINE = InnoDB
  AUTO_INCREMENT = 21
  DEFAULT CHARSET = utf8;

-- ----------------------------
-- Records of django_content_type
-- ----------------------------
BEGIN;
INSERT INTO `django_content_type`
VALUES (16, 'account', 'emailaddress');
INSERT INTO `django_content_type`
VALUES (17, 'account', 'emailconfirmation');
INSERT INTO `django_content_type`
VALUES (1, 'admin', 'logentry');
INSERT INTO `django_content_type`
VALUES (3, 'auth', 'group');
INSERT INTO `django_content_type`
VALUES (2, 'auth', 'permission');
INSERT INTO `django_content_type`
VALUES (11, 'blog', 'bookmark');
INSERT INTO `django_content_type`
VALUES (12, 'blog', 'bulletin');
INSERT INTO `django_content_type`
VALUES (6, 'blog', 'category');
INSERT INTO `django_content_type`
VALUES (8, 'blog', 'comments');
INSERT INTO `django_content_type`
VALUES (10, 'blog', 'friendlink');
INSERT INTO `django_content_type`
VALUES (7, 'blog', 'post');
INSERT INTO `django_content_type`
VALUES (9, 'blog', 'tag');
INSERT INTO `django_content_type`
VALUES (14, 'captcha', 'captchastore');
INSERT INTO `django_content_type`
VALUES (4, 'contenttypes', 'contenttype');
INSERT INTO `django_content_type`
VALUES (5, 'sessions', 'session');
INSERT INTO `django_content_type`
VALUES (15, 'sites', 'site');
INSERT INTO `django_content_type`
VALUES (19, 'socialaccount', 'socialaccount');
INSERT INTO `django_content_type`
VALUES (18, 'socialaccount', 'socialapp');
INSERT INTO `django_content_type`
VALUES (20, 'socialaccount', 'socialtoken');
INSERT INTO `django_content_type`
VALUES (13, 'user', 'user');
COMMIT;

-- ----------------------------
-- Table structure for django_migrations
-- ----------------------------
DROP TABLE IF EXISTS `django_migrations`;
CREATE TABLE `django_migrations`
(
    `id`      int(11)      NOT NULL AUTO_INCREMENT,
    `app`     varchar(255) NOT NULL,
    `name`    varchar(255) NOT NULL,
    `applied` datetime(6)  NOT NULL,
    PRIMARY KEY (`id`) USING BTREE
) ENGINE = InnoDB
  AUTO_INCREMENT = 28
  DEFAULT CHARSET = utf8;

-- ----------------------------
-- Records of django_migrations
-- ----------------------------
BEGIN;
INSERT INTO `django_migrations`
VALUES (1, 'contenttypes', '0001_initial', '2020-06-18 02:12:35.814452');
INSERT INTO `django_migrations`
VALUES (2, 'contenttypes', '0002_remove_content_type_name', '2020-06-18 02:12:35.995473');
INSERT INTO `django_migrations`
VALUES (3, 'auth', '0001_initial', '2020-06-18 02:12:36.518323');
INSERT INTO `django_migrations`
VALUES (4, 'auth', '0002_alter_permission_name_max_length', '2020-06-18 02:12:36.617832');
INSERT INTO `django_migrations`
VALUES (5, 'auth', '0003_alter_user_email_max_length', '2020-06-18 02:12:36.633886');
INSERT INTO `django_migrations`
VALUES (6, 'auth', '0004_alter_user_username_opts', '2020-06-18 02:12:36.651697');
INSERT INTO `django_migrations`
VALUES (7, 'auth', '0005_alter_user_last_login_null', '2020-06-18 02:12:36.666231');
INSERT INTO `django_migrations`
VALUES (8, 'auth', '0006_require_contenttypes_0002', '2020-06-18 02:12:36.673945');
INSERT INTO `django_migrations`
VALUES (9, 'auth', '0007_alter_validators_add_error_messages', '2020-06-18 02:12:36.688437');
INSERT INTO `django_migrations`
VALUES (10, 'auth', '0008_alter_user_username_max_length', '2020-06-18 02:12:36.706317');
INSERT INTO `django_migrations`
VALUES (11, 'auth', '0009_alter_user_last_name_max_length', '2020-06-18 02:12:36.722116');
INSERT INTO `django_migrations`
VALUES (12, 'user', '0001_initial', '2020-06-18 02:12:37.359134');
INSERT INTO `django_migrations`
VALUES (13, 'account', '0001_initial', '2020-06-18 02:12:37.684737');
INSERT INTO `django_migrations`
VALUES (14, 'account', '0002_email_max_length', '2020-06-18 02:12:37.800160');
INSERT INTO `django_migrations`
VALUES (15, 'admin', '0001_initial', '2020-06-18 02:12:38.042732');
INSERT INTO `django_migrations`
VALUES (16, 'admin', '0002_logentry_remove_auto_add', '2020-06-18 02:12:38.066027');
INSERT INTO `django_migrations`
VALUES (17, 'admin', '0003_logentry_add_action_flag_choices', '2020-06-18 02:12:38.085666');
INSERT INTO `django_migrations`
VALUES (18, 'blog', '0001_initial', '2020-06-18 02:12:38.421173');
INSERT INTO `django_migrations`
VALUES (19, 'blog', '0002_auto_20200618_1012', '2020-06-18 02:12:39.652720');
INSERT INTO `django_migrations`
VALUES (20, 'captcha', '0001_initial', '2020-06-18 02:12:39.717574');
INSERT INTO `django_migrations`
VALUES (21, 'sessions', '0001_initial', '2020-06-18 02:12:39.823601');
INSERT INTO `django_migrations`
VALUES (22, 'sites', '0001_initial', '2020-06-18 02:12:39.875498');
INSERT INTO `django_migrations`
VALUES (23, 'sites', '0002_alter_domain_unique', '2020-06-18 02:12:39.920345');
INSERT INTO `django_migrations`
VALUES (24, 'socialaccount', '0001_initial', '2020-06-18 02:12:40.828658');
INSERT INTO `django_migrations`
VALUES (25, 'socialaccount', '0002_token_max_lengths', '2020-06-18 02:12:41.114885');
INSERT INTO `django_migrations`
VALUES (26, 'socialaccount', '0003_extra_data_default_dict', '2020-06-18 02:12:41.141429');
INSERT INTO `django_migrations`
VALUES (27, 'user', '0002_auto_20200704_2202', '2020-07-04 14:03:00.236718');
COMMIT;

-- ----------------------------
-- Table structure for django_session
-- ----------------------------
DROP TABLE IF EXISTS `django_session`;
CREATE TABLE `django_session`
(
    `session_key`  varchar(40) NOT NULL,
    `session_data` longtext    NOT NULL,
    `expire_date`  datetime(6) NOT NULL,
    PRIMARY KEY (`session_key`) USING BTREE,
    KEY `django_session_expire_date_a5c62663` (`expire_date`) USING BTREE
) ENGINE = InnoDB
  DEFAULT CHARSET = utf8;

-- ----------------------------
-- Records of django_session
-- ----------------------------
BEGIN;
COMMIT;

-- ----------------------------
-- Table structure for django_site
-- ----------------------------
DROP TABLE IF EXISTS `django_site`;
CREATE TABLE `django_site`
(
    `id`     int(11)      NOT NULL AUTO_INCREMENT,
    `domain` varchar(100) NOT NULL,
    `name`   varchar(50)  NOT NULL,
    PRIMARY KEY (`id`) USING BTREE,
    UNIQUE KEY `django_site_domain_a2e37b91_uniq` (`domain`) USING BTREE
) ENGINE = InnoDB
  AUTO_INCREMENT = 3
  DEFAULT CHARSET = utf8;

-- ----------------------------
-- Records of django_site
-- ----------------------------
BEGIN;
INSERT INTO `django_site`
VALUES (2, 'www.ch3nnn.cn', 'www.ch3nnn.cn');
COMMIT;

-- ----------------------------
-- Table structure for socialaccount_socialaccount
-- ----------------------------
DROP TABLE IF EXISTS `socialaccount_socialaccount`;
CREATE TABLE `socialaccount_socialaccount`
(
    `id`          int(11)      NOT NULL AUTO_INCREMENT,
    `provider`    varchar(30)  NOT NULL,
    `uid`         varchar(191) NOT NULL,
    `last_login`  datetime(6)  NOT NULL,
    `date_joined` datetime(6)  NOT NULL,
    `extra_data`  longtext     NOT NULL,
    `user_id`     int(11)      NOT NULL,
    PRIMARY KEY (`id`) USING BTREE,
    UNIQUE KEY `socialaccount_socialaccount_provider_uid_fc810c6e_uniq` (`provider`, `uid`) USING BTREE,
    KEY `socialaccount_socialaccount_user_id_8146e70c_fk_user_user_id` (`user_id`) USING BTREE,
    CONSTRAINT `socialaccount_socialaccount_user_id_8146e70c_fk_user_user_id` FOREIGN KEY (`user_id`) REFERENCES `user_user` (`id`)
) ENGINE = InnoDB
  AUTO_INCREMENT = 14
  DEFAULT CHARSET = utf8;

-- ----------------------------
-- Records of socialaccount_socialaccount
-- ----------------------------
BEGIN;
INSERT INTO `socialaccount_socialaccount`
VALUES (6, 'weibo', '2729718737', '2021-03-20 13:30:06.287059', '2020-06-18 09:12:42.935432',
        '{\"bi_followers_count\": 129, \"is_guardian\": 0, \"mbtype\": 2, \"profile_image_url\": \"https://tvax3.sinaimg.cn/crop.0.0.828.828.50/a2b433d1ly8gczmyo1jmkj20n00n0wfc.jpg?KID=imgbed,tva&Expires=1616257806&ssig=Ut7z763J1c\", \"weihao\": \"\", \"vclub_member\": 0, \"id\": 2729718737, \"planet_video\": 0, \"verified_source_url\": \"\", \"video_status_count\": 0, \"pc_new\": 0, \"block_app\": 0, \"like\": false, \"class\": 1, \"follow_me\": false, \"city\": \"1000\", \"verified_reason\": \"\", \"insecurity\": {\"sexual_content\": false}, \"verified_source\": \"\", \"is_teenager_list\": 0, \"location\": \"\\u5317\\u4eac\", \"followers_count\": 638, \"is_teenager\": 0, \"credit_score\": 80, \"video_mark\": 0, \"live_status\": 0, \"pagefriends_count\": 0, \"lang\": \"zh-cn\", \"verified_reason_url\": \"\", \"ptype\": 0, \"story_read_state\": -1, \"screen_name\": \"\\u9673\\u9673\\u9673\\u901a\", \"url\": \"\", \"remark\": \"\", \"idstr\": \"2729718737\", \"verified_type\": -1, \"user_ability\": 3408896, \"description\": \"\\u6298\\u817e\\u4e0d\\u606f\\u00b7\\u4e50\\u6b64\\u4e0d\\u75b2\", \"following\": false, \"statuses_count\": 620, \"block_word\": 0, \"verified_trade\": \"\", \"name\": \"\\u9673\\u9673\\u9673\\u901a\", \"verified\": false, \"star\": 0, \"online_status\": 0, \"mbrank\": 2, \"special_follow\": false, \"avatar_hd\": \"https://tvax3.sinaimg.cn/crop.0.0.828.828.1024/a2b433d1ly8gczmyo1jmkj20n00n0wfc.jpg?KID=imgbed,tva&Expires=1616257806&ssig=TTEP63%2BhSa\", \"favourites_count\": 35, \"video_play_count\": 0, \"urank\": 30, \"cardid\": \"star_583\", \"friends_count\": 183, \"status\": {\"mid\": \"4614700899239420\", \"source_allowclick\": 0, \"comments_count\": 0, \"biz_ids\": [100101], \"source\": \"<a href=\\\"http://weibo.com/\\\" rel=\\\"nofollow\\\">iPhone\\u5ba2\\u6237\\u7aef</a>\", \"id\": 4614700899239420, \"in_reply_to_screen_name\": \"\", \"visible\": {\"type\": 0, \"list_id\": 0}, \"bmiddle_pic\": \"http://wx3.sinaimg.cn/bmiddle/a2b433d1gy1gojk5qqclij21hc0u0dj7.jpg\", \"mblogtype\": 0, \"is_show_bulletin\": 2, \"in_reply_to_user_id\": \"\", \"pic_num\": 2, \"comment_manage_info\": {\"comment_permission_type\": -1, \"approval_comment_type\": 0}, \"isLongText\": false, \"source_type\": 2, \"content_auth\": 0, \"truncated\": false, \"text_tag_tips\": [], \"pic_urls\": [{\"thumbnail_pic\": \"http://wx3.sinaimg.cn/thumbnail/a2b433d1gy1gojk5qqclij21hc0u0dj7.jpg\"}, {\"thumbnail_pic\": \"http://wx3.sinaimg.cn/thumbnail/a2b433d1gy1gojk5q4ppfj21hc0u0dj1.jpg\"}], \"original_pic\": \"http://wx3.sinaimg.cn/large/a2b433d1gy1gojk5qqclij21hc0u0dj7.jpg\", \"cardid\": \"star_583\", \"pending_approval_count\": 0, \"picStatus\": \"0:1,1:1\", \"show_additional_indication\": 0, \"text\": \"#csgo# \\u780d\\u5200\\ud83d\\udd2a http://t.cn/RxDsnbV\", \"rid\": \"0\", \"idstr\": \"4614700899239420\", \"is_paid\": false, \"textLength\": 35, \"hot_weibo_tags\": [], \"userType\": 0, \"positive_recom_flag\": 0, \"attitudes_count\": 0, \"reposts_count\": 0, \"darwin_tags\": [], \"mblog_vip_type\": 0, \"hide_flag\": 0, \"reward_exhibition_type\": 0, \"favorited\": false, \"thumbnail_pic\": \"http://wx3.sinaimg.cn/thumbnail/a2b433d1gy1gojk5qqclij21hc0u0dj7.jpg\", \"gif_ids\": \"\", \"more_info_type\": 0, \"created_at\": \"Sun Mar 14 17:24:54 +0800 2021\", \"geo\": null, \"can_edit\": false, \"hasActionTypeCard\": 0, \"page_type\": 72, \"annotations\": [{\"client_mblogid\": \"iPhone-E6A155B3-F2C8-43E5-B01C-3C3438195802\", \"place\": {\"poiid\": \"8008633010000000000\", \"title\": \"\\u676d\\u5dde\", \"type\": \"checkin\"}}, {\"mapi_request\": true}], \"in_reply_to_status_id\": \"\", \"mlevel\": 0, \"biz_feature\": 4294967300}, \"cover_image_phone\": \"http://ww1.sinaimg.cn/crop.0.0.640.640.640/9d44112bjw1f1xl1c10tuj20hs0hs0tw.jpg\", \"gender\": \"m\", \"allow_all_act_msg\": false, \"avatar_large\": \"https://tvax3.sinaimg.cn/crop.0.0.828.828.180/a2b433d1ly8gczmyo1jmkj20n00n0wfc.jpg?KID=imgbed,tva&Expires=1616257806&ssig=12ZQuP%2BEXm\", \"user_ability_extend\": 0, \"geo_enabled\": true, \"like_me\": false, \"province\": \"11\", \"created_at\": \"Sat Apr 21 12:41:45 +0800 2012\", \"allow_all_comment\": true, \"domain\": \"chenyinren\", \"profile_url\": \"chenyinren\"}',
        11);
INSERT INTO `socialaccount_socialaccount`
VALUES (7, 'github', '32930577', '2020-06-18 09:29:28.273002', '2020-06-18 09:29:28.273082',
        '{\"avatar_url\": \"https://avatars1.githubusercontent.com/u/32930577?v=4\", \"email\": null, \"node_id\": \"MDQ6VXNlcjMyOTMwNTc3\", \"location\": null, \"id\": 32930577, \"following\": 0, \"followers_url\": \"https://api.github.com/users/dapang-Gao/followers\", \"public_repos\": 0, \"updated_at\": \"2020-06-18T09:29:14Z\", \"received_events_url\": \"https://api.github.com/users/dapang-Gao/received_events\", \"repos_url\": \"https://api.github.com/users/dapang-Gao/repos\", \"type\": \"User\", \"site_admin\": false, \"following_url\": \"https://api.github.com/users/dapang-Gao/following{/other_user}\", \"public_gists\": 0, \"bio\": null, \"followers\": 0, \"url\": \"https://api.github.com/users/dapang-Gao\", \"company\": null, \"gravatar_id\": \"\", \"name\": null, \"starred_url\": \"https://api.github.com/users/dapang-Gao/starred{/owner}{/repo}\", \"subscriptions_url\": \"https://api.github.com/users/dapang-Gao/subscriptions\", \"created_at\": \"2017-10-19T12:11:16Z\", \"html_url\": \"https://github.com/dapang-Gao\", \"twitter_username\": null, \"gists_url\": \"https://api.github.com/users/dapang-Gao/gists{/gist_id}\", \"login\": \"dapang-Gao\", \"organizations_url\": \"https://api.github.com/users/dapang-Gao/orgs\", \"events_url\": \"https://api.github.com/users/dapang-Gao/events{/privacy}\", \"hireable\": null, \"blog\": \"\"}',
        12);
INSERT INTO `socialaccount_socialaccount`
VALUES (8, 'weibo', '7463282363', '2020-06-27 11:48:54.708861', '2020-06-27 11:48:54.708916',
        '{\"weihao\": \"\", \"insecurity\": {\"sexual_content\": false}, \"follow_me\": false, \"like\": false, \"idstr\": \"7463282363\", \"live_status\": 0, \"bi_followers_count\": 0, \"created_at\": \"Sat Jun 27 19:21:12 +0800 2020\", \"profile_image_url\": \"https://tvax1.sinaimg.cn/crop.0.0.828.828.50/00895aFZly8gg72g4y5inj30n00n0wf1.jpg?KID=imgbed,tva&Expires=1593269334&ssig=gFsiTIpsNC\", \"user_ability\": 2097152, \"planet_video\": 0, \"ptype\": 0, \"verified_type\": -1, \"is_teenager_list\": 0, \"followers_count\": 1, \"verified_trade\": \"\", \"city\": \"1000\", \"geo_enabled\": true, \"is_guardian\": 0, \"mbrank\": 0, \"credit_score\": 80, \"video_status_count\": 0, \"urank\": 0, \"mbtype\": 0, \"domain\": \"\", \"profile_url\": \"u/7463282363\", \"star\": 0, \"video_mark\": 0, \"name\": \"\\u4e0d\\u4f1a\\u64b8\\u7801\\u7a0b\\u5e8f\\u733f\", \"vclub_member\": 0, \"verified_reason\": \"\", \"is_teenager\": 0, \"remark\": \"\", \"allow_all_act_msg\": false, \"statuses_count\": 0, \"like_me\": false, \"location\": \"\\u5176\\u4ed6\", \"gender\": \"m\", \"pc_new\": 0, \"avatar_large\": \"https://tvax1.sinaimg.cn/crop.0.0.828.828.180/00895aFZly8gg72g4y5inj30n00n0wf1.jpg?KID=imgbed,tva&Expires=1593269334&ssig=aP7DPDmVnf\", \"id\": 7463282363, \"avatar_hd\": \"https://tvax1.sinaimg.cn/crop.0.0.828.828.1024/00895aFZly8gg72g4y5inj30n00n0wf1.jpg?KID=imgbed,tva&Expires=1593269334&ssig=GPErsHchKN\", \"province\": \"100\", \"verified_reason_url\": \"\", \"friends_count\": 21, \"verified\": false, \"screen_name\": \"\\u4e0d\\u4f1a\\u64b8\\u7801\\u7a0b\\u5e8f\\u733f\", \"video_play_count\": 0, \"allow_all_comment\": true, \"verified_source\": \"\", \"following\": false, \"favourites_count\": 0, \"block_word\": 0, \"block_app\": 0, \"online_status\": 0, \"story_read_state\": -1, \"email\": \"\", \"special_follow\": false, \"url\": \"\", \"lang\": \"zh-cn\", \"description\": \"\", \"class\": 1, \"verified_source_url\": \"\", \"pagefriends_count\": 3}',
        14);
INSERT INTO `socialaccount_socialaccount`
VALUES (9, 'github', '40114564', '2021-05-21 01:15:50.910131', '2020-07-05 04:23:53.058991',
        '{\"url\": \"https://api.github.com/users/ct437383389\", \"type\": \"User\", \"blog\": \"ch3nnn.cn\", \"html_url\": \"https://github.com/ct437383389\", \"gists_url\": \"https://api.github.com/users/ct437383389/gists{/gist_id}\", \"following_url\": \"https://api.github.com/users/ct437383389/following{/other_user}\", \"events_url\": \"https://api.github.com/users/ct437383389/events{/privacy}\", \"avatar_url\": \"https://avatars.githubusercontent.com/u/40114564?v=4\", \"followers\": 0, \"node_id\": \"MDQ6VXNlcjQwMTE0NTY0\", \"name\": \"Ch3nnnnnnnnn\", \"public_gists\": 0, \"bio\": null, \"received_events_url\": \"https://api.github.com/users/ct437383389/received_events\", \"public_repos\": 4, \"followers_url\": \"https://api.github.com/users/ct437383389/followers\", \"site_admin\": false, \"twitter_username\": null, \"gravatar_id\": \"\", \"starred_url\": \"https://api.github.com/users/ct437383389/starred{/owner}{/repo}\", \"id\": 40114564, \"created_at\": \"2018-06-09T11:14:08Z\", \"company\": null, \"login\": \"ct437383389\", \"repos_url\": \"https://api.github.com/users/ct437383389/repos\", \"email\": null, \"location\": \"BeiJing\", \"updated_at\": \"2021-04-26T06:57:11Z\", \"hireable\": null, \"following\": 0, \"subscriptions_url\": \"https://api.github.com/users/ct437383389/subscriptions\", \"organizations_url\": \"https://api.github.com/users/ct437383389/orgs\"}',
        15);
INSERT INTO `socialaccount_socialaccount`
VALUES (10, 'weibo', '6807413009', '2020-07-17 07:04:36.111466', '2020-07-17 07:04:36.111530',
        '{\"description\": \"\", \"urank\": 0, \"geo_enabled\": true, \"avatar_large\": \"https://tvax1.sinaimg.cn/crop.0.0.828.828.180/007qHd61ly8ggtzcda2dpj30n00n0ta9.jpg?KID=imgbed,tva&Expires=1594980276&ssig=dWkZ8UZVAU\", \"block_word\": 0, \"video_mark\": 0, \"credit_score\": 80, \"friends_count\": 29, \"verified\": false, \"video_play_count\": 0, \"class\": 1, \"story_read_state\": -1, \"pagefriends_count\": 4, \"verified_reason\": \"\", \"lang\": \"zh-cn\", \"name\": \"\\u732b\\u7af9_\", \"is_teenager_list\": 0, \"online_status\": 0, \"follow_me\": false, \"verified_type\": -1, \"screen_name\": \"\\u732b\\u7af9_\", \"verified_source\": \"\", \"star\": 0, \"like\": false, \"allow_all_act_msg\": false, \"verified_reason_url\": \"\", \"verified_trade\": \"\", \"insecurity\": {\"sexual_content\": false}, \"province\": \"100\", \"mbtype\": 0, \"bi_followers_count\": 0, \"statuses_count\": 0, \"created_at\": \"Fri Jul 17 15:01:32 +0800 2020\", \"id\": 6807413009, \"is_teenager\": 0, \"special_follow\": false, \"planet_video\": 0, \"gender\": \"m\", \"followers_count\": 1, \"live_status\": 0, \"mbrank\": 0, \"location\": \"\\u5176\\u4ed6\", \"profile_image_url\": \"https://tvax1.sinaimg.cn/crop.0.0.828.828.50/007qHd61ly8ggtzcda2dpj30n00n0ta9.jpg?KID=imgbed,tva&Expires=1594980276&ssig=J6%2Bm%2FB4o1O\", \"verified_source_url\": \"\", \"pc_new\": 0, \"user_ability\": 2097152, \"profile_url\": \"u/6807413009\", \"weihao\": \"\", \"following\": false, \"block_app\": 0, \"allow_all_comment\": true, \"like_me\": false, \"ptype\": 0, \"favourites_count\": 0, \"email\": \"\", \"url\": \"\", \"vclub_member\": 0, \"is_guardian\": 0, \"idstr\": \"6807413009\", \"domain\": \"\", \"video_status_count\": 0, \"city\": \"1000\", \"avatar_hd\": \"https://tvax1.sinaimg.cn/crop.0.0.828.828.1024/007qHd61ly8ggtzcda2dpj30n00n0ta9.jpg?KID=imgbed,tva&Expires=1594980276&ssig=PbxrRrTFTX\", \"remark\": \"\"}',
        16);
INSERT INTO `socialaccount_socialaccount`
VALUES (11, 'weibo', '5375965234', '2020-07-17 07:11:44.482835', '2020-07-17 07:11:44.482907',
        '{\"description\": \"\", \"urank\": 4, \"geo_enabled\": true, \"avatar_large\": \"https://tvax3.sinaimg.cn/crop.0.0.996.996.180/005RP08Gly8fk5gdkkvqoj30ro0roq54.jpg?KID=imgbed,tva&Expires=1594980704&ssig=zktZxQfrsh\", \"block_word\": 0, \"video_mark\": 2, \"credit_score\": 80, \"friends_count\": 149, \"verified\": false, \"video_play_count\": 0, \"class\": 1, \"story_read_state\": -1, \"pagefriends_count\": 9, \"verified_reason\": \"\", \"lang\": \"zh-cn\", \"name\": \"\\u5f00\\u5c14\\u6587\\u6728\\u6bcf\", \"is_teenager_list\": 0, \"online_status\": 0, \"follow_me\": false, \"verified_type\": -1, \"screen_name\": \"\\u5f00\\u5c14\\u6587\\u6728\\u6bcf\", \"verified_source\": \"\", \"star\": 0, \"like\": false, \"allow_all_act_msg\": false, \"verified_reason_url\": \"\", \"verified_trade\": \"\", \"insecurity\": {\"sexual_content\": false}, \"province\": \"100\", \"mbtype\": 0, \"pc_new\": 0, \"bi_followers_count\": 1, \"statuses_count\": 240, \"created_at\": \"Tue Nov 18 11:05:50 +0800 2014\", \"id\": 5375965234, \"is_teenager\": 0, \"special_follow\": false, \"planet_video\": 0, \"gender\": \"f\", \"followers_count\": 52, \"live_status\": 0, \"mbrank\": 0, \"location\": \"\\u5176\\u4ed6\", \"profile_image_url\": \"https://tvax3.sinaimg.cn/crop.0.0.996.996.50/005RP08Gly8fk5gdkkvqoj30ro0roq54.jpg?KID=imgbed,tva&Expires=1594980704&ssig=UuWNyzAlvj\", \"verified_source_url\": \"\", \"cover_image_phone\": \"http://ww1.sinaimg.cn/crop.0.0.640.640.640/549d0121tw1egm1kjly3jj20hs0hsq4f.jpg\", \"user_ability\": 2359296, \"profile_url\": \"u/5375965234\", \"weihao\": \"\", \"following\": false, \"block_app\": 0, \"allow_all_comment\": true, \"like_me\": false, \"ptype\": 0, \"favourites_count\": 0, \"email\": \"\", \"url\": \"\", \"city\": \"1000\", \"vclub_member\": 0, \"is_guardian\": 0, \"idstr\": \"5375965234\", \"domain\": \"\", \"video_status_count\": 0, \"status\": {\"sync_mblog\": true, \"darwin_tags\": [], \"in_reply_to_user_id\": \"\", \"truncated\": false, \"mblogtype\": 0, \"mid\": \"4524734044283283\", \"hide_flag\": 0, \"page_type\": 32, \"topic_id\": \"1022:100808e57bb364ea5d7b996e05bedf032aab52\", \"text\": \"#\\u5317\\u4eac\\u79df\\u623f\\u5408\\u79df[\\u8d85\\u8bdd]##\\u5317\\u4eac\\u79df\\u623f[\\u8d85\\u8bdd]##\\u5317\\u4eac\\u79df\\u623f[\\u8d85\\u8bdd]#\\u6c42\\u79df\\u5927\\u5c6f\\u8def\\u5730\\u94c1\\u7ad9\\u9644\\u8fd1\\uff0c\\u5730\\u94c1\\u67f3\\u82b3\\u7ad9\\uff0c\\u828d\\u836f\\u5c45\\u5730\\u94c1\\u7ad9\\u9644\\u8fd1\\uff0c\\u72ec\\u536b\\uff0c\\u53ef\\u505a\\u996d\\uff0c2\\u4e2a\\u4eba\\uff0c3000-3500\\u3002\\u4e2d\\u4ecb\\u52ff\\u6270\\u3002 \\u200b \\u200b\\u200b\\u200b\\u65e0\\u5ba0\\u7269\\uff0c\\u63a5\\u53d7\\u5ba4\\u53cb\\u517b\\u5ba0\\u7269\\u30028-8\\u6708\\u5e95\\u5165\\u4f4f\\uff0c\\u6700\\u597d\\u72ec\\u536b\\uff0c\\u975e\\u72ec\\u536b\\uff0c\\u5408\\u79df\\u4e24\\u5c45\\u5ba4\\u53ef\\u63a5\\u53d7\", \"biz_feature\": 0, \"source_allowclick\": 1, \"in_reply_to_status_id\": \"\", \"annotations\": [{\"shooting\": 1, \"client_mblogid\": \"46a225f2-150b-45cb-9efd-2a7cbc5ff541\"}, {\"mapi_request\": true}], \"more_info_type\": 0, \"source\": \"<a href=\\\"http://app.weibo.com/t/feed/66tb9r\\\" rel=\\\"nofollow\\\">\\u575a\\u679c\\u624b\\u673a 3</a>\", \"mblog_vip_type\": 0, \"pic_num\": 0, \"attitudes_count\": 0, \"text_tag_tips\": [], \"in_reply_to_screen_name\": \"\", \"mlevel\": 0, \"favorited\": false, \"created_at\": \"Thu Jul 09 11:08:44 +0800 2020\", \"id\": 4524734044283283, \"positive_recom_flag\": 0, \"pic_urls\": [], \"reward_exhibition_type\": 0, \"hasActionTypeCard\": 0, \"hot_weibo_tags\": [], \"gif_ids\": \"\", \"content_auth\": 0, \"comment_manage_info\": {\"approval_comment_type\": 0, \"comment_permission_type\": -1}, \"userType\": 0, \"source_type\": 1, \"comments_count\": 0, \"is_show_bulletin\": 2, \"is_paid\": false, \"is_imported_topic\": false, \"show_additional_indication\": 0, \"isLongText\": false, \"can_edit\": false, \"rid\": \"0\", \"textLength\": 227, \"visible\": {\"type\": 0, \"list_id\": 0}, \"reposts_count\": 0, \"idstr\": \"4524734044283283\", \"geo\": null, \"pending_approval_count\": 0}, \"avatar_hd\": \"https://tvax3.sinaimg.cn/crop.0.0.996.996.1024/005RP08Gly8fk5gdkkvqoj30ro0roq54.jpg?KID=imgbed,tva&Expires=1594980704&ssig=YNdy%2FfejaX\", \"remark\": \"\"}',
        17);
INSERT INTO `socialaccount_socialaccount`
VALUES (12, 'weibo', '7495671774', '2020-10-16 07:23:41.925075', '2020-10-16 07:22:07.995017',
        '{\"verified_reason_url\": \"\", \"id\": 7495671774, \"like\": false, \"following\": false, \"cover_image_phone\": \"http://ww1.sinaimg.cn/crop.0.0.640.640.640/549d0121tw1egm1kjly3jj20hs0hsq4f.jpg\", \"idstr\": \"7495671774\", \"verified_source\": \"\", \"credit_score\": 80, \"block_app\": 0, \"favourites_count\": 0, \"followers_count\": 1, \"verified_reason\": \"\", \"pc_new\": 0, \"star\": 0, \"video_play_count\": 0, \"mbrank\": 0, \"geo_enabled\": true, \"verified_type\": -1, \"insecurity\": {\"sexual_content\": false}, \"video_mark\": 0, \"lang\": \"zh-cn\", \"verified\": false, \"online_status\": 0, \"live_status\": 0, \"is_teenager_list\": 0, \"video_status_count\": 0, \"pagefriends_count\": 2, \"name\": \"\\u6307\\u9488AI\", \"vclub_member\": 0, \"bi_followers_count\": 0, \"description\": \"\", \"mbtype\": 0, \"weihao\": \"\", \"urank\": 0, \"profile_url\": \"u/7495671774\", \"ptype\": 0, \"story_read_state\": -1, \"screen_name\": \"\\u6307\\u9488AI\", \"class\": 1, \"like_me\": false, \"is_teenager\": 0, \"statuses_count\": 0, \"remark\": \"\", \"province\": \"100\", \"block_word\": 0, \"verified_source_url\": \"\", \"special_follow\": false, \"avatar_large\": \"https://tvax1.sinaimg.cn/crop.0.0.132.132.180/008bh4DQly4gi3aksvawkj303o03ot8i.jpg?KID=imgbed,tva&Expires=1602843821&ssig=8d1MVBAt0u\", \"planet_video\": 0, \"url\": \"\", \"city\": \"1000\", \"avatar_hd\": \"https://tvax1.sinaimg.cn/crop.0.0.132.132.1024/008bh4DQly4gi3aksvawkj303o03ot8i.jpg?KID=imgbed,tva&Expires=1602843821&ssig=x6miplkxGv\", \"domain\": \"\", \"profile_image_url\": \"https://tvax1.sinaimg.cn/crop.0.0.132.132.50/008bh4DQly4gi3aksvawkj303o03ot8i.jpg?KID=imgbed,tva&Expires=1602843821&ssig=uZCP47XPcH\", \"created_at\": \"Tue Aug 25 19:41:17 +0800 2020\", \"verified_trade\": \"\", \"allow_all_act_msg\": false, \"follow_me\": false, \"location\": \"\\u5176\\u4ed6\", \"gender\": \"m\", \"allow_all_comment\": true, \"friends_count\": 22, \"user_ability\": 2097152, \"is_guardian\": 0}',
        18);
INSERT INTO `socialaccount_socialaccount`
VALUES (13, 'weibo', '5876263279', '2021-04-01 07:17:55.919287', '2021-04-01 07:17:55.919340',
        '{\"bi_followers_count\": 14, \"is_guardian\": 0, \"mbtype\": 2, \"profile_image_url\": \"https://tva4.sinaimg.cn/crop.0.2.507.507.50/006pGcvZjw8f96hxk0ajsj30e30e8weo.jpg?KID=imgbed,tva&Expires=1617272275&ssig=fDtNLtWTPi\", \"weihao\": \"\", \"vclub_member\": 0, \"id\": 5876263279, \"planet_video\": 0, \"verified_source_url\": \"\", \"video_status_count\": 0, \"pc_new\": 0, \"block_app\": 0, \"like\": false, \"class\": 1, \"follow_me\": false, \"city\": \"1\", \"verified_reason\": \"\", \"insecurity\": {\"sexual_content\": false}, \"verified_source\": \"\", \"is_teenager_list\": 0, \"location\": \"\\u6d59\\u6c5f \\u676d\\u5dde\", \"followers_count\": 52, \"is_teenager\": 0, \"credit_score\": 80, \"video_mark\": 0, \"live_status\": 0, \"pagefriends_count\": 7, \"lang\": \"zh-cn\", \"verified_reason_url\": \"\", \"ptype\": 0, \"story_read_state\": -1, \"screen_name\": \"\\u4e00\\u4e2a\\u676d\\u5dde\\u7537\\u5b69\\u513f\", \"url\": \"\", \"remark\": \"\", \"idstr\": \"5876263279\", \"verified_type\": -1, \"user_ability\": 35651584, \"description\": \"\", \"following\": false, \"statuses_count\": 122, \"block_word\": 0, \"verified_trade\": \"\", \"name\": \"\\u4e00\\u4e2a\\u676d\\u5dde\\u7537\\u5b69\\u513f\", \"star\": 0, \"online_status\": 0, \"mbrank\": 1, \"special_follow\": false, \"avatar_hd\": \"https://tva4.sinaimg.cn/crop.0.2.507.507.1024/006pGcvZjw8f96hxk0ajsj30e30e8weo.jpg?KID=imgbed,tva&Expires=1617272275&ssig=upLB6x9pkk\", \"favourites_count\": 6, \"video_play_count\": 0, \"urank\": 9, \"cardid\": \"star_11247_common\", \"friends_count\": 303, \"avatar_large\": \"https://tva4.sinaimg.cn/crop.0.2.507.507.180/006pGcvZjw8f96hxk0ajsj30e30e8weo.jpg?KID=imgbed,tva&Expires=1617272275&ssig=ilg4pLa0A9\", \"domain\": \"\", \"gender\": \"m\", \"allow_all_act_msg\": false, \"created_at\": \"Mon Mar 07 20:35:08 +0800 2016\", \"geo_enabled\": true, \"like_me\": false, \"province\": \"33\", \"verified\": false, \"allow_all_comment\": true, \"status\": {\"mid\": \"4616874328851657\", \"source_allowclick\": 0, \"comments_count\": 0, \"source\": \"<a href=\\\"http://weibo.com/\\\" rel=\\\"nofollow\\\">iPhone\\u5ba2\\u6237\\u7aef</a>\", \"id\": 4616874328851657, \"in_reply_to_screen_name\": \"\", \"visible\": {\"type\": 0, \"list_id\": 0}, \"content_auth\": 0, \"mblogtype\": 0, \"in_reply_to_user_id\": \"\", \"pic_num\": 0, \"isLongText\": false, \"source_type\": 2, \"truncated\": false, \"is_show_bulletin\": 2, \"pic_urls\": [], \"cardid\": \"star_11247_common\", \"pending_approval_count\": 0, \"text_tag_tips\": [], \"show_additional_indication\": 0, \"text\": \"\\u8f6c\\u53d1\\u5fae\\u535a\", \"rid\": \"0\", \"idstr\": \"4616874328851657\", \"is_paid\": false, \"comment_manage_info\": {\"comment_permission_type\": -1, \"approval_comment_type\": 0}, \"hot_weibo_tags\": [], \"userType\": 0, \"positive_recom_flag\": 0, \"attitudes_count\": 0, \"reposts_count\": 0, \"darwin_tags\": [], \"mblog_vip_type\": 0, \"hide_flag\": 0, \"reward_exhibition_type\": 0, \"favorited\": false, \"more_info_type\": 0, \"gif_ids\": \"\", \"created_at\": \"Sat Mar 20 17:21:19 +0800 2021\", \"geo\": null, \"can_edit\": false, \"hasActionTypeCard\": 0, \"annotations\": [{\"mapi_request\": true}], \"in_reply_to_status_id\": \"\", \"mlevel\": 0, \"repost_type\": 2, \"biz_feature\": 0}, \"profile_url\": \"u/5876263279\"}',
        19);
COMMIT;

-- ----------------------------
-- Table structure for socialaccount_socialapp
-- ----------------------------
DROP TABLE IF EXISTS `socialaccount_socialapp`;
CREATE TABLE `socialaccount_socialapp`
(
    `id`        int(11)      NOT NULL AUTO_INCREMENT,
    `provider`  varchar(30)  NOT NULL,
    `name`      varchar(40)  NOT NULL,
    `client_id` varchar(191) NOT NULL,
    `secret`    varchar(191) NOT NULL,
    `key`       varchar(191) NOT NULL,
    PRIMARY KEY (`id`) USING BTREE
) ENGINE = InnoDB
  AUTO_INCREMENT = 4
  DEFAULT CHARSET = utf8;

-- ----------------------------
-- Records of socialaccount_socialapp
-- ----------------------------
BEGIN;
INSERT INTO `socialaccount_socialapp`
VALUES (1, 'github', 'Github', '15882d7a67caa6c188cc', 'ff6d2899d6656d613d30191577b93b400788cb25', '');
INSERT INTO `socialaccount_socialapp`
VALUES (2, 'weibo', 'Weibo', '1628214363', 'd1a76b5cde23617f96d6a2bd22f855c5', '');
INSERT INTO `socialaccount_socialapp`
VALUES (3, 'baidu', 'Baidu', 'z3iAjeikn07u7RaUIbjt6pj2yZY9yRUS', 'taugvu9pgOtlNGGVeknrtae1wrEFNTg9', '');
COMMIT;

-- ----------------------------
-- Table structure for socialaccount_socialapp_sites
-- ----------------------------
DROP TABLE IF EXISTS `socialaccount_socialapp_sites`;
CREATE TABLE `socialaccount_socialapp_sites`
(
    `id`           int(11) NOT NULL AUTO_INCREMENT,
    `socialapp_id` int(11) NOT NULL,
    `site_id`      int(11) NOT NULL,
    PRIMARY KEY (`id`) USING BTREE,
    UNIQUE KEY `socialaccount_socialapp_sites_socialapp_id_site_id_71a9a768_uniq` (`socialapp_id`, `site_id`) USING BTREE,
    KEY `socialaccount_socialapp_sites_site_id_2579dee5_fk_django_site_id` (`site_id`) USING BTREE,
    CONSTRAINT `socialaccount_social_socialapp_id_97fb6e7d_fk_socialacc` FOREIGN KEY (`socialapp_id`) REFERENCES `socialaccount_socialapp` (`id`),
    CONSTRAINT `socialaccount_socialapp_sites_site_id_2579dee5_fk_django_site_id` FOREIGN KEY (`site_id`) REFERENCES `django_site` (`id`)
) ENGINE = InnoDB
  AUTO_INCREMENT = 4
  DEFAULT CHARSET = utf8;

-- ----------------------------
-- Records of socialaccount_socialapp_sites
-- ----------------------------
BEGIN;
INSERT INTO `socialaccount_socialapp_sites`
VALUES (1, 1, 2);
INSERT INTO `socialaccount_socialapp_sites`
VALUES (2, 2, 2);
INSERT INTO `socialaccount_socialapp_sites`
VALUES (3, 3, 2);
COMMIT;

-- ----------------------------
-- Table structure for socialaccount_socialtoken
-- ----------------------------
DROP TABLE IF EXISTS `socialaccount_socialtoken`;
CREATE TABLE `socialaccount_socialtoken`
(
    `id`           int(11)  NOT NULL AUTO_INCREMENT,
    `token`        longtext NOT NULL,
    `token_secret` longtext NOT NULL,
    `expires_at`   datetime(6) DEFAULT NULL,
    `account_id`   int(11)  NOT NULL,
    `app_id`       int(11)  NOT NULL,
    PRIMARY KEY (`id`) USING BTREE,
    UNIQUE KEY `socialaccount_socialtoken_app_id_account_id_fca4e0ac_uniq` (`app_id`, `account_id`) USING BTREE,
    KEY `socialaccount_social_account_id_951f210e_fk_socialacc` (`account_id`) USING BTREE,
    CONSTRAINT `socialaccount_social_account_id_951f210e_fk_socialacc` FOREIGN KEY (`account_id`) REFERENCES `socialaccount_socialaccount` (`id`),
    CONSTRAINT `socialaccount_social_app_id_636a42d7_fk_socialacc` FOREIGN KEY (`app_id`) REFERENCES `socialaccount_socialapp` (`id`)
) ENGINE = InnoDB
  AUTO_INCREMENT = 14
  DEFAULT CHARSET = utf8;

-- ----------------------------
-- Records of socialaccount_socialtoken
-- ----------------------------
BEGIN;
INSERT INTO `socialaccount_socialtoken`
VALUES (6, '2.00ZXcjyCzvoLmB0f69104873zT7bHD', '', '2026-03-19 13:30:05.203530', 6, 2);
INSERT INTO `socialaccount_socialtoken`
VALUES (7, 'b5f340e217b24e1bf52a8b9b8fb9e87eebdb3023', '', NULL, 7, 1);
INSERT INTO `socialaccount_socialtoken`
VALUES (8, '2.00zfKFJIzvoLmBe61ef0ff83PKrZGC', '', '2020-06-28 18:59:59.604388', 8, 2);
INSERT INTO `socialaccount_socialtoken`
VALUES (9, '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', '', NULL, 9, 1);
INSERT INTO `socialaccount_socialtoken`
VALUES (10, '2.00BGNh7HzvoLmBe49822ab47eOvRzB', '', '2020-08-16 18:59:59.976616', 10, 2);
INSERT INTO `socialaccount_socialtoken`
VALUES (11, '2.00gIAprFzvoLmB27b73b7ea3tZL29C', '', '2020-08-16 18:59:59.361727', 11, 2);
INSERT INTO `socialaccount_socialtoken`
VALUES (12, '2.00qdERLIzvoLmB825adcdfa1FZTpjC', '', '2020-11-15 18:59:59.837460', 12, 2);
INSERT INTO `socialaccount_socialtoken`
VALUES (13, '2.00zVMg6GzvoLmBad20ed1238pYRoJC', '', '2021-05-01 18:59:59.808676', 13, 2);
COMMIT;

-- ----------------------------
-- Table structure for tb_bookmark
-- ----------------------------
DROP TABLE IF EXISTS `tb_bookmark`;
CREATE TABLE `tb_bookmark`
(
    `id`   int(11)      NOT NULL AUTO_INCREMENT,
    `mark` varchar(100) NOT NULL,
    `url`  varchar(200) NOT NULL,
    PRIMARY KEY (`id`) USING BTREE
) ENGINE = InnoDB
  AUTO_INCREMENT = 3
  DEFAULT CHARSET = utf8;

-- ----------------------------
-- Records of tb_bookmark
-- ----------------------------
BEGIN;
INSERT INTO `tb_bookmark`
VALUES (1, 'CSDN博客', 'https://blog.csdn.net/weixin_43064185');
INSERT INTO `tb_bookmark`
VALUES (2, 'Ch3nnnnnnnnn博客', 'https://ch3nnn.cn/');
COMMIT;

-- ----------------------------
-- Table structure for tb_bulletin
-- ----------------------------
DROP TABLE IF EXISTS `tb_bulletin`;
CREATE TABLE `tb_bulletin`
(
    `id`           int(11)    NOT NULL AUTO_INCREMENT,
    `text`         text       NOT NULL,
    `author_id`    int(11)    NOT NULL,
    `publish_date` date       NOT NULL,
    `is_show`      tinyint(1) NOT NULL,
    PRIMARY KEY (`id`) USING BTREE,
    KEY `tb_bulletin_author_id_0fe8bfc0_fk_auth_user_id` (`author_id`) USING BTREE,
    CONSTRAINT `tb_bulletin_author_id_0fe8bfc0_fk_auth_user_id` FOREIGN KEY (`author_id`) REFERENCES `user_user` (`id`)
) ENGINE = InnoDB
  AUTO_INCREMENT = 8
  DEFAULT CHARSET = utf8;

-- ----------------------------
-- Records of tb_bulletin
-- ----------------------------
BEGIN;
INSERT INTO `tb_bulletin`
VALUES (7, '【搜索功能】从Mysql替换为elasticsearch。赶紧去试试吧, 输入关键字会有错误纠正、关键字高亮偶 ！！', 1, '2020-06-18', 1);
COMMIT;

-- ----------------------------
-- Table structure for tb_category
-- ----------------------------
DROP TABLE IF EXISTS `tb_category`;
CREATE TABLE `tb_category`
(
    `id`   int(11)      NOT NULL AUTO_INCREMENT COMMENT '分类id',
    `name` varchar(100) NOT NULL COMMENT '分类名称',
    PRIMARY KEY (`id`) USING BTREE
) ENGINE = InnoDB
  AUTO_INCREMENT = 14
  DEFAULT CHARSET = utf8;

-- ----------------------------
-- Records of tb_category
-- ----------------------------
BEGIN;
INSERT INTO `tb_category`
VALUES (1, 'Mysql');
INSERT INTO `tb_category`
VALUES (2, 'Python');
INSERT INTO `tb_category`
VALUES (3, '数据');
INSERT INTO `tb_category`
VALUES (4, 'Liunx');
INSERT INTO `tb_category`
VALUES (5, 'Django');
INSERT INTO `tb_category`
VALUES (6, '前端');
INSERT INTO `tb_category`
VALUES (7, '网络安全');
INSERT INTO `tb_category`
VALUES (8, '技术教程');
INSERT INTO `tb_category`
VALUES (9, '消息队列');
INSERT INTO `tb_category`
VALUES (10, 'Java');
INSERT INTO `tb_category`
VALUES (11, 'ElasticSearch');
INSERT INTO `tb_category`
VALUES (12, 'Docker');
INSERT INTO `tb_category`
VALUES (13, 'Nginx');
COMMIT;

-- ----------------------------
-- Table structure for tb_comments
-- ----------------------------
DROP TABLE IF EXISTS `tb_comments`;
CREATE TABLE `tb_comments`
(
    `id`           int(11)     NOT NULL AUTO_INCREMENT,
    `text`         longtext    NOT NULL,
    `created_time` datetime(6) NOT NULL,
    `new_id`       int(11)     NOT NULL,
    `user_id`      int(11)     NOT NULL,
    PRIMARY KEY (`id`) USING BTREE,
    KEY `tb_comments_new_id_69b173ac_fk_tb_content_id` (`new_id`) USING BTREE,
    KEY `tb_comments_user_id_2087acc4_fk_auth_user_id` (`user_id`) USING BTREE,
    CONSTRAINT `tb_comments_new_id_69b173ac_fk_tb_content_id` FOREIGN KEY (`new_id`) REFERENCES `tb_content` (`id`),
    CONSTRAINT `tb_comments_user_id_2087acc4_fk_auth_user_id` FOREIGN KEY (`user_id`) REFERENCES `user_user` (`id`)
) ENGINE = InnoDB
  AUTO_INCREMENT = 34
  DEFAULT CHARSET = utf8;

-- ----------------------------
-- Records of tb_comments
-- ----------------------------
BEGIN;
INSERT INTO `tb_comments`
VALUES (20, '哈哈哈哈哈，写的不错', '2020-06-18 09:30:28.042427', 92, 12);
INSERT INTO `tb_comments`
VALUES (21, '测试评论', '2020-06-23 05:32:15.815210', 32, 11);
INSERT INTO `tb_comments`
VALUES (22, '看看好使不', '2020-06-27 11:06:07.976291', 24, 13);
INSERT INTO `tb_comments`
VALUES (23, '厉害', '2020-06-27 11:51:11.547281', 24, 14);
INSERT INTO `tb_comments`
VALUES (28, '观摩观摩', '2020-07-05 04:31:11.681308', 24, 15);
INSERT INTO `tb_comments`
VALUES (29, '博文很直白，非常有用', '2020-07-17 07:07:10.011822', 24, 16);
INSERT INTO `tb_comments`
VALUES (30, '啦啦啦啦啦啦啦@030=', '2020-07-17 07:12:05.380026', 114, 17);
INSERT INTO `tb_comments`
VALUES (31, '?', '2020-10-16 07:24:57.474716', 24, 18);
INSERT INTO `tb_comments`
VALUES (32, 'good', '2021-03-20 13:30:40.852665', 94, 11);
INSERT INTO `tb_comments`
VALUES (33, '6666666666666', '2021-04-01 07:18:08.865132', 24, 19);
COMMIT;

-- ----------------------------
-- Table structure for tb_content
-- ----------------------------
DROP TABLE IF EXISTS `tb_content`;
CREATE TABLE `tb_content`
(
    `id`            int(11)          NOT NULL AUTO_INCREMENT,
    `title`         varchar(70)      NOT NULL COMMENT '文章标题',
    `body`          longtext         NOT NULL COMMENT '文章内容',
    `excerpt`       varchar(200)     NOT NULL COMMENT '文章摘要',
    `created_time`  datetime         NOT NULL COMMENT '创建日期',
    `modified_time` datetime         NOT NULL COMMENT '发布日期',
    `views`         int(10) unsigned NOT NULL COMMENT '浏览量',
    `author_id`     int(11)          NOT NULL COMMENT '作者id',
    `category_id`   int(11)          NOT NULL COMMENT '分类id',
    `top`           tinyint(1)       NOT NULL COMMENT '置顶',
    `is_private`    tinyint(1)       NOT NULL DEFAULT '0' COMMENT '是否展示',
    `is_delete`     tinyint(1)       NOT NULL DEFAULT '0' COMMENT '逻辑删除',
    PRIMARY KEY (`id`) USING BTREE,
    KEY `tb_content_author_id_4e0bf2a7_fk_auth_user_id` (`author_id`) USING BTREE,
    KEY `tb_content_category_id_c6e5ac73_fk_tb_category_id` (`category_id`) USING BTREE,
    CONSTRAINT `tb_content_author_id_4e0bf2a7_fk_auth_user_id` FOREIGN KEY (`author_id`) REFERENCES `user_user` (`id`),
    CONSTRAINT `tb_content_category_id_c6e5ac73_fk_tb_category_id` FOREIGN KEY (`category_id`) REFERENCES `tb_category` (`id`)
) ENGINE = InnoDB
  AUTO_INCREMENT = 137
  DEFAULT CHARSET = utf8mb4;

-- ----------------------------
-- Records of tb_content
-- ----------------------------
BEGIN;
INSERT INTO `tb_content`
VALUES (1, 'MySQL数据库 WHERE与HAVING的区别',
        '<pre>\r\n<code class=\"language-sql\">总结自己面试遇到手写sql题\r\n\r\n一个SQL查询出表fenshu, 语文课程的成绩都大于80的学生姓名\r\n\r\n如下一张表:\r\n+--------+---------+---------+\r\n| name   | kecheng | chengji |\r\n+--------+---------+---------+\r\n| 张三   | 语文    |      81 |\r\n| 张三   | 数学    |      75 |\r\n| 李四   | 语文    |      76 |\r\n| 李四   | 数学    |      90 |\r\n| 王五   | 语文    |      81 |\r\n| 王五   | 数学    |     100 |\r\n| 王五   | 英语    |      90 |\r\n+--------+---------+---------+\r\nselect kecheng, group_concat(name) from fenshu where chengji &gt;80  group by kecheng having kecheng=\'语文\';\r\n+---------+--------------------+\r\n| kecheng | group_concat(name) |\r\n+---------+--------------------+\r\n| 语文    | 张三,王五          |\r\n+---------+--------------------+\r\n当时自己写成 \'select kecheng, group_concat(name) from fenshu group by kecheng ~~having kecheng &gt; 80~~ ;\' 忘记了 WHERE 与HAVING 区别, 只知道HAVING作用与GROUP BY 之后. 应该在查询结果集之前用WHERE过滤掉 chengji &gt; 80, 然后用 HAVING 查询 kecheng=\'语文\'\r\n\r\n总结: WHERE与HAVING区别在于, HAVING是对聚合后的结果进行条件的过滤, 而WHERE是在聚合前对记录进行过滤. 如果逻辑允许, 尽可能用WHERE先过滤记录, 这样能减少结果集, 提高查询效率, 最后再根据逻辑时候用HAVING进行再过滤</code></pre>\r\n\r\n<p>&nbsp;</p>',
        '', '2018-12-05 17:23:00', '2018-12-05 17:23:00', 272, 11, 1, 0, 0, 1);
INSERT INTO `tb_content`
VALUES (2, 'python for循环中 对列表进行删除操作 会出现列表元素删除不干净',
        '<blockquote>\r\n<p>指针问题 remove 第一次：a=[1,2,3,4,5]-&gt;a=1 第二次：a=[2,3,4,5]-&gt;指针发生变法i=3 同理第三次i=5</p>\r\n</blockquote>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">data = [1, 2, 3, 4, 5]\r\nfor i in data:\r\n    data.remove(i)\r\n\r\nprint(data)\r\n</code></pre>\r\n\r\n<pre>\r\n<code class=\"language-python\">打印结果为:[2, 4, 6]</code>\r\n</pre>\r\n</div>\r\n\r\n<blockquote>\r\n<p><strong>解决方式 用新的列表代替旧的列表 进行删除操作</strong></p>\r\n</blockquote>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">from copy import deepcopy\r\n\r\ndata = [1,2,3,4,5]\r\nold_list = data\r\nnew_list = deepcopy(old_list)\r\nfor i in old_list:\r\n    new_list.remove(i)\r\n    \r\nprint(new_list)    </code></pre>\r\n\r\n<p>&nbsp;</p>\r\n</div>\r\n\r\n<blockquote>\r\n<pre>\r\n<code class=\"language-python\">打印结果为:[] </code></pre>\r\n\r\n<p>&nbsp;</p>\r\n</blockquote>',
        '', '2018-04-05 17:26:00', '2018-04-05 17:26:00', 364, 1, 2, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (7, 'Markdown用的不太习惯，于是决定添加一个富文本编辑器',
        '<p>Markdown用的不太习惯，于是决定添加一个富文本编辑器。ckeditor是一个老牌的编辑器，GitHub上有一个第三方模块django-ckeditor封装了所有功能，把import到我们的项目里，然后设置一下参数，就可轻松使用了。</p>\r\n\r\n<p>github地址：&nbsp;<strong><a href=\"https://github.com/django-ckeditor/django-ckeditor\" target=\"_blank\">https://github.com/django-ckeditor/django-ckeditor</a></strong></p>\r\n\r\n<p>EDIT：通过网友反应的一些问题，以及后来我对djangk-ckeditor的深入使用，决定对本文重新编辑一下，让各位学友少踩一些坑，同时增加一些功能的介绍。</p>\r\n\r\n<h2>开发环境： Python 3.5、Django 1.10</h2>\r\n\r\n<h2>安装</h2>\r\n\r\n<p>使用pip安装&nbsp;<code>django-ckeditor</code>&nbsp;和&nbsp;<code>pillow</code>，pillow用于生成缩略图，用来在编辑器里浏览上传的图片</p>\r\n\r\n<pre>\r\n<code class=\"language-python\">pip install django-ckeditor\r\npip install pillow</code></pre>\r\n\r\n<h2>QUICK START</h2>\r\n\r\n<p>在&nbsp;<code>project/settings.py</code>&nbsp;里进行如下设置：</p>\r\n\r\n<pre>\r\n<code class=\"language-python\">INSTALLED_APPS = [\r\n    \'ckeditor\',\r\n    \'ckeditor_uploader\',\r\n]\r\n\r\nMEDIA_ROOT = os.path.join(BASE_DIR, \'media\')\r\nMEDIA_URL = \'/media/\'\r\nCKEDITOR_UPLOAD_PATH = \'upload/\'\r\nCKEDITOR_IMAGE_BACKEND = \'pillow\'</code></pre>\r\n\r\n<p>1. 首先将&nbsp;<code>&#39;ckeditor&#39;</code>和&nbsp;<code>&#39;ckeditor_uploader&#39;<code>加入到INSTALLED_APPS中，</code></code></p>\r\n\r\n<p>2. 设置&nbsp;<code>MEDIA_ROOT</code>&nbsp;和&nbsp;<code>MEDIA_URL</code>，<code>CKEDITOR_UPLOAD_PATH = &#39;upload/&#39;</code>，图片将上传到项目下的media/upload路径下，图片的url是 /media/upload/</p>\r\n\r\n<p>3. 设置<code>CKEDITOR_IMAGE_BACKEND = &#39;pillow&#39;</code>, 用于生成图片缩略图，在编辑器里浏览上传的图片</p>\r\n\r\n<p><img alt=\"\" src=\"http://www.aaron-zhao.com/media/upload/Aaron/2017/08/13/gikcyf.png\" /></p>\r\n\r\n<p>4. 在project/urls.py里，加入&nbsp;<code>ckeditor_uploader.url</code></p>\r\n\r\n<pre>\r\n<code class=\"language-python\">from django.conf.urls import url,include\r\nfrom django.conf.urls.static import static\r\nfrom django.conf import settings\r\nfrom django.contrib import admin\r\n\r\nurlpatterns = [\r\n    url(r\'\', include(\'ckeditor_uploader.urls\')),\r\n] + static(settings.MEDIA_URL, document_root=settings.MEDIA_ROOT) #没有这一句无法显示上传的图片</code></pre>\r\n\r\n<h3>注意</h3>\r\n\r\n<p>在开发环境里debug模式下，<code>static(settings.MEDIA_URL, document_root=settings.MEDIA_ROOT)</code>&nbsp;这句是必不可少的，没有的话，你上传的图片将无法显示。将这段代码Python shell里运行一下，会发现其实就是解析了media_url</p>\r\n\r\n<p><img src=\"http://www.aaron-zhao.com/media/upload/Aaron/2017/08/13/yjcowo.png\" /></p>\r\n\r\n<p>当我们在服务器部署时，需要用nginx来配置静态资源，在nginx的配置文件里</p>\r\n\r\n<pre>\r\n<code class=\"language-python\">location /media {\r\n                alias /path-to/media;\r\n        }</code></pre>\r\n\r\n<p>4. 在blog/models.py的Post类，让正文字段使用&nbsp;<code>RichTextUploadingField()</code></p>\r\n\r\n<pre>\r\n<code class=\"language-python\">from ckeditor_uploader.fields import RichTextUploadingField\r\n\r\nclass Post(models.Model):\r\n    content = RichTextUploadingField(verbose_name=\'正文\')</code></pre>\r\n\r\n<p>5. 最后还是不要忘了迁移数据库</p>\r\n\r\n<pre>\r\n<code class=\"language-python\">pyhton manage.py makemigrations\r\npython manage.py migrate</code></pre>\r\n\r\n<p>进入admin后台去添加文章，就会发现编辑器已经在那里了，是不是很开心啊</p>\r\n\r\n<p><img alt=\"django-ckeditor\" src=\"http://www.aaron-zhao.com/media/upload/Aaron/2017/08/13/bqeuzo.png\" /></p>\r\n\r\n<h2>其他可选配置</h2>\r\n\r\n<p><code>CKEDITOR_ALLOW_NONIMAGE_FILES = False</code>&nbsp;不允许非图片文件上传，默认为True</p>\r\n\r\n<p><code>CKEDITOR_BROWSE_SHOW_DIRS = True</code>&nbsp;在编辑器里浏览上传的图片时，图片会以路径分组，日期排序</p>\r\n\r\n<p><code>CKEDITOR_RESTRICT_BY_USER = True</code>&nbsp;限制用户浏览图片的权限，只能浏览自己上传的图片，图片会传到以用户名命名的文件夹下，超级管理员依旧可以看所有图片</p>\r\n\r\n<h3>NOTICE</h3>\r\n\r\n<p>django-ckeditor默认的只允许管理员（staff member）上传图片，当普通用户使用编辑器时（比如评论区、留言板、发帖子），如果要使他们上传图片的话，需要对django-ckeditor的源码进行修改</p>\r\n\r\n<p>在ckeditor_uploader/urls.py里，它的<strong>upload</strong>&nbsp;和<strong>&nbsp;browse</strong>方法用了<code>staff_member_required</code>装饰器，把它换成<code>login_required</code>装饰器即可</p>\r\n\r\n<pre>\r\n<code class=\"language-python\">if django.VERSION &gt;= (1, 8):\r\n    urlpatterns = [\r\n        url(r\'^upload/\', login_required(views.upload), name=\'ckeditor_upload\'),\r\n        url(r\'^browse/\', never_cache(login_required(views.browse)), name=\'ckeditor_browse\'),\r\n    ]</code></pre>\r\n\r\n<h2>自定义编辑器</h2>\r\n\r\n<p>如果想要自定义编辑器，添加或删除一些按钮的话，需要在settings.py里设置&nbsp;<code>CKEDITOR_CONFIGS</code></p>\r\n\r\n<pre>\r\n<code class=\"language-python\">CKEDITOR_CONFIGS = {\r\n    # 配置名是default时，django-ckeditor默认使用这个配置\r\n    \'default\': {\r\n        # 使用简体中文\r\n        \'language\':\'zh-cn\',\r\n        # 编辑器的宽高请根据你的页面自行设置\r\n        \'width\':\'auto\',\r\n        \'height\':\'150px\',\r\n        \'image_previewText\':\' \',\r\n        \'tabSpaces\': 4,\r\n        \'toolbar\': \'Custom\',\r\n        # 添加按钮在这里\r\n        \'toolbar_Custom\': [\r\n            [\'Bold\', \'Italic\', \'Underline\', \'Format\', \'RemoveFormat\'],\r\n            [\'NumberedList\', \'BulletedList\'],\r\n            [\'Blockquote\', \'CodeSnippet\'],\r\n            [\'Image\', \'Link\', \'Unlink\'],\r\n            [\'Maximize\']\r\n        ],\r\n        # 插件\r\n        \'extraPlugins\': \',\'.join([\'codesnippet\',\'uploadimage\',\'widget\',\'lineutils\',]),\r\n    }\r\n}</code></pre>\r\n\r\n<p>当配置名称是 &#39;default&#39;，django-ckeditor会默认使用这个配置，<code>CKEDITOR_CONFIGS</code>里可以添加多个配置，比如</p>\r\n\r\n<pre>\r\n<code class=\"language-python\">CKEDITOR_CONFIGS = {\r\n    # 配置名是default时，django-ckeditor默认使用这个配置\r\n    \'default\': {\r\n\r\n    }  \r\n    # 名为custom的配置  \r\n    \'custom\': {\r\n\r\n    }\r\n}</code></pre>\r\n\r\n<p>当需要使用非默认配置是，需要在&nbsp;<code>RichTextUploadingField()</code>&nbsp;里指定该配置名称</p>\r\n\r\n<pre>\r\n<code>class Post(models.Model):\r\n    content = RichTextUploadingField(config_name=\'custom\')</code></pre>\r\n\r\n<h2>添加代码功能</h2>\r\n\r\n<p>写技术博客的话，我们的编辑器自然需要添加代码块的功能。需要用到插件<code>codesnippet</code>，ckeditor的插件放在了<code>ckeditor/static/ckeditor/ckeditor/plugins/</code>路径下。</p>\r\n\r\n<p>当我们添加一个功能插件时，需要在<code>CKEDITOR_CONFIGS</code>里的extraPlugins对应的value里添加该插件的名字（名字字母小写），如果该插件还有相对应的按钮，则在toolbar对应的value里添加名字（首字母大写），以codesnippet为例，在下面代码的第16行和21行分别添加了&nbsp;<code>&#39;CodeSnippet&#39;</code>&nbsp;和&nbsp;<code>&#39;codesnippet&#39;</code></p>\r\n\r\n<h3>NOTICE</h3>\r\n\r\n<p>在21行的extraPlugins里还添加了&nbsp;<code>&#39;uploadimage&#39;</code>，这个插件的作用是允许用户直接在编辑器里粘贴（ctrl + v）图片</p>\r\n\r\n<pre>\r\n<code class=\"language-python\">CKEDITOR_CONFIGS = {\r\n    # 配置名是default时，django-ckeditor默认使用这个配置\r\n    \'default\': {\r\n        # 使用简体中文\r\n        \'language\':\'zh-cn\',\r\n        # 编辑器的宽高请根据你的页面自行设置\r\n        \'width\':\'730px\',\r\n        \'height\':\'150px\',\r\n        \'image_previewText\':\' \',\r\n        \'tabSpaces\': 4,\r\n        \'toolbar\': \'Custom\',\r\n        # 添加按钮在这里\r\n        \'toolbar_Custom\': [\r\n            [\'Bold\', \'Italic\', \'Underline\', \'Format\', \'RemoveFormat\'],\r\n            [\'NumberedList\', \'BulletedList\'],\r\n            [\'Blockquote\', \'CodeSnippet\'],\r\n            [\'Image\', \'Link\', \'Unlink\'],\r\n            [\'Maximize\']\r\n        ],\r\n        # 插件\r\n        \'extraPlugins\': \',\'.join([\'codesnippet\',\'uploadimage\',\'widget\',\'lineutils\',]),\r\n    }\r\n}</code></pre>\r\n\r\n<h2>代码高亮、代码行数 &nbsp;</h2>\r\n\r\n<p>从ckeditor官网下载<a href=\"http://download.ckeditor.com/prism/releases/prism_1.0.1.zip\" target=\"_blank\">&nbsp;<strong>插件prism</strong></a>（点这里直接下载），然后将其解压到<code>ckeditor/static/ckeditor/ckeditor/plugins</code>路径下，同样的我们需要在<code>CKEDITOR_CONFIGS</code>里将extraPlugins对应的value里加入插件&nbsp;<code>&#39;prism&#39;</code>&nbsp;和另外两个插件<code>&quot;lineutils&quot;</code>、<code>&quot;widget&quot;</code>&nbsp;，这两个插件无须下载，在django-ckeditor中已经有了</p>\r\n\r\n<pre>\r\n<code>\'extraPlugins\': \',\'.join([\'codesnippet\',\'uploadimage\',\'prism\',\'widget\',\'lineutils\',]),</code></pre>\r\n\r\n<p>&nbsp;去prismjs官网下载css文件<strong><a href=\"http://prismjs.com/download.html\" target=\"_blank\">http://prismjs.com/download.html</a></strong>，选择你喜欢的主题，勾选支持的语言，以及别忘选择<strong>line-numbers</strong>功能，下载后把他解压到<strong>static/blog/css</strong>下</p>\r\n\r\n<p><img alt=\"\" src=\"http://www.aaron-zhao.com/media/upload/Aaron/2017/08/13/kyrhlt.png\" /></p>\r\n\r\n<p><img alt=\"\" src=\"http://www.aaron-zhao.com/media/upload/Aaron/2017/08/13/bqcahk.png\" /></p>\r\n\r\n<p><img alt=\"\" src=\"http://www.aaron-zhao.com/media/upload/Aaron/2017/08/13/egtvla.png\" /></p>\r\n\r\n<p>然后在模板中引用静态文件</p>\r\n\r\n<pre>\r\n<code class=\"language-python\">&lt;script src=\"{% static \'ckeditor/ckeditor/plugins/prism/lib/prism/prism_patched.min.js\' %}\"&gt;&lt;/script&gt;\r\n&lt;link rel=\"stylesheet\" href=\"{% static \'blog/css/prism.css\' %}\"&gt;</code></pre>\r\n\r\n<h2>在admin以外的地方使用django-ckeditor</h2>\r\n\r\n<p>如果在admin以外的地方使用django-ckeditor，比如<strong><a href=\"http://www.aaron-zhao.com/post/6/\" target=\"_blank\">添加评论功能</a></strong></p>\r\n\r\n<p>在渲染表单的那个页面需要引入&nbsp;<code>ckeditor-init.js</code>&nbsp;和&nbsp;<code>ckeditor.js</code>&nbsp;两个文件，否则编辑器无法显示</p>\r\n\r\n<pre>\r\n<code class=\"language-html\">{% load static %}\r\n&lt;script type=\"text/javascript\" src=\"{% static \"ckeditor/ckeditor-init.js\" %}\"&gt;&lt;/script&gt;\r\n&lt;script type=\"text/javascript\" src=\"{% static \"ckeditor/ckeditor/ckeditor.js\" %}\"&gt;&lt;/script&gt;</code></pre>\r\n\r\n<p>当然还有另外一种方法，本质上跟前者一样的</p>\r\n\r\n<pre>\r\n<code class=\"language-html\">&lt;form&gt;\r\n    {{ myform.media }}\r\n    {{ myform.as_p }}\r\n    &lt;input type=\"submit\"/&gt;\r\n&lt;/form&gt;</code></pre>\r\n\r\n<h3>编辑框响应式</h3>\r\n\r\n<p>1. 需要CKEDITOR_CONFIGS里设置 &#39;width&#39;: &#39;auto&#39;</p>\r\n\r\n<p>2.</p>\r\n\r\n<pre>\r\n<code class=\"language-html\">&lt;script&gt;\r\n    $(\".django-ckeditor-widget\").removeAttr(\'style\');\r\n&lt;/script&gt;</code></pre>',
        '', '2018-10-05 19:05:00', '2018-10-05 19:05:00', 371, 1, 2, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (14, 'pymysql中 execute 和 executemany 性能对比',
        '<h4>一.性能对比</h4>\r\n\r\n<p>今天突然想测试一下, pymysql中exectue ,和 executemany 插入数据库的效率,&nbsp;<br />\r\n看看区别大不大.&nbsp;<br />\r\npymysql 中 execute 和 executemany 性能对比</p>\r\n\r\n<p>users表结构</p>\r\n\r\n<pre>\r\n<code class=\"language-python\">CREATE TABLE `users` (                                                            \r\n  `id` int(11) NOT NULL AUTO_INCREMENT,\r\n  `email` varchar(255) DEFAULT NULL,\r\n  `password` varchar(255) DEFAULT NULL,\r\n  PRIMARY KEY (`id`)\r\n) ENGINE=InnoDB  DEFAULT CHARSET=utf8;</code></pre>\r\n\r\n<pre>\r\n<code class=\"language-python\">\r\nimport pymysql\r\n\r\n# 数据库配置信息\r\nSHOUFUYOU_USER_PROFILE_CONFIG = {\r\n    \'host\': \'xxx.xxx.xxx.xxx\',\r\n    \'port\': xxxx,\r\n    \'user\': \'xxxx\',\r\n    \'password\': \'xxxxxxx\',\r\n    \'db\': \'xxxxx\',\r\n    \'charset\': \'utf8\',\r\n}\r\n\r\n\r\n\r\n\r\ndef fn_timer(fn):\r\n    \"\"\"\r\n    计算 fn 的运算时间\r\n    :param fn:\r\n    :return:\r\n    \"\"\"\r\n\r\n    @wraps(fn)\r\n    def function_timer(*args, **kwargs):\r\n        start = now()\r\n        result = fn(*args, **kwargs)\r\n        logger.info(f\'{fn.__name__} total running time {now() - start} seconds\')\r\n        return result\r\n\r\n    return function_timer\r\n\r\n\r\n\r\n\r\n@fn_timer\r\ndef test_execute(connection, sql):\r\n    rows_count = 0\r\n    with connection.cursor(pymysql.cursors.DictCursor) as cursor:\r\n        for i in range(1000):\r\n            rows_count += cursor.execute(sql, (\'frank@python.org\', \'test\' + str(i)))\r\n        connection.commit()\r\n\r\n    return rows_count\r\n\r\n\r\n@fn_timer\r\ndef test_execute_many(connection, sql):\r\n    with connection.cursor(pymysql.cursors.DictCursor) as cursor:\r\n        datas = [(\'webmaster@python.org\', \'test\' + str(i)) for i in range(1,1000)]\r\n        rows_count = cursor.executemany(sql, datas)\r\n        connection.commit()\r\n\r\n    return rows_count\r\n\r\n\r\nif __name__ == \'__main__\':\r\n    insert_sql = \"INSERT INTO `users` (`email`, `password`) VALUES (%s, %s)\"\r\n    connection = pymysql.connect(**SHOUFUYOU_USER_PROFILE_CONFIG)\r\n\r\n    test_execute(connection, insert_sql)\r\n    test_execute_many(connection, insert_sql)\r\n\r\n\r\nConnected to pydev debugger (build 173.4127.16)\r\n test_execute total running time 33.28491401672363 seconds\r\ntest_execute_many total running time 0.12204098701477051 seconds\r\n\r\n</code></pre>\r\n\r\n<p>测试结果如下:</p>\r\n\r\n<p><img alt=\"\" src=\"/media/upload/2019/04/11/_20190411205620.jpg\" style=\"height:283px; width:970px\" /></p>\r\n\r\n<h4>二. 总结</h4>\r\n\r\n<p>可以看出明显的区别, 如果需要批量插入数据库,还是用 executemany方法 这个和execute 不是一个数量级.&nbsp;<br />\r\n如果只是插入比较少的数量量 用 exectue 比较好点.</p>',
        '', '2019-04-11 12:57:00', '2019-04-11 12:57:00', 408, 1, 1, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (22, 'MySQL 百万级以上分页优化',
        '<p>正常我们码农数据库的时候一般都是以下这种查询方式：</p>\r\n\r\n<pre>\r\n<code class=\"language-sql\">select * from table order by id limit 100000, 10;</code></pre>\r\n\r\n<p>但是以上这种查询会导致我们数据慢死，一般我们采用以下方式：</p>\r\n\r\n<pre>\r\n<code class=\"language-sql\">select * from table order by id limit 1000000, 10;</code></pre>\r\n\r\n<p>以上这种查询也不算最快 查询大概也要十几秒，数据不算太多采用以上方式，反之可以尝试以下方式：</p>\r\n\r\n<pre>\r\n<code class=\"language-sql\">celect * from table where id &gt;= (select id from table limit 1000000, 1) limit 10;</code></pre>\r\n\r\n<p>以上的也只是提速一点点 正点的来了&hellip;：</p>\r\n\r\n<pre>\r\n<code>select * from table where id between 1000000 and 1000010;</code></pre>\r\n\r\n<p>另外，如果需要查询 id 不是连续的一段，最佳的方法就是先找出 id ，然后用 in 查询：</p>\r\n\r\n<pre>\r\n<code class=\"language-sql\">select * from table where id in(10000, 100000, 1000000…);</code></pre>\r\n\r\n<p>优化Mysql千万级快速分页<br />\r\nLimit 1,111 数据大了确实有些性能上的问题，而通过各种方法给用上where id &gt;= XX,这样用上索引的id号可能速度上快点儿。<br />\r\n&nbsp;</p>',
        '', '2019-02-09 09:53:00', '2019-02-09 09:53:00', 301, 1, 1, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (23, 'Pandas DataFrame连接表 几种连接方法的对比',
        '<p>Pandas.DataFrame操作表连接有三种方式：merge, join, concat。下面就来说一说这三种方式的特性和用法。</p>\r\n\r\n<p>先看两张表：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" class=\"has\" src=\"//upload-images.jianshu.io/upload_images/8428973-2623e5cc670978a0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/320/format/webp\" /></p>\r\n\r\n<p>Screen Shot 2018-08-31 at 2.24.44 PM.png</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" class=\"has\" src=\"//upload-images.jianshu.io/upload_images/8428973-7bcb667048367102.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/320/format/webp\" /></p>\r\n\r\n<p>Screen Shot 2018-08-31 at 2.24.52 PM.png</p>\r\n\r\n<ol>\r\n	<li>merge。相当于SQL中的JOIN。该函数的典型应用场景是，两张表有相同内容的列（即SQL中的键），现在我们想把两张表整合到一张表里。在此典型情况下，结果集的行数并没有增加，列数则为两个元数据的列数和减去连接键的数量。</li>\r\n</ol>\r\n\r\n<p>1.1 参数说明：</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">merge(left, right, how=\'inner\', on=None, left_on=None, right_on=None,\r\n      left_index=False, right_index=False, sort=True,\r\n      suffixes=(\'_x\', \'_y\'), copy=True, indicator=False)\r\n</code></pre>\r\n</div>\r\n\r\n<p>left与right：两个不同的DataFrame<br />\r\nhow：指的是合并(连接)的方式有inner(内连接),left(左外连接),right(右外连接),outer(全外连接);默认为inner！<br />\r\non : 指的是用于连接的列索引名称。必须存在右右两个DataFrame对象中，如果没有指定且其他参数也未指定则以两个DataFrame的列名交集做为连接键<br />\r\nleft_on：左则DataFrame中用作连接键的列名;这个参数中左右列名不相同，但代表的含义相同时非常有用。<br />\r\nright_on：右则DataFrame中用作 连接键的列名<br />\r\nleft_index：使用左则DataFrame中的行索引做为连接键，用到这个参数时，就有点类似于接下来要说的JOIN函数了。<br />\r\nright_index：使用右则DataFrame中的行索引做为连接键<br />\r\nsort：默认为True，将合并的数据进行排序。在大多数情况下设置为False可以提高性能<br />\r\nsuffixes：字符串值组成的元组，用于指定当左右DataFrame存在相同列名时在列名后面附加的后缀名称，默认为(&#39;_x&#39;,&#39;_y&#39;)<br />\r\ncopy：默认为True,总是将数据复制到数据结构中；大多数情况下设置为False可以提高性能<br />\r\nindicator：在 0.17.0中还增加了一个显示合并数据中来源情况；如只来自己于左边(left_only)、两者(both)</p>\r\n\r\n<p>1.2 merge的特征<br />\r\n1.2.1 默认以重叠列名当做链接键<br />\r\n1.2.2 默认是INNER JOIN。<br />\r\n1.2.3 可以多键连接，&#39;on&#39;参数后传入多键列表即可<br />\r\n1.2.4 如果两个对象的列表不同，可以用left_on, right_on指定。<br />\r\n1.2.5 也可以用行索引当连接键，使用参数left_index=True, right_index=True. 但是这种情况下最好用JOIN</p>\r\n\r\n<p>现在来看例子：<br />\r\n开头介绍的两张表除了列名有重叠，内容并没有重叠的地方，所以并不是典型的merge场景。但是，用merge能不能合并呢？也可以。<br />\r\n如果用merge：pd.merge(df1, df2)，会得到一张空表<br />\r\n必须指定行索引参数left_index, right_index：</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">pd.merge(df1, df2, left_index=True, right_index=True, how=\'left\')\r\n</code></pre>\r\n</div>\r\n\r\n<p><img alt=\"\" class=\"has\" src=\"//upload-images.jianshu.io/upload_images/8428973-bdf4a5cf15f8a8d0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/320/format/webp\" /></p>\r\n\r\n<p>Screen Shot 2018-08-31 at 2.30.56 PM.png</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>这种是「非典型」应用，这种表的场景，更多的时候我们用JOIN函数来实现：</p>\r\n\r\n<ol>\r\n	<li>JOIN 拼接列，主要用于基于行索引上的合并。</li>\r\n</ol>\r\n\r\n<ul>\r\n	<li>只要两个表列名不同，不加任何参数就可以直接用。</li>\r\n	<li>如果两个表有重复的列名，需指定lsuffix, rsuffix参数。</li>\r\n	<li>其中参数的意义与merge方法基本相同,只是join方法默认为左外连接how=left</li>\r\n</ul>\r\n\r\n<div>\r\n<pre>\r\n<code>df1.join(df2, lsuffix=\'_l\', rsuffix=\'_r\') # 列名重复的时候需要指定lsuffix, rsuffix参数\r\n</code></pre>\r\n</div>\r\n\r\n<p><img alt=\"\" class=\"has\" src=\"//upload-images.jianshu.io/upload_images/8428973-fa9f591667b367b4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/320/format/webp\" /></p>\r\n\r\n<p>Screen Shot 2018-08-31 at 3.10.52 PM.png</p>\r\n\r\n<p>JOIN最适合的情况是基于行索引，上述例子因为列名有重复（即使内容没有重复），所以必须在JOIN的时候设置lsuffix, rsuffix参数，否则会报错。<br />\r\n如果列名不重复，则直接用&#39; df1.join(df2) &#39;即可。</p>\r\n\r\n<p>但是！ 如果我们想用JOIN实现基于列索引的合并，也是完全可以的。请注意以下的讨论全是关于用JOIN实现列索引合并的，即如何正确使用JOIN函数中的「ON」参数。<br />\r\n用JOIN实现基于列索引的合并主要考虑三种情况：</p>\r\n\r\n<ul>\r\n	<li>列名不同，列内容有相同</li>\r\n	<li>列名相同，列内容有相同</li>\r\n	<li>列名不同，列内容也不同</li>\r\n</ul>\r\n\r\n<p>（1） 列名不同，列内容有相同，需要用到 l.join(r.set_index(key of r), on=&#39;key of l&#39;)</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">\r\nleft = pd.DataFrame({\'key1\': [\'foo\', \'bar1\'], \'lval\': [1, 2]})\r\nright = pd.DataFrame({\'key2\': [\'foo\', \'bar\'], \'rval\': [4, 5]})\r\nleft.join(right.set_index(\'key2\'), on=\'key1\')\r\n</code></pre>\r\n</div>\r\n\r\n<p><img alt=\"\" class=\"has\" src=\"//upload-images.jianshu.io/upload_images/8428973-6df332f3fe745611.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/320/format/webp\" /></p>\r\n\r\n<p>Screen Shot 2018-08-31 at 4.05.30 PM.png</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>这种JOIN的写法等同于前面提到的merge设置left_on,right_on。</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">pd.merge(left, right,left_on=\'key1\', right_on=\'key2\') # 列名不同，但内容有相同可以当键\r\n</code></pre>\r\n</div>\r\n\r\n<p><img alt=\"\" class=\"has\" src=\"//upload-images.jianshu.io/upload_images/8428973-8525e581844a2476.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/320/format/webp\" /></p>\r\n\r\n<p>Screen Shot 2018-08-31 at 4.10.38 PM.png</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>因为merge默认是内连接，所以返回的结果只有一行，而JOIN返回的结果是以左表的key列为准，有两行。</p>\r\n\r\n<p>（2）列名相同，内容有相同，需要用到l.join(r.set_index(key), on=&#39;key&#39;)。</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">left = pd.DataFrame({\'key\': [\'foo\', \'bar1\'], \'lval\': [1, 2]})\r\nright = pd.DataFrame({\'key\': [\'foo\', \'bar\'], \'rval\': [4, 5]})\r\nleft.join(right.set_index(\'key\'), on=\'key\',lsuffix=\'_l\', rsuffix=\'_r\')\r\n</code></pre>\r\n</div>\r\n\r\n<p><img alt=\"\" class=\"has\" src=\"//upload-images.jianshu.io/upload_images/8428973-6bb7e4c4e5cbc3ac.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/320/format/webp\" /></p>\r\n\r\n<p>Screen Shot 2018-08-31 at 4.18.25 PM.png</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>这种JOIN的写法等同于前面提到的merge设置不带任何参数，而且这种情况下merge会去掉重复的列</p>\r\n\r\n<div>\r\n<pre>\r\n<code>pd.merge(left, right) # 列名不同，但内容有相同，所以依然可以作为键来用\r\n</code></pre>\r\n</div>\r\n\r\n<p><img alt=\"\" class=\"has\" src=\"//upload-images.jianshu.io/upload_images/8428973-89d0cd21f54a2341.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/320/format/webp\" /></p>\r\n\r\n<p>Screen Shot 2018-08-31 at 4.20.42 PM.png</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>同样，因为merge默认是内连接，所以返回的结果只有一行，而JOIN返回的结果是以左表的key列为准，有两行。</p>\r\n\r\n<p>特别注意，即使列名相同了，也必须用到&#39; set_index(key)&#39; 否则连接集会显示如下：</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">left.join(right,on=\'key\',lsuffix=\'_l\', rsuffix=\'_r\')\r\n</code></pre>\r\n</div>\r\n\r\n<p><img alt=\"\" class=\"has\" src=\"//upload-images.jianshu.io/upload_images/8428973-751db8c2bfee6990.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/320/format/webp\" /></p>\r\n\r\n<p>Screen Shot 2018-08-31 at 4.34.59 PM.png</p>\r\n\r\n<p>另外值得注意的一点，不指定&#39;ON= &#39;参数的情况下，JOIN是按行索引连接，也就是简单的水平连接两个表，不对列进行任何操作。如下代码返回的结果：</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">left.join(right,lsuffix=\'_l\', rsuffix=\'_r\')\r\n</code></pre>\r\n</div>\r\n\r\n<p><img alt=\"\" class=\"has\" src=\"//upload-images.jianshu.io/upload_images/8428973-0392b479cc87ec10.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/320/format/webp\" /></p>\r\n\r\n<p>Screen Shot 2018-08-31 at 4.25.30 PM.png</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>这个结果其实和用concat进行行操作是一模一样的：</p>\r\n\r\n<div>\r\n<pre>\r\n<code>pd.concat([left, right], axis=1)\r\n</code></pre>\r\n</div>\r\n\r\n<p>（3）列名不同，内容也不同<br />\r\n这种情况是典型的行索引，不能用JOIN的ON参数进行列连接。</p>\r\n\r\n<ol>\r\n	<li>concat 轴向连接。就是单纯地把两个表拼在一起，这个过程也被称作绑定（binding）或堆叠（stacking）。因此可以想见，这个函数的关键参数应该是 axis，用于指定连接的轴向。axis=1 在行中操作，axis=0是在列中操作。<br />\r\n	默认是axis=0,即垂直堆叠。</li>\r\n</ol>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">df1=pd.DataFrame(np.random.randn(3,4),columns=[\'a\',\'b\',\'c\',\'d\'])\r\ndf2=pd.DataFrame(np.random.randn(2,3),columns=[\'b\',\'d\',\'a\'])\r\npd.concat([df1, df2], axis=1) # 对行操作，相当于水平连接\r\n</code></pre>\r\n</div>\r\n\r\n<p>注意到这里，左表和右表没有一个单元格是一样的，只是按照行索引水平堆在了一起，所以可以理解为相当于</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">pd.merge(df1,df2,left_index=True,right_index=True,how=\'outer\') \r\n</code></pre>\r\n</div>\r\n\r\n<p>或者</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">df1.join(df2, lsuffix=\"_l\")\r\n</code></pre>\r\n</div>\r\n\r\n<p>效果都是生成这样一张表</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" class=\"has\" src=\"//upload-images.jianshu.io/upload_images/8428973-147fb89eb27da629.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/320/format/webp\" /></p>\r\n\r\n<p>Screen Shot 2018-08-31 at 1.24.10 PM.png</p>\r\n\r\n<p>最后看看CONCAT的垂直堆叠。垂直堆叠就是axis=0，这种情况下有个参数比较特殊，叫&#39; ignore_index= &#39;，默认情况下是False。如果设成了True，就是把结果的合并表重新编排行索引。否则，行索引还是原来两个表里的值，比如&quot;0,1,2,0,1&quot;</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">pd.concat([df1, df2], axis=0, ignore_index=True)\r\n</code></pre>\r\n<img src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" /><img src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" style=\"height:15px; width:15px\" title=\"点击并拖拽以移动\" /></div>\r\n\r\n<p><img alt=\"\" class=\"has\" src=\"//upload-images.jianshu.io/upload_images/8428973-8b7662f97054ab27.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/320/format/webp\" /></p>\r\n\r\n<p>Screen Shot 2018-08-31 at 1.26.39 PM.png</p>\r\n\r\n<p>如果两张表的列名都不相同，垂直堆叠会生扩展不同的列，生成一张更宽的表。</p>',
        '', '2018-09-15 03:53:00', '2018-05-15 03:54:00', 95, 1, 2, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (24, '使用Docker部署Django应用的过程和心得',
        '<blockquote>\r\n<p><strong><em>之前部署Web应用，没用docker，直接在服务器上部署，使用了django+nginx+supervisor+gunicorn部署博客应用。但后来了解了docker，为其&ldquo;Build，Ship and Run Any App,Anywhere&rdquo;的思想所折服，觉得这个太牛逼了，所以我也尝试一下自己用docker部署Web应用。本篇文章为了记录我用docker部署web应用的过程和心得。</em></strong></p>\r\n</blockquote>\r\n\r\n<blockquote>\r\n<p>Django常见的两种部署方式：</p>\r\n\r\n<ol>\r\n	<li>\r\n	<p>Django + Nginx + uWSGI</p>\r\n	</li>\r\n	<li>\r\n	<p>Django+ Nginx + Gunicorn</p>\r\n	</li>\r\n</ol>\r\n\r\n<p>采用用&nbsp;uWSGI 配合 Nginx的部署方式</p>\r\n\r\n<p>构建的容器：</p>\r\n\r\n<ol>\r\n	<li>Django+nginx+uwsgi 容器 (dockerfiles/django-uwsgi-nginx)</li>\r\n	<li>MySQL容器 (mysql:5.6)</li>\r\n</ol>\r\n</blockquote>\r\n\r\n<p>&nbsp;<img src=\"/media/upload/2019/08/28/image.png\" style=\"height:128px; width:1392px\" /></p>\r\n\r\n<p>下载好镜像, 就是要运行容器. 在这之前需要为容器自定义创建专属网络</p>\r\n\r\n<h1>1.创建专属网络</h1>\r\n\r\n<pre>\r\n<code class=\"language-bash\">docker network create django_network</code></pre>\r\n\r\n<p><img src=\"/media/upload/2019/08/28/image_4sLDFF1.png\" style=\"height:214px; width:1110px\" /></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>后面的服务都会使用这个专属网络进行通信，主机名就是域名地址，通信地址直接填主机名，docker提供了域名解析，所以我settings.py的数据库配置如下:</p>\r\n\r\n<pre>\r\n<code class=\"language-python\"># 配置mysql\r\nDATABASES = {\r\n    \'default\': {\r\n        \'ENGINE\': \'django.db.backends.mysql\',\r\n        \'NAME\': \'djmyblog\',\r\n        \'USER\': \'用户\',\r\n        \'PASSWORD\': \'密码\',\r\n        \'HOST\': \'django_mysql\',  # 这就是数据库容器名  通过域名解析\r\n        \'PORT\': \'端口\',\r\n    }\r\n}</code></pre>\r\n\r\n<h1>2.部署Mysql</h1>\r\n\r\n<pre>\r\n<code class=\"language-bash\">docker run -d -p 3307:3306 --network django_network --name django_mysql -e MYSQL_ROOT_PASSWORD=123456 mysql:5.6\r\n# 说明下参数意义\r\n# -p 映射端口:docker内部端口： 端口映射，只有将容器端口映射到外部，外部才能访问\r\n# -e 环境变量，指定一些服务内读取的变量，以初始化服务，这里的变量意义从字面上不难理解\r\n# --network 指定容器所在网络，需要互相访问的容器记得指定到同一个网络！\r\n# --name 容器名，这个名字在同一个容器网络里是可以直接当成域名访问的！</code></pre>\r\n\r\n<h1>3.部署web服务</h1>\r\n\r\n<pre>\r\n<code class=\"language-python\"> docker run -d --network django_network --name django_web -p 80:80 -p 443:443 -v /home:/home  dockerfiles/django-uwsgi-nginx\r\n# 说明下参数意义\r\n# -p 映射端口:docker内部端口： 端口映射，只有将容器端口映射到外部，外部才能访问\r\n# -v 数据卷，可以将主机上的某个目录与容器的某个目录关联起来，容器上的挂载点下的内容就是主机的这个目录下的内容\r\n# --network 指定容器所在网络，需要互相访问的容器记得指定到同一个网络！\r\n# --name 容器名，这个名字在同一个容器网络里是可以直接当成域名访问的！</code></pre>\r\n\r\n<h1>4.<strong>Nginx配置（nginx目录）</strong></h1>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>接下是配置 Nginx 来处理用户请求。</p>\r\n\r\n<p>先在服务器的 /etc/nginx/sites-available/ 目录下新建一个配置文件，文件名我一般就设置为域名。写上下面的配置内容：</p>\r\n\r\n<pre>\r\n<code class=\"language-nginx\">server {\r\n        charset utf-8;\r\n        listen 80;\r\n        server_name blog;\r\n\r\n        location /static {\r\n                # 写静态文件夹路径\r\n                alias /home/django-blog/blogproject/static;\r\n        }\r\n        location /media {\r\n                # 上传图片路径\r\n                alias /home/django-blog/blogproject/media;\r\n        }\r\n        location / {\r\n                proxy_set_header Host $host;\r\n                proxy_pass http://0.0.0.0:8000;\r\n                 # 设置请求头，传递原始请求ip给 gunicorn 服务器\r\n                proxy_set_header X-Real-IP $remote_addr;\r\n        }\r\n        location /static/look_girl_models {\r\n                 add_header Access-Control-Allow-Origin https://paugram.com;\r\n        }\r\n\r\n        location ~ .*\\.(js|css|png|jpg|gif)$ {\r\n                root /home/django-blog/blogproject; #站点根目录\r\n                if (-f $request_filename) {\r\n                    expires 1d;\r\n                break;\r\n                }\r\n        }\r\n\r\n}</code></pre>\r\n\r\n<p>在 /etc/nginx/sites-available/ 放置了配置文件，接下来需要创建一个符号链接，把这个配置文件加入到启用的网站列表中去，被启用网站的目录在 /etc/nginx/sites-enabled/，你可以理解为从 sites-available/ 目录下发送了一个配置文件的快捷方式到 sites-enabled/ 目录。具体命令如下：</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">sudo ln -s /etc/nginx/sites-available/myblog /etc/nginx/sites-enabled/myblog</code></pre>\r\n\r\n<h1>5. 使用 Gunicorn</h1>\r\n\r\n<p>Gunicorn 一般用来管理多个进程，有进程挂了Gunicorn 可以把它拉起来，防止服务器长时间停止服务，还可以动态调整 worker 的数量，请求多的时候增加 worker 的数量，请求少的时候减少。</p>\r\n\r\n<p>安装 Gunicorn：</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">pip install gunicorn</code></pre>\r\n\r\n<p>用 Gunicorn 启动服务器进程：</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\"># 需要在项目目录下\r\ngunicorn --bind 0.0.0.0:8000 blogproject.wsgi:application \r\n\r\n</code></pre>\r\n\r\n<h1>6.&nbsp;进程管理工具 Supervisor&nbsp;</h1>\r\n\r\n<p>supervisor-app.conf 配置信息</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\"># gunicorn\r\n[program: gunicorn-app]\r\n# 项目目录\r\ndirectory = /home/django-blog/blogproject\r\n# 命令\r\ncommand = nohup gunicorn --bind 0.0.0.0:8000 blogproject.wsgi:application  &gt; /dev/null 2&gt;&amp;1\r\n\r\n# nginx\r\n[program:nginx-app]\r\ncommand = /usr/sbin/nginx</code></pre>\r\n\r\n<h1>7. 运行项目</h1>\r\n\r\n<pre>\r\n<code class=\"language-bash\"># 这时候你可以使用supervisorctl命令\r\nsupervisorctl start all\r\n\r\n\r\n# 查看运行状态命令 \r\nsupervisorctl status\r\n#gunicorn-app                     RUNNING   pid 128, uptime 0:45:08\r\n#nginx-app                        RUNNING   pid 129, uptime 0:45:08</code></pre>\r\n\r\n<p>这里为什么要使用Supervisor, 因为以后每次部署项目就不需要在运行各个组件. 只需要一个命令就可以将项目起来, 很方便.</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h1>部署的时候踩的坑的问题</h1>\r\n\r\n<h3>docker 容器中乱码解决办法(真实解决!!!)&nbsp;</h3>\r\n\r\n<p>进入web容器找到项目, 在运行web是报错了, settint.py文件里的中文注释全部乱码</p>\r\n\r\n<blockquote>\r\n<p>解决方法:</p>\r\n\r\n<pre>\r\n<code class=\"language-python\">LANG=C.UTF-8</code></pre>\r\n\r\n<p>然后再激活:</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">source /etc/profile </code></pre>\r\n\r\n<p>然而实际上这样显示是没有出问题了,但是我的hdfs命令却失效了!!!</p>\r\n\r\n<p>提示command not find</p>\r\n\r\n<p>然而发现不使用激活环境激活语句,直接也就可以看到中文正常显示了,或者使用这样进行环境变量的设置:</p>\r\n\r\n<pre>\r\n<code class=\"language-python\">export LANG=C.UTF-8</code></pre>\r\n\r\n<p>但是有个问题就是每次进入容器都要执行一次&nbsp;export LANG=C.UTF-8 确实很麻烦</p>\r\n\r\n<p>这里就需要修改Linux的配置文件&nbsp;</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">.bashrc             当你登入shell时执行</code></pre>\r\n\r\n<p>需要vim添加&nbsp;.bashrc&nbsp;文件</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\"># vim打开配置文件\r\nvim ~/.bashrc  \r\n\r\n\r\n# 在文件最后添加\r\n​export LANG=C.UTF-8\r\n\r\n​</code></pre>\r\n\r\n<p>&nbsp;</p>\r\n</blockquote>\r\n\r\n<p>&nbsp;</p>',
        '', '2019-08-10 12:13:00', '2019-08-10 12:13:00', 1264, 1, 5, 1, 0, 1);
INSERT INTO `tb_content`
VALUES (25, '使用shell脚本自定义实现选择登录ssh',
        '<p>在系统bin目录中建立两个脚本分别是pssh tssh</p>\r\n\r\n<p>pssh</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">#!/usr/bin/expect -f\r\nset ip [lindex $argv 0 ]\r\nset port [lindex $argv 1 ]\r\nset password [lindex $argv 2 ]\r\nset uname [lindex $argv 3 ]\r\nset timeout 10\r\nspawn ssh root@$ip -p$port\r\nexpect {\r\n\"*yes/no\" { send \"yes\\r\"; exp_continue}\r\n\"*password:\" { send \"$password\\rclear\\r\\r\\r请小心使用,您现在登录的服务器IP是:$ip,服务器名称是:$uname\" }\r\n}\r\ninteract</code></pre>\r\n\r\n<p>tssh</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">#!/bin/sh\r\necho \"以下是你的所有服务器列表\"\r\necho \"1.A服务器 192.168.100.11\"\r\necho \"2.B服务器 192.168.100.12\"\r\necho \"3.C服务器 192.168.100.13\"\r\necho \"回车键退出\"\r\necho \"请输入对应数字,选择你要登录的服务器:\\c\"\r\nread input\r\ntest $input = 0\r\n\r\ncase $input in\r\n1)pssh 192.168.100.11 22 123456 A服务器;;\r\n2)pssh 192.168.100.12 22 admin B服务器;;\r\n3)pssh 192.168.100.13 22 root C服务器;;\r\nesac</code></pre>\r\n\r\n<p>记得将给脚本加上可执行权限</p>\r\n\r\n<p>然后在终端上执行tssh出现如下结果</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">以下是你的所有服务器列表\r\n1.A服务器 192.168.100.11\r\n2.B服务器 192.168.100.12\r\n3.C服务器 192.168.100.13\r\n回车键退出\r\n请输入对应数字,选择你要登录的服务器:1\r\nspawn ssh root@192.168.100.11 -p22\r\nCentOS release 6.8 (Final)\r\nKernel \\r on an \\m\r\nroot@192.168.100.11\'s password: \r\nLast login: Thu Aug 18 18:34:58 2016 from 192.168.100.2\r\nWelcome to aliyun Elastic Compute Service!\r\n[root@Official ~]#</code></pre>\r\n\r\n<p>&nbsp;</p>',
        '', '2018-09-05 11:36:00', '2018-09-05 11:36:00', 172, 1, 4, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (26, 'Django-如何显示文章摘要?',
        '<p>需要在blog主页显示文章的摘要, 即显示文章的前面一部分.</p>\r\n\r\n<h2>在django中, 我尝试过以下做法:</h2>\r\n\r\n<pre>\r\n<code class=\"language-python\">{{ post.get_message_as_markdown|safe| truncatechars:\'400\'}}       // 截取文章的前400个词\r\n</code></pre>\r\n\r\n<p>但问题是, 文章中为了排版可能带有html标记(实际上是使用了markdown语法), 如:</p>\r\n\r\n<pre>\r\n<code class=\"language-python\">  who are you ?&lt;p&gt;I am python &lt;/p&gt; \r\n</code></pre>\r\n\r\n<p>如果不凑巧, 碰巧截取掉了某个html标记, 如变为:</p>\r\n\r\n<pre>\r\n<code class=\"language-python\">  who are you ?&lt;p&gt;I am python            //少了个结束标志 \'&lt;/p&gt;\'\r\n</code></pre>\r\n\r\n<p>那么整个页面都会被破坏.</p>\r\n\r\n<p>如果恰好截取到中间，则前端显示一定会出现排版乱码的现象</p>\r\n\r\n<p>这时候就会出现以下情况:</p>\r\n\r\n<p><img alt=\"\" src=\"/media/upload/2019/09/03/wx20190903-1616122x_ail0qrg.png\" style=\"height:407px; width:600px\" /></p>\r\n\r\n<h2>原来django其实早就帮我们解决好这个问题了，通过过滤器truncatechars_html</h2>\r\n\r\n<pre>\r\n<code class=\"language-python\"># 像这样的模板\r\n{{ value|truncatechars_html:9 }}</code></pre>\r\n\r\n<pre>\r\n<code class=\"language-python\">如果value是“＆lt； p＆gt； Joel 是 a slug＆lt； / p＆gt； “，输出将为”＆lt； p＆gt； Joel i …＆lt； / p＆gt；“ t7 &gt;。</code></pre>\r\n\r\n<h2><strong>解决方法是:</strong></h2>\r\n\r\n<pre>\r\n<code class=\"language-python\">truncatewords_html 或者 truncatechars_html（django 1.7以上）\r\n\r\n# 将truncatechars替换为truncatechars_html\r\n{{ post.get_message_as_markdown|safe|truncatechars_html:400}}</code></pre>',
        '', '2019-09-03 08:14:00', '2019-09-03 08:14:00', 256, 1, 5, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (27, '如何记录页面加载时间',
        '<h2>一、纯前端时间戳</h2>\r\n\r\n<p>在&nbsp;<code>&lt;head&gt;</code>&nbsp;里面记录一个时间戳，在文档底部用&nbsp;<code>onload</code>&nbsp;记录结束时间戳。</p>\r\n\r\n<pre>\r\n<code class=\"language-javascript\">&lt;!--头部--&gt;\r\n&lt;head&gt;\r\n    &lt;script&gt;\r\n        const start = Date.now()\r\n    &lt;/script&gt;\r\n&lt;/head&gt;\r\n&lt;!--底部--&gt;\r\n&lt;script&gt;\r\n    window.onload = () =&gt; {\r\n        const end = Date.now()\r\n        console.log(`消耗了 ${end - start} ms`)\r\n    }\r\n&lt;/script&gt;</code></pre>\r\n\r\n<p><strong>缺点</strong></p>\r\n\r\n<p>文档加载之前的时间被忽略了，比如建立连接、网络延迟、解析数据的时间。</p>\r\n\r\n<h2>二、配合后端</h2>\r\n\r\n<p>可以记录到从后端建立连接到文档加载完成之后的时间。</p>\r\n\r\n<p><strong>缺点</strong></p>\r\n\r\n<p>存在前后端时间不一致的问题，增加后端工作量，从页面开始到访问到后端资源的这段时间依旧被忽略了。</p>\r\n\r\n<h2>三、配合 HTML5 中的 PerformanceTiming.navigationStart</h2>\r\n\r\n<blockquote>\r\n<p>PerformanceTiming.navigationStart 是一个返回代表一个时刻的 unsigned long long 型只读属性，为紧接着在相同的浏览环境下卸载前一个文档结束之时的 Unix毫秒时间戳。如果没有上一个文档，则它的值相当于 PerformanceTiming.fetchStart&nbsp;<a href=\"https://developer.mozilla.org/zh-CN/docs/Web/API/PerformanceTiming/navigationStart\" rel=\"nofollow\" target=\"_blank\">MDN</a>。</p>\r\n</blockquote>\r\n\r\n<pre>\r\n<code class=\"language-javascript\">window.onload = () =&gt; {\r\n    const load = Date.now() - performance.timing.navigationStart\r\n    console.log(`消耗了 ${load} ms`)\r\n}\r\n</code></pre>\r\n\r\n<p><strong>缺点</strong></p>\r\n\r\n<p>存在兼容性问题，因为是 HTML5 新特性，目前只有 IE9+ 支持。</p>\r\n\r\n<p>&nbsp;</p>',
        '', '2019-09-04 07:19:00', '2019-09-04 07:19:00', 125, 1, 6, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (28, '页面侧边栏-标签云',
        '<h2>功能:</h2>\r\n\r\n<ul>\r\n	<li><strong>点击标签进入页面</strong></li>\r\n	<li><strong>鼠标悬浮标签显示共几篇文章</strong></li>\r\n	<li><strong>页面刷新标签随机大小、随机颜色</strong></li>\r\n</ul>\r\n\r\n<p><img src=\"/media/upload/2019/09/04/image.png\" style=\"height:471px; width:400px\" /></p>\r\n\r\n<p>模块必须包含名为的模块级变量<code>register</code>，该变量是一个<code>template.Library</code>实例，其中注册了所有标记和过滤器</p>\r\n\r\n<pre>\r\n<code class=\"language-python\">from django import template\r\nregister = template.Library()</code></pre>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>自定义过滤器用于<strong>鼠标悬浮标签显示共几篇文章</strong></p>\r\n\r\n<pre>\r\n<code class=\"language-python\"># 用于标签与title数量\r\n@register.filter\r\ndef make_count(obj):\r\n    # 根据外键获取文章数量\r\n    cunt = obj.post_set.all().count()\r\n    return cunt</code></pre>\r\n\r\n<p>通过自定义过滤器用于&nbsp;<strong>页面刷新标签随机大小、随机颜色</strong></p>\r\n\r\n<pre>\r\n<code class=\"language-python\"># 用于标签随机生成数\r\n@register.filter\r\ndef random_num(num):\r\n    import random\r\n    num = random.uniform(int(num), 50)\r\n    return num\r\n\r\n\r\n# style 随机颜色\r\n@register.filter\r\ndef random_color(num):\r\n    import random\r\n    num = random.randint(0, int(num))\r\n    return int(num)</code></pre>\r\n\r\n<pre>\r\n<code class=\"language-html\">&lt;div class=\"tagcloud\"&gt;\r\n    {% tag_list as tag_list %}\r\n    {% for tag in tag_list %}\r\n        &lt;a class=\"tag-link-29 tag-link-position-29\"\r\n           href=\"/mark/?name={{ tag.name }}\"\r\n           style=\"color: rgb({{ \'255\'|random_color }},{{ \'255\'|random_color }},{{ \'255\'|random_color }}); font-size: {{ \'10\'| random_num }}pt;\"\r\n           title=\"{{ tag|make_count }}篇话题\"&gt; {{ tag.name }}\r\n        &lt;/a&gt;\r\n    {% endfor %}\r\n&lt;/div&gt;</code></pre>\r\n\r\n<p>&nbsp;</p>',
        '', '2019-09-04 10:05:00', '2019-09-04 10:05:00', 94, 1, 5, 0, 0, 1);
INSERT INTO `tb_content`
VALUES (29, 'Django创建模型迁移未创建对应表',
        '<blockquote>\r\n<p>问题描述：</p>\r\n\r\n<p>在django中创建了一个app，而且在app中自定义创建了几个数据表，在同步的时候系统自带的表可以成功，但是models中的没有生效，而且进入对应app下的migrations目录，发现为空，应该如何解决呢！</p>\r\n</blockquote>\r\n\r\n<h2><strong>解决方法:&nbsp;</strong></h2>\r\n\r\n<pre>\r\n<code class=\"language-python\"># managerbook就是你的app名字，此处要写成自己的app名字\r\npython3 manage.py makemigrations --empty managerbook  \r\n\r\n# 再次正常运行生成迁移文件的命令\r\npython3 manage.py makemigrations   \r\n\r\n# 同步数据库\r\npython3 manage.py migrate  \r\n</code></pre>\r\n\r\n<p>如果在同步数据库报错</p>\r\n\r\n<blockquote>\r\n<h1>django.db.utils.InternalError: (1050, &quot;Table &#39;django_content_type&#39; already exists&quot;)</h1>\r\n</blockquote>\r\n\r\n<pre>\r\n<code class=\"language-python\"># 将同步数据库命令改为\r\npython3 manage.py migrate --fake</code></pre>\r\n\r\n<p>&nbsp;</p>',
        '', '2019-09-05 03:32:00', '2019-09-05 03:32:00', 102, 1, 5, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (30, '在Django项目中项目全局获取request对象',
        '<p>新建middleware.py&nbsp;</p>\r\n\r\n<pre>\r\n<code class=\"language-python\"># -*- coding:utf-8 -*-\r\n\r\n\r\nfrom django.utils.deprecation import MiddlewareMixin\r\n\r\n\r\nclass GlobalRequestMiddleware(MiddlewareMixin):\r\n    __instance = None\r\n\r\n    def __new__(cls, *args, **kwargs):\r\n        if not cls.__instance:\r\n            cls.__instance = object.__new__(cls)\r\n        return cls.__instance\r\n\r\n    def process_request(self, request):\r\n        GlobalRequestMiddleware.__instance = request\r\n\r\n    @classmethod\r\n    def getRequest(cls):\r\n        return cls.__instance\r\n</code></pre>\r\n\r\n<p>需要在setting.py文件中添加</p>\r\n\r\n<pre>\r\n<code class=\"language-python\">\r\nMIDDLEWARE = [\r\n    \'django.middleware.security.SecurityMiddleware\',\r\n    \'django.contrib.sessions.middleware.SessionMiddleware\',\r\n    \'django.middleware.common.CommonMiddleware\',\r\n    \'django.middleware.csrf.CsrfViewMiddleware\',\r\n    \'django.contrib.auth.middleware.AuthenticationMiddleware\',\r\n    \'django.contrib.messages.middleware.MessageMiddleware\',\r\n    \'django.middleware.clickjacking.XFrameOptionsMiddleware\',\r\n    \'blogproject.middleware.GlobalRequestMiddleware\'  # 将自定义middleware注册\r\n]</code></pre>\r\n\r\n<p>这样就可以在整个项目任何地方获取到request请求对象</p>\r\n\r\n<pre>\r\n<code class=\"language-python\">from blogproject.middleware import GlobalRequestMiddleware\r\n\r\ncurrentRequest = GlobalRequestMiddleware.getRequest()</code></pre>\r\n\r\n<p>&nbsp;</p>',
        '', '2019-09-09 11:17:00', '2019-09-09 11:17:00', 91, 1, 5, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (32, '使用UnblockNeteaseMusic播放网易云音乐客户端无版权歌曲',
        '<p><strong>说明：</strong><code>UnblockNeteaseMusic</code>是一款可以给你解除网易云音乐海外限制并解锁变灰(无版权)歌曲的工具，让你可以听取客户端任何的歌曲，而不受到限制，此前该类似工具挺多的，不过貌似都不维护或者失效了，这里提到的项目更新很频繁，支持<code>Windows</code>、<code>MacOS</code>、安卓、<code>IOS</code>等设备，所以就分享一下使用方法。</p>\r\n\r\n<h2>截图</h2>\r\n\r\n<p><img alt=\"\" data-widget=\"image\" src=\"https://img-blog.csdnimg.cn/2020040814214460.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"width:800px\" /></p>\r\n\r\n<p><img alt=\"\" data-widget=\"image\" src=\"https://img-blog.csdnimg.cn/20200408142207385.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"width:800px\" /></p>\r\n\r\n<h2>特性</h2>\r\n\r\n<ul>\r\n	<li>使用网易云旧链/<code>QQ</code>/虾米/百度/酷狗/酷我/咕咪/<code>JOOX</code>音源替换变灰歌曲链接(默认仅启用前四)。</li>\r\n	<li>为请求增加<code>X-Real-IP</code>参数解锁海外限制，支持指定网易云服务器<code>IP</code>，支持设置上游<code>HTTP</code>/<code>HTTPS</code>代理。</li>\r\n	<li>完整的流量代理功能(<code>HTTP</code>/<code>HTTPS</code>)，可直接作为系统代理(同时支持<code>PAC</code>)。</li>\r\n</ul>\r\n\r\n<h2>安装</h2>\r\n\r\n<p><strong>Github地址：</strong><a href=\"https://github.com/nondanee/UnblockNeteaseMusic\">https://github.com/nondanee/UnblockNeteaseMusic</a></p>\r\n\r\n<p><strong>1、安装Nodejs</strong></p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre data-widget=\"codeSnippet\">\r\n<code class=\"hljs\">#Debian/Ubuntu系统\r\ncurl -sL https://deb.nodesource.com/setup_10.x | bash -\r\napt install -y nodejs git \r\n\r\n#CentOS系统\r\ncurl -sL https://rpm.nodesource.com/setup_10.x | bash -\r\nyum install nodejs git -y\r\n</code></pre>\r\n</div>\r\n\r\n<p><strong>2、运行UnblockNeteaseMusic</strong></p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre data-widget=\"codeSnippet\">\r\n<code class=\"hljs\">git clone https://github.com/nondanee/UnblockNeteaseMusic.git\r\ncd UnblockNeteaseMusic\r\nnode app.js</code></pre>\r\n</div>\r\n\r\n<p>运行端口默认为<code>8080</code>，需要想修改可以编辑<code>app.js</code>文件的<code>config.port</code>对应的数值，或者使用命令：</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre data-widget=\"codeSnippet\">\r\n<code class=\"hljs\">#这里默认修改4567，自行调整\r\nnode app.js -p 4567</code></pre>\r\n</div>\r\n\r\n<p>这里还可以加一个<code>-s</code>参数限制代理范围防止被滥用，也就是仅放行网易云音乐所属域名的请求，不过使用起来的话就受限了，仅支持<code>PAC</code>或<code>Hosts</code>。</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre data-widget=\"codeSnippet\">\r\n<code class=\"hljs\">node app.js -s\r\n</code></pre>\r\n</div>\r\n\r\n<p><strong>3、开机自启</strong><br />\r\n这里使用<code>Systemd</code>进程守护，只适用于<code>CentOS 7</code>、<code>Debian 8+</code>、<code>Ubuntu 16+</code>等。</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre data-widget=\"codeSnippet\">\r\n<code class=\"hljs\">#修改下ExecStartPre源码路径即可，然后一起复制到SSH运行\r\ncat &gt; /etc/systemd/system/UnblockNeteaseMusic.service &lt;&lt;EOF\r\n[Unit]\r\nDescription=UnblockNeteaseMusic\r\nAfter=network.target\r\nWants=network.target\r\n\r\n[Service]\r\nType=simple\r\nPIDFile=/var/run/UnblockNeteaseMusic.pid\r\nWorkingDirectory=/root/UnblockNeteaseMusic\r\nExecStart=$(command -v node) app.js -p 4567\r\nRestartPreventExitStatus=23\r\nRestart=always\r\n\r\n[Install]\r\nWantedBy=multi-user.target\r\nEOF</code></pre>\r\n</div>\r\n\r\n<p>启动并开机自启：</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre data-widget=\"codeSnippet\">\r\n<code class=\"hljs\">systemctl start UnblockNeteaseMusic\r\nsystemctl enable UnblockNeteaseMusic\r\n</code></pre>\r\n</div>\r\n\r\n<p>如果没有<code>Systemd</code>的，比如<code>CentOS 6</code>，<code>Debian 7</code>等，直接使用<code>rc.local</code>，使用命令：</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre data-widget=\"codeSnippet\">\r\n<code class=\"hljs\">#路径和命令自行修改\r\nsed -i &#39;/exit/d&#39; /etc/rc.local\r\necho &quot;cd /root/UnblockNeteaseMusic &amp;&amp; node app.js -p 4567&quot; &gt;&gt; /etc/rc.local\r\n</code></pre>\r\n</div>\r\n\r\n<h2>Docker安装</h2>\r\n\r\n<p><strong>1、安装Docker</strong></p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre data-widget=\"codeSnippet\">\r\n<code class=\"hljs\">#CentOS 6\r\nrpm -iUvh http://dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm\r\nyum update -y\r\nyum -y install docker-io\r\nservice docker start\r\nchkconfig docker on\r\n\r\n#CentOS 7、Debian、Ubuntu\r\ncurl -sSL https://get.docker.com/ | sh\r\nsystemctl start docker\r\nsystemctl enable docker\r\n</code></pre>\r\n</div>\r\n\r\n<p><strong>2、运行镜像</strong></p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre data-widget=\"codeSnippet\">\r\n<code class=\"hljs\">docker run --restart=always --name unmusic -d -p 4567:8080 nondanee/unblockneteasemusic</code></pre>\r\n</div>\r\n\r\n<p>运行端口<code>4567</code>，自行修改。</p>\r\n\r\n<h2>使用</h2>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre data-widget=\"codeSnippet\">\r\n<code class=\"hljs\">提示：使用方法可以选择修改Hosts或者设置代理的方式，自己挑选一种比较会的吧。\r\n</code></pre>\r\n</div>\r\n\r\n<p><strong>1、修改Hosts</strong><br />\r\n找到<code>Hosts</code>路径，大致位置：</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre data-widget=\"codeSnippet\">\r\n<code class=\"hljs\">Windows系统：位于C:\\Windows\\System32\\drivers\\etc\\hosts\r\nAndroid系统：位于/system/etc/hosts\r\nMac系统：位于/etc/hosts\r\nIOS系统：位于/etc/hosts\r\nLinux系统：位于/etc/hosts\r\n</code></pre>\r\n</div>\r\n\r\n<p>向<code>hosts</code>文件添加两条规则</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre data-widget=\"codeSnippet\">\r\n<code class=\"hljs\">#将前面参数修改为服务器IP\r\n&lt;Server IP&gt; music.163.com\r\n&lt;Server IP&gt; interface.music.163.com\r\n</code></pre>\r\n</div>\r\n\r\n<p>使用此方法必须监听<code>80</code>端口，也就是使用<code>-p 80</code>参数指定<code>80</code>端口运行。</p>\r\n\r\n<p><strong>2、设置代理</strong><br />\r\n安卓系统：</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre data-widget=\"codeSnippet\">\r\n<code class=\"hljs\">#设置方法\r\n手机设置 &gt; WLAN &gt; 网络设置 &gt; 高级选项 &gt; 代理\r\n\r\n一般安卓手机设置代理类型的时候分2种，手动代理和自动代理，有的手机可能只有手动代理，大致设置如下：\r\n手动代理 &gt; 只需要填上你的服务器IP和端口就可以了。\r\n自动代理 &gt; 填上你的PAC地址就行了，地址：http://&lt;Server Name:PORT&gt;/proxy.pac，修改为你的ip、运行端口。\r\n\r\n如果你发现设置后不能使用或者出现其它网络问题，带了-s参数的不妨去掉后再试试。\r\n</code></pre>\r\n</div>\r\n\r\n<p><code>Windows</code>系统：</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre data-widget=\"codeSnippet\">\r\n<code class=\"hljs\">#设置方法\r\n网易云客户端设置 &gt; 工具 &gt; 自定义代理 &gt; HTTP代理\r\n\r\n这里只需要填上你的服务器ip和端口，保存即可。\r\n</code></pre>\r\n</div>\r\n\r\n<p><code>IOS</code>系统：<br />\r\n这里很久前有人要博主详细说下<code>IOS</code>使用方法，对于不会设置的是挺复杂的，所以就截图说下，需要借助<code>Shadowrocket</code>工具。</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre data-widget=\"codeSnippet\">\r\n<code class=\"hljs\">#设置方法\r\n打开小火箭 &gt; 添加节点(类型选择HTTP，输入你的ip和端口，随便备注下，右上角完成即可) &gt; 编辑配置 &gt; 添加规则(类型选择USER-AGENT，选项选择网易云，用户代理输入NeteaseMusic*)，保存即可。</code></pre>\r\n</div>\r\n\r\n<p><img alt=\"\" data-widget=\"image\" src=\"https://img-blog.csdnimg.cn/20200408142226794.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"width:800px\" /><br />\r\n像<code>macOS</code>啥的，没设备就不测试了，直接列举下作者提供方法。</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre data-widget=\"codeSnippet\">\r\n<code class=\"hljs\">UWP    Windows设置 &gt; 网络和Internet &gt; 代理\r\nLinux    系统设置 &gt; 网络 &gt; 网络代理\r\nmacOS    系统偏好设置 &gt; 网络 &gt; 高级 &gt; 代理\r\n</code></pre>\r\n</div>\r\n\r\n<p>设置好了后，你会发现客户端之前因为版权问题不能听的都可以听了，然后建议搭建的时候，选择的服务器网络延迟尽量好点，不然播放会很慢。</p>\r\n\r\n<h2>问题补充</h2>\r\n\r\n<p>1、如果设置好了后，打开客户端提示网络问题的话，稍等片刻就好了，如果过会还是不行，就检查下操作啥的，比如防火墙。</p>\r\n\r\n<p>一般情况下<code>CentOS</code>防火墙还需要开启运行端口，比如博主用的<code>4567</code>，使用命令：</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre data-widget=\"codeSnippet\">\r\n<code class=\"hljs\">#CentOS 6\r\niptables -I INPUT -p tcp --dport 4567 -j ACCEPT\r\nservice iptables save\r\nservice iptables restart\r\n\r\n#CentOS 7\r\nfirewall-cmd --zone=public --add-port=4567/tcp --permanent\r\nfirewall-cmd --reload</code></pre>\r\n</div>\r\n\r\n<p>宝塔的话可以直接面板左侧-安全-开启对应的端口即可。</p>\r\n\r\n<p>2、上面只提到了安卓<code>WLAN</code>下的使用方法，这里再补充个手机数据下的使用方法，建议配合<code>Xndroid</code>工具，最新版<code>APP</code>下载地址&rarr;<a href=\"https://github.com/XndroidDev/Xndroid/releases\">传送门</a>，大致设置如下：</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre data-widget=\"codeSnippet\">\r\n<code class=\"hljs\">打开Xndroid &gt; 点击左侧Fqrouter &gt; 添加个人代理(只需要填服务器ip和端口即可) &gt; 代理列表配置项(将高级设置里面全部关掉) &gt; 软件右上角代理设置(只代理网易云音乐)</code></pre>\r\n<img src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" /><span style=\"background:url(&quot;https://chenyinren.top/root_static/ckeditor/ckeditor/plugins/widget/images/handle.png&quot;) rgba(220, 220, 220, 0.5); display:block; left:0px; top:-15px\"><img role=\"presentation\" src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" style=\"height:15px; width:15px\" title=\"点击并拖拽以移动\" /></span></div>\r\n\r\n<p>设置完成后你还可以在右上角启动设置中，关掉<code>xx-net</code>和<code>fqrouter</code>里面的所有启动项，这样开启软件速度也会快很多。</p>\r\n\r\n<p>最后貌似很多妹子都喜欢用网易云，小伙伴们可以去喜欢的妹子面前装个逼，自己搭建好了，然后教她们点亮下灰色无版权歌曲。</p>',
        '', '2018-02-18 03:56:00', '2018-02-18 03:56:00', 681, 1, 8, 0, 0, 1);
INSERT INTO `tb_content`
VALUES (33, 'docker 安装 nginx 配置反向代理',
        '<h1><strong>1.安装nginx docker镜像</strong></h1>\r\n\r\n<p>获取nginx官方镜像&nbsp;</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">docker pull nginx\r\n</code></pre>\r\n\r\n<p><img src=\"/media/upload/2019/09/29/image.png\" style=\"height:187px; width:800px\" /></p>\r\n\r\n<p>查看镜像库</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">docker images</code></pre>\r\n\r\n<p><img src=\"/media/upload/2019/09/29/image_isW1Kgp.png\" style=\"height:82px; width:800px\" /></p>\r\n\r\n<p>使用nginx镜像来创建nginx容器实例</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">docker run --name nginx_my -p 80:80 -d nginx</code></pre>\r\n\r\n<blockquote>\r\n<p>run 创建容器实例</p>\r\n\r\n<p>-- name 容器命名</p>\r\n\r\n<p>-v 映射目录</p>\r\n\r\n<p>-d 设置容器后台运行</p>\r\n\r\n<p>-p 本机端口映射 将容器的80端口映射到本机的80端口</p>\r\n\r\n<p>语句最后一个nginx是使用镜像的名称</p>\r\n\r\n<p>创建容器成功后,启动nginx容器</p>\r\n</blockquote>\r\n\r\n<p>访问 本机测试&nbsp; &nbsp;127.0.0.1:80</p>\r\n\r\n<p><img src=\"/media/upload/2019/09/29/image_TkMpAxA.png\" style=\"height:240px; width:800px\" />&nbsp;</p>\r\n\r\n<h1><strong>2.将nginx关键目录映射到本机</strong></h1>\r\n\r\n<p>首先在本机创建nginx的一些文件存储目录</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\"> mkdir -p /root/nginx/conf /root/nginx/logs</code></pre>\r\n\r\n<p><img src=\"/media/upload/2019/09/29/image_5forRF7.png\" style=\"height:150px; width:600px\" />&nbsp;</p>\r\n\r\n<p><strong>logs</strong>: nginx日志目录</p>\r\n\r\n<p><strong>conf</strong>: nginx配置文件目录</p>\r\n\r\n<h2>查看nginx_my容器id</h2>\r\n\r\n<pre>\r\n<code class=\"language-bash\">docker ps\r\n</code></pre>\r\n\r\n<p><img src=\"/media/upload/2019/09/29/image_J7bvB7J.png\" style=\"height:33px; width:800px\" />&nbsp;</p>\r\n\r\n<h2>将nginx-test容器配置文件copy到本地</h2>\r\n\r\n<pre>\r\n<code class=\"language-bash\">docker cp 4f54ae11387b:/etc/nginx/nginx.conf /root/nginx/conf</code></pre>\r\n\r\n<p><img src=\"/media/upload/2019/09/29/image_MwTDGSw.png\" style=\"height:99px; width:600px\" />&nbsp;</p>\r\n\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;</p>\r\n\r\n<h2>创建新nginx容器nginx-web并将<strong>logs,conf</strong>目录映射到本地</h2>\r\n\r\n<pre>\r\n<code class=\"language-bash\">docker run -d -p 8899:80 --name nginx_reverse  -v /root/nginx/conf/nginx.conf:/etc/nginx/nginx.conf -v /root/nginx/logs:/var/log/nginx  nginx </code></pre>\r\n\r\n<h1><strong>3.设置反向代理</strong></h1>\r\n\r\n<p>进入到/root/conf/nginx.conf 添加如下即可</p>\r\n\r\n<pre>\r\n<code class=\"language-nginx\">server{\r\n       listen 80;\r\n       charset utf-8;\r\n       server_name _;\r\n\r\n       location / {\r\n          proxy_pass http://192.168.1.128:15672;\r\n          proxy_redirect default;\r\n       }\r\n    }</code></pre>\r\n\r\n<p><img src=\"/media/upload/2019/09/29/image_y9vu1pC.png\" style=\"height:965px; width:800px\" /></p>\r\n\r\n<p>这样就可以用本机80端口代理本机15672端口了&nbsp;</p>\r\n\r\n<p>测试反向代理是否可用</p>\r\n\r\n<p>直接使用80访问端口</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h1><strong>4.踩过坑</strong></h1>\r\n\r\n<h2><strong>1.&nbsp;docker运行nginx为什么要使用 daemon off</strong><br />\r\n&nbsp;</h2>\r\n\r\n<blockquote>\r\n<p>Docker 容器启动时，默认会把容器内部第一个进程，也就是pid=1的程序，作为docker容器是否正在运行的依据，如果 docker 容器<u>pid=1</u>的进程挂了，那么docker容器便会直接退出。</p>\r\n\r\n<p>Docker未执行自定义的CMD之前，nginx的pid是1，执行到CMD之后，nginx就在后台运行，bash或sh脚本的pid变成了1。</p>\r\n\r\n<p>所以一旦执行完自定义CMD，nginx容器也就退出了。</p>\r\n</blockquote>\r\n\r\n<p><a href=\"https://hub.docker.com/_/nginx\">Nginx的docker仓库仔细查看说明，其实是有说明的.</a></p>\r\n\r\n<p><img src=\"/media/upload/2019/09/29/image_31WUO1c.png\" style=\"height:379px; width:800px\" /></p>\r\n\r\n<p>将nginx容器停止后修改配置文件出现nginx启动不起来解决方式:</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\"># 在命令后面添加 nginx-debug -g \'daemon off;\'\r\n\r\ndocker run -d -p 8899:80 --name nginx_reverse  -v /root/nginx/conf/nginx.conf:/etc/nginx/nginx.conf -v /root/nginx/logs:/var/log/nginx  nginx nginx-debug -g \'daemon off;\'</code></pre>\r\n\r\n<h2><strong>2. 修改配置文件后还是没有转发端口</strong></h2>\r\n\r\n<p>这个可能是修改nginx配置文件后没有重启nginx, 需要重启nginx, 也就是重启docker nginx容器就可以</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">docker restart nginx_my</code></pre>\r\n\r\n<p><br />\r\n&nbsp;</p>',
        '', '2019-09-29 09:39:00', '2019-09-29 09:39:00', 89, 1, 4, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (34, '实现机器远程跳转的两种自动化方式',
        '<p>现在实验室大部分的服务器是不允许直接ssh连接的，需要先连到一个跳转机，之后再通过这个跳转机去ssh连接服务器。如果是自动化连接，如下图所示：</p>\r\n\r\n<p><img alt=\"\" src=\"https://cdn.ch3nnn.cn/upload/2020/04/17/6f2eb07883a847caa7fe75933ee6a7e9.png\" style=\"height:138px; width:600px\" /></p>\r\n\r\n<p>手工操作的话无非就是两次输入ssh连接命令，如果是脚本自动连接的话该怎么做呢，本节针对shell脚本与python脚本两种自动化方式实现ssh远程跳转。</p>\r\n\r\n<h3>shell脚本:</h3>\r\n\r\n<p><code>ssh -i id_rsa -F bastion_ssh_config fsp@172.28.55.64</code><br />\r\n其中id_rsa为ssh连接的私钥文件（需要提前在目标主机与跳转机上置入公钥）。bastion_ssh_config为跳转配置文件，内容样例如下：</p>\r\n\r\n<pre>\r\n<code class=\"language-python\">ControlPersist 15m\r\nStrictHostKeyChecking no\r\nUserKnownHostsFile /dev/null\r\n#172.28.55.64为目标主机的IP，192.168.35.97为跳转机的IP\r\nHost 172.28.55.64\r\n    ProxyCommand ssh -i id_rsa test@192.168.35.97 -W %h:%p -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null\r\n</code></pre>\r\n\r\n<h3>python脚本：</h3>\r\n\r\n<p><code>python ssh_jumphost_connect.py</code><br />\r\n其中ssh_jumphost_connect.py文件的内容样例如下：</p>\r\n\r\n<pre>\r\n<code class=\"language-python\">import paramiko\r\nfrom sshtunnel import SSHTunnelForwarder\r\n#192.168.35.97为跳转机的IP，172.28.55.64为目标主机的IP，\r\nwith SSHTunnelForwarder((\'192.168.35.97\', 22), ssh_username=\'test\', ssh_password=\'Test@1234\', remote_bind_address=(\'172.28.55.64\', 22), local_bind_address=(\'0.0.0.0\', 10022)) as server:\r\n    client = paramiko.SSHClient()\r\n    client.load_system_host_keys()\r\n    client.set_missing_host_key_policy(paramiko.AutoAddPolicy())\r\n    client.connect(hostname=\'127.0.0.1\', port=10022, username=\'test\', password=\'Test@1234\')\r\n    stdin, stdout, stderr = client.exec_command(\'ls\')\r\n    print stdout.read()\r\n    client.close()\r\n</code></pre>\r\n\r\n<p>参考链接：<br />\r\n<a href=\"https://selivan.github.io/2018/01/29/ansible-ssh-bastion-host.html\" rel=\"nofollow\" target=\"_blank\">https://selivan.github.io/2018/01/29/ansible-ssh-bastion-host.html</a><br />\r\n<a href=\"https://pypi.org/project/sshtunnel/\" rel=\"nofollow\" target=\"_blank\">https://pypi.org/project/sshtunnel/</a></p>',
        '', '2019-10-11 08:41:00', '2019-10-11 08:41:00', 176, 1, 2, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (35, 'RabbitMq系列之一：介绍',
        '<p>RabbitMQ 是一个消息代理。它的核心原理非常简单：接收和发送消息。你可以把它想像成一个邮局：你把信件放入邮箱，邮递员就会把信件投递到你的收件人处。在这个比喻中，RabbitMQ 就扮演着邮箱、邮局以及邮递员的角色。</p>\r\n\r\n<p>RabbitMQ 和邮局的主要区别是，它不是用来处理纸张的，它是用来接收、存储和发送消息（message）这种二进制数据的。</p>\r\n\r\n<p>一般提到 RabbitMQ 和消息，都会用到一些专有名词。</p>\r\n\r\n<ul>\r\n	<li>生产(Producing)意思就是发送。发送消息的程序就是一个生产者(producer)。我们一般用 &quot;P&quot; 来表示:</li>\r\n</ul>\r\n\r\n<p><img alt=\"\" src=\"http://wiki.jikexueyuan.com/project/rabbitmq/images/1.png\" /></p>\r\n\r\n<ul>\r\n	<li>队列(queue)就是邮箱的名称。消息通过你的应用程序和 RabbitMQ 进行传输，它们能够只存储在一个队列（queue）中。 队列（queue）没有任何限制，你要存储多少消息都可以&mdash;&mdash;基本上是一个无限的缓冲。多个生产者（producers）能够把消息发送给同一个队列，同样，多个消费者（consumers）也能够从同一个队列（queue）中获取数据。队列可以绘制成这样（图上是队列的名称）：</li>\r\n</ul>\r\n\r\n<p><img alt=\"\" src=\"http://wiki.jikexueyuan.com/project/rabbitmq/images/2.png\" /></p>\r\n\r\n<ul>\r\n	<li>消费（Consuming）和获取消息是一样的意思。一个消费者（consumer）就是一个等待获取消息的程序。我们把它绘制为 &quot;C&quot;：</li>\r\n</ul>\r\n\r\n<p>需要指出的是生产者、消费者、代理需不要待在同一个设备上；事实上大多数应用也确实不在会将他们放在一台机器上。</p>\r\n\r\n<h2>Hello World!</h2>\r\n\r\n<p><strong>（使用pika 0.9.5 Python客户端）</strong></p>\r\n\r\n<p>我们的 &ldquo;Hello world&rdquo; 不会很复杂&mdash;&mdash;仅仅发送一个消息，然后获取它并输出到屏幕。这样以来我们需要两个程序，一个用作发送消息，另一个接受消息并打印消息内容</p>\r\n\r\n<p>我们的大致的设计是这样的：</p>\r\n\r\n<p><img alt=\"\" src=\"http://wiki.jikexueyuan.com/project/rabbitmq/images/3.png\" /></p>\r\n\r\n<p>生产者（producer）把消息发送到一个名为 &ldquo;hello&rdquo; 的队列中。消费者（consumer）从这个队列中获取消息。</p>\r\n\r\n<h2>RabbitMQ 库</h2>\r\n\r\n<p>RabbitMQ 使用的是 AMQP 协议。要使用她你就必须需要一个使用同样协议的库。几乎所有的编程语言都有可选择的库。python 也是一样，可以从以下几个库中选择：</p>\r\n\r\n<p><a href=\"http://barryp.org/software/py-amqplib/\" rel=\"nofollow\">py-amqplib</a><br />\r\n<a href=\"https://launchpad.net/txamqp\" rel=\"nofollow\">txAMQP</a><br />\r\n<a href=\"http://github.com/pika/pika\" rel=\"nofollow\">pika</a></p>\r\n\r\n<p>在这一系列教程中，我们打算使用 pika。要安装 pika，你可以使用 pip 这个包管理工具：</p>\r\n\r\n<pre>\r\n<code>$ sudo pip install pika==0.9.5  </code></pre>\r\n\r\n<p>安装过程依赖于 pip 和 git-core 两个包，你需要先安装它们。</p>\r\n\r\n<ul>\r\n	<li>Ubuntu平台<br />\r\n	$ sudo apt-get install python-pip git-core</li>\r\n	<li>Debian平台<br />\r\n	sudoapt&minus;getinstallpython&minus;setuptoolsgit&minus;core&nbsp;sudo easy_install pip</li>\r\n	<li>Windows平台 运行easy_install的安装程序setuptools即可，安装后运行以下命令\r\n	<blockquote>\r\n	<p>easy_install pip<br />\r\n	pip install pika==0.9.5</p>\r\n	</blockquote>\r\n	</li>\r\n</ul>\r\n\r\n<h2>发送消息</h2>\r\n\r\n<p><img alt=\"\" src=\"http://wiki.jikexueyuan.com/project/rabbitmq/images/5.png\" /></p>\r\n\r\n<p>我们第一个程序 send.py 会发送一个消息到队列中。首先要做的事情就是建立一个到 RabbitMQ 服务器的连接。</p>\r\n\r\n<pre>\r\n<code>\\#!/usr/bin/env python\r\nimport pika\r\n\r\nconnection = pika.BlockingConnection(pika.ConnectionParameters(\r\n               \'localhost\'))\r\nchannel = connection.channel()  </code></pre>\r\n\r\n<p>现在我们已经连接上服务器了，那么，在发送消息之前我们需要确认队列是存在的。如果我们把消息发送到一个不存在的队列，RabbitMQ 会丢弃这条消息。我门先创建一个名为 hello 的队列，然后把消息发送到这个队列中。</p>\r\n\r\n<pre>\r\n<code>channel.queue_declare(queue=\'hello\')  </code></pre>\r\n\r\n<p>这时候我们就可以发送消息了，我们第一条消息只包含了 Hello World! 字符串，我们打算把它发送到我们的 hello 队列。</p>\r\n\r\n<p>在 RabbitMQ 中，消息是不能直接发送到队列，它需要发送到交换机（exchange）中。我们不打算在这里深入讨论它&mdash;&mdash;你可以通过教程的第三部分了解更多。现在我们所需要了解的是如何使用默认的交换机（exchange），它使用一个空字符串来标识。交换机允许我们指定某条消息需要投递到哪个队列，routing_key 参数必须指定为队列的名称：</p>\r\n\r\n<pre>\r\n<code>channel.basic_publish(exchange=\'\',\r\n                      routing_key=\'hello\',\r\n                      body=\'Hello World!\')\r\nprint \" [x] Sent \'Hello World!\'\"  </code></pre>\r\n\r\n<p>在退出程序之前，我们需要确认网络缓冲已经被刷写、消息已经投递到 RabbitMQ。完成这些事情（正确的关闭连接）是很简单的。</p>\r\n\r\n<pre>\r\n<code>connection.close()  </code></pre>\r\n\r\n<p>发送不成功！</p>\r\n\r\n<p>如果这是你第一次使用 RabbitMQ，并且没有看到 &ldquo;Sent&rdquo; 消息出现在屏幕上，你可能会抓耳挠腮不知所以。这也许是因为没有足够的磁盘空间给代理使用所造成的（代理默认需要 1Gb 的空闲空间），所以它才会拒绝接收消息。查看一下代理的日志确定并且减少必要的限制。配置文件文档会告诉你如何更改磁盘空间限制（disk_free_limit）。</p>\r\n\r\n<h2>获取数据</h2>\r\n\r\n<p><img alt=\"\" src=\"http://wiki.jikexueyuan.com/project/rabbitmq/images/6.png\" /></p>\r\n\r\n<p>我们的第二个程序 receive.py，将会从队列中获取消息并打印消息。</p>\r\n\r\n<p>这次我们还是先要连接到 RabbitMQ 服务器。连接服务器的代码和之前是一样的。</p>\r\n\r\n<p>下一步也和之前一样，我们需要确认队列是存在的。使用 queue_declare 创建一个队列&mdash;&mdash;我们可以运行这个命令很多次，但是只有一个队列会被创建。</p>\r\n\r\n<pre>\r\n<code>channel.queue_declare(queue=\'hello\')  </code></pre>\r\n\r\n<p>你也许要问: 为什么要重复声明队列呢 &mdash;&mdash; 我们已经在前面的代码中声明过它了。如果我们确定了队列是已经存在的，那么我们可以不这么做，比如此前预先运行了send.py 程序。可是我们并不确定哪个程序会首先运行。这种情况下，在程序中重复将队列重复声明一下是种值得推荐的做法。</p>\r\n\r\n<h3>列出所有队列</h3>\r\n\r\n<p>你也许希望查看 RabbitMQ 中有哪些队列、有多少消息在队列中。此时你可以使用rabbitmqctl 工具（使用有权限的用户）：</p>\r\n\r\n<pre>\r\n<code>bash\r\n   $ sudo rabbitmqctl list_queues\r\n   Listing queues ...\r\n   hello    0\r\n   ...done.</code></pre>\r\n\r\n<p>（在 Windows 中不需要 sudo 命令）</p>\r\n\r\n<p>从队列中获取消息相对来说稍显复杂。需要为队列定义一个回调（callback）函数。当我们获取到消息的时候，Pika 库就会调用此回调函数。这个回调函数会将接收到的消息内容输出到屏幕上。</p>\r\n\r\n<pre>\r\n<code>def callback(ch, method, properties, body):\r\n    print \" [x] Received %r\" % (body,)  </code></pre>\r\n\r\n<p>下一步，我们需要告诉 RabbitMQ 这个回调函数将会从名为 &quot;hello&quot; 的队列中接收消息：</p>\r\n\r\n<pre>\r\n<code>channel.basic_consume(callback,\r\n                      queue=\'hello\',\r\n                      no_ack=True)  </code></pre>\r\n\r\n<p>要成功运行这些命令，我们必须保证队列是存在的，我们的确可以确保它的存在&mdash;&mdash;因为我们之前已经使用 queue_declare 将其声明过了。</p>\r\n\r\n<p>no_ack 参数稍后会进行介绍。</p>\r\n\r\n<p>最后，我们输入一个用来等待消息数据并且在需要的时候运行回调函数的无限循环。</p>\r\n\r\n<pre>\r\n<code>print \' [*] Waiting for messages. To exit press CTRL+C\'\r\nchannel.start_consuming()  </code></pre>\r\n\r\n<h2>整合</h2>\r\n\r\n<p>send.py 的全部代码：</p>\r\n\r\n<pre>\r\n<code>\\#!/usr/bin/env python\r\nimport pika\r\n\r\nconnection = pika.BlockingConnection(pika.ConnectionParameters(\r\n        host=\'localhost\'))\r\nchannel = connection.channel()\r\n\r\nchannel.queue_declare(queue=\'hello\')\r\n\r\nchannel.basic_publish(exchange=\'\',\r\n                      routing_key=\'hello\',\r\n                      body=\'Hello World!\')\r\nprint \" [x] Sent \'Hello World!\'\"\r\nconnection.close()  </code></pre>\r\n\r\n<p>(send.py 源码)</p>\r\n\r\n<p>receive.py的全部代码：</p>\r\n\r\n<pre>\r\n<code>\\#!/usr/bin/env python\r\nimport pika\r\n\r\nconnection = pika.BlockingConnection(pika.ConnectionParameters(\r\n        host=\'localhost\'))\r\nchannel = connection.channel()\r\n\r\nchannel.queue_declare(queue=\'hello\')\r\n\r\nprint \' [*] Waiting for messages. To exit press CTRL+C\'\r\n\r\ndef callback(ch, method, properties, body):\r\n    print \" [x] Received %r\" % (body,)\r\n\r\nchannel.basic_consume(callback,\r\n                      queue=\'hello\',\r\n                      no_ack=True)\r\n\r\nchannel.start_consuming()  </code></pre>\r\n\r\n<p>(receive.py source)</p>\r\n\r\n<p>现在就可以在终端中运行我们的程序了。首先，用 send.py 重续发送一条消息：</p>\r\n\r\n<pre>\r\n<code>$ python send.py\r\n[x] Sent \'Hello World!\' </code></pre>\r\n\r\n<p>生产者（producer）程序 send.py 每次运行之后就会停止。现在我们就来接收消息：</p>\r\n\r\n<pre>\r\n<code>$ python receive.py\r\n[*] Waiting for messages. To exit press CTRL+C\r\n[x] Received \'Hello World!\'  </code></pre>\r\n\r\n<p>成功了！我们已经通过 RabbitMQ 发送第一条消息。你也许已经注意到了，receive.py 程序并没有退出。它一直在准备获取消息，你可以通过 Ctrl-C 来中止它。</p>\r\n\r\n<p>试下在新的终端中再次运行 send.py。</p>',
        '', '2019-10-12 05:49:00', '2019-10-12 05:49:00', 87, 1, 9, 0, 0, 1);
INSERT INTO `tb_content`
VALUES (36, 'RabbitMq系列之二：工作队列',
        '<h1>工作队列</h1>\r\n\r\n<p><strong>（使用pika 0.9.5 Python客户端）</strong></p>\r\n\r\n<p><img alt=\"\" src=\"http://wiki.jikexueyuan.com/project/rabbitmq/images/7.png\" /></p>\r\n\r\n<p>在第一篇教程中，我们已经写了一个从已知队列中发送和获取消息的程序。在这篇教程中，我们将创建一个工作队列（Work Queue），它会发送一些耗时的任务给多个工作者（Worker）。</p>\r\n\r\n<p>工作队列（又称：任务队列&mdash;&mdash;Task Queues）是为了避免等待一些占用大量资源、时间的操作。当我们把任务（Task）当作消息发送到队列中，一个运行在后台的工作者（worker）进程就会取出任务然后处理。当你运行多个工作者（workers），任务就会在它们之间共享。</p>\r\n\r\n<p>这个概念在网络应用中是非常有用的，它可以在短暂的 HTTP 请求中处理一些复杂的任务。</p>\r\n\r\n<h2>准备</h2>\r\n\r\n<p>之前的教程中，我们发送了一个包含 &ldquo;Hello World!&rdquo; 的字符串消息。现在，我们将发送一些字符串，把这些字符串当作复杂的任务。我们没有真实的例子，例如图片缩放、pdf 文件转换。所以使用 time.sleep() 函数来模拟这种情况。我们在字符串中加上点号（.）来表示任务的复杂程度，一个点（.）将会耗时1秒钟。比如 &quot;Hello...&quot; 就会耗时3秒钟。</p>\r\n\r\n<p>我们对之前教程的 send.py 做些简单的调整，以便可以发送随意的消息。这个程序会按照计划发送任务到我们的工作队列中。我们把它命名为 new_task.py：</p>\r\n\r\n<pre>\r\n<code>import sys\r\n\r\nmessage = \' \'.join(sys.argv[1:]) or \"Hello World!\"\r\nchannel.basic_publish(exchange=\'\',\r\n                      routing_key=\'hello\',\r\n                      body=message)\r\nprint \" [x] Sent %r\" % (message,)  </code></pre>\r\n\r\n<p>我们的旧脚本（receive.py）同样需要做一些改动：它需要为消息体中每一个点号（.）模拟1秒钟的操作。它会从队列中获取消息并执行，我们把它命名为 worker.py：</p>\r\n\r\n<pre>\r\n<code>import time\r\n\r\ndef callback(ch, method, properties, body):\r\n    print \" [x] Received %r\" % (body,)\r\n    time.sleep( body.count(\'.\') )\r\n    print \" [x] Done\"  </code></pre>\r\n\r\n<h2>循环调度</h2>\r\n\r\n<p>使用工作队列的一个好处就是它能够并行的处理队列。如果堆积了很多任务，我们只需要添加更多的工作者（workers）就可以了，扩展很简单。</p>\r\n\r\n<p>首先，我们先同时运行两个 worker.py 脚本，它们都会从队列中获取消息，到底是不是这样呢？我们看看。</p>\r\n\r\n<p>你需要打开三个终端，两个用来运行 worker.py 脚本，这两个终端就是我们的两个消费者（consumers）&mdash;&mdash; C1 和 C2。</p>\r\n\r\n<pre>\r\n<code>shell1$ python worker.py\r\n [*] Waiting for messages. To exit press CTRL+C  </code></pre>\r\n\r\n<pre>\r\n<code>shell2$ python worker.py\r\n [*] Waiting for messages. To exit press CTRL+C  </code></pre>\r\n\r\n<p>第三个终端，我们用来发布新任务。你可以发送一些消息给消费者（consumers）：</p>\r\n\r\n<pre>\r\n<code>shell3$ python new_task.py First message.\r\nshell3$ python new_task.py Second message..\r\nshell3$ python new_task.py Third message...\r\nshell3$ python new_task.py Fourth message....\r\nshell3$ python new_task.py Fifth message.....  </code></pre>\r\n\r\n<p>看看到底发送了什么给我们的工作者（workers）：</p>\r\n\r\n<pre>\r\n<code>shell1$ python worker.py\r\n [*] Waiting for messages. To exit press CTRL+C\r\n [x] Received \'First message.\'\r\n [x] Received \'Third message...\'\r\n [x] Received \'Fifth message.....\'  </code></pre>\r\n\r\n<pre>\r\n<code>shell2$ python worker.py\r\n [*] Waiting for messages. To exit press CTRL+C\r\n [x] Received \'Second message..\'\r\n [x] Received \'Fourth message....\'  </code></pre>\r\n\r\n<p>默认来说，RabbitMQ 会按顺序得把消息发送给每个消费者（consumer）。平均每个消费者都会收到同等数量得消息。这种发送消息得方式叫做&mdash;&mdash;轮询（round-robin）。试着添加三个或更多得工作者（workers）。</p>\r\n\r\n<h2>消息确认</h2>\r\n\r\n<p>当处理一个比较耗时得任务的时候，你也许想知道消费者（consumers）是否运行到一半就挂掉。当前的代码中，当消息被 RabbitMQ 发送给消费者（consumers）之后，马上就会在内存中移除。这种情况，你只要把一个工作者（worker）停止，正在处理的消息就会丢失。同时，所有发送到这个工作者的还没有处理的消息都会丢失。</p>\r\n\r\n<p>我们不想丢失任何任务消息。如果一个工作者（worker）挂掉了，我们希望任务会重新发送给其他的工作者（worker）。</p>\r\n\r\n<p>为了防止消息丢失，RabbitMQ 提供了消息响应（acknowledgments）。消费者会通过一个 ack（响应），告诉 RabbitMQ 已经收到并处理了某条消息，然后RabbitMQ 就会释放并删除这条消息。</p>\r\n\r\n<p>如果消费者（consumer）挂掉了，没有发送响应，RabbitMQ 就会认为消息没有被完全处理，然后重新发送给其他消费者（consumer）。这样，及时工作者（workers）偶尔的挂掉，也不会丢失消息。</p>\r\n\r\n<p>消息是没有超时这个概念的；当工作者与它断开连的时候，RabbitMQ 会重新发送消息。这样在处理一个耗时非常长的消息任务的时候就不会出问题了。</p>\r\n\r\n<p>消息响应默认是开启的。之前的例子中我们可以使用 no_ack=True 标识把它关闭。是时候移除这个标识了，当工作者（worker）完成了任务，就发送一个响应。</p>\r\n\r\n<pre>\r\n<code>def callback(ch, method, properties, body):\r\n    print \" [x] Received %r\" % (body,)\r\n    time.sleep( body.count(\'.\') )\r\n    print \" [x] Done\"\r\n    ch.basic_ack(delivery_tag = method.delivery_tag)\r\n\r\nchannel.basic_consume(callback,\r\n                      queue=\'hello\')  </code></pre>\r\n\r\n<p>运行上面的代码，我们发现即使使用 CTRL+C 杀掉了一个工作者（worker）进程，消息也不会丢失。当工作者（worker）挂掉这后，所有没有响应的消息都会重新发送。</p>\r\n\r\n<h2>忘记确认</h2>\r\n\r\n<p>一个很容易犯的错误就是忘了 basic_ack，后果很严重。消息在你的程序退出之后就会重新发送，如果它不能够释放没响应的消息，RabbitMQ 就会占用越来越多的内存。</p>\r\n\r\n<p>为了排除这种错误，你可以使用 rabbitmqctl 命令，输出 messages_unacknowledged 字段：</p>\r\n\r\n<pre>\r\n<code>$ sudo rabbitmqctl list_queues name messages_ready messages_unacknowledged\r\nListing queues ...\r\nhello    0       0\r\n...done.</code></pre>\r\n\r\n<h2>消息持久化</h2>\r\n\r\n<p>如果你没有特意告诉 RabbitMQ，那么在它退出或者崩溃的时候，将会丢失所有队列和消息。为了确保信息不会丢失，有两个事情是需要注意的：我们必须把&ldquo;队列&rdquo;和&ldquo;消息&rdquo;设为持久化。</p>\r\n\r\n<p>首先，为了不让队列消失，需要把队列声明为持久化（durable）：</p>\r\n\r\n<pre>\r\n<code>channel.queue_declare(queue=\'hello\', durable=True)  </code></pre>\r\n\r\n<p>尽管这行代码本身是正确的，但是仍然不会正确运行。因为我们已经定义过一个叫hello 的非持久化队列。RabbitMq 不允许你使用不同的参数重新定义一个队列，它会返回一个错误。但我们现在使用一个快捷的解决方法&mdash;&mdash;用不同的名字，例如task_queue。</p>\r\n\r\n<pre>\r\n<code>channel.queue_declare(queue=\'task_queue\', durable=True)  </code></pre>\r\n\r\n<p>这个queue_declare必须在生产者（producer）和消费者（consumer）对应的代码中修改。</p>\r\n\r\n<p>这时候，我们就可以确保在 RabbitMq 重启之后 queue_declare 队列不会丢失。另外，我们需要把我们的消息也要设为持久化&mdash;&mdash;将 delivery_mode 的属性设为2。</p>\r\n\r\n<pre>\r\n<code>channel.basic_publish(exchange=\'\',\r\n                      routing_key=\"task_queue\",\r\n                      body=message,\r\n                      properties=pika.BasicProperties(\r\n                         delivery_mode = 2, # make message persistent\r\n                      ))  </code></pre>\r\n\r\n<h2>注意：消息持久化</h2>\r\n\r\n<p>将消息设为持久化并不能完全保证不会丢失。以上代码只是告诉了 RabbitMq 要把消息存到硬盘，但从 RabbitMq 收到消息到保存之间还是有一个很小的间隔时间。因为 RabbitMq 并不是所有的消息都使用 fsync(2) &mdash;&mdash;它有可能只是保存到缓存中，并不一定会写到硬盘中。并不能保证真正的持久化，但已经足够应付我们的简单工作队列。如果你一定要保证持久化，你需要改写你的代码来支持事务（transaction）。</p>\r\n\r\n<h2>公平调度</h2>\r\n\r\n<p>你应该已经发现，它仍旧没有按照我们期望的那样进行分发。比如有两个工作者（workers），处理奇数消息的比较繁忙，处理偶数消息的比较轻松。然而RabbitMQ 并不知道这些，它仍然一如既往的派发消息。</p>\r\n\r\n<p>这时因为 RabbitMQ 只管分发进入队列的消息，不会关心有多少消费者（consumer）没有作出响应。它盲目的把第 n-th 条消息发给第 n-th 个消费者。</p>\r\n\r\n<p><img alt=\"\" src=\"http://wiki.jikexueyuan.com/project/rabbitmq/images/8.png\" /></p>\r\n\r\n<p>我们可以使用 basic.qos 方法，并设置 prefetch_count=1。这样是告诉RabbitMQ，再同一时刻，不要发送超过1条消息给一个工作者（worker），直到它已经处理了上一条消息并且作出了响应。这样，RabbitMQ 就会把消息分发给下一个空闲的工作者（worker）。</p>\r\n\r\n<pre>\r\n<code>channel.basic_qos(prefetch_count=1)  </code></pre>\r\n\r\n<h2>关于队列大小</h2>\r\n\r\n<p>如果所有的工作者都处理繁忙状态，你的队列就会被填满。你需要留意这个问题，要么添加更多的工作者（workers），要么使用其他策略。</p>\r\n\r\n<h2>整合代码</h2>\r\n\r\n<p>new_task.py 的完整代码：</p>\r\n\r\n<pre>\r\n<code>\\#!/usr/bin/env python\r\nimport pika\r\nimport sys\r\n\r\nconnection = pika.BlockingConnection(pika.ConnectionParameters(\r\n        host=\'localhost\'))\r\nchannel = connection.channel()\r\n\r\nchannel.queue_declare(queue=\'task_queue\', durable=True)\r\n\r\nmessage = \' \'.join(sys.argv[1:]) or \"Hello World!\"\r\nchannel.basic_publish(exchange=\'\',\r\n                      routing_key=\'task_queue\',\r\n                      body=message,\r\n                      properties=pika.BasicProperties(\r\n                         delivery_mode = 2, # make message persistent\r\n                      ))\r\nprint \" [x] Sent %r\" % (message,)\r\nconnection.close()  </code></pre>\r\n\r\n<p>(new_task.py源码)</p>\r\n\r\n<p>我们的worker：</p>\r\n\r\n<pre>\r\n<code>\\#!/usr/bin/env python\r\nimport pika\r\nimport time\r\n\r\nconnection = pika.BlockingConnection(pika.ConnectionParameters(\r\n        host=\'localhost\'))\r\nchannel = connection.channel()\r\n\r\nchannel.queue_declare(queue=\'task_queue\', durable=True)\r\nprint \' [*] Waiting for messages. To exit press CTRL+C\'\r\n\r\ndef callback(ch, method, properties, body):\r\n    print \" [x] Received %r\" % (body,)\r\n    time.sleep( body.count(\'.\') )\r\n    print \" [x] Done\"\r\n    ch.basic_ack(delivery_tag = method.delivery_tag)\r\n\r\nchannel.basic_qos(prefetch_count=1)\r\nchannel.basic_consume(callback,\r\n                      queue=\'task_queue\')\r\n\r\nchannel.start_consuming()  </code></pre>\r\n\r\n<p>(worker.py source)</p>\r\n\r\n<p>使用消息响应和 prefetch_count 你就可以搭建起一个工作队列了。这些持久化的选项使得在 RabbitMQ 重启之后仍然能够恢复。</p>',
        '', '2019-10-12 05:51:00', '2019-10-12 05:52:00', 98, 1, 9, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (37, 'RabbitMq系列之三：发布/订阅',
        '<h1>发布／订阅</h1>\r\n\r\n<p><strong>（使用pika 0.9.5 Python客户端）</strong></p>\r\n\r\n<p>在上篇教程中，我们搭建了一个工作队列，每个任务只分发给一个工作者（worker）。在本篇教程中，我们要做的跟之前完全不一样 &mdash;&mdash; 分发一个消息给多个消费者（consumers）。这种模式被称为&ldquo;发布／订阅&rdquo;。</p>\r\n\r\n<p>为了描述这种模式，我们将会构建一个简单的日志系统。它包括两个程序&mdash;&mdash;第一个程序负责发送日志消息，第二个程序负责获取消息并输出内容。</p>\r\n\r\n<p>在我们的这个日志系统中，所有正在运行的接收方程序都会接受消息。我们用其中一个接收者（receiver）把日志写入硬盘中，另外一个接受者（receiver）把日志输出到屏幕上。</p>\r\n\r\n<p>最终，日志消息被广播给所有的接受者（receivers）。</p>\r\n\r\n<h2>交换机（Exchanges）</h2>\r\n\r\n<p>前面的教程中，我们发送消息到队列并从中取出消息。现在是时候介绍 RabbitMQ 中完整的消息模型了。</p>\r\n\r\n<p>让我们简单的概括一下之前的教程：</p>\r\n\r\n<ul>\r\n	<li>发布者（producer）是发布消息的应用程序。</li>\r\n	<li>队列（queue）用于消息存储的缓冲。</li>\r\n	<li>消费者（consumer）是接收消息的应用程序。</li>\r\n</ul>\r\n\r\n<p>RabbitMQ 消息模型的核心理念是：发布者（producer）不会直接发送任何消息给队列。事实上，发布者（producer）甚至不知道消息是否已经被投递到队列。</p>\r\n\r\n<p>发布者（producer）只需要把消息发送给一个交换机（exchange）。交换机非常简单，它一边从发布者方接收消息，一边把消息推送到队列。交换机必须知道如何处理它接收到的消息，是应该推送到指定的队列还是是多个队列，或者是直接忽略消息。这些规则是通过交换机类型（exchange type）来定义的。</p>\r\n\r\n<p><img alt=\"\" src=\"http://wiki.jikexueyuan.com/project/rabbitmq/images/9.png\" /></p>\r\n\r\n<p>有几个可供选择的交换机类型：直连交换机（direct）, 主题交换机（topic）, （头交换机）headers和 扇型交换机（fanout）。我们在这里主要说明最后一个 &mdash;&mdash; 扇型交换机（fanout）。先创建一个 fanout 类型的交换机，命名为 logs：</p>\r\n\r\n<pre>\r\n<code>channel.exchange_declare(exchange=\'logs\',\r\n                         type=\'fanout\')  </code></pre>\r\n\r\n<p>扇型交换机（fanout）很简单，你可能从名字上就能猜测出来，它把消息发送给它所知道的所有队列。这正是我们的日志系统所需要的。</p>\r\n\r\n<h2>交换器列表</h2>\r\n\r\n<p>rabbitmqctl 能够列出服务器上所有的交换器：</p>\r\n\r\n<pre>\r\n<code>$ sudo rabbitmqctl list_exchanges\r\nListing exchanges ...\r\nlogs      fanout\r\namq.direct      direct\r\namq.topic       topic\r\namq.fanout      fanout\r\namq.headers     headers\r\n...done. </code></pre>\r\n\r\n<p>这个列表中有一些叫做 amq.* 的交换器。这些都是默认创建的，不过这时候你还不需要使用他们。</p>\r\n\r\n<h2>匿名的交换器</h2>\r\n\r\n<p>前面的教程中我们对交换机一无所知，但仍然能够发送消息到队列中。因为我们使用了命名为空字符串 (&quot;&quot;) 默认的交换机。</p>\r\n\r\n<p>回想我们之前是如何发布一则消息：</p>\r\n\r\n<pre>\r\n<code>channel.basic_publish(exchange=\'\',\r\n                      routing_key=\'hello\',\r\n                      body=message)  </code></pre>\r\n\r\n<p>exchange 参数就是交换机的名称。空字符串代表默认或者匿名交换机：消息将会根据指定的 routing_key 分发到指定的队列。</p>\r\n\r\n<p>现在，我们就可以发送消息到一个具名交换机了：</p>\r\n\r\n<pre>\r\n<code>channel.basic_publish(exchange=\'logs\',\r\n                      routing_key=\'\',\r\n                      body=message) </code></pre>\r\n\r\n<h2>临时队列</h2>\r\n\r\n<p>你还记得之前我们使用的队列名吗（ hello 和 task_queue）？给一个队列命名是很重要的&mdash;&mdash;我们需要把工作者（workers）指向正确的队列。如果你打算在发布者（producers）和消费者（consumers）之间共享同队列的话，给队列命名是十分重要的。</p>\r\n\r\n<p>但是这并不适用于我们的日志系统。我们打算接收所有的日志消息，而不仅仅是一小部分。我们关心的是最新的消息而不是旧的。为了解决这个问题，我们需要做两件事情。</p>\r\n\r\n<p>首先，当我们连接上 RabbitMQ 的时候，我们需要一个全新的、空的队列。我们可以手动创建一个随机的队列名，或者让服务器为我们选择一个随机的队列名（推荐）。我们只需要在调用 queue_declare 方法的时候，不提供 queue 参数就可以了：</p>\r\n\r\n<pre>\r\n<code>result = channel.queue_declare()  </code></pre>\r\n\r\n<p>这时候我们可以通过 result.method.queue 获得已经生成的随机队列名。它可能是这样子的：amq.gen-U0srCoW8TsaXjNh73pnVAw==。</p>\r\n\r\n<p>第二步，当与消费者（consumer）断开连接的时候，这个队列应当被立即删除。exclusive 标识符即可达到此目的。</p>\r\n\r\n<pre>\r\n<code>result = channel.queue_declare(exclusive=True)  </code></pre>\r\n\r\n<h2>绑定（Bindings）</h2>\r\n\r\n<p><img alt=\"\" src=\"http://wiki.jikexueyuan.com/project/rabbitmq/images/10.png\" /></p>\r\n\r\n<p>我们已经创建了一个扇型交换机（fanout）和一个队列。现在我们需要告诉交换机如何发送消息给我们的队列。交换器和队列之间的联系我们称之为绑定（binding）。</p>\r\n\r\n<pre>\r\n<code>channel.queue_bind(exchange=\'logs\',\r\n                   queue=result.method.queue)  </code></pre>\r\n\r\n<p>现在，logs 交换机将会把消息添加到我们的队列中。</p>\r\n\r\n<h2>绑定（binding）列表</h2>\r\n\r\n<p>你可以使用 rabbitmqctl list_bindings 列出所有现存的绑定。</p>\r\n\r\n<h2>代码整合</h2>\r\n\r\n<p><img alt=\"\" src=\"http://wiki.jikexueyuan.com/project/rabbitmq/images/11.png\" /></p>\r\n\r\n<p>发布日志消息的程序看起来和之前的没有太大区别。最重要的改变就是我们把消息发送给 logs 交换机而不是匿名交换机。在发送的时候我们需要提供 routing_key参数，但是它的值会被扇型交换机（fanout exchange）忽略。以下是emit_log.py 脚本：</p>\r\n\r\n<pre>\r\n<code>\\#!/usr/bin/env python\r\nimport pika\r\nimport sys\r\n\r\nconnection = pika.BlockingConnection(pika.ConnectionParameters(\r\n        host=\'localhost\'))\r\nchannel = connection.channel()\r\n\r\nchannel.exchange_declare(exchange=\'logs\',\r\n                         type=\'fanout\')\r\n\r\nmessage = \' \'.join(sys.argv[1:]) or \"info: Hello World!\"\r\nchannel.basic_publish(exchange=\'logs\',\r\n                      routing_key=\'\',\r\n                      body=message)\r\nprint \" [x] Sent %r\" % (message,)\r\nconnection.close()  </code></pre>\r\n\r\n<p>(emit_log.py 源文件)</p>\r\n\r\n<p>正如你看到的那样，在连接成功之后，我们声明了一个交换器，这一个是很重要的，因为不允许发布消息到不存在的交换器。</p>\r\n\r\n<p>如果没有绑定队列到交换器，消息将会丢失。但这个没有所谓，如果没有消费者监听，那么消息就会被忽略。</p>\r\n\r\n<p>receive_logs.py 的代码：</p>\r\n\r\n<pre>\r\n<code>\\#!/usr/bin/env python\r\nimport pika\r\n\r\nconnection = pika.BlockingConnection(pika.ConnectionParameters(\r\n        host=\'localhost\'))\r\nchannel = connection.channel()\r\n\r\nchannel.exchange_declare(exchange=\'logs\',\r\n                         type=\'fanout\')\r\n\r\nresult = channel.queue_declare(exclusive=True)\r\nqueue_name = result.method.queue\r\n\r\nchannel.queue_bind(exchange=\'logs\',\r\n                   queue=queue_name)\r\n\r\nprint \' [*] Waiting for logs. To exit press CTRL+C\'\r\n\r\ndef callback(ch, method, properties, body):\r\n    print \" [x] %r\" % (body,)\r\n\r\nchannel.basic_consume(callback,\r\n                      queue=queue_name,\r\n                      no_ack=True)\r\n\r\nchannel.start_consuming()  </code></pre>\r\n\r\n<p>(receive_logs.py source)</p>\r\n\r\n<p>这样我们就完成了。如果你想把日志保存到文件中，只需要打开控制台输入：</p>\r\n\r\n<pre>\r\n<code>$ python receive_logs.py &gt; logs_from_rabbit.log  </code></pre>\r\n\r\n<p>如果你想在屏幕中查看日志，那么打开一个新的终端然后运行：</p>\r\n\r\n<pre>\r\n<code>$ python receive_logs.py  </code></pre>\r\n\r\n<p>当然还要发送日志：</p>\r\n\r\n<pre>\r\n<code>$ python emit_log.py  </code></pre>\r\n\r\n<p>使用 rabbitmqctl list_bindings 你可确认已经创建的队列绑定。你可以看到运行中的两个 receive_logs.py 程序：</p>\r\n\r\n<pre>\r\n<code>$ sudo rabbitmqctl list_bindings\r\nListing bindings ...\r\n ...\r\nlogs    amq.gen-TJWkez28YpImbWdRKMa8sg==                []\r\nlogs    amq.gen-x0kymA4yPzAT6BoC/YP+zw==                []\r\n...done.  </code></pre>\r\n\r\n<p>显示结果很直观：logs 交换器把数据发送给两个系统命名的队列。</p>',
        '', '2019-10-12 05:53:00', '2019-10-12 05:53:00', 141, 1, 9, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (38, 'RabbitMq系列之四：路由(Routing)',
        '<h1>路由(Routing)</h1>\r\n\r\n<p><strong>（使用pika 0.9.5 Python客户端）</strong></p>\r\n\r\n<p>在前面的教程中，我们实现了一个简单的日志系统。可以把日志消息广播给多个接收者。</p>\r\n\r\n<p>本篇教程中我们打算新增一个功能 &mdash;&mdash; 使得它能够只订阅消息的一个字集。例如，我们只需要把严重的错误日志信息写入日志文件（存储到磁盘），但同时仍然把所有的日志信息输出到控制台中</p>\r\n\r\n<h2>绑定（Bindings）</h2>\r\n\r\n<p>前面的例子，我们已经创建过绑定（bindings），代码如下：</p>\r\n\r\n<pre>\r\n<code>channel.queue_bind(exchange=exchange_name,\r\n                   queue=queue_name)  </code></pre>\r\n\r\n<p>绑定（binding）是指交换机（exchange）和队列（queue）的关系。可以简单理解为：这个队列（queue）对这个交换机（exchange）的消息感兴趣。</p>\r\n\r\n<p>绑定的时候可以带上一个额外的 routing_key 参数。为了避免与basic_publish的参数混淆，我们把它叫做绑定键（binding key）。以下是如何创建一个带绑定键的绑定。</p>\r\n\r\n<pre>\r\n<code>channel.queue_bind(exchange=exchange_name,\r\n                   queue=queue_name,\r\n                   routing_key=\'black\')  </code></pre>\r\n\r\n<p>绑定键的意义取决于交换机（exchange）的类型。我们之前使用过的扇型交换机（fanout exchanges）会忽略这个值。</p>\r\n\r\n<h2>直连交换机（Direct exchange）</h2>\r\n\r\n<p>我们的日志系统广播所有的消息给所有的消费者（consumers）。我们打算扩展它，使其基于日志的严重程度进行消息过滤。例如我们也许只是希望将比较严重的错误（error）日志写入磁盘，以免在警告（warning）或者信息（info）日志上浪费磁盘空间。</p>\r\n\r\n<p>我们使用的扇型交换机（fanout exchange）没有足够的灵活性 &mdash;&mdash; 它能做的仅仅是广播。</p>\r\n\r\n<p>我们将会使用直连交换机（direct exchange）来代替。路由的算法很简单 &mdash;&mdash; 交换机将会对绑定键（binding key）和路由键（routing key）进行精确匹配，从而确定消息该分发到哪个队列。</p>\r\n\r\n<p>下图能够很好的描述这个场景：</p>\r\n\r\n<p><img alt=\"\" src=\"http://wiki.jikexueyuan.com/project/rabbitmq/images/12.png\" /></p>\r\n\r\n<p>在这个场景中，我们可以看到直连交换机 X 和两个队列进行了绑定。第一个队列使用 orange 作为绑定键，第二个队列有两个绑定，一个使用 black 作为绑定键，另外一个使用 green。</p>\r\n\r\n<p>这样以来，当路由键为 orange 的消息发布到交换机，就会被路由到队列 Q1。路由键为 black 或者 green 的消息就会路由到 Q2。其他的所有消息都将会被丢弃。</p>\r\n\r\n<h2>多个绑定（Multiple bindings）</h2>\r\n\r\n<p><img alt=\"\" src=\"http://wiki.jikexueyuan.com/project/rabbitmq/images/13.png\" /></p>\r\n\r\n<p>多个队列使用相同的绑定键是合法的。这个例子中，我们可以添加一个 X 和 Q1 之间的绑定，使用 black 绑定键。这样一来，直连交换机就和扇型交换机的行为一样，会将消息广播到所有匹配的队列。带有 black 路由键的消息会同时发送到 Q1 和 Q2。</p>\r\n\r\n<h2>发送日志</h2>\r\n\r\n<p>我们将会发送消息到一个直连交换机，把日志级别作为路由键。这样接收日志的脚本就可以根据严重级别来选择它想要处理的日志。我们先看看发送日志。</p>\r\n\r\n<p>我们需要创建一个交换机（exchange）：</p>\r\n\r\n<pre>\r\n<code>channel.exchange_declare(exchange=\'direct_logs\',\r\n                         type=\'direct\')  </code></pre>\r\n\r\n<p>然后我们发送一则消息：</p>\r\n\r\n<pre>\r\n<code>channel.basic_publish(exchange=\'direct_logs\',\r\n                      routing_key=severity,\r\n                      body=message)  </code></pre>\r\n\r\n<p>我们先假设 &ldquo;severity&rdquo; 的值是 info、warning、error 中的一个。</p>\r\n\r\n<h2>订阅</h2>\r\n\r\n<p>处理接收消息的方式和之前差不多，只有一个例外，我们将会为我们感兴趣的每个严重级别分别创建一个新的绑定。</p>\r\n\r\n<pre>\r\n<code>result = channel.queue_declare(exclusive=True)\r\nqueue_name = result.method.queue\r\n\r\nfor severity in severities:\r\n    channel.queue_bind(exchange=\'direct_logs\',\r\n                       queue=queue_name,\r\n                       routing_key=severity)  </code></pre>\r\n\r\n<h2>代码整合</h2>\r\n\r\n<p><img alt=\"\" src=\"http://wiki.jikexueyuan.com/project/rabbitmq/images/14.png\" /></p>\r\n\r\n<p>emit_log_direct.py 的代码：</p>\r\n\r\n<pre>\r\n<code>\\#!/usr/bin/env python\r\nimport pika\r\nimport sys\r\n\r\nconnection = pika.BlockingConnection(pika.ConnectionParameters(\r\n        host=\'localhost\'))\r\nchannel = connection.channel()\r\n\r\nchannel.exchange_declare(exchange=\'direct_logs\',\r\n                         type=\'direct\')\r\n\r\nseverity = sys.argv[1] if len(sys.argv) &gt; 1 else \'info\'\r\nmessage = \' \'.join(sys.argv[2:]) or \'Hello World!\'\r\nchannel.basic_publish(exchange=\'direct_logs\',\r\n                      routing_key=severity,\r\n                      body=message)\r\nprint \" [x] Sent %r:%r\" % (severity, message)\r\nconnection.close()  </code></pre>\r\n\r\n<p>receive_logs_direct.py 的代码：</p>\r\n\r\n<pre>\r\n<code>\\#!/usr/bin/env python\r\nimport pika\r\nimport sys\r\n\r\nconnection = pika.BlockingConnection(pika.ConnectionParameters(\r\n        host=\'localhost\'))\r\nchannel = connection.channel()\r\n\r\nchannel.exchange_declare(exchange=\'direct_logs\',\r\n                         type=\'direct\')\r\n\r\nresult = channel.queue_declare(exclusive=True)\r\nqueue_name = result.method.queue\r\n\r\nseverities = sys.argv[1:]\r\nif not severities:\r\n    print &gt;&gt; sys.stderr, \"Usage: %s [info] [warning] [error]\" % \\\r\n                         (sys.argv[0],)\r\n    sys.exit(1)\r\n\r\nfor severity in severities:\r\n    channel.queue_bind(exchange=\'direct_logs\',\r\n                       queue=queue_name,\r\n                       routing_key=severity)\r\n\r\nprint \' [*] Waiting for logs. To exit press CTRL+C\'\r\n\r\ndef callback(ch, method, properties, body):\r\n    print \" [x] %r:%r\" % (method.routing_key, body,)\r\n\r\nchannel.basic_consume(callback,\r\n                      queue=queue_name,\r\n                      no_ack=True)\r\n\r\nchannel.start_consuming()  </code></pre>\r\n\r\n<p>如果你希望只是保存 warning 和 error 级别的日志到磁盘，只需要打开控制台并输入：</p>\r\n\r\n<pre>\r\n<code>$ python receive_logs_direct.py warning error &gt; logs_from_rabbit.log  </code></pre>\r\n\r\n<p>如果你希望所有的日志信息都输出到屏幕中，打开一个新的终端，然后输入：</p>\r\n\r\n<pre>\r\n<code>$ python receive_logs_direct.py info warning error\r\n [*] Waiting for logs. To exit press CTRL+C  </code></pre>\r\n\r\n<p>如果要触发一个 error 级别的日志，只需要输入：</p>\r\n\r\n<pre>\r\n<code>$ python emit_log_direct.py error \"Run. Run. Or it will explode.\"\r\n [x] Sent \'error\':\'Run. Run. Or it will explode.\'  </code></pre>\r\n\r\n<p>这里是完整的代码：(<a href=\"https://github.com/rabbitmq/rabbitmq-tutorials/blob/master/python/emit_log_direct.py\" rel=\"nofollow\">emit_log_direct.py</a>&nbsp;和&nbsp;<a href=\"https://github.com/rabbitmq/rabbitmq-tutorials/blob/master/python/receive_logs_direct.py\" rel=\"nofollow\">receive_logs_direct.py</a>)</p>',
        '', '2019-10-12 05:53:00', '2019-10-12 05:53:00', 92, 1, 9, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (39, 'RabbitMq系列--为什么需要主题交换机？',
        '<h1>为什么需要主题交换机？</h1>\r\n\r\n<p><strong>（使用Python 客户端 &mdash;&mdash; pika 0.9.8）</strong></p>\r\n\r\n<p>上一篇教程里，我们改进了我们的日志系统。我们使用直连交换机替代了扇型交换机，从只能盲目的广播消息改进为有可能选择性的接收日志。</p>\r\n\r\n<p>尽管直连交换机能够改善我们的系统，但是它也有它的限制 &mdash;&mdash; 没办法基于多个标准执行路由操作。</p>\r\n\r\n<p>在我们的日志系统中，我们不只希望订阅基于严重程度的日志，同时还希望订阅基于发送来源的日志。Unix 工具&nbsp;<a href=\"http://en.wikipedia.org/wiki/Syslog\" rel=\"nofollow\">syslog</a>&nbsp;就是同时基于严重程度 -severity (info/warn/crit...) 和 设备 -facility (auth/cron/kern...) 来路由日志的。</p>\r\n\r\n<p>如果这样的话，将会给予我们非常大的灵活性，我们既可以监听来源于 &ldquo;cron&rdquo; 的严重程度为 &ldquo;critical errors&rdquo; 的日志，也可以监听来源于 &ldquo;kern&rdquo; 的所有日志。</p>\r\n\r\n<p>为了实现这个目的，接下来我们学习如何使用另一种更复杂的交换机 &mdash;&mdash; 主题交换机。</p>\r\n\r\n<h2>主题交换机</h2>\r\n\r\n<p>发送到主题交换机（topic exchange）的消息不可以携带随意什么样子的路由键（routing_key），它的路由键必须是一个由.分隔开的词语列表。这些单词随便是什么都可以，但是最好是跟携带它们的消息有关系的词汇。以下是几个推荐的例子：&quot;stock.usd.nyse&quot;, &quot;nyse.vmw&quot;, &quot;quick.orange.rabbit&quot;。词语的个数可以随意，但是不要超过 255 字节。</p>\r\n\r\n<p>绑定键也必须拥有同样的格式。主题交换机背后的逻辑跟直连交换机很相似 &mdash;&mdash; 一个携带着特定路由键的消息会被主题交换机投递给绑定键与之想匹配的队列。但是它的绑定键和路由键有两个特殊应用方式：</p>\r\n\r\n<ul>\r\n	<li>\r\n	<ul>\r\n		<li>(星号) 用来表示一个单词.</li>\r\n	</ul>\r\n	</li>\r\n	<li>\r\n	<h1>(井号) 用来表示任意数量（零个或多个）单词。</h1>\r\n	</li>\r\n</ul>\r\n\r\n<p>下边用图说明：</p>\r\n\r\n<p><img alt=\"\" src=\"http://wiki.jikexueyuan.com/project/rabbitmq/images/15.png\" /></p>\r\n\r\n<p>这个例子里，我们发送的所有消息都是用来描述小动物的。发送的消息所携带的路由键是由三个单词所组成的，这三个单词被两个.分割开。路由键里的第一个单词描述的是动物的手脚的利索程度，第二个单词是动物的颜色，第三个是动物的种类。所以它看起来是这样的：&nbsp;..。</p>\r\n\r\n<p>我们创建了三个绑定：Q1 的绑定键为&nbsp;<em>.orange.</em>，Q2 的绑定键为&nbsp;<em>.</em>.rabbit 和 lazy.# 。</p>\r\n\r\n<p>这三个绑定键被可以总结为：</p>\r\n\r\n<ul>\r\n	<li>Q1 对所有的桔黄色动物都感兴趣。</li>\r\n	<li>Q2 则是对所有的兔子和所有懒惰的动物感兴趣。</li>\r\n</ul>\r\n\r\n<p>一个携带有 quick.orange.rabbit 的消息将会被分别投递给这两个队列。携带着 lazy.orange.elephant 的消息同样也会给两个队列都投递过去。另一方面携带有 quick.orange.fox 的消息会投递给第一个队列，携带有 lazy.brown.fox 的消息会投递给第二个队列。携带有 lazy.pink.rabbit 的消息只会被投递给第二个队列一次，即使它同时匹配第二个队列的两个绑定。携带着 quick.brown.fox 的消息不会投递给任何一个队列。</p>\r\n\r\n<p>如果我们违反约定，发送了一个携带有一个单词或者四个单词（&quot;orange&quot; or &quot;quick.orange.male.rabbit&quot;）的消息时，发送的消息不会投递给任何一个队列，而且会丢失掉。</p>\r\n\r\n<p>但是另一方面，即使 &quot;lazy.orange.male.rabbit&quot; 有四个单词，他还是会匹配最后一个绑定，并且被投递到第二个队列中。</p>\r\n\r\n<h2>主题交换机</h2>\r\n\r\n<p>主题交换机是很强大的，它可以表现出跟其他交换机类似的行为</p>\r\n\r\n<p>当一个队列的绑定键为 &quot;#&quot;（井号） 的时候，这个队列将会无视消息的路由键，接收所有的消息。</p>\r\n\r\n<p>当 * (星号) 和 # (井号) 这两个特殊字符都未在绑定键中出现的时候，此时主题交换机就拥有的直连交换机的行为。</p>\r\n\r\n<h2>组合在一起</h2>\r\n\r\n<p>接下来我们会将主题交换机应用到我们的日志系统中。在开始工作前，我们假设日志的路由键由两个单词组成，路由键看起来是这样的：.</p>\r\n\r\n<p>代码跟<a href=\"http://rabbitmq.mr-ping.com/zh_CN/latest/tutorials_with_python/[5]Topics/\" rel=\"nofollow\">上一篇教程差</a>不多。</p>\r\n\r\n<p>emit_log_topic.py 的代码：</p>\r\n\r\n<pre>\r\n<code>\\#!/usr/bin/env python\r\nimport pika\r\nimport sys\r\n\r\nconnection = pika.BlockingConnection(pika.ConnectionParameters(\r\n        host=\'localhost\'))\r\nchannel = connection.channel()\r\n\r\nchannel.exchange_declare(exchange=\'topic_logs\',\r\n                         type=\'topic\')\r\n\r\nrouting_key = sys.argv[1] if len(sys.argv) &gt; 1 else \'anonymous.info\'\r\nmessage = \' \'.join(sys.argv[2:]) or \'Hello World!\'\r\nchannel.basic_publish(exchange=\'topic_logs\',\r\n                      routing_key=routing_key,\r\n                      body=message)\r\nprint \" [x] Sent %r:%r\" % (routing_key, message)\r\nconnection.close()  </code></pre>\r\n\r\n<p>receive_logs_topic.py 的代码：</p>\r\n\r\n<pre>\r\n<code>\\#!/usr/bin/env python\r\nimport pika\r\nimport sys\r\n\r\nconnection = pika.BlockingConnection(pika.ConnectionParameters(\r\n        host=\'localhost\'))\r\nchannel = connection.channel()\r\n\r\nchannel.exchange_declare(exchange=\'topic_logs\',\r\n                         type=\'topic\')\r\n\r\nresult = channel.queue_declare(exclusive=True)\r\nqueue_name = result.method.queue\r\n\r\nbinding_keys = sys.argv[1:]\r\nif not binding_keys:\r\n    print &gt;&gt; sys.stderr, \"Usage: %s [binding_key]...\" % (sys.argv[0],)\r\n    sys.exit(1)\r\n\r\nfor binding_key in binding_keys:\r\n    channel.queue_bind(exchange=\'topic_logs\',\r\n                       queue=queue_name,\r\n                       routing_key=binding_key)\r\n\r\nprint \' [*] Waiting for logs. To exit press CTRL+C\'\r\n\r\ndef callback(ch, method, properties, body):\r\n    print \" [x] %r:%r\" % (method.routing_key, body,)\r\n\r\nchannel.basic_consume(callback,\r\n                      queue=queue_name,\r\n                      no_ack=True)\r\n\r\nchannel.start_consuming()  </code></pre>\r\n\r\n<p>执行下边命令 接收所有日志：</p>\r\n\r\n<pre>\r\n<code>python receive_logs_topic.py \"#\"</code></pre>\r\n\r\n<p>执行下边命令 接收来自 &rdquo;kern&ldquo; 设备的日志：</p>\r\n\r\n<pre>\r\n<code>python receive_logs_topic.py \"kern.*\"</code></pre>\r\n\r\n<p>执行下边命令 只接收严重程度为 &rdquo;critical&ldquo; 的日志：</p>\r\n\r\n<pre>\r\n<code>python receive_logs_topic.py \"*.critical\"</code></pre>\r\n\r\n<p>执行下边命令 建立多个绑定：</p>\r\n\r\n<pre>\r\n<code>python receive_logs_topic.py \"kern.*\" \"*.critical\"</code></pre>\r\n\r\n<p>执行下边命令 发送路由键为 &quot;kern.critical&quot; 的日志：</p>\r\n\r\n<pre>\r\n<code>python emit_log_topic.py \"kern.critical\" \"A critical kernel error\"  </code></pre>\r\n\r\n<p>执行上边命令试试看效果吧。另外，上边代码不会对路由键和绑定键做任何假设，所以你可以在命令中使用超过两个路由键参数。</p>\r\n\r\n<h2>如果你现在还没被搞晕，想想下边问题:</h2>\r\n\r\n<ul>\r\n	<li>绑定键为 * 的队列会取到一个路由键为空的消息吗？</li>\r\n	<li>绑定键为 #.* 的队列会获取到一个名为..的路由键的消息吗？它会取到一个路由键为单个单词的消息吗？</li>\r\n	<li>a.*.# 和 a.#的区别在哪儿？</li>\r\n</ul>\r\n\r\n<p>（完整代码参见&nbsp;<a href=\"https://github.com/rabbitmq/rabbitmq-tutorials/blob/master/python/emit_log_topic.py\" rel=\"nofollow\">emit_logs_topic.py</a>&nbsp;and&nbsp;<a href=\"https://github.com/rabbitmq/rabbitmq-tutorials/blob/master/python/receive_logs_topic.py\" rel=\"nofollow\">receive_logs_topic.py</a>)</p>',
        '', '2019-10-12 05:54:00', '2019-10-12 05:54:00', 116, 1, 9, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (40, 'RabbitMq系列之五：远程过程调用（RPC）',
        '<h1>远程过程调用（RPC）</h1>\r\n\r\n<p><strong>（Python客户端 &mdash;&mdash; 使用 pika 0.9.8）</strong></p>\r\n\r\n<p>在第二篇教程中我们介绍了如何使用工作队列（work queue）在多个工作者（woker）中间分发耗时的任务。</p>\r\n\r\n<p>可是如果我们需要将一个函数运行在远程计算机上并且等待从那儿获取结果时，该怎么办呢？这就是另外的故事了。这种模式通常被称为远程过程调用（Remote Procedure Call）或者 RPC。</p>\r\n\r\n<p>这篇教程中，我们会使用 RabbitMQ 来构建一个 RPC 系统：包含一个客户端和一个 RPC 服务器。现在的情况是，我们没有一个值得被分发的足够耗时的任务，所以接下来，我们会创建一个模拟RPC服务来返回斐波那契数列。</p>\r\n\r\n<h2>客户端接口</h2>\r\n\r\n<p>为了展示 RPC 服务如何使用，我们创建了一个简单的客户端类。它会暴露出一个名为 &ldquo;call&rdquo; 的方法用来发送一个 RPC 请求，并且在收到回应前保持阻塞。</p>\r\n\r\n<pre>\r\n<code>fibonacci_rpc = FibonacciRpcClient()\r\nresult = fibonacci_rpc.call(4)\r\nprint \"fib(4) is %r\" % (result,)  </code></pre>\r\n\r\n<h3>关于 RPC 的注意事项</h3>\r\n\r\n<p>尽管 RPC 在计算领域是一个常用模式，但它也经常被诟病。当一个问题被抛出的时候，程序员往往意识不到这到底是由本地调用还是由较慢的 RPC 调用引起的。同样的困惑还来自于系统的不可预测性和给调试工作带来的不必要的复杂性。跟软件精简不同的是，滥用 RPC 会导致不可维护的<a href=\"http://zh.wikipedia.org/wiki/%E9%9D%A2%E6%9D%A1%E5%BC%8F%E4%BB%A3%E7%A0%81\" rel=\"nofollow\">面条代码</a>.</p>\r\n\r\n<p>考虑到这一点，牢记以下建议：</p>\r\n\r\n<p>确保能够明确的搞清楚哪个函数是本地调用的，哪个函数是远程调用的。给你的系统编写文档。保持各个组件间的依赖明确。处理错误案例。明了客户端改如何处理 RPC 服务器的宕机和长时间无响应情况。</p>\r\n\r\n<p>当对避免使用 RPC 有疑问的时候。如果可以的话，你应该尽量使用异步管道来代替RPC 类的阻塞。结果被异步地推送到下一个计算场景。</p>\r\n\r\n<h2>回调队列</h2>\r\n\r\n<p>一般来说通过 RabbitMQ 来实现 RPC 是很容易的。一个客户端发送请求信息，服务器端将其应用到一个回复信息中。为了接收到回复信息，客户端需要在发送请求的时候同时发送一个回调队列（callback queue）的地址。我们试试看：</p>\r\n\r\n<pre>\r\n<code>result = channel.queue_declare(exclusive=True)\r\ncallback_queue = result.method.queue\r\n\r\nchannel.basic_publish(exchange=\'\',\r\n                      routing_key=\'rpc_queue\',\r\n                      properties=pika.BasicProperties(\r\n                            reply_to = callback_queue,\r\n                            ),\r\n                      body=request)\r\n\r\n# ... and some code to read a response message from the callback_queue ...  </code></pre>\r\n\r\n<h3>消息属性</h3>\r\n\r\n<p>AMQP 协议给消息预定义了一系列的14个属性。大多数属性很少会用到，除了以下几个：</p>\r\n\r\n<ul>\r\n	<li>delivery_mode（投递模式）：将消息标记为持久的（值为2）或暂存的（除了2之外的其他任何值）。第二篇教程里接触过这个属性，记得吧？</li>\r\n	<li>content_type（内容类型）:用来描述编码的 mime-type。例如在实际使用中常常使用 application/json 来描述 JOSN 编码类型。</li>\r\n	<li>reply_to（回复目标）：通常用来命名回调队列。</li>\r\n	<li>correlation_id（关联标识）：用来将RPC的响应和请求关联起来。</li>\r\n</ul>\r\n\r\n<h2>关联标识</h2>\r\n\r\n<p>上边介绍的方法中，我们建议给每一个 RPC 请求新建一个回调队列。这不是一个高效的做法，幸好这儿有一个更好的办法 &mdash;&mdash; 我们可以为每个客户端只建立一个独立的回调队列。</p>\r\n\r\n<p>这就带来一个新问题，当此队列接收到一个响应的时候它无法辨别出这个响应是属于哪个请求的。correlation_id 就是为了解决这个问题而来的。我们给每个请求设置一个独一无二的值。稍后，当我们从回调队列中接收到一个消息的时候，我们就可以查看这条属性从而将响应和请求匹配起来。如果我们接手到的消息的correlation_id 是未知的，那就直接销毁掉它，因为它不属于我们的任何一条请求。</p>\r\n\r\n<p>你也许会问，为什么我们接收到未知消息的时候不抛出一个错误，而是要将它忽略掉？这是为了解决服务器端有可能发生的竞争情况。尽管可能性不大，但RPC服务器还是有可能在已将应答发送给我们但还未将确认消息发送给请求的情况下死掉。如果这种情况发生，RPC 在重启后会重新处理请求。这就是为什么我们必须在客户端优雅的处理重复响应，同时RPC也需要尽可能保持幂等性。</p>\r\n\r\n<h2>总结</h2>\r\n\r\n<p><img alt=\"\" src=\"http://wiki.jikexueyuan.com/project/rabbitmq/images/16.png\" /></p>\r\n\r\n<p>我们的 RPC 如此工作:</p>\r\n\r\n<ul>\r\n	<li>当客户端启动的时候，它创建一个匿名独享的回调队列。</li>\r\n	<li>在 RPC 请求中，客户端发送带有两个属性的消息：一个是设置回调队列的 reply_to 属性，另一个是设置唯一值的 correlation_id 属性。</li>\r\n	<li>将请求发送到一个 rpc_queue 队列中。</li>\r\n	<li>RPC 工作者（又名：服务器）等待请求发送到这个队列中来。当请求出现的时候，它执行他的工作并且将带有执行结果的消息发送给 reply_to 字段指定的队列。</li>\r\n	<li>客户端等待回调队列里的数据。当有消息出现的时候，它会检查 correlation_id 属性。如果此属性的值与请求匹配，将它返回给应用。 整合到一起</li>\r\n</ul>\r\n\r\n<p>rpc_server.py代码：</p>\r\n\r\n<pre>\r\n<code>\\#!/usr/bin/env python\r\nimport pika\r\n\r\nconnection = pika.BlockingConnection(pika.ConnectionParameters(\r\n        host=\'localhost\'))\r\n\r\nchannel = connection.channel()\r\n\r\nchannel.queue_declare(queue=\'rpc_queue\')\r\n\r\ndef fib(n):\r\n    if n == 0:\r\n        return 0\r\n    elif n == 1:\r\n        return 1\r\n    else:\r\n        return fib(n-1) + fib(n-2)\r\n\r\ndef on_request(ch, method, props, body):\r\n    n = int(body)\r\n\r\n    print \" [.] fib(%s)\"  % (n,)\r\n    response = fib(n)\r\n\r\n    ch.basic_publish(exchange=\'\',\r\n                     routing_key=props.reply_to,\r\n                     properties=pika.BasicProperties(correlation_id = \\\r\n                                                     props.correlation_id),\r\n                     body=str(response))\r\n    ch.basic_ack(delivery_tag = method.delivery_tag)\r\n\r\nchannel.basic_qos(prefetch_count=1)\r\nchannel.basic_consume(on_request, queue=\'rpc_queue\')\r\n\r\nprint \" [x] Awaiting RPC requests\"\r\nchannel.start_consuming()   </code></pre>\r\n\r\n<p>服务器端代码相当简单：</p>\r\n\r\n<ul>\r\n	<li>（4）像往常一样，我们建立连接，声明队列</li>\r\n	<li>（11）我们声明我们的 fibonacci 函数，它假设只有合法的正整数当作输入。（别指望这个函数能处理很大的数值，函数递归你们都懂得...）</li>\r\n	<li>（19）我们为 basic_consume 声明了一个回调函数，这是 RPC 服务器端的核心。它执行实际的操作并且作出响应。</li>\r\n	<li>（32）或许我们希望能在服务器上多开几个线程。为了能将负载平均地分摊到多个服务器，我们需要将 prefetch_count 设置好。 rpc_client.py 代码:</li>\r\n</ul>\r\n\r\n<pre>\r\n<code>\\#!/usr/bin/env python\r\nimport pika\r\nimport uuid\r\n\r\nclass FibonacciRpcClient(object):\r\n    def __init__(self):\r\n        self.connection = pika.BlockingConnection(pika.ConnectionParameters(\r\n                host=\'localhost\'))\r\n\r\n        self.channel = self.connection.channel()\r\n\r\n        result = self.channel.queue_declare(exclusive=True)\r\n        self.callback_queue = result.method.queue\r\n\r\n        self.channel.basic_consume(self.on_response, no_ack=True,\r\n                                   queue=self.callback_queue)\r\n\r\n    def on_response(self, ch, method, props, body):\r\n        if self.corr_id == props.correlation_id:\r\n            self.response = body\r\n\r\n    def call(self, n):\r\n        self.response = None\r\n        self.corr_id = str(uuid.uuid4())\r\n        self.channel.basic_publish(exchange=\'\',\r\n                                   routing_key=\'rpc_queue\',\r\n                                   properties=pika.BasicProperties(\r\n                                         reply_to = self.callback_queue,\r\n                                         correlation_id = self.corr_id,\r\n                                         ),\r\n                                   body=str(n))\r\n        while self.response is None:\r\n            self.connection.process_data_events()\r\n        return int(self.response)\r\n\r\nfibonacci_rpc = FibonacciRpcClient()\r\n\r\nprint \" [x] Requesting fib(30)\"\r\nresponse = fibonacci_rpc.call(30)\r\nprint \" [.] Got %r\" % (response,)  </code></pre>\r\n\r\n<p>客户端代码稍微有点难懂：</p>\r\n\r\n<ul>\r\n	<li>（7）建立连接、通道并且为回复（replies）声明独享的回调队列。</li>\r\n	<li>（16）我们订阅这个回调队列，以便接收 RPC 的响应。</li>\r\n	<li>（18）&ldquo;on_response&rdquo; 回调函数对每一个响应执行一个非常简单的操作，检查每一个响应消息的 correlation_id 属性是否与我们期待的一致，如果一致，将响应结果赋给 self.response，然后跳出 consuming 循环。</li>\r\n	<li>（23）接下来，我们定义我们的主要方法 call 方法。它执行真正的 RPC 请求。</li>\r\n	<li>（24）在这个方法中，首先我们生成一个唯一的 correlation_id 值并且保存起来，&#39;on_response&#39; 回调函数会用它来获取符合要求的响应。</li>\r\n	<li>（25）接下来，我们将带有 reply_to 和 correlation_id 属性的消息发布出去。</li>\r\n	<li>（32）现在我们可以坐下来，等待正确的响应到来。</li>\r\n	<li>（33）最后，我们将响应返回给用户。</li>\r\n</ul>\r\n\r\n<p>我们的 RPC 服务已经准备就绪了，现在启动服务器端：</p>\r\n\r\n<pre>\r\n<code>$ python rpc_server.py\r\n [x] Awaiting RPC requests  </code></pre>\r\n\r\n<p>运行客户端，请求一个fibonacci队列。</p>\r\n\r\n<pre>\r\n<code>$ python rpc_client.py\r\n [x] Requesting fib(30)  </code></pre>\r\n\r\n<p>此处呈现的设计并不是实现 RPC 服务的唯一方式，但是他有一些重要的优势：</p>\r\n\r\n<ul>\r\n	<li>如果 RPC 服务器运行的过慢的时候，你可以通过运行另外一个服务器端轻松扩展它。试试在控制台中运行第二个 rpc_server.py 。</li>\r\n	<li>在客户端，RPC 请求只发送或接收一条消息。不需要像 queue_declare 这样的异步调用。所以RPC客户端的单个请求只需要一个网络往返。</li>\r\n</ul>\r\n\r\n<p>我们的代码依旧非常简单，而且没有试图去解决一些复杂（但是重要）的问题，如：</p>\r\n\r\n<ul>\r\n	<li>当没有服务器运行时，客户端如何作出反映。</li>\r\n	<li>客户端是否需要实现类似RPC超时的东西。</li>\r\n	<li>如果服务器发生故障，并且抛出异常，应该被转发到客户端吗？</li>\r\n	<li>在处理前，防止混入无效的信息（例如检查边界）</li>\r\n</ul>\r\n\r\n<p>如果你想做一些实验，你会发现&nbsp;<a href=\"http://www.rabbitmq.com/plugins.html\" rel=\"nofollow\">rabbitmq-management plugin</a>&nbsp;在观测队列方面是很有用处的。</p>\r\n\r\n<p>（完整的&nbsp;<a href=\"https://github.com/rabbitmq/rabbitmq-tutorials/blob/master/python/rpc_client.py\" rel=\"nofollow\">rpc_client.py</a>&nbsp;和&nbsp;<a href=\"https://github.com/rabbitmq/rabbitmq-tutorials/blob/master/python/rpc_server.py\" rel=\"nofollow\">rpc_server.py</a>&nbsp;代码)</p>',
        '', '2019-10-12 05:55:00', '2019-10-12 05:55:00', 120, 1, 9, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (41, '数据库SELECT COUNT语句',
        '<p>关于数据库中行数统计，无论是MySQL还是Oracle，都有一个函数可以使用，那就是COUNT</p>\r\n\r\n<p>尝尝问道以下问题</p>\r\n\r\n<blockquote>\r\n<p>1、COUNT有几种用法？</p>\r\n\r\n<p>2、COUNT(字段名)和COUNT(*)的查询结果有什么不同？</p>\r\n\r\n<p>3、COUNT(1)和COUNT(*)之间有什么不同？</p>\r\n\r\n<p>4、COUNT(1)和COUNT(*)之间的效率哪个更高？</p>\r\n\r\n<p>5、为什么《阿里巴巴Java开发手册》建议使用COUNT(*)</p>\r\n\r\n<p>6、MySQL的MyISAM引擎对COUNT(*)做了哪些优化？</p>\r\n\r\n<p>7、MySQL的InnoDB引擎对COUNT(*)做了哪些优化？</p>\r\n\r\n<p>8、上面提到的MySQL对COUNT(*)做的优化，有一个关键的前提是什么？</p>\r\n\r\n<p>9、SELECT COUNT(*) 的时候，加不加where条件有差别吗？</p>\r\n\r\n<p>10、COUNT(*)、COUNT(1)和COUNT(字段名)的执行过程是怎样的？</p>\r\n</blockquote>\r\n\r\n<h3>认识COUNT</h3>\r\n\r\n<p>关于COUNT函数，在MySQL官网中有详细介绍：</p>\r\n\r\n<p><img alt=\"\" class=\"has\" data-widget=\"image\" src=\"https://img-blog.csdnimg.cn/20191105095647739.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:225px; width:800px\" /></p>\r\n\r\n<blockquote>\r\n<p>简单翻译一下：</p>\r\n\r\n<p>1、COUNT(expr) ，返回SELECT语句检索的行中expr的值不为NULL的数量。结果是一个BIGINT值。</p>\r\n\r\n<p>2、如果查询结果没有命中任何记录，则返回0</p>\r\n\r\n<p>3、但是，值得注意的是，<code>COUNT(*)</code>&nbsp;的统计结果中，会包含值为NULL的行数。</p>\r\n</blockquote>\r\n\r\n<p>&nbsp;总结一点: 就是COUNT(*)会统计包含NULL行的数据, 而COUNT(列名)不会统计包含NULL行的数据</p>\r\n\r\n<h3>COUNT(*)和COUNT(1)</h3>\r\n\r\n<p><br />\r\n介绍完了COUNT(*)，接下来看看COUNT(1)，对于，这二者到底有没有区别，网上的说法众说纷纭。</p>\r\n\r\n<p>有的说COUNT(*)执行时会转换成COUNT(1)，所以COUNT(1)少了转换步骤，所以更快。</p>\r\n\r\n<p>还有的说，因为MySQL针对COUNT(*)做了特殊优化，所以COUNT(*)更快。</p>\r\n\r\n<p>那么，到底哪种说法是对的呢？看下MySQL官方文档是怎么说的：</p>\r\n\r\n<blockquote>\r\n<p>InnoDB handles SELECT COUNT(*) and SELECT COUNT(1) operations in the same way. There is no performance difference.</p>\r\n</blockquote>\r\n\r\n<p>画重点：same way , no performance difference。意思说 同样的方法，没有性能差异。所以，对于COUNT(1)和COUNT(*)，MySQL的优化是完全一样的，根本不存在谁比谁快！&nbsp;</p>\r\n\r\n<p>那既然COUNT(*)和COUNT(1)一样，建议用哪个呢？</p>\r\n\r\n<p>建议使用COUNT(*)！因为这个是SQL92定义的标准统计行数的语法，而且本文只是基于MySQL做了分析，关于Oracle中的这个问题，也是众说纷纭的呢。<br />\r\n&nbsp;</p>\r\n\r\n<h3>COUNT(列名)、COUNT(常量)和COUNT(*)之间的区别</h3>\r\n\r\n<p><strong><code>COUNT(常量)</code>&nbsp;和&nbsp;<code>COUNT(*)</code>表示的是直接查询符合条件的数据库表的行数。而<code>COUNT(列名)</code>表示的是查询符合条件的列的值不为NULL的行数</strong></p>\r\n\r\n<p>除了查询得到结果集有区别之外，<code>COUNT(*)</code>相比<code>COUNT(常量)</code>&nbsp;和&nbsp;<code>COUNT(列名)</code>来讲，<strong>COUNT(*)是SQL92定义的标准统计行数的语法，因为他是标准语法，所以MySQL数据库对他进行过很多优化。</strong></p>\r\n\r\n<h3>COUNT(*)的优化</h3>\r\n\r\n<p><code>COUNT(*)</code>是SQL92定义的标准统计行数的语法, MySQL数据库对他进行过很多优化.&nbsp;</p>\r\n\r\n<p>MyISAM和InnoDB有很多区别，其中有一个关键的区别和我们接下来要介绍的<code>COUNT(*)</code>有关，那就是<strong>MyISAM不支持事务，MyISAM中的锁是表级锁；而InnoDB支持事务，并且支持行级锁。</strong></p>\r\n\r\n<p>因为MyISAM的锁是表级锁，所以同一张表上面的操作需要串行进行，所以，<strong>MyISAM做了一个简单的优化，那就是它可以把表的总行数单独记录下来，如果从一张表中使用COUNT(*)进行查询的时候，可以直接返回这个记录下来的数值就可以了，当然，前提是不能有where条件。</strong></p>\r\n\r\n<p>MyISAM之所以可以把表中的总行数记录下来供COUNT(*)查询使用，那是因为MyISAM数据库是表级锁，不会有并发的数据库行数修改，所以查询得到的行数是准确的。</p>\r\n\r\n<p>对于InnoDB来说，就不能做这种缓存操作了，因为InnoDB支持事务，其中大部分操作都是行级锁，所以可能表的行数可能会被并发修改，那么缓存记录下来的总行数就不准确了。</p>\r\n\r\n<p><strong>COUNT(*)的目的只是为了统计总行数，所以，他根本不关心自己查到的具体值，所以，他如果能够在扫表的过程中，选择一个成本较低的索引进行的话，那就可以大大节省时间。</strong></p>\r\n\r\n<p>MySQL数据库对于COUNT(*)的优化，这些优化的前提都是查询语句中不包含WHERE以及GROUP BY条件。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h3>COUNT(字段)</h3>\r\n\r\n<p>查询就比较简单粗暴了，就是进行全表扫描，然后判断指定字段的值是不是为NULL，不为NULL则累加。</p>\r\n\r\n<p>相比<code>COUNT(*)</code>，<code>COUNT(字段)</code>多了一个步骤就是判断所查询的字段是否为NULL，所以他的<strong>性能要比<code>COUNT(*)</code>慢</strong>。</p>\r\n\r\n<h3>总结</h3>\r\n\r\n<p>本文介绍了COUNT函数的用法，主要用于统计表行数。主要用法有COUNT(*)、COUNT(字段)和COUNT(1)。</p>\r\n\r\n<p>因为COUNT(*)是SQL92定义的标准统计行数的语法，所以MySQL对他进行了很多优化，MyISAM中会直接把表的总行数单独记录下来供COUNT(*)查询，而InnoDB则会在扫表的时候选择最小的索引来降低成本。当然，这些优化的前提都是没有进行where和group的条件查询。</p>\r\n\r\n<p>在InnoDB中COUNT(*)和COUNT(1)实现上没有区别，而且效率一样，但是COUNT(字段)需要进行字段的非NULL判断，所以效率会低一些。</p>\r\n\r\n<p>因为COUNT(*)是SQL92定义的标准统计行数的语法，并且效率高，所以请直接使用COUNT(*)查询表的行数！</p>\r\n\r\n<p>参考资料：</p>\r\n\r\n<p><a href=\"https://blog.csdn.net/hollis_chuang/article/details/102657937\">不就是SELECT COUNT语句吗，竟然能被面试官虐的体无完肤</a><br />\r\n<a href=\"https://dev.mysql.com/doc/refman/8.0/en/group-by-functions.html#function_count\">《极客时间&mdash;&mdash;MySQL实战45讲》</a></p>',
        '', '2019-11-05 02:26:00', '2019-11-05 02:27:00', 103, 1, 1, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (42, '古语云：工欲善其事必先利其器 --> Java最新、最全的 IntelliJ IDEA(2018.3.3) 的介绍、安装、破解、配置与使用',
        '<h2><strong>一、IntelliJ IDEA 介绍 -&gt; Eclipse IBM</strong></h2>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h3><strong>1. JetBrains 公司介绍</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>IDEA(<a href=\"https://www.jetbrains.com/idea/\">https://www.jetbrains.com/idea/</a>)是 JetBrains 公司的产品，公司旗下还有其 它产品，比如：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<ul>\r\n	<li>WebStorm：用于开发 JavaScript、HTML5、CSS3 等前端技术</li>\r\n	<li>yCharm：用于开发 python</li>\r\n	<li>PhpStorm：用于开发 PHP</li>\r\n	<li>RubyMine：用于开发 Ruby/Rails</li>\r\n	<li>AppCode：用于开发 Objective - C/Swift</li>\r\n	<li>CLion：用于开发 C/C++</li>\r\n	<li>DataGrip：用于开发数据库和 SQL</li>\r\n	<li>Rider：用于开发.NET</li>\r\n	<li>GoLand：用于开发 Go</li>\r\n	<li>Android Studio：用于开发 android(是google 基于 IDEA 社区版进行迭代的)</li>\r\n	<li>&hellip;&hellip;</li>\r\n</ul>\r\n\r\n<h3><strong>2. IntelliJ IDEA 介绍</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>IDEA，全称 IntelliJ IDEA，是 Java 语言的集成开发环境，IDEA 在业界被公认为是最好的 java 开发工具之一，尤其在智能代码助手、代码自动提示、重构、J2EE 支持、Ant、JUnit、CVS 整合、代码审查、创新的 GUI 设计等方面的功能可以说是超常的。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>IntelliJ IDEA 在 2015 年的官网上这样介绍自己： <code>Excel at enterprise, mobile and web development with Java, Scala and Groovy, with all the latest modern technologies and frameworks available out of the box.</code></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>简明翻译：IntelliJ IDEA 主要用于支持 Java、Scala、Groovy 等语言的开发工具，同时具备支持目前主流的技术和框架，擅长于企业应用、移动应用和 Web 应用的开发。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h3><strong>3. IDEA 的主要功能介绍</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>语言支持上：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L3Z0b2M0YTg2ZTkucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>其他支持：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2ZqOXJvaG1reXQucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<h3><strong>4. IDEA 的主要优势：(相较于 Eclipse 而言)</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>① 强大的整合能力。比如：Git、Maven、Spring 等 ② 提示功能的快速、便捷 ③ 提示功能的范围广</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L3V3cTE5cGRpbHkucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>④ 好用的快捷键和代码模板。比如：private static final = psf ⑤ 精准搜索</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h3><strong>5. IDEA 的下载地址：(官网)</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><a href=\"https://www.jetbrains.com/idea/download/#section=windows\">https://www.jetbrains.com/idea/download/#section=windows</a> IDEA 分为两个版本：旗舰版(Ultimate)和社区版(Community)。 旗舰版收费(限 30 天免费试用)，社区版免费，这和 Eclipse 有很大区别。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L214cTh1ZHNnODUucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>这里提供了不同操作系统下的两个不同版本的安装文件。 两个不同版本的详细对比，可以参照官网： <a href=\"https://www.jetbrains.com/idea/features/editions_comparison_matrix.html\">https://www.jetbrains.com/idea/features/editions_comparison_matrix.html</a></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h3><strong>6. 官网提供的详细使用文档</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><a href=\"https://www.jetbrains.com/help/idea/meet-intellij-idea.html\">https://www.jetbrains.com/help/idea/meet-intellij-idea.html</a></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h2><strong>二、windows 下安装过程</strong></h2>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h3><strong>1. 安装前的准备</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><strong>1.1 硬件要求(Hardware requirements)</strong></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<ul>\r\n	<li>内存：2 GB RAM minimum, 4 GB RAM recommended</li>\r\n	<li>硬盘：1.5 GB hard disk space + at least 1 GB for caches</li>\r\n	<li>屏幕：1024x768 minimum screen resolution</li>\r\n</ul>\r\n\r\n<p>个人建议配置：内存 8G 或以上，CPU 最好 i5 以上，最好安装块固态硬盘(SSD)，将 IDEA 安装在固态硬盘上，这样流畅度会加快很多。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><strong>1.2 软件要求(Software requirements)</strong></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>操作系统：Microsoft Windows 10/8/7/Vista/2003/XP (32 or 64 bit) 软件环境：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<ul>\r\n	<li>JRE 1.8 is bundled with the IntelliJ IDEA distribution. You do not need to install Java on your computer to run IntelliJ IDEA.</li>\r\n	<li>A standalone JDK is required for Java development.</li>\r\n</ul>\r\n\r\n<p>注意：这里如果没有安装 JDK 的话，请参考提供的文档《尚硅谷_宋红康_JDK8 的下载/安装/配置.pdf》进行安装配置。 或者参考：<a href=\"https://www.cnblogs.com/chenmingjun/p/9941191.html\">win10 64位系统中安装多个jdk版本的切换问题</a></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h3><strong>2. 具体安装过程</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>双击【ideaIU-2018.3.3.exe】安装文件：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L21yZTZnc2N3MDgucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>点击【Next】</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2Y3Y213ejFvaGMucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>选择好【文件的安装文件目录】，点击【Next】</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2xyZnRpMDQwenoucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p><code>红色箭头</code>所指向的选项代表根据你的电脑选择对应的位数，这里我选择64位。 <code>绿色箭头</code>所指向的选项代表关联文件，如果你打钩了，以后你双击电脑上的.java文件就会用它打开，这里推荐选择不关联。。 <code>蓝色箭头</code>所指向的选项代表是否由JetBrain自动下载一个jre，对于之前没有在电脑上配置jre的人来说强烈建议你在此处勾选上，同一个计算机内可以有多套jre共存并且彼此互相不冲突。每个程序都可以自带jre，当程序运行的时候会寻找对应的jre，寻找时具有优先级，先寻当前目录，再寻父目录，最后在系统的环境变量里寻找。而如果之前在系统的环境变量里已经配置了jre的路径，那不选择倒也不会出很大问题。但如果不确定的话建议在安装JetBrain时选择自动安装一个jre，既方便又不会和已有的环境冲突，多个jre是共存的，无非是占用一点磁盘空间而已。 其余的我们暂不选择</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1LzVrenRiNXBlcDYucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>点击【安装】</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L3l0ZWF2b3N6MHgucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>等待安装</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L3BkYjdvYmNrMmMucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>点击【完成】</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L213NGpyNWlvMXAucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<h3><strong>3. 安装总结</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>从安装上来看，IntelliJ IDEA 对硬件的要求似乎不是很高。可是实际在开发中其实并不是这样的，因为 IntelliJ IDEA 执行时会有大量的缓存、索引文件，所以如果你正在使用 Eclipse / MyEclipse，想通过 IntelliJ IDEA 来解决计算机的卡、慢等问题，这基本上是不可能的，本质上你应该对自己的硬件设备进行升级。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h3><strong>4. 查看安装目录结构</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2loamRkb2l2N3MucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<pre>\r\n<code>bin：容器，执行文件和启动参数等\r\nhelp：快捷键文档和其他帮助文档\r\njre64：64 位java 运行环境\r\nlib：idea 依赖的类库\r\nlicense：各个插件许可\r\nplugin：插件</code></pre>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>其中，bin 目录下：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2plaGR6OGRic2kucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>这里以我的电脑系统(64 位 Windows10，24G 内存)为例，说明一下如何调整 VM 配置文件：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2ZkdDd3bnpwNHkucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>详解如下：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<pre>\r\n<code>1. 大家根据电脑系统的位数，选择 32 位的 VM 配置文件或者 64 位的 VM 配置文件。\r\n2. 32 位操作系统内存不会超过 4G，所以没有多大空间可以调整，建议不用调整了。\r\n3. 64 位操作系统中 8G 内存以下的机子或是静态页面开发者是无需修改的。\r\n4. 64 位操作系统且内存大于 8G 的，如果你是开发大型项目、Java 项目或是 Android 项目，建议进行修改，常修改的就是下面 3 个参数：\r\n-Xms128m，16 G 内存的机器可尝试设置为 -Xms512m\r\n　　(设置初始的内存数，增加该值可以提高 Java 程序的启动速度)\r\n-Xmx750m，16 G 内存的机器可尝试设置为 -Xmx1500m\r\n　　(设置最大内存数，提高该值，可以减少内存 Garage 收集的频率，提高程序性能)\r\n-XX:ReservedCodeCacheSize=240m，16G 内存的机器可尝试设置为 -XX:ReservedCodeCacheSize=480m\r\n　　(保留代码占用的内存容量)</code></pre>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h3><strong>5. 查看设置目录结构</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>安装完成后没有启动 IntelliJ IDEA 的话，该目录还不会生成。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L3o1emxqeGhmbTQucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>这是 IDEA 的各种配置的保存目录。这个设置目录有一个特性，就是你删除掉整个目录之后，重新启动 IntelliJ IDEA 会再自动帮你生成一个全新的默认配置，所以很多时候如果你把 IntelliJ IDEA 配置改坏了，没关系，删掉该目录，一切都会还原到默认。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><strong>5.1 config 目录</strong></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>config 目录是 IntelliJ IDEA 个性化化配置目录，或者说是整个 IDE 设置目录。<code>此目录可看成是最重要的目录，没有之一</code>，如果你还记得安装篇的介绍的时候，安装新版本的 IntelliJ IDEA 会自动扫描硬盘上的旧配置目录，指的就是该目录。这个目录主要记录了：<code>IDE 主要配置功能</code>、<code>自定义的代码模板</code>、<code>自定义的文件模板</code>、<code>自定义的快捷键</code>、<code>Project 的 tasks 记录等等个性化的设置</code>。 比如：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2N3dm9kdXFsenMucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p><strong>5.2 system 目录</strong></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><code>system 目录是 IntelliJ IDEA 系统文件目录</code>，是 IntelliJ IDEA 与开发项目一个桥梁目录，里面主要有：<code>缓存</code>、<code>索引</code>、<code>容器文件输出</code>等等，虽然不是最重要目录，但也是最不可或缺的目录之一。比如：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2hzZzN5MzgyamYucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<h2><strong>三、启动应用后简单配置</strong></h2>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h3><strong>1. 是否导入已有设置</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>首次启动，会弹出如下的对话框。选择不导入已有的设置，点击【OK】</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1LzZocnAycGhtaDUucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>再点击接收用户许可，点击【继续】</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L3F1ajBjY2JmY3EucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>点击【不发送】</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2NhZHh2bXZtNzEucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<h3><strong>2. 设置主题</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>这里根据个人喜好，进行选择，也可以选择跳过(skip all and set defaults)。后面在settings 里也可以再设置主题等。这里选择【Next:Default plugins】</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2VsMXZuMWYzYjkucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<h3><strong>3. 设置插件</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>设置 IDEA 中的各种插件，可以选择自定义设置、删除，或者安装本身不存在的插件（比如：支持 Scala 的插件）。这里不设置，后面也可以通过界面菜单栏的 settings 进行设置。 IDEA 插件官方下载地址：https://plugins.jetbrains.com/idea 点击【Next:Featured plugins】</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2R1amlwcXBqM3UucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>点击【Start using IntelliJ IDEA】</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L3hkMXVxYmpvNjYucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<h3><strong>4. 激活</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<blockquote>\r\n<p>&nbsp;</p>\r\n</blockquote>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<ul>\r\n	<li>IEDA的激活方式有三种，<code>激活码</code>、<code>激活服务器</code>和<code>破解补丁</code>。激活码的话可以去淘宝买，激活的时间基本都是一年；激活服务器的激活到期时间就看服务器的稳定程度和JB官方的是否封杀了；破解补丁是利用程序注入实现激活，最大的好处是可以实现永久激活(2100年过期)，不用老是折腾。</li>\r\n	<li>然后根据提供的激活文档《IDEA2017-2018_激活方法》或百度：idea 破解码，填入：Lisence server 的具体值即可（需要联网）。或者选择 Activation code，根据文档提供的激活码，同样可以激活（不需要联网）。</li>\r\n</ul>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2RsZmNnM2lybHUucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>补充，对于 IDEA 2017.3 版本，需要按照如下的方式激活： 方式一： &emsp;&emsp;启动：idea_active_proxy 激活代理.exe &emsp;&emsp;接着，启动 IDEA：输入 server: http://localhost:8888，然后可以关闭 idea_active_proxy 工具。 方式二：淘宝，你懂的！ &emsp;&emsp;本博主的破解方式（激活码方式）。 附激活码：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<pre>\r\n<code>5HMBH3TMNB-eyJsaWNlbnNlSWQiOiI1SE1CSDNUTU5CIiwibGljZW5zZWVOYW1lIjoiZGUgZGUiLCJhc3NpZ25lZU5hbWUiOiIiLCJhc3NpZ25lZUVtYWlsIjoiIiwibGljZW5zZVJlc3RyaWN0aW9uIjoiRm9yIGVkdWNhdGlvbmFsIHVzZSBvbmx5IiwiY2hlY2tDb25jdXJyZW50VXNlIjpmYWxzZSwicHJvZHVjdHMiOlt7ImNvZGUiOiJJSSIsInBhaWRVcFRvIjoiMjAxOS0wNi0yMyJ9LHsiY29kZSI6IlJTMCIsInBhaWRVcFRvIjoiMjAxOS0wNi0yMyJ9LHsiY29kZSI6IldTIiwicGFpZFVwVG8iOiIyMDE5LTA2LTIzIn0seyJjb2RlIjoiUkQiLCJwYWlkVXBUbyI6IjIwMTktMDYtMjMifSx7ImNvZGUiOiJSQyIsInBhaWRVcFRvIjoiMjAxOS0wNi0yMyJ9LHsiY29kZSI6IkRDIiwicGFpZFVwVG8iOiIyMDE5LTA2LTIzIn0seyJjb2RlIjoiREIiLCJwYWlkVXBUbyI6IjIwMTktMDYtMjMifSx7ImNvZGUiOiJSTSIsInBhaWRVcFRvIjoiMjAxOS0wNi0yMyJ9LHsiY29kZSI6IkRNIiwicGFpZFVwVG8iOiIyMDE5LTA2LTIzIn0seyJjb2RlIjoiQUMiLCJwYWlkVXBUbyI6IjIwMTktMDYtMjMifSx7ImNvZGUiOiJEUE4iLCJwYWlkVXBUbyI6IjIwMTktMDYtMjMifSx7ImNvZGUiOiJHTyIsInBhaWRVcFRvIjoiMjAxOS0wNi0yMyJ9LHsiY29kZSI6IlBTIiwicGFpZFVwVG8iOiIyMDE5LTA2LTIzIn0seyJjb2RlIjoiQ0wiLCJwYWlkVXBUbyI6IjIwMTktMDYtMjMifSx7ImNvZGUiOiJQQyIsInBhaWRVcFRvIjoiMjAxOS0wNi0yMyJ9LHsiY29kZSI6IlJTVSIsInBhaWRVcFRvIjoiMjAxOS0wNi0yMyJ9XSwiaGFzaCI6Ijk0MDEwNTkvMCIsImdyYWNlUGVyaW9kRGF5cyI6MCwiYXV0b1Byb2xvbmdhdGVkIjpmYWxzZSwiaXNBdXRvUHJvbG9uZ2F0ZWQiOmZhbHNlfQ==-bxO8rTTyr3M7eZ2vDLNED2oFAS+YVV9ql2RvEfJY6FyXPTmtO2I5XpEs9AoYVK5VX+NF7GD41LvCwONzvL69j1fDjVGcU1udj00srdHvuCMnPk1tsiJlnZ2wzmE+AVWKNbMMkzSphlxov5czEzRKG3lMPZ8ffz66+doKgcnef1y5owYdcm4qOCVGtBraBgDPNNM//BUTiCMu51J9B80YFvD2bDmw4pDYl2sorR/530+5Qc4Qrfeurz0YllUD7MEVzNKYh9hSLgWGk4GinB50qifwcqPhI6EF5TGD4oMHEdfCXom0NfO9P8fWwKpGFhfZ4XJml7k3EIAEzYFnau4QJw==-MIIEPjCCAiagAwIBAgIBBTANBgkqhkiG9w0BAQsFADAYMRYwFAYDVQQDDA1KZXRQcm9maWxlIENBMB4XDTE1MTEwMjA4MjE0OFoXDTE4MTEwMTA4MjE0OFowETEPMA0GA1UEAwwGcHJvZDN5MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAxcQkq+zdxlR2mmRYBPzGbUNdMN6OaXiXzxIWtMEkrJMO/5oUfQJbLLuMSMK0QHFmaI37WShyxZcfRCidwXjot4zmNBKnlyHodDij/78TmVqFl8nOeD5+07B8VEaIu7c3E1N+e1doC6wht4I4+IEmtsPAdoaj5WCQVQbrI8KeT8M9VcBIWX7fD0fhexfg3ZRt0xqwMcXGNp3DdJHiO0rCdU+Itv7EmtnSVq9jBG1usMSFvMowR25mju2JcPFp1+I4ZI+FqgR8gyG8oiNDyNEoAbsR3lOpI7grUYSvkB/xVy/VoklPCK2h0f0GJxFjnye8NT1PAywoyl7RmiAVRE/EKwIDAQABo4GZMIGWMAkGA1UdEwQCMAAwHQYDVR0OBBYEFGEpG9oZGcfLMGNBkY7SgHiMGgTcMEgGA1UdIwRBMD+AFKOetkhnQhI2Qb1t4Lm0oFKLl/GzoRykGjAYMRYwFAYDVQQDDA1KZXRQcm9maWxlIENBggkA0myxg7KDeeEwEwYDVR0lBAwwCgYIKwYBBQUHAwEwCwYDVR0PBAQDAgWgMA0GCSqGSIb3DQEBCwUAA4ICAQC9WZuYgQedSuOc5TOUSrRigMw4/+wuC5EtZBfvdl4HT/8vzMW/oUlIP4YCvA0XKyBaCJ2iX+ZCDKoPfiYXiaSiH+HxAPV6J79vvouxKrWg2XV6ShFtPLP+0gPdGq3x9R3+kJbmAm8w+FOdlWqAfJrLvpzMGNeDU14YGXiZ9bVzmIQbwrBA+c/F4tlK/DV07dsNExihqFoibnqDiVNTGombaU2dDup2gwKdL81ua8EIcGNExHe82kjF4zwfadHk3bQVvbfdAwxcDy4xBjs3L4raPLU3yenSzr/OEur1+jfOxnQSmEcMXKXgrAQ9U55gwjcOFKrgOxEdek/Sk1VfOjvS+nuM4eyEruFMfaZHzoQiuw4IqgGc45ohFH0UUyjYcuFxxDSU9lMCv8qdHKm+wnPRb0l9l5vXsCBDuhAGYD6ss+Ga+aDY6f/qXZuUCEUOH3QUNbbCUlviSz6+GiRnt1kA9N2Qachl+2yBfaqUqr8h7Z2gsx5LcIf5kYNsqJ0GavXTVyWh7PYiKX4bs354ZQLUwwa/cG++2+wNWP+HtBhVxMRNTdVhSm38AknZlD+PTAsWGu9GyLmhti2EnVwGybSD2Dxmhxk3IPCkhKAK+pl0eWYGZWG3tJ9mZ7SowcXLWDFAk0lRJnKGFMTggrWjV8GYpw5bq23VmIqqDLgkNzuoog==</code></pre>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>有效期到2019年6月24日</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L203dG5rZ2U0MGQucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>到期，请到淘宝购买。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h2><strong>四、创建 Java 工程，运行 Hello World</strong></h2>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h3><strong>1. 创建 Java 工程</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1LzR5M2FhdWR3ajkucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>选项详解如下：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<pre>\r\n<code>Create New Project：创建一个新的工程。\r\nImport Project：导入一个现有的工程。\r\nOpen：打开一个已有工程。比如：可以打开 Eclipse 项目。\r\nCheck out from Version Control：可以通过服务器上的项目地址 check out Github 上面项目或其他 Git 托管服务器上的项目。</code></pre>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>这里选择 Create New Project，需要明确一下概念： IntelliJ IDEA 没有类似 Eclipse 的工作空间的概念（Workspaces），最大单元就是Project。 这里可以把 Project 理解为 Eclipse 中的 Workspace。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L29ua2g5NncxZWwucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>选择指定目录下的 JDK 作为 Project SDK。 如果要创建 Web 工程，则需要勾选上面的 Web Application。如果不需要创建 Web工程的话，则不需要勾选。这里先不勾选，我们只是创建简单的 Java 工程。 其中，选择【New&hellip;】，选择 jdk 的安装路径所在位置：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L25pZXNzMXpjcjMucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>点击【OK】以后，选择【Next】</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L3RqajdsdW9uamYucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>这里不用勾选。选择【Next】，进入下一个页面：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L3N4NjVjYjVqYXIucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>给创建的工程起一个名字和工程所在位置，点击【finish】</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L290MG56OGNrbGUucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>点击【OK】即可。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h3><strong>2. 设置显示常见的视图</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>调出工具条和按钮组</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1LzhsZTVzM2lsanIucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<h3><strong>3. 工程界面展示</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L3djZGZ1anc3Y2cucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>工程下的 src 类似于 Eclipse 下的 src 目录，用于存放代码。 工程下的.idea 和 project01.iml 文件都是 IDEA 工程特有的。类似于 Eclipse 工程下的.settings、.classpath、.project 文件等。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h3><strong>4. 创建 Package 和 Class</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>接着在 src 目录下创建一个 package：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L3VrNjdvZ2w0ZzgucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>com.atguigu.java</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L3ZuZHZpMWZpM3cucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>在包下 New 一个 Java Class：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2Y2b2FvazhocnIucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>HelloWorld</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L3B4eHl6Z3dud28ucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>不管是创建 Class，还是 Interface，还是 Annotation，都是选择 New --&gt; Java Class，然后在 Kind 下拉框中选择创建的结构的类型。接着在类 HelloWorld 里声明主方法，输出 Hello World!，完成测试。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2h4bG5oNm1oZHUucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p><code>说明</code>：在 IDEA 里要说的是，写完代码，不用点击保存。IDEA 会自动保存代码。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h3><strong>5. 创建模块(Module)</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>1、在 Eclipse 中我们有 workspace（工作空间）和 Project（工程）的概念，在 IDEA 中只有 Project（工程）和 Module（模块）的概念。这里的对应关系为： IDEA 官网说明：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<pre>\r\n<code>An Eclipse workspace is similar to a project in IntelliJ IDEA \r\nAn Eclipse project maps to a module in IntelliJ IDEA\r\n翻译：\r\nEclipse 中 workspace 相当于 IDEA 中的 Project\r\nEclipse 中 Project 相当于 IDEA 中的 Module</code></pre>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>这个地方刚开始用的时候会很容易理不清它们之间的关系。 2、从 Eclipse 转过来的人总是下意识地要在同一个窗口管理 n 个项目，这在 IntelliJ IDEA 是无法做到的。IntelliJ IDEA 提供的解决方案是打开多个项目实例，即打开多个项目窗口。即：一个 Project 打开一个 Window 窗口。 3、在 IntelliJ IDEA 中 Project 是最顶级的级别，次级别是 Module。一个 Project 可以有多个 Module。目前主流的大型项目都是分布式部署的，结构都是类似这种多 Module 结构。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1LzgwMHVsYm5oYWUucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>这类项目一般是这样划分的，比如：core Module、web Module、plugin Module、solr Module 等等，模块之间彼此可以相互依赖。通过这些 Module 的命名也可以看出，他们之间都是处于同一个项目业务下的模块，彼此之间是有不可分割的业务关系的。举例：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L3BsaWUzMXB3cjgucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>4、相比较于多 Module 项目，小项目就无需搞得这么复杂。只有一个 Module 的结构 IntelliJ IDEA 也是支持的，并且 IntelliJ IDEA 创建项目的时候，默认就是单 Module 的结构的。 下面，我们演示如何创建 Module:</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2QwZDF5ODRuMDMucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>点击【Next】</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1LzlzZmJpZGE2ZHAucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>给模块起名字和保存的位置</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L3QwcnlwODJybHAucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>之后，我们可以在 Module 的 src 里写代码，此时 Project01 工程下的 src 就没什么 用了。可以删掉。 5、演示创建类的同时创建包</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2thcGRrZDBjOG4ucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>包名小写，类名大写</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2theGVqdGM2ajQucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>效果如下图：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2loNmFodTA5dWkucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>6、如何删除模块</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L3FyeHJ6MDQ5c2YucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>选中要删除的模块，点击减号</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1LzBnZ2N5am0weWgucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>点击【Yes】后，点击【Ok】</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L284Y3drMTk0cGkucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>此时再选中要删除的模块会出现有【Delete】选项，会从硬盘上将此 Module 删除掉</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1LzJrbjhsem55OHEucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>7、查看项目配置</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1LzR5eG91cHdvaHIucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>进入项目结构：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L3U2NHBxOWEzNmYucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<h2><strong>五、常用配置</strong></h2>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<blockquote>\r\n<p>&nbsp;</p>\r\n</blockquote>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<ul>\r\n	<li>IntelliJ IDEA 有很多人性化的设置我们必须单独拿出来讲解，也因为这些人性化的设置让那些 IntelliJ IDEA 死忠粉更加死心塌地使用它和分享它。</li>\r\n</ul>\r\n\r\n<p>进入设置界面：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2JkaDRxZ3BidTAucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>目录结构如下：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L3h1OWFjNzJjZHMucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<h3><strong>1. Appearance &amp; Behavior</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><strong>1.1 设置主题</strong></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>这里默认提供了三套主题：Darcula，High contrast和IntelliJ。这里可以根据自己的喜好进行选择。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1Lzg0aWZiYnJscDUucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p><strong>1.2 设置窗体及菜单的字体及字体大小(可忽略)</strong></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1LzR5MzN1NXEzMnMucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p><strong>1.3 补充:设置编辑区主题(可忽略)</strong></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>IDEA 默认提供了三个编辑区主题，可以通过如下的方式进行选择。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2psYnE4czJmMTUucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>如果想要更多的主题效果的话，可以到如下的网站下载： http://www.riaway.com/</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<blockquote>\r\n<p>&nbsp;</p>\r\n</blockquote>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<ul>\r\n	<li>下载以后，导入主题：（方式一）</li>\r\n</ul>\r\n\r\n<p>File &ndash;&gt; Import Setttings &ndash;&gt; 选中下载的主题 jar 文件 &ndash;&gt; 一路确认 &ndash;&gt; 重启IDEA。 重启以后，新主题会自动启用。如果没有启用，可以如下方式选择：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<blockquote>\r\n<p>&nbsp;</p>\r\n</blockquote>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<ul>\r\n	<li>下载以后，导入主题：（方式二）</li>\r\n</ul>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2gxczYxaTV3NzIucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p><strong>1.4 补充：通过插件(Plugins)更换主题</strong></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>喜欢黑色主题的话，还可以下载插件：Material Theme UI</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1LzF5ZmVuc2J2dHgucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>点击按钮以后，在联网环境下搜索如上的插件安 -&gt; 装 -&gt; 重启IDEA 即可。 如果对安装的主题插件不满意，还可以找到此插件，进行卸载 -&gt; 重启IDEA 即可。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h3><strong>2. Editor -&gt; General</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><strong>2.1 设置鼠标滚轮修改字体大小(可忽略)</strong></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L3pneXAzbTJ1ZXkucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>我们可以勾选此设置后，增加【Ctrl + 鼠标滚轮】快捷键来控制代码字体大小显示。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><strong>2.2 设置鼠标悬浮提示</strong></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1LzkwYW1rbTl1b3MucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p><strong>2.3 设置自动导包功能</strong></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2dreXkycWlpYmUucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<ul>\r\n	<li>Add unambiguous imports on the fly：自动导入不明确的结构</li>\r\n	<li>Optimize imports on the fly：自动帮我们优化导入的包</li>\r\n</ul>\r\n\r\n<p><strong>2.4 设置显示行号和方法间的分隔符</strong></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1Lzc2ZnBqb2ZzdGIucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<ul>\r\n	<li>如上图红圈所示，可以勾选 Show line numbers：显示行数。我建议一般这个要勾选上。</li>\r\n	<li>如上图红圈所示，可以勾选 Show method separators：显示方法分隔线。这种线有助于我们区分开方法，所以建议勾选上。</li>\r\n</ul>\r\n\r\n<p><strong>2.5 设置忽略大小写提示</strong></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1LzRvZ3NjYWloOTAucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<ul>\r\n	<li>IntelliJ IDEA 的代码提示和补充功能有一个特性：区分大小写。如上图标注所示，默认就是 First letter only 区分大小写的。</li>\r\n	<li>区分大小写的情况是这样的：比如我们在 Java 代码文件中输入 stringBuffer，IntelliJ IDEA - 默认是不会帮我们提示或是代码补充的，但是如果我们输入StringBuffer 就可以进行代码提示和补充。</li>\r\n	<li>如果想不区分大小写的话，取消勾选该选项即可。（2017版本的IEDA中是改为 None 选项）</li>\r\n</ul>\r\n\r\n<p><strong>2.6 设置取消单行显示 tabs 的操作</strong></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L3QxODVncnZzdHoucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>如上图标注所示，在打开很多文件的时候，IntelliJ IDEA 默认是把所有打开的文件名以 Tab 单行显示的。但是我个人现在的习惯是使用多行，多行效率比单行高，因为单行会隐藏超过界面部分 Tab，这样找文件不方便。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h3><strong>3. Editor &ndash;&gt; Font</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><strong>3.1 设置默认的字体、字体大小、字体行间距</strong></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1LzVjbjJ4aTB1eHQucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<h3><strong>4. Editor &ndash;&gt; Color Scheme</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><strong>4.1 修改当前主题的字体、字体大小、字体行间距(可忽略)</strong></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>如果当前主题不希望使用默认字体、字体大小、字体行间距，还可以单独设置：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2Y5YzZsZ3YyY3gucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p><strong>4.2 修改当前主题的控制台输出的字体及字体大小(可忽略)</strong></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1LzQwcTA4OW43b2YucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p><strong>4.3 修改代码中注释的字体颜色</strong></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1LzJ6cWU5bmpoN3AucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<ul>\r\n	<li>Doc Comment &ndash;&gt; Text：修改文档注释的字体颜色</li>\r\n	<li>Block comment：修改多行注释的字体颜色</li>\r\n	<li>Line comment：修改当行注释的字体颜色</li>\r\n</ul>\r\n\r\n<h3><strong>5. Editor &ndash;&gt; Code Style</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><strong>5.1 设置超过指定 import 个数，改为* (可忽略)</strong></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L3g5dnk1aGRoZDAucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<h3><strong>6. Editor &ndash;&gt; File and Code Templates</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><strong>6.1 修改类头的文档注释信息</strong></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L3ZkOW9henk1enoucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>常用的预设的变量，这里直接贴出官网给的：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<pre>\r\n<code>${PACKAGE_NAME}     name of the package in which the new file is created\r\n${USER}             current user system login name\r\n${DATE}             current system date\r\n${TIME}             current system time\r\n${YEAR}             current year\r\n${MONTH}            current month\r\n${MONTH_NAME_SHORT} first 3 letters of the current month name. Example: Jan, Feb, etc.\r\n${MONTH_NAME_FULL}  full name of the current month. Example: January, February, etc.\r\n${DAY}              current day of the month\r\n${DAY_NAME_SHORT}   first 3 letters of the current day name. Example: Mon, Tue, etc.\r\n${DAY_NAME_FULL}    full name of the current day. Example: Monday, Tuesday, etc.\r\n${HOUR}             current hour\r\n${MINUTE}           current minute\r\n${PROJECT_NAME}     the name of the current project</code></pre>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h3><strong>7. Editor &ndash;&gt; File Encodings</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><strong>7.1 设置项目文件编码</strong></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L3VzdnN4eHJ6bWYucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p><strong>7.2 设置当前源文件的编码(可忽略)</strong></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>打开某一个文件，在右下角</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1LzlhZ3c0anltcmQucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>出现如下图选项：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1LzFxamcxOHV2eGsucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>对单独文件的编码修改还可以点击右下角的编码设置区。如果代码内容中包含中文，则会弹出如上的操作选择。其中：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<ul>\r\n	<li>①Reload 表示使用新编码重新加载，新编码不会保存到文件中，重新打开此文件，旧编码是什么依旧还是什么。</li>\r\n	<li>②Convert 表示使用新编码进行转换，新编码会保存到文件中，重新打开此文件，新编码是什么则是什么。</li>\r\n	<li>③含有中文的代码文件，Convert 之后可能会使中文变成乱码，所以在转换成请做好备份，不然可能出现转换过程变成乱码，无法还原。</li>\r\n</ul>\r\n\r\n<h3><strong>8. Build,Execution,Deployment</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><strong>8.1 设置自动编译</strong></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L3R0a2ljc2VnNmkucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>构建就是以我们编写的 java 代码、框架配置文件、国际化等其他资源文件、JSP 页面和图片等资源作为&ldquo;原材料&rdquo;，去&ldquo;生产&rdquo;出一个可以运行的项目的过程。 Intellij Idea 默认状态为不自动编译状态，Eclipse 默认为自动编译，如下图所示：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L3RhZnM0YXpwOWcucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>很多朋友都是从 Eclipse 转到 Intellij 的，这常常导致我们在需要操作 class 文件时忘记对修改后的 java 类文件进行重新编译，从而对旧文件进行了操作。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h3><strong>9. 设置为省电模式 (可忽略)</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L3NlZ2VsYmZwbWEucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>如上图所示，IntelliJ IDEA 有一种叫做 <code>省电模式</code> 的状态，开启这种模式之后 IntelliJ IDEA 会关掉代码检查和代码提示等功能。所以一般也可认为这是一种 <code>阅读模式</code>，如果你在开发过程中遇到突然代码文件不能进行检查和提示，可以来看看这里是否有开启该功能。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h3><strong>10. 设置代码水平或垂直显示</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L3FxMnNyOXA4NXkucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<h2><strong>六、设置快捷键(Keymap)</strong></h2>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h3><strong>1. 设置快捷为 Eclipse 的快捷键</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1LzIyYWpzMTZxNWMucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<h3><strong>2. 通过快捷键功能修改快捷键设置</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L3BuYmloaWFndTMucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<h3><strong>3. 通过指定快捷键，查看或修改其功能</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L3MyZGEwMXV3b2YucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<h3><strong>4. 导入已有设置的快捷键</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1LzhqdGFhc3c0MXMucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>选择配置好的快捷键jar的位置，点击【0K】之后，重启 IDEA 即可。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h3><strong>5. 常用快捷键</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1LzNidmtwYXJtNWsucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<h2><strong>七、关于模板(Templates)</strong></h2>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>　　(Editor &ndash;&gt; Live Templates 和 Editor &ndash;&gt; General &ndash;&gt; Postfix Completion)</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h3><strong>1. Live Templates(实时代码模板)功能介绍</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<blockquote>\r\n<p>&nbsp;</p>\r\n</blockquote>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<ul>\r\n	<li>它的原理就是配置一些常用代码字母缩写，在输入简写时可以出现你预定义的固定模式的代码，使得开发效率大大提高，同时也可以增加个性化。最简单的例子就是在 Java 中输入 sout 会出现 System.out.println();</li>\r\n	<li>官方介绍 Live Templates：https://www.jetbrains.com/help/idea/using-live-templates.html</li>\r\n</ul>\r\n\r\n<h3><strong>2. 已有的常用模板</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>Postfix Completion 默认如下：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L3RrMXA1ZmhramMucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>Live Templates 默认如下：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1LzlvYXVjdGNqN3oucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>二者的区别：Live Templates(实时代码模板) 可以自定义，而 Postfix Completion 不可以。同时，有些操作二者都提供了模板，Postfix Templates 较 Live Templates 能快 0.01 秒。 举例：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<ul>\r\n	<li>2.1 psvm：可生成 main 方法</li>\r\n	<li>2.2 sout：System.out.println() 快捷输出 类似的：\r\n	<ul>\r\n		<li>soutp=System.out.println(&quot;方法形参名 = &quot; + 形参名);</li>\r\n		<li>soutv=System.out.println(&quot;变量名 = &quot; + 变量);</li>\r\n		<li>soutm=System.out.println(&quot;当前类名.当前方法&quot;);</li>\r\n		<li>&quot;abc&quot;.sout =&gt; System.out.println(&quot;abc&quot;);</li>\r\n	</ul>\r\n\r\n	<p>&nbsp;</p>\r\n	</li>\r\n	<li>2.3 fori：可生成 for 循环 类似的：\r\n	<ul>\r\n		<li>iter：可生成增强 for 循环</li>\r\n		<li>itar：可生成普通 for 循环</li>\r\n	</ul>\r\n\r\n	<p>&nbsp;</p>\r\n	</li>\r\n	<li>2.4 list.for：可生成集合 list 的增强 for 循环 List list = new ArrayList(); 输入：list.for 即可输出 for (String s : list) { } 又如：\r\n	<ul>\r\n		<li>list.fori 顺序遍历</li>\r\n		<li>list.forr 倒序遍历</li>\r\n	</ul>\r\n\r\n	<p>&nbsp;</p>\r\n	</li>\r\n	<li>2.5 ifn：可生成 if (xxx = null) 类似的：\r\n	<ul>\r\n		<li>inn：可生成 if(xxx != null) 或 xxx.nn 或 xxx.null</li>\r\n	</ul>\r\n\r\n	<p>&nbsp;</p>\r\n	</li>\r\n	<li>2.6 prsf：可生成 private static final 类似的：\r\n	<ul>\r\n		<li>psf：可生成 public static final</li>\r\n		<li>psfi：可生成 public static final int</li>\r\n		<li>psfs：可生成 public static final String</li>\r\n	</ul>\r\n\r\n	<p>&nbsp;</p>\r\n	</li>\r\n</ul>\r\n\r\n<h3><strong>3. 修改现有模板：Live Templates</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>如果对于现有的模板，感觉不习惯、不适应的，可以修改： 修改 1： 通过调用 psvm 调用 main 方法不习惯，可以改为跟 Eclipse 一样，使用 main 调取。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L3kxdGhuNXlnZmcucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>修改 2：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2kwaGtxajR0cDgucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>类似的还可以修改 psfs。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h3><strong>4. 自定义模板</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>IDEA 提供了很多现成的 Templates。但你也可以根据自己的需要创建新的Template。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L3o5Njk4ZzRrOG8ucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>先定义一个模板的组：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2Y2ZjRqaGk0eWwucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>选中自定义的模板组，点击&rdquo;+&rdquo;来定义模板。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2k1OWhpOGQ1anQucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>填写具体模板：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2Jid2EzbzQybmMucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>1、Abbreviation：模板的缩略名称 2、Description：模板的描述 3、Template text：模板的代码片段 4、应用范围。比如点击 Define。选择如下：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1LzVhdHRxZWsyeGkucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>可以如上的方式定义个测试方法，然后在 java 类文件中测试即可。 类似的可以再配置如下的几个 Template: 例如1：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L3Bxc3B0NGZ6aDEucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>例如2：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1Lzd6bGNibGkyaTgucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<h2><strong>八、创建 Java Web Project 或 Module</strong></h2>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h3><strong>1. 创建的静态 Java Web(前端开发)</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>某一个项目右键 -&gt; New -&gt; Module</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L21ia3dnaHk5cHoucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>填写静态web的工程名称和位置：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L295MTU1bmk0OWcucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<h3><strong>2. 创建动态的 Java Web</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><strong>2.1 创建动态 Web 的 Module(后端开发)</strong></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>某一个项目右键 -&gt; New -&gt; Module</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L29maXR3eWljejQucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>这里一定要勾选 Web Application，才能创建一个 Web 工程。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2Jta2ZndGN2b2IucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>提供 Web 工程名和位置。 创建以后的工程结构如下：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1LzVldmZyNms1ZzQucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>打开 index.jsp。修改为如下内容。这里你会发现 IDEA 的代码提示功能要强于 Eclipse。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L3AyZGtpdzVoc3gucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p><strong>2.2 配置本地 Tomcat</strong></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>在 IDEA 中配置 Tomcat 之前，需要保证已经安装并配置了 Tomcat 的环境变量。 如果没有安装并配置，可以参考《尚硅谷_宋红康_Tomcat快速部署.pdf》，配置完成以后，在命令行输入：catalina run。能够启动 tomcat，则证明安装配置成功。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<blockquote>\r\n<p><strong>注意：</strong>网上有些安装教程提到需要配置CATALINA_HOME环境变量，此变量指向了tomcat的目录，主要是为了方便tomcat运行使用，如果配置了，当你的电脑上有多个tomcat目录时只能成功运行那个和CATALINA_HOME一致的tomcat，如果不配置，在你启动tomcat时它会自己确定tomcat目录，这里我们就不配置了。<code>即推荐不进行tomcat的环境变量的配置</code>。</p>\r\n</blockquote>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>下面看如何在 IDEA 中配置：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2dhd2JqanozNHAucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>点击 Edit Configurations，对于2017版的IDEA，是再点击&ldquo;+&rdquo;按钮，再选择Tomcat Server -&gt; Local， 点击 Edit Configurations，对于2018版的IEDA，是再选择Templates -&gt; Tomcat Server -&gt; Local，编辑好模板后，再点击&ldquo;+&rdquo;按钮，再选择Tomcat Server -&gt; Local。 这里我们选择 TomEE Server 或者 Tomcat Server 都可以。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L3E5cmF3djgyamQucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>然后配置 Tomcat 的名称以及配置应用服务器的位置。根据自己 Tomcat 的安装位置决定。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L3dqZGg0ampkNGIucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>其它位置使用默认值(设置要启动的浏览器以及端口号)，如下图所示。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L3ZoY2VwZnJia3gucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>接着点击部署【Deployment】-&gt; 点击+ -&gt; 【Artifact】：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2g3aDR0eHB2d3cucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>选择应用后</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L29mbHVvbTh1YW4ucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>再点回【Server】选项卡，此时：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L3p1eTFvd25rcW4ucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>这样我们的模板就配置好了，接下来，我们点击&ldquo;+&rdquo;按钮，再选择Tomcat Server -&gt; Local，直接使用我们新建配置好的模板即可，如下图：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L3JrNzhqdG0zbngucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>点击【OK】后，执行刚才创建的 index.jsp 即可：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2RiOGh6bnJxOWkucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>效果如下：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L3d2MDFpeTAwN24ucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>注意事项： 显示运行以后的 Tomcat 的信息：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L3BjNG5ob3l1bmsucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>可以点击红圈圈，刚点击后并不能马上关闭tomcat服务器，只是断开了与服务器的连接，稍后当停止按钮显示为灰色，才表示关闭。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h2><strong>九、关联数据库</strong></h2>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h3><strong>1. 关联方式</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L3I2NTd3OGI2ZmQucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>填写数据库相关信息，此时【Test Connection】为灰色状态</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2R1OWl1aG1odTUucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>填写完成后，点击【Download missing driver files】去中央仓库下载驱动文件，此时【Test Connection】为可点击状态，我们点击它进行数据库连接测试，测试成功如下：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L3N5bHFtZXR0YnkucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>点击【OK】后，查看效果：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2xtNG9jaG50bC5wbmc?x-oss-process=image/format,png\" /></p>\r\n\r\n<blockquote>\r\n<p><code>注意</code>：表面上很多人认为配置 Database 就是为了有一个 GUI 管理数据库功能，但是这并不是 IntelliJ IDEA 的 Database 最重要特性。数据库的 GUI 工具有很多，IntelliJ IDEA 的 Database 也没有太明显的优势。IntelliJ IDEA 的 Database 最大特性就是对于 Java Web 项目来讲，常使用的 ORM 框架，如 Hibernate、Mybatis 有很好的支持，比如<code>配置好了 Database 之后，IntelliJ IDEA 会自动识别 domain 对象与数据表的关系，也可以通过 Database 的数据表直接生成 domain 对象</code>等等。</p>\r\n</blockquote>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h3><strong>2. 常用操作</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2gxajFtYXAxZ2QucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<ul>\r\n	<li>图标 1：同步当前的数据库连接。这个是最重要的操作。配置好连接以后或通过其他工具操作数据库以后，需要及时同步。</li>\r\n	<li>图标 2：配置当前的连接。</li>\r\n	<li>图标 3：断开当前的连接。</li>\r\n	<li>图标 4：显示相应数据库对象的数据。</li>\r\n	<li>图标 5：编辑修改当前数据库对象。</li>\r\n</ul>\r\n\r\n<h2><strong>十、版本控制(Version Control)</strong></h2>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>不管是个人开发还是团队开发，版本控制都会被使用。而 IDEA 也很好的集成了版本控制的相关结构。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2dwenB2cjU5czAucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<blockquote>\r\n<p>&nbsp;</p>\r\n</blockquote>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<ul>\r\n	<li>很多人认为 IntelliJ IDEA 自带了 SVN 或是 Git 等版本控制工具，认为只要安装了 IntelliJ IDEA 就可以完全使用版本控制应有的功能。这完全是一种错误的解读，IntelliJ IDEA是自带对这些版本控制工具的插件支持，但是该装什么版本控制客户端还是要照样装的。</li>\r\n</ul>\r\n\r\n<p>比如我们搜索插件git</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1Lzk4c2Fmbm54eHkucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<blockquote>\r\n<p>&nbsp;</p>\r\n</blockquote>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<ul>\r\n	<li>IntelliJ IDEA 对版本控制的支持是以插件化的方式来实现的。旗舰版默认支持目前主流的版本控制软件：CVS、Subversion（SVN）、Git、Mercurial、Perforce、TFS。又因为目前太多人使用 Github进行协同或是项目版本管理，所以 IntelliJ IDEA 同时自带了 Github 插件，方便 Checkout 和管理你的 Github 项目。</li>\r\n	<li>实际开发中，发现在 IDEA 中使用 SVN 的经历不算愉快，经常会遇到很多问题，比如紧急情况下 IDEA 无法更新、提交等。所以这里，谈下在 IDEA中使用 Git。</li>\r\n</ul>\r\n\r\n<h3><strong>1. 提前安装好 Git 的客户端</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>　　Git 的客户端 msysGit 官网下载：<a href=\"https://git-scm.com/\">https://git-scm.com/</a>，安装教程链接：<a href=\"https://www.cnblogs.com/chenmingjun/p/10160410.html\">https://www.cnblogs.com/chenmingjun/p/10160410.html</a> 　　Git 的客户端 TortoiseGit 官网下载：<a href=\"http://download.tortoisegit.org/tgit/\">http://download.tortoisegit.org/tgit/</a></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h3><strong>2. IDEA 关联 git.exe</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L3NmeTNoemc3aXAucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<h3><strong>3. 关联 GitHub 上的账户，并测试连接</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>点击【GitHub】-&gt;【Add account】</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2NpZWt3NHlxOTkucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>输入GitHub的用户名和密码</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1LzFuNTB1Y3QxemMucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>连接成功后的截图：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L3RhNmEyenNkOWEucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<h3><strong>4. 在 GitHub 上创建账户下的一个新的仓库作为测试</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2ppNmpjbHN0a2sucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>填写相关信息</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1LzJlMXg0dGp3ajIucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>创建远程仓库成功后的截图：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L3lhdTc2ZnYzeWsucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<h3><strong>5. IDEA 支持从当前登录的 Github 账号上直接 Checkout 项目</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L3p1YzluNG5kZ2cucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<h3><strong>6. 在 IDEA 中 clone GitHub 上的仓库</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>选择仓库地址：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2x1bWwyN3ViczcucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>点击【Clone】后，点击【Yes】</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h3><strong>7. 连接成功以后，会下载 github 上的项目</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2M3d2dlZWU1eHUucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>填写项目名称和存储位置</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1LzE3bTJjYnRjZjkucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>根据自己的需要，选择本窗口，还是开启一个新的窗口。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L3A0ZDM5NGJkbnMucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>Clone成功后截图：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2UyZnNqbXkxemgucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<h3><strong>8. 除此之外，还可以通过如下的方式连接 GitHub</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2JwZzFjbXdhdzQucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<h3><strong>9. IDEA 本地代码分享到 GitHub</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L3lpcGl2cG9ybXoucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>此时会在 GitHub 上创建一个新的仓库，而非更新已经存在的仓库。 填写新的仓库的信息</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2VmempiMnBuMHQucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<h3><strong>10. Git 的常用操作</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2k1azA4Nm04bWgucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<blockquote>\r\n<p>Clone：拷贝远程仓库 Commit：本地提交 Push：远程提交 Pull：更新到本地</p>\r\n</blockquote>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h3><strong>11. 没有使用 Git 时本地历史记录的查看</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2U1cnlhMnp6dWMucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>即使我们项目没有使用版本控制功能，IntelliJ IDEA 也给我们提供了本地文件历史记录。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L3V6dng4YndjZHYucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<h2><strong>十一、断点调试</strong></h2>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h3><strong>1. Debug 的设置</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L25uNHN4NDlucnUucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>设置 Debug 连接方式，默认是 Socket。Shared memory 是 Windows 特有的一个属性，一般在 Windows 系统下建议使用此设置，内存占用相对较少。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h3><strong>2. 常用断点调试快捷键</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1LzNlOWN1Z2VxZm8ucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>对于常用的 Debug 的快捷键，需要大家熟练掌握。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1LzlneXQ0ZzlwaTIucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<h3><strong>3. 条件断点</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>说明： &emsp;&emsp;调试的时候，在循环里增加条件判断，可以极大的提高效率，心情也能愉悦。 具体操作： &emsp;&emsp;在断点处右击跳出条件断点。可以在满足某个条件下，实施断点。 查看表达式的值(Ctrl + u)： &emsp;&emsp;选择行，Ctrl + u。还可以在查看框中输入编写代码时的其他方法：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L29qNXRxaGR6bTEucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<h2><strong>十二、配置 Maven</strong></h2>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h3><strong>1. Maven 的介绍</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>Make -&gt; Ant -&gt; Maven -&gt; Gradle</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<blockquote>\r\n<p>Maven 是 Apache 提供的一款自动化构建工具，用于自动化构建和依赖管理。开发团队基本不用花多少时间就能自动完成工程的基础构建配置，因为 Maven 使用了一个标准的目录结构和一个默认的构建生命周期。在如下环节中，Maven 使得开发者工作变得更简单。</p>\r\n</blockquote>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>构建环节：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L3E2M2kyaTQzZXYucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>详解如下：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<ul>\r\n	<li>清理：表示在编译代码前将之前生成的内容删除</li>\r\n	<li>编译：将源代码编译为字节码</li>\r\n	<li>测试：运行单元测试用例程序</li>\r\n	<li>报告：测试程序的结果</li>\r\n	<li>打包：将 java 项目打成 jar 包；将 Web 项目打成 war 包</li>\r\n	<li>安装：将 jar 或 war 生成到 Maven 仓库中</li>\r\n	<li>部署：将 jar 或 war 从 Maven 仓库中部署到 Web 服务器上运行</li>\r\n</ul>\r\n\r\n<h3><strong>2. Maven 的配置</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<blockquote>\r\n<p>maven 的下载 &ndash; 解压 &ndash; 环境变量的配置这里就赘述了，需要的参考 1-课件中的《Maven 的配置》。下面直接整合 Maven。选择自己 Maven 的目录，和 settings 文件，然后配置自己的仓库 reposiroty。</p>\r\n</blockquote>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<ul>\r\n	<li>Maven 的核心程序并不包含具体功能，仅负责宏观调度。具体功能由插件来完成。</li>\r\n	<li>Maven 核心程序会到本地仓库中查找插件。</li>\r\n	<li>如果本地仓库中没有就会从远程中央仓库下载。</li>\r\n	<li>此时如果不能上网则无法执行 Maven 的具体功能。</li>\r\n</ul>\r\n\r\n<p>为了解决这个问题，我们可以将 Maven 的本地仓库指向一个在联网情况下下载好的目录。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1LzN4bTVocjB3ZDAucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<blockquote>\r\n<p>&nbsp;</p>\r\n</blockquote>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<ul>\r\n	<li>Maven home directory：可以指定本地 Maven 的安装目录所在，因为我已经配置了 MAVEN_HOME 系统参数，所以直接这样配置 IntelliJ IDEA 是可以找到的。但是假如你没有配置的话，这里可以选择你的 Maven 安装目录。此外，这里不建议使用 IDEA 默认的。</li>\r\n	<li>User settings file / Local repository：我们还可以指定 Maven 的 settings.xml 位置和本地仓库位置。</li>\r\n</ul>\r\n\r\n<p>settings.xml文件修改的地方： 1、本地仓库地址</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1Lzl6cWp5OWhpNmMucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>2、远程仓库地址</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1LzV0cm0wa292bXEucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>settings.xml文件修改的内容如下：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<pre>\r\n<code>......\r\n    &lt;localRepository&gt;D:\\learn\\Maven\\repository-idea&lt;/localRepository&gt;\r\n......\r\n    &lt;!-- 阿里云的远程仓库 --&gt;\r\n    &lt;mirror&gt;\r\n        &lt;id&gt;alimaven&lt;/id&gt;\r\n        &lt;name&gt;aliyun maven&lt;/name&gt;\r\n        &lt;url&gt;http://maven.aliyun.com/nexus/content/groups/public/&lt;/url&gt;\r\n        &lt;mirrorOf&gt;central&lt;/mirrorOf&gt;\r\n    &lt;/mirror&gt;\r\n    &lt;!-- maven官方运维的2号远程仓库 --&gt;\r\n    &lt;mirror&gt;\r\n        &lt;id&gt;repo2&lt;/id&gt;\r\n        &lt;name&gt;rep2 maven&lt;/name&gt;\r\n        &lt;url&gt;http://repo2.maven.org/maven2/&lt;/url&gt;\r\n        &lt;mirrorOf&gt;central&lt;/mirrorOf&gt;\r\n    &lt;/mirror&gt;\r\n......</code></pre>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>Maven -&gt; Importing</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2h1dDl2bWZ4MXYucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<blockquote>\r\n<p>&nbsp;</p>\r\n</blockquote>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<ul>\r\n	<li>Import Maven projects automatically：表示 IntelliJ IDEA 会实时监控项目的 pom.xml 文件，进行项目变动设置，<code>建议勾选</code>。</li>\r\n	<li>Automatically download：在 Maven 导入依赖包的时候是否自动下载源码和文档。默认是没有勾选的，也<code>不建议勾选</code>，原因是这样可以加快项目从外网导入依赖包的速度，如果我们需要源码和文档的时候我们到时候再针对某个依赖包进行联网下载即可。IntelliJ IDEA 支持直接从公网下载源码和文档的。</li>\r\n	<li>VM options for importer：可以设置导入的 VM 参数。<code>一般这个都不需要主动改</code>，除非项目真的导入太慢了我们再增大此参数。</li>\r\n</ul>\r\n\r\n<h3><strong>3. 演示使用Maven</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>创建对应的 Module</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2pvaGxmMzRyeHYucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>选择Spring Boot 的模板 Spring Initializr</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2xtdnk4ZGkwOWgucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>举例：此时 Spring Initalizr 是 springboot 工程的模板。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1LzRpZGYwbTZvcWYucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>Group：组织或公司域名，倒序 Artifact：项目模块名称 Version：默认 maven 生成版本：0.0.1-SNAPSHOT</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2IxbGpiY2VuNGUucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>这里可以暂时先不选，后面开发需要了再进行设置。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L3Mya2RyazRjd3gucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>点击【finish】 即可完成创建。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2o5MHhieGljZG8ucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>创建完成以后，可以在 IDEA 右边看到创建的 Module。如果没有，可以刷新一下。目录下也会有对应的生命周期。其中常用的是：clean、compile、package、install。比如这里install，如果其他项目需要将这里的模块作为依赖使用，那就可以install。安装到本地仓库的位置。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2dicXlxYnZqZDkucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>本地仓库中的文件截图：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2VwZHdqOXY1d2YucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>其他操作这里不再赘述。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h2><strong>十三、其它设置</strong></h2>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h3><strong>1.生成 javadoc</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2tlZmoycDNrcWIucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>填写生成javadoc的项目或者模块、输出位置、语言、编码等</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1LzY1YzQ5OHRib28ucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>Locale：输入语言类型：zh_CN Other command line arguments：-encoding UTF-8 -charset UTF-8 出现错误：未知标记：date 如下图：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1LzFsaW5hZXVpZGwucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>解决方法: Other command line arguments：-encoding UTF-8 -charset UTF-8 -tag date:a:&quot;date&quot;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h3><strong>2. 缓存和索引的清理</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<blockquote>\r\n<p>&nbsp;</p>\r\n</blockquote>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<ul>\r\n	<li><code>IntelliJ IDEA 首次加载项目的时候，都会创建索引</code>，而创建索引的时间跟项目的文件多少成正比。在 IntelliJ IDEA 创建索引过程中即使你编辑了代码也是编译不了、运行不起来的，所以还是安安静静等 IntelliJ IDEA 创建索引完成。</li>\r\n	<li><code>IntelliJ IDEA 的缓存和索引主要是用来加快文件查询，从而加快各种查找、代码提示等操作的速度</code>，所以 IntelliJ IDEA 的索引的重要性再强调一次也不为过。但是，IntelliJ IDEA 的索引和缓存并不是一直会良好地支持 IntelliJ IDEA 的，某些特殊条件下，IntelliJ IDEA 的缓存和索引文件也是会损坏的，比如：断电、蓝屏引起的强制关机，当你重新打开 IntelliJ IDEA，很可能 IntelliJ IDEA 会报 各种莫名其妙错误，甚至项目打不开，IntelliJ IDEA 主题还原成默认状态。即使没有断电、蓝屏，也会有莫名奇怪的问题的时候，也很有可能是 IntelliJ IDEA 缓 存和索引出现了问题，这种情况还不少。遇到此类问题也不用过多担心。我们可以清理缓存和索引。如下：</li>\r\n</ul>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L3pwNHUwY2E4c2gucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>点击第一个按钮</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2lvejR6ZjZ2bW8ucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<blockquote>\r\n<p>&nbsp;</p>\r\n</blockquote>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<ul>\r\n	<li>一般建议点击 Invalidate and Restart，这样会比较干净。</li>\r\n	<li>上图警告：清除索引和缓存会使得 IntelliJ IDEA 的 Local History 丢失。所以如果你项目没有加入到版本控制，而你又需要你项目文件的历史更改记录，那你最好备份下你的 LocalHistory 目录。 目录地址在：C:\\Users\\当前登录的系统用户名.IntelliJIdea14\\system\\LocalHistory 建议使用硬盘的全文搜索，这样效率更高。</li>\r\n	<li>通过上面方式清除缓存、索引本质也就是去删除 C 盘下的 system 目录下的对应的文件而已，所以如果你不用上述方法也可以删除整个 system。当 IntelliJ IDEA 再次启动项目的时候会重新创建新的 system 目录以及对应项目缓存和索引。</li>\r\n</ul>\r\n\r\n<h3><strong>3. 取消更新</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>取消勾选：即可取消更新</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1LzNsaTJ2azl1bWsucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<h3><strong>4. 插件的使用</strong></h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>在 IntelliJ IDEA 的安装讲解中我们其实已经知道，IntelliJ IDEA 本身很多功能也都是通过插件的方式来实现的。 官网插件库：<a href=\"https://plugins.jetbrains.com/\">https://plugins.jetbrains.com/</a></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2I2ankxd3d5dG4ucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>在IDEA中是打开Settings</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2ZscHRvYXh5aXEucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>需要特别注意的是：在国内的网络下，经常出现显示不了插件列表，或是显示了插件列表，无法下载完成安装。这时候请自行打开 V**，一般都可以得到解决。 演示安装GsonFormat</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2sxd2YxMnBrOWMucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>如下图演示，在线安装 IntelliJ IDEA 插件库中的插件。安装完以后会提示重启，才可以使用插件。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L2FzOXk4cjU5Z2EucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>常用插件推荐：</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS0zNTQxMTM1L3pydWd0cm5jdHkucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<h2><strong>十四、资料附录</strong></h2>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>　　最新尚硅谷Java开发利器：IntelliJ IDEA的安装、配置与使用 　　链接：<a href=\"https://pan.baidu.coms/11biVBv9EI9yfL6Cee0r0LQ\">https://pan.baidu.coms/11biVBv9EI9yfL6Cee0r0LQ</a> 密码：n7hn</p>',
        '', '2019-11-20 03:05:00', '2019-11-20 03:06:00', 813, 1, 10, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (48, '让键盘变成你想要的样子：改键利器 Karabiner-Elements',
        '<p>随着年度作者颁奖典礼的结，几位最佳作者已经陆陆续续拿到了我派定制键盘，但是一个比较糟心的问题随之而来：</p>\r\n\r\n<blockquote>\r\n<p>我的电脑是 Mac，收到的键盘是 Windows 布局的，有些用不惯。</p>\r\n</blockquote>\r\n\r\n<p>要知道，键盘之于男生就像口红之于女士，我们很难得到一块完全满足自己期待的键盘。</p>\r\n\r\n<p>由于 Mac 的键盘和主流布局不一致，许多人都会遇到外接键盘布局不适应的情况；即便是 MacBook 的内置键盘，也有人觉得其设计不够合理，不符合自己的工作习惯。好在键盘和使用者之间是可以磨合的，<a href=\"https://github.com/tekezo/Karabiner-Elements/releases\">Karabiner-Elements</a>&nbsp;就是 Mac 上一款非常好用的开源改键利器，能让键盘顺着你的意愿来工作。</p>\r\n\r\n<h2>简单修改：把闲置按 键利用起来</h2>\r\n\r\n<p>你可能听说过 Karabiner，它是 Karabiner-Elements 的前身，不过在最新的系统中已经失效了。现在，请使用 Karabiner-Elements。</p>\r\n\r\n<p><strong>在&nbsp;<a href=\"https://pqrs.org/osx/karabiner/\">官网</a>&nbsp;下载安装之后</strong>，你可以看到 Karabiner-Elements 最基础的功能（Simple Modifications）：改<strong>按键映射</strong>。比如说我平时用不到的&nbsp;<code>Fn</code>&nbsp;键，就被强征过来当作删除键，这样我就不必频频翘起兰花指去按&nbsp;<code>⌫Delete</code>&nbsp;键了。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"null\" class=\"has\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9jZG4uc3NwYWkuY29tL21pbmphLzIwMTgtMDEtMjAtU2NyZWVuJTIwU2hvdCUyMDIwMTgtMDEtMjAlMjBhdCUyMDIwLjU0LjI2LWZzOC5wbmc?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>自己定义一条按键映射非常简单，用&nbsp;<code>fn to delete_or_backspace</code>&nbsp;这样顺序来设置，就表示把前一颗按键当作后者来使用。我习惯左手操控修饰键（<code>⇧Shift</code>、<code>⌘Command</code>&nbsp;这些键），所以就把利用率较低的右侧按键另行设置了一些功能，代替那些边边角角的按键。</p>\r\n\r\n<p>对于使用笔记本内置键盘的用户来说，修改键盘映射多少有悖直觉，明明按键上写了&nbsp;<code>Fn</code>，按下去居然会删掉刚刚打的字，这种键盘标识和实际功能割裂的状况并不好受；但是外接键盘（尤其是机械键盘）可以自己更换键帽，达到功能和显示的统一，用起来就很舒服了。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"null\" class=\"has\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9jZG4uc3NwYWkuY29tL21pbmphLzIwMTgtMDEtMjAtbmV3LUlNR18wODYxLmpwZw?x-oss-process=image/format,png\" style=\"width:500px\" /></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>同样在折腾新键盘的 elijahlee 还提到 Mac 用户的一个特殊需求：这键盘默认情况下右侧没有能实现「Command 」功能的键，即使通过「Fn+Win+Ctrl」切换成 Mac 模式，也没法单手按下「⌘Command+P」这类快捷键。于是我把右侧的「Alt」键换成了「Command」键的功能，让右手单手操作快捷键时更方便。值得一提的是，这块 iQunix 的键盘（<a href=\"https://sspai.com/post/41495\">测评戳这里</a>）有一处可圈可点的设计，纵使我把右侧功能键的功能改了，它们还是可以实现方向键的作用，喜欢 iQunix 默认方向键的人也能大胆修改键位。</p>\r\n\r\n<h2>功能键也不要浪费</h2>\r\n\r\n<p>对我来说，整个 Mac 键盘上用得最少的地方就是顶部的功能键，除了静音键外我几乎都不曾按过。这样放着很可惜，可以用 Karabiner-Elements 把其他键利用起来。我把&nbsp;<code>F1</code>、<code>F2</code>&nbsp;键全都设置为静音键，这样在需要和别人交谈时就不用在小喇叭三胞胎里举棋不定，左手往正上方一伸、「啪」地一按，就是关掉声音，尽显对他人的尊重。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"null\" class=\"has\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9jZG4uc3NwYWkuY29tL21pbmphLzIwMTgtMDEtMjAtU2NyZWVuJTIwU2hvdCUyMDIwMTgtMDEtMTclMjBhdCUyMDIxLjM0LjI0LWZzOC5wbmc?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h2>复杂修改：让方向键更顺手</h2>\r\n\r\n<p>在拿到少数派键盘之前，我就习惯了用 Karabiner-Elements 打造 Vim 风格的方向键。也许你对这个词感到陌生，还会奇怪，干嘛放着 MacBook 上好好的方向键不用？其实，Mac 自带键盘的方向键位于右下角，打字时把爪子挪过去点很不方便，而 Vim 式的操作中，可以挪用&nbsp;<code>HJKL</code>&nbsp;四枚按键，调教一下充当方向键，打字时手掌都不用抬起，就能实现光标的移动，很快捷。</p>\r\n\r\n<p>Karabiner-Elements 里自带了 Vim 风格的方向键，在「Complex Modifications（复杂修改）」中可以把右侧的&nbsp;<code>⌘Command</code>&nbsp;键和&nbsp;<code>HJKL</code>&nbsp;四大金刚组合起来，达到更快捷的光标移动效果。如果这组设计让你觉得硌手，那么&nbsp;<a href=\"https://pqrs.org/osx/karabiner/complex_modifications/#modifier-keys\">官方</a>&nbsp;还有更多的键位可供选择。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"null\" class=\"has\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9jZG4uc3NwYWkuY29tL21pbmphLzIwMTgtMDEtMjAtR3JvdXAucG5n?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>Complex Modifications 还能自己编写（具体方法这里不展开），也许有人会喜欢图示那组&nbsp;<code>WASD</code>&nbsp;版本的方向键 :D。少数派寄来的键盘是 60% 布局，虽然能通过&nbsp;<code>Fn</code>&nbsp;键和右下角的几颗键组合来实现方向键功能，但我还是更喜欢 Vim 布局，此时 Karabiner-Elements 就派上用场。</p>\r\n\r\n<h2>多键盘，多模式</h2>\r\n\r\n<p>看到 Karabiner-Elements 巨细靡遗的细节设计，心思缜密的读者就会考虑：一块键盘尚且能应付，如果我工作中使用多块键盘，岂不是用了 Karabiner-Elements 会造成混乱？其实在 Devices 设置中，你可以添加多个键盘，而简单修改和复杂修改都是可以针对内置、外接不同键盘运用不同规则的。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"null\" class=\"has\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9jZG4uc3NwYWkuY29tL21pbmphLzIwMTgtMDEtMjAtU2NyZWVuJTIwU2hvdCUyMDIwMTgtMDEtMjAlMjBhdCUyMDIwLjUxLjI0LWZzOC5wbmc?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>我收到的新键盘和 MacBook 自带键盘布局差异很大，所以我会先选定 Target Devices（目标设备），防止它们用了对方的设置自弹自唱不受控制。</p>\r\n\r\n<p>不过在实际使用中，比要管理多块键盘更麻烦的，就是要应付多种场景。打字时我需要快捷短促的 Vim 模式，绘图时希望用一颗&nbsp;<code>Fn</code>&nbsp;代替原来的四颗组合键从而防止手指打结，玩游戏时则会偷偷模拟原先复杂的出招键位&mdash;&mdash;就像敲下核武器按钮，屏幕那一端的人还在苦思出招表，我已经放出了绝招（此举将时游戏趣味大打折扣，慎用）。</p>\r\n\r\n<p>Karabiner-Elements 允许你设置多个 Profile（配置），每个 Profile 里可以有不同的键位，从而适应各异的任务。<strong>点击菜单栏图标还能快速切换配置文件，非常方便。</strong></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"null\" class=\"has\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9jZG4uc3NwYWkuY29tL21pbmphLzIwMTgtMDEtMjAtU2NyZWVuJTIwU2hvdCUyMDIwMTgtMDEtMTclMjBhdCUyMDIxLjQzLjU1LnBuZw?x-oss-process=image/format,png\" style=\"width:300px\" /></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h2>小结</h2>\r\n\r\n<p>实体键盘是一种非常好的交互方式，快捷键、按键的反馈，都是触摸屏难以带来的。但是实体键盘固定的形态也在一定程度上限制其发挥，一个样式无法满足所有人的需求。此时，我们就可以用 Karabiner-Elements 这样的改键工具来让键盘更符合个人的使用习惯。</p>\r\n\r\n<p>在一些键盘发烧友的圈子里，「可编程键盘」大受欢迎，它们自定义的程度就更高了。不过对于多数没有这些设备、或者不想花大力气定制键盘的人来说，Karabiner-Elements 仍然是一件更容易使用的工具</p>',
        '', '2020-02-20 08:30:00', '2020-02-20 08:30:00', 98, 1, 4, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (49, 'win10 开启ssh server服务 远程登录',
        '<h1>开启SSH</h1>\r\n\r\n<h2>安装openssh</h2>\r\n\r\n<ul>\r\n	<li>设置-应用-应用和功能-管理可选功能-添加功能<br />\r\n	安装OpenSSH服务器和客户端</li>\r\n</ul>\r\n\r\n<p><img alt=\"\" class=\"has\" data-widget=\"image\" src=\"https://img-blog.csdnimg.cn/20190510172903432.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:328px; width:426px\" /></p>\r\n\r\n<p><strong>选择: 应用&nbsp;</strong></p>\r\n\r\n<p><img alt=\"\" class=\"has\" data-widget=\"image\" src=\"https://img-blog.csdnimg.cn/20190510172938346.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:384px; width:600px\" /></p>\r\n\r\n<p><img alt=\"\" class=\"has\" data-widget=\"image\" src=\"https://img-blog.csdnimg.cn/20190510173018180.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:284px; width:400px\" /></p>\r\n\r\n<p>添加功能: 找到openssh 服务器&nbsp;</p>\r\n\r\n<p><img alt=\"\" class=\"has\" data-widget=\"image\" src=\"https://img-blog.csdnimg.cn/20190510173037355.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:225px; width:400px\" /></p>\r\n\r\n<h2>验证安装</h2>\r\n\r\n<p>在cmd界面输入<code>ssh</code>，验证客户端</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\">\r\n<code class=\"hljs\">ssh\r\nusage: ssh [-46AaCfGgKkMNnqsTtVvXxYy] [-b bind_address] [-c cipher_spec]\r\n           [-D [bind_address:]port] [-E log_file] [-e escape_char]\r\n           [-F configfile] [-I pkcs11] [-i identity_file]\r\n           [-J [user@]host[:port]] [-L address] [-l login_name] [-m mac_spec]\r\n           [-O ctl_cmd] [-o option] [-p port] [-Q query_option] [-R address]\r\n           [-S ctl_path] [-W host:port] [-w local_tun[:remote_tun]]\r\n           destination [command]\r\n</code></pre>\r\n</div>\r\n\r\n<h1>SSH服务</h1>\r\n\r\n<p>同样是命令行界面</p>\r\n\r\n<ul>\r\n	<li>启动SSH服务<code>net start sshd</code>\r\n\r\n	<div contenteditable=\"false\" tabindex=\"-1\">\r\n	<pre class=\"has\" data-widget=\"codeSnippet\">\r\n<code class=\"hljs\">net start sshd\r\nOpenSSH SSH Server 服务正在启动 .\r\nOpenSSH SSH Server 服务已经启动成功。</code></pre>\r\n	</div>\r\n	</li>\r\n</ul>\r\n\r\n<ul>\r\n	<li>停止SSH服务<code>net stop sshd</code></li>\r\n</ul>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\">\r\n<code class=\"hljs\">net stop sshd\r\nOpenSSH SSH Server 服务已成功停止。</code></pre>\r\n<img src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" /><span style=\"background-color:rgba(220,220,220,0.5)\"><img role=\"presentation\" src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" style=\"height:15px; width:15px\" title=\"点击并拖拽以移动\" /></span></div>\r\n\r\n<h1>远程SSH</h1>\r\n\r\n<p>自己百度会详细点，如果是本机请先<strong>开启SSH服务</strong>，大概如下<br />\r\n命令<code>ssh username@127.0.0.1</code>即<code>ssh 用户名@用户ip</code></p>\r\n\r\n<p>需要注意的是<strong>用户名和用户密码</strong>，我的用户名是用户C盘用户文件夹下的文件夹名系统自己指定的吧估计，用户密码我试了一下是微软账户的密码，我的微软账户密码也是我的系统密码，应该是系统密码。</p>\r\n\r\n<p>&nbsp;<img alt=\"\" class=\"has\" data-widget=\"image\" src=\"https://img-blog.csdnimg.cn/2019051017342731.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:269px; width:600px\" /></p>',
        '', '2020-01-02 08:42:00', '2020-01-02 08:43:00', 67, 1, 4, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (50, 'MySQL：if语句、if...else语句、case语句，使用方法解析',
        '<p><strong>if语句做为表达式使用，语法格式如下：</strong></p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\">\r\n<code class=\"language-sql hljs\">IF(expr1,expr2,expr3)</code></pre>\r\n</div>\r\n\r\n<p><strong>说明： &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</strong></p>\r\n\r\n<p>如果 expr1 是TRUE (expr1 &lt;&gt; 0 and expr1 &lt;&gt; NULL)，则 IF()的返回值为expr2; 否则返回值则为 expr3。IF() 的返回值为数字值或字符串值，具体情况视其所在语境而定。</p>\r\n\r\n<p><strong>例子： &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</strong></p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\">\r\n<code class=\"language-sql hljs\"><span class=\"hljs-keyword\">select</span>&nbsp;*,<span class=\"hljs-keyword\">if</span>(age=<span class=\"hljs-number\">1</span>,<span class=\"hljs-string\">&quot;男&quot;</span>,<span class=\"hljs-string\">&quot;女&quot;</span>)&nbsp;<span class=\"hljs-keyword\">as</span>&nbsp;ages&nbsp;<span class=\"hljs-keyword\">from</span>&nbsp;<span class=\"hljs-keyword\">user</span>;\r\n</code></pre>\r\n</div>\r\n\r\n<p>当然如果作为表达式的话，if也可以用CASE when来实现的：</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\">\r\n<code class=\"language-sql hljs\"><span class=\"hljs-comment\">/*&nbsp;下面这个将输出：男&nbsp;*/</span>\r\n<span class=\"hljs-keyword\">SELECT</span>&nbsp;<span class=\"hljs-keyword\">CASE</span>&nbsp;<span class=\"hljs-number\">1</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\">WHEN</span>&nbsp;<span class=\"hljs-number\">1</span>&nbsp;<span class=\"hljs-keyword\">THEN</span>&nbsp;<span class=\"hljs-string\">&#39;男&#39;</span>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\">WHEN</span>&nbsp;<span class=\"hljs-number\">2</span>&nbsp;<span class=\"hljs-keyword\">THEN</span>&nbsp;<span class=\"hljs-string\">&#39;女&#39;</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\">ELSE</span>&nbsp;<span class=\"hljs-string\">&#39;未知&#39;</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\">END</span>\r\n<span class=\"hljs-keyword\">as</span>&nbsp;ages\r\n\r\n\r\n<span class=\"hljs-comment\">/*&nbsp;下面这个将输出：女&nbsp;*/</span>\r\n<span class=\"hljs-keyword\">SELECT</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\">CASE</span>&nbsp;<span class=\"hljs-number\">2</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\">WHEN</span>&nbsp;<span class=\"hljs-number\">1</span>&nbsp;<span class=\"hljs-keyword\">THEN</span>&nbsp;<span class=\"hljs-string\">&#39;男&#39;</span>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\">WHEN</span>&nbsp;<span class=\"hljs-number\">2</span>&nbsp;<span class=\"hljs-keyword\">THEN</span>&nbsp;<span class=\"hljs-string\">&#39;女&#39;</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\">ELSE</span>&nbsp;<span class=\"hljs-string\">&#39;未知&#39;</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\">END</span>\r\n<span class=\"hljs-keyword\">as</span>&nbsp;ages\r\n\r\n\r\n\r\n<span class=\"hljs-comment\">/*&nbsp;下面这个将输出：未知&nbsp;*/</span>\r\n<span class=\"hljs-keyword\">SELECT</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\">CASE</span>&nbsp;<span class=\"hljs-number\">3</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\">WHEN</span>&nbsp;<span class=\"hljs-number\">1</span>&nbsp;<span class=\"hljs-keyword\">THEN</span>&nbsp;<span class=\"hljs-string\">&#39;男&#39;</span>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\">WHEN</span>&nbsp;<span class=\"hljs-number\">2</span>&nbsp;<span class=\"hljs-keyword\">THEN</span>&nbsp;<span class=\"hljs-string\">&#39;女&#39;</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\">ELSE</span>&nbsp;<span class=\"hljs-string\">&#39;未知&#39;</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\">END</span>\r\n<span class=\"hljs-keyword\">as</span>&nbsp;ages\r\n\r\n\r\n\r\n<span class=\"hljs-comment\">/*&nbsp;&nbsp;&nbsp;当然还有一种写法&nbsp;&nbsp;输出：未知&nbsp;*/</span>\r\n<span class=\"hljs-keyword\">SELECT</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\">CASE</span>&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\">WHEN</span>&nbsp;<span class=\"hljs-number\">3</span>=<span class=\"hljs-number\">1</span>&nbsp;<span class=\"hljs-keyword\">THEN</span>&nbsp;<span class=\"hljs-string\">&#39;男&#39;</span>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\">WHEN</span>&nbsp;<span class=\"hljs-number\">3</span>=<span class=\"hljs-number\">2</span>&nbsp;<span class=\"hljs-keyword\">THEN</span>&nbsp;<span class=\"hljs-string\">&#39;女&#39;</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\">ELSE</span>&nbsp;<span class=\"hljs-string\">&#39;未知&#39;</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\">END</span>\r\n<span class=\"hljs-keyword\">as</span>&nbsp;ages\r\n\r\n\r\n\r\n<span class=\"hljs-keyword\">SELECT</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\">CASE</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\">WHEN</span>&nbsp;<span class=\"hljs-number\">3</span>=<span class=\"hljs-number\">1</span>&nbsp;<span class=\"hljs-keyword\">THEN</span>&nbsp;<span class=\"hljs-string\">&#39;男&#39;</span>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\">WHEN</span>&nbsp;<span class=\"hljs-number\">3</span>=<span class=\"hljs-number\">2</span>&nbsp;<span class=\"hljs-keyword\">THEN</span>&nbsp;<span class=\"hljs-string\">&#39;女&#39;</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;    <span class=\"hljs-keyword\">WHEN</span>&nbsp;(<span class=\"hljs-number\">3</span>=<span class=\"hljs-number\">4</span>&nbsp;||&nbsp;<span class=\"hljs-number\">3</span>!=<span class=\"hljs-literal\">null</span>)&nbsp;<span class=\"hljs-keyword\">THEN</span>&nbsp;<span class=\"hljs-string\">&#39;测试&#39;</span>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\">ELSE</span>&nbsp;<span class=\"hljs-string\">&#39;未知&#39;</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\">END</span>\r\n<span class=\"hljs-keyword\">as</span>&nbsp;ages</code></pre>\r\n</div>\r\n\r\n<p>从上面的例子我们可以看出得很明白了，case后面的值=when后台的值，然后就会输出when后面跟的then后的值。如果都不等行的话，就输出else后的值。</p>\r\n\r\n<p><strong>IF...ELSE...做为流程控制语句使用，语法格式如下：</strong></p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\">\r\n<code class=\"language-sql hljs\">IF&nbsp;search_condition&nbsp;THEN&nbsp;\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;statement_list&nbsp;&nbsp;\r\n\r\n[ELSEIF&nbsp;search_condition&nbsp;THEN]&nbsp;&nbsp;\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;statement_list&nbsp;...&nbsp;&nbsp;\r\n\r\n[ELSE&nbsp;\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;statement_list]&nbsp;&nbsp;\r\n\r\n<span class=\"hljs-keyword\">END</span>&nbsp;<span class=\"hljs-keyword\">IF</span></code></pre>\r\n</div>\r\n\r\n<p><strong>说明： &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</strong></p>\r\n\r\n<p>与PHP中的IF语句类似</p>\r\n\r\n<p>当IF中条件search_condition成立时，执行THEN后的statement_list语句、</p>\r\n\r\n<p>否则判断ELSEIF中的条件成立时，执行其后的statement_list语句、</p>\r\n\r\n<p>否则继续判断其他分支。</p>\r\n\r\n<p>当所有分支的条件均不成立时，执行ELSE分支。</p>\r\n\r\n<p>search_condition是一个条件表达式，可以由&ldquo;=、&lt;、&lt;=、&gt;、&gt;=、!=&rdquo;等条件运算符组成，并且可以使用AND、OR、NOT对多个表达式进行组合。</p>\r\n\r\n<p><strong>例子： &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</strong></p>\r\n\r\n<p>建立一个存储过程，该存储过程通过学生学号（student_no）和课程编号（course_no）查询其成绩（grade），返回成绩和成绩的等级，成绩大于90分的为A级，小于90分大于等于80分的为B级，小于80分大于等于70分的为C级，依次到E级</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\">\r\n<code class=\"language-sql hljs\">create&nbsp;procedure&nbsp;dbname.proc_getGrade&nbsp;&nbsp;\r\n\r\n(stu_no&nbsp;varchar(20),cour_no&nbsp;varchar(10))&nbsp;&nbsp;\r\n\r\nBEGIN&nbsp;\r\n\r\ndeclare&nbsp;stu_grade&nbsp;float;&nbsp;&nbsp;\r\n\r\nselect&nbsp;grade&nbsp;into&nbsp;stu_grade&nbsp;from&nbsp;grade&nbsp;where&nbsp;student_no=stu_no&nbsp;and&nbsp;course_no=cour_no;&nbsp;&nbsp;\r\n\r\nif&nbsp;stu_grade&gt;=90&nbsp;then&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;stu_grade,&#39;A&#39;;&nbsp;&nbsp;\r\nelseif&nbsp;stu_grade&lt;90&nbsp;and&nbsp;stu_grade&gt;=80&nbsp;then&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;stu_grade,&#39;B&#39;;&nbsp;&nbsp;\r\nelseif&nbsp;stu_grade&lt;80&nbsp;and&nbsp;stu_grade&gt;=70&nbsp;then&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;stu_grade,&#39;C&#39;;&nbsp;&nbsp;\r\nelseif&nbsp;stu_grade70&nbsp;and&nbsp;stu_grade&gt;=60&nbsp;then&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;stu_grade,&#39;D&#39;;&nbsp;&nbsp;\r\nelse&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;stu_grade,&#39;E&#39;;&nbsp;&nbsp;\r\nend&nbsp;if;&nbsp;&nbsp;\r\n\r\nEND</code></pre>\r\n<img src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" /><span style=\"background:url(&quot;http://chenyinren.top/root_static/ckeditor/ckeditor/plugins/widget/images/handle.png&quot;) rgba(220, 220, 220, 0.5); display:block; left:0px; top:-15px\"><img role=\"presentation\" src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" style=\"height:15px; width:15px\" title=\"点击并拖拽以移动\" /></span></div>\r\n\r\n<p><strong>注意：IF作为一条语句，在END IF后需要加上分号&ldquo;;&rdquo;以表示语句结束，其他语句如CASE、LOOP等也是相同的。</strong></p>',
        '', '2020-01-18 05:43:00', '2020-01-18 05:43:00', 71, 1, 1, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (51, 'Pandaral·lel 和Modi: 一行代码加快CPU环境下高效并行Pandas计算速度',
        '<h1><strong>Pandaral&middot;lel</strong></h1>\r\n\r\n<p>使用pandas，当您运行以下行时：</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\">\r\n<code class=\"language-python hljs\"><span class=\"hljs-comment\"># Standard apply</span>\r\n\r\ndf.apply(func)</code></pre>\r\n</div>\r\n\r\n<p>得到这个CPU使用率：</p>\r\n\r\n<p><img alt=\"\" class=\"has\" data-widget=\"image\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS01NjY5ODUxL3RyemQwd293NzEuZ2lm\" /></p>\r\n\r\n<p>标准pandas适用 - 仅使用1个CPU</p>\r\n\r\n<p>即使计算机有多个CPU，也只有一个完全专用于您的计算。</p>\r\n\r\n<p>而不是下边这种CPU使用，想要一个简单的方法来得到这样的东西：</p>\r\n\r\n<p><img alt=\"\" class=\"has\" data-widget=\"image\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS01NjY5ODUxLzBlNm00d2tmMHUuZ2lm\" /></p>\r\n\r\n<p>并行Pandas适用 - 使用所有CPU</p>\r\n\r\n<p><strong>Pandaral&middot;lel 如何帮助解决这个问题？</strong></p>\r\n\r\n<p><strong>Pandaral&middot;lel</strong> 的想法是将pandas计算分布在计算机上所有可用的CPU上，以显着提高速度。</p>\r\n\r\n<table border=\"1\" cellspacing=\"0\">\r\n	<thead>\r\n		<tr>\r\n			<th>没有并行化</th>\r\n			<th><img alt=\"æ²¡æPandarallel\" class=\"has\" data-widget=\"image\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9naXRodWIuY29tL25hbGVwYWUvcGFuZGFyYWxsZWwvcmF3L21hc3Rlci9kb2NzL3Byb2dyZXNzX2FwcGx5LmdpZg\" /></th>\r\n		</tr>\r\n	</thead>\r\n	<tbody>\r\n		<tr>\r\n			<td><strong>通过并行化</strong></td>\r\n			<td><img alt=\"\" class=\"has\" data-widget=\"image\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS01NjY5ODUxL3oyajR3enl0NDkuZ2lm\" /><img alt=\"\" class=\"has\" data-widget=\"image\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hc2sucWNsb3VkaW1nLmNvbS9odHRwLXNhdmUveWVoZS01NjY5ODUxL3oyajR3enl0NDkuZ2lm\" /></td>\r\n		</tr>\r\n	</tbody>\r\n</table>\r\n\r\n<h2><strong>安装</strong></h2>\r\n\r\n<p><code>pip install pandarallel</code></p>\r\n\r\n<h2><strong>要求</strong></h2>\r\n\r\n<ul>\r\n	<li>Linux或macOS（目前不支持Windows）</li>\r\n</ul>\r\n\r\n<h2><strong>警告</strong></h2>\r\n\r\n<ul>\r\n	<li>并行化有成本（实现新进程，通过共享内存发送数据等等），因此只有并行化的计算量足够高时，并行化才有效。对于非常少量的数据，使用并行并不总是值得的。</li>\r\n</ul>\r\n\r\n<h2><strong>例子</strong></h2>\r\n\r\n<p><a href=\"https://github.com/nalepae/pandarallel/blob/master/docs/examples.ipynb\">此处</a>提供了每个API的示例。</p>\r\n\r\n<h2><strong>基准</strong></h2>\r\n\r\n<p>对于<a href=\"https://github.com/nalepae/pandarallel/blob/master/docs/examples.ipynb\">一些例子</a>，这里是使用和不使用Pandaral&middot;lel的比较基准。</p>\r\n\r\n<p>用于此基准的计算机：</p>\r\n\r\n<ul>\r\n	<li>操作系统：Linux Ubuntu 16.04</li>\r\n	<li>硬件：Intel Core i7 @ 3.40 GHz - 4核</li>\r\n</ul>\r\n\r\n<p><a data-widget=\"image\" href=\"https://github.com/nalepae/pandarallel/blob/3d470139d409fc2cf61bab085298011fefe638c0/docs/standard_vs_parallel_4_cores.png\"><img alt=\"基准\" class=\"has\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9naXRodWIuY29tL25hbGVwYWUvcGFuZGFyYWxsZWwvcmF3LzNkNDcwMTM5ZDQwOWZjMmNmNjFiYWIwODUyOTgwMTFmZWZlNjM4YzAvZG9jcy9zdGFuZGFyZF92c19wYXJhbGxlbF80X2NvcmVzLnBuZw\" style=\"height:425px; width:800px\" /></a></p>\r\n\r\n<p>对于那些给出的示例，并行操作比标准操作快大约快4倍（除了<code>series.map</code>运行速度仅快3.2倍）。</p>\r\n\r\n<h2><strong>API</strong></h2>\r\n\r\n<p>首先，你必须导入<code>pandarallel</code>：</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\" style=\"margin-left:0px\">\r\n<code class=\"language-hljs language-python hljs\"><span class=\"hljs-keyword\">import</span> pandarallel</code></pre>\r\n</div>\r\n\r\n<p>然后，您必须初始化它。</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\" style=\"margin-left:0px\">\r\n<code class=\"language-python hljs\">pandarallel.initialize()</code></pre>\r\n</div>\r\n\r\n<p>此方法需要4个可选参数：</p>\r\n\r\n<ul>\r\n	<li><code>shm_size_mb</code>：Pandarallel共享内存的大小（MB）。如果默认值太小，则可以设置较大的值。默认情况下，它设置为2 GB。（INT）</li>\r\n	<li><code>nb_workers</code>：工人数量。默认情况下，它设置为操作系统看到的核心数。（INT）</li>\r\n	<li><code>progress_bar</code>：将其设置<code>True</code>为显示进度条。</li>\r\n	<li><code>verbose</code>：详细程度。&gt; 1显示所有日志 - 1，仅显示初始化日志 - &lt;1显示无日志（int）</li>\r\n</ul>\r\n\r\n<p><strong>警告</strong>：进度条是一项实验性功能。这可能导致相当大的性能损失。不适用于<code>DataFrameGroupy.parallel_apply</code>。</p>\r\n\r\n<p>使用<code>df</code>pandas DataFrame，<code>series</code>pandas Series，<code>func</code>应用/ map的函数<code>args1</code>，<code>args2</code>一些参数和<code>col_name</code>列名：</p>\r\n\r\n<table border=\"1\" cellspacing=\"0\">\r\n	<thead>\r\n		<tr>\r\n			<th>没有并行化</th>\r\n			<th>通过并行化</th>\r\n		</tr>\r\n	</thead>\r\n	<tbody>\r\n		<tr>\r\n			<td><code>df.apply(func)</code></td>\r\n			<td><code>df.parallel_apply(func)</code></td>\r\n		</tr>\r\n		<tr>\r\n			<td><code>df.applymap(func)</code></td>\r\n			<td><code>df.parallel_applymap(func)</code></td>\r\n		</tr>\r\n		<tr>\r\n			<td><code>df.groupby(args).apply(func)</code></td>\r\n			<td><code>df.groupby(args).parallel_apply(func)</code></td>\r\n		</tr>\r\n		<tr>\r\n			<td><code>df.groupby(args1).col_name.rolling(args2).apply(func)</code></td>\r\n			<td><code>df.groupby(args1).col_name.rolling(args2).parallel_apply(func)</code></td>\r\n		</tr>\r\n		<tr>\r\n			<td><code>series.map(func)</code></td>\r\n			<td><code>series.parallel_map(func)</code></td>\r\n		</tr>\r\n		<tr>\r\n			<td><code>series.apply(func)</code></td>\r\n			<td><code>series.parallel_apply(func)</code></td>\r\n		</tr>\r\n		<tr>\r\n			<td><code>series.rolling(args).apply(func)</code></td>\r\n			<td><code>series.rolling(args).parallel_apply(func)</code></td>\r\n		</tr>\r\n	</tbody>\r\n</table>\r\n\r\n<p>您将<a href=\"https://github.com/nalepae/pandarallel/blob/master/docs/examples.ipynb\">在此处</a>找到此表的每一行的完整示例。</p>\r\n\r\n<h2><strong>故障排除</strong></h2>\r\n\r\n<p><em>我有8个CPU，但<code>parallel_apply</code>加速计算只有大约x4。为什么？</em></p>\r\n\r\n<p>实际上<strong>Pandarallel</strong>只能加速计算，直到计算机拥有的<strong>内核</strong>数量为止。最近的大多数CPU（如Intel core-i7）都使用超线程。例如，4核超线程CPU将向操作系统显示8个CPU，但<strong>实际上</strong>只有4个物理计算单元。</p>\r\n\r\n<p>在<strong>Ubuntu上</strong>，您可以获得核心数量<code>$ grep -m 1 &#39;cpu cores&#39; /proc/cpuinfo</code>。</p>\r\n\r\n<p><em>当我跑步时<code>from pandarallel import pandarallel</code>，我明白了<code>ModuleNotFoundError: No module named &#39;pyarrow._plasma</code>。为什么？</em></p>\r\n\r\n<p>你在使用Windows吗？<strong>Pandarallel</strong>依靠<strong>Pyarrow Plasma</strong>共享内存来工作。目前，<strong>Pyarrow Plasma</strong>仅适用于Linux和macOS（不支持Windows）。很抱歉，但目前<strong>Pandarallel</strong>仅支持Linux和macOS ......</p>\r\n\r\n<p><a href=\"https://python.ctolib.com/nalepae-pandarallel.html\">Pandaral&middot;lel：在多CPU环境简单高效并行运行Pandas</a></p>\r\n\r\n<p><a href=\"https://github.com/nalepae/pandarallel\">Pandaral&middot;lel :github</a></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<hr />\r\n<h1><strong>Modi</strong></h1>\r\n\r\n<p>pandas库是python中最有名的数据分析库，因为dataframe这种易用强大的数据类型，pandas成为数据科学必备套件。pandas可以和很多包联合使用，比如与机器学习sklearn、统计分析statsmodels、可视化searborn&amp;matplotlib等等。下图是近几年python包的使用量趋势，pandas一骑绝尘</p>\r\n\r\n<p><img alt=\"\" class=\"has\" data-widget=\"image\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9tbWJpei5xcGljLmNuL21tYml6X3BuZy9pYk9Ganh3aWNraWI0NFEyQ1NvTGNYbFVZYzZaWWlhWFhoaWJ5SXVkNHFlTlVKakJ2QUxiWUZ3ODRiaWNLcmZVU0ZtWmhpYnpoaWE4U2dKQTREZnJxT1pRZ2NMTkZBLzY0MA?x-oss-process=image/format,png\" style=\"height:800px; width:800px\" /></p>\r\n\r\n<p>但pandas有一个弱点：不适用于大规模数据。</p>\r\n\r\n<p>pandas默认只调用电脑单个的CPU进行数据读取和运算，但是当前的电脑大多是4核，甚至8核，而如果常规使用pandas意味着我们没有充分使用电脑的性能。</p>\r\n\r\n<h3><strong>安装</strong></h3>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\">\r\n<code class=\"hljs\">pip3 install ray\r\npip3 install dask!\r\npip3 install modin</code></pre>\r\n</div>\r\n\r\n<h3><strong>modin使用</strong></h3>\r\n\r\n<p>modin的用法与pandas相差无几，只是在导入的时候略有不同。</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\">\r\n<code class=\"language-python hljs\"><span class=\"hljs-keyword\">import</span> modin.pandas <span class=\"hljs-keyword\">as</span> pd</code></pre>\r\n</div>\r\n\r\n<p>现在这个pd就拥有与pandas一样的功能</p>\r\n\r\n<h3><strong>读取速度</strong></h3>\r\n\r\n<p>说了这么多了，我们先看看pandas导入test.csv文件(107M)的速度。</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\">\r\n<code class=\"language-python hljs\"><span class=\"hljs-keyword\">import</span> time\r\n<span class=\"hljs-keyword\">import</span> pandas <span class=\"hljs-keyword\">as</span> pd\r\n\r\nstart = time.time()\r\ndf = pd.read_csv(<span class=\"hljs-string\">&#39;data/test.csv&#39;</span>)\r\nend = time.time()\r\nprint(end-start)</code></pre>\r\n</div>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\">\r\n<code class=\"hljs\">1.611081838607788</code></pre>\r\n</div>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre data-widget=\"codeSnippet\">\r\n<code class=\"language-html hljs\">pandas导入107M的test.csv耗时1.78s</code></pre>\r\n</div>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\">\r\n<code class=\"language-python hljs\"><span class=\"hljs-keyword\">import</span> time\r\n<span class=\"hljs-keyword\">import</span> modin.pandas <span class=\"hljs-keyword\">as</span> pd\r\n\r\nstart = time.time()\r\n<span class=\"hljs-comment\">#test.csv 107M</span>\r\ndf = pd.read_csv(<span class=\"hljs-string\">&#39;data/test.csv&#39;</span>)\r\nend = time.time()\r\nprint(end-start)</code></pre>\r\n</div>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\">\r\n<code class=\"hljs\">0.7474761009216309</code></pre>\r\n</div>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre data-widget=\"codeSnippet\">\r\n<code class=\"language-html hljs\">modin只用了0.75s，加快了2.1倍。</code></pre>\r\n</div>\r\n\r\n<h3><strong>运算速度</strong></h3>\r\n\r\n<p>pd.concat是用来连接多个dataframe的操作函数，当我们的df很大时，pd.concat就会变慢。我们在这里实验一下pandas和modin各自的速度</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\">\r\n<code class=\"language-python hljs\"><span class=\"hljs-keyword\">import</span> time\r\n<span class=\"hljs-keyword\">import</span> pandas <span class=\"hljs-keyword\">as</span> pd\r\n\r\ndf = pd.read_csv(<span class=\"hljs-string\">&#39;data/test.csv&#39;</span>)\r\nstart = time.time()\r\nnewdf = pd.concat([df <span class=\"hljs-keyword\">for</span> _ <span class=\"hljs-keyword\">in</span> range(<span class=\"hljs-number\">100</span>)])\r\nend = time.time()\r\nprint(end-start)</code></pre>\r\n</div>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\">\r\n<code class=\"hljs\">10.625022888183594</code></pre>\r\n</div>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\">\r\n<code class=\"language-python hljs\"><span class=\"hljs-keyword\">import</span> time\r\n<span class=\"hljs-keyword\">import</span> modin.pandas <span class=\"hljs-keyword\">as</span> pd\r\n\r\ndf = pd.read_csv(<span class=\"hljs-string\">&#39;data/test.csv&#39;</span>)\r\nstart = time.time()\r\nnewdf = pd.concat([df <span class=\"hljs-keyword\">for</span> _ <span class=\"hljs-keyword\">in</span> range(<span class=\"hljs-number\">100</span>)])\r\nend = time.time()\r\nprint(end-start)</code></pre>\r\n</div>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\">\r\n<code class=\"hljs\">0.7488729953765869</code></pre>\r\n</div>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre data-widget=\"codeSnippet\">\r\n<code class=\"language-html hljs\">同样的pd.concat操作，modin比pandas快了14倍。我又做了几个对比，制作成表格</code></pre>\r\n</div>\r\n\r\n<p><img alt=\"\" class=\"has\" data-widget=\"image\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9tbWJpei5xcGljLmNuL21tYml6X3BuZy9pYk9Ganh3aWNraWI0NFEyQ1NvTGNYbFVZYzZaWWlhWFhoaWJ5eWdYcWZxaFlCNkhpYjE1SjJWeEh1SGNJMG1nYUJQZFF2QW1YbXBZa3NJYk5YaWNmWG9jWEZRYkEvNjQw?x-oss-process=image/format,png\" style=\"height:282px; width:800px\" /></p>\r\n\r\n<h3><strong>实战技巧</strong></h3>\r\n\r\n<p>modin目前仍然正在发展中，并不是所有的pandas的函数都能加速。如果加速遇到报错，说明这个操作modin不支持。</p>\r\n\r\n<p>默认modin会调用电脑全部的cpu，如果不想全部调用，可以使用ray来限制cpu使用数。</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\">\r\n<code class=\"language-python hljs\"><span class=\"hljs-keyword\">import</span> ray\r\n<span class=\"hljs-keyword\">import</span> warnings\r\nwarnings.filterwarnings(<span class=\"hljs-string\">&#39;ignore&#39;</span>)\r\nray.init(num_cpus=<span class=\"hljs-number\">4</span>, ignore_reinit_error=<span class=\"hljs-keyword\">True</span>)\r\n<span class=\"hljs-keyword\">import</span> modin.pandas <span class=\"hljs-keyword\">as</span> pd</code></pre>\r\n</div>\r\n\r\n<p>如果待操作的数据文件远大于电脑内存RAM，可以设置</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\">\r\n<code class=\"language-python hljs\"><span class=\"hljs-keyword\">import</span> os\r\nos.environ[<span class=\"hljs-string\">&quot;MODIN_OUT_OF_CORE&quot;</span>]=<span class=\"hljs-string\">&#39;true&#39;</span>\r\n<span class=\"hljs-keyword\">import</span> modin.pandas <span class=\"hljs-keyword\">as</span> pd</code></pre>\r\n<img src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" /><span style=\"background:url(&quot;http://chenyinren.top/root_static/ckeditor/ckeditor/plugins/widget/images/handle.png&quot;) rgba(220, 220, 220, 0.5); display:block; left:0px; top:-15px\"><img role=\"presentation\" src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" style=\"height:15px; width:15px\" title=\"点击并拖拽以移动\" /></span></div>\r\n\r\n<p>Modin是为加速pandas而开发的包，可以自动按照电脑CPU数调整运行的核数。</p>',
        '', '2020-01-22 00:45:00', '2020-01-22 00:45:00', 122, 1, 3, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (52, 'SQL语句中----删除表数据drop、truncate和delete的用法',
        '<p>一、SQL中的语法</p>\r\n\r\n<p>&nbsp;&nbsp;&nbsp;1、<strong>drop table&nbsp;</strong>表名称&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eg: drop table&nbsp; dbo.Sys_Test<br />\r\n&nbsp;&nbsp;&nbsp;2、<strong>truncate table&nbsp;</strong>表名称&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eg: truncate&nbsp; table dbo.Sys_Test&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />\r\n&nbsp;&nbsp;&nbsp;3、<strong>delete from</strong>&nbsp;表名称&nbsp;<strong>where</strong>&nbsp;列名称 = 值&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; eg: delete from dbo.Sys_Test where test=&#39;test&#39;</p>\r\n\r\n<p>二、drop，truncate，delete区别</p>\r\n\r\n<p>&nbsp;&nbsp;&nbsp; 1、drop (删除表)：删除内容和定义，释放空间。简单来说就是<strong>把整个表去掉</strong>.以后要新增数据是不可能的,除非新增一个表。</p>\r\n\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;drop语句将删除表的结构被依赖的约束（constrain),触发器（trigger)索引（index);依赖于该表的存储过程/函数将被保留，但其状态会变为：invalid。</p>\r\n\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;2、truncate (清空表中的数据)：删除内容、释放空间但不删除定义(<strong>保留表的数据结构</strong>)。与drop不同的是,只是清空表数据而已。</p>\r\n\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 注意:truncate 不能删除行数据,要删就要把表清空。</p>\r\n\r\n<p>&nbsp;&nbsp;&nbsp; 3、delete (删除表中的数据)：delete 语句用于<strong>删除表中的行</strong>。delete语句执行删除的过程是每次从表中删除一行，并且同时将该行的删除操作作为事务记录在日志中保存</p>\r\n\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 以便进行进行回滚操作。</p>\r\n\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;truncate与不带where的delete ：只删除数据，而不删除表的结构（定义）</p>\r\n\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;4、truncate table 删除表中的所有行，但表结构及其列、约束、索引等保持不变。新行标识所用的计数值重置为该列的种子。如果想保留标识计数值，请改用delete。</p>\r\n\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;如果要删除表定义及其数据，请使用&nbsp;drop table 语句。&nbsp;&nbsp;<br />\r\n&nbsp;&nbsp;&nbsp;&nbsp;5、对于由foreign key约束引用的表，不能使用truncate table ，而应使用不带where子句的delete语句。由于truncate table 记录在日志中，所以它不能激活触发器。</p>\r\n\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;6、执行速度，一般来说: drop&gt; truncate &gt; delete。</p>\r\n\r\n<p>&nbsp;&nbsp;&nbsp; 7、delete语句是数据库操作语言(dml)，这个操作会放到 rollback segement 中，事务提交之后才生效；如果有相应的 trigger，执行的时候将被触发。</p>\r\n\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;truncate、drop 是数据库定义语言(ddl)，操作立即生效，原数据不放到 rollback segment 中，不能回滚，操作不触发 trigger。&nbsp;</p>',
        '', '2020-02-25 02:18:00', '2020-02-25 02:18:00', 105, 1, 1, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (53, 'Navicat Premium 11/12/15安装与激活（破解）',
        '<p>Navicat premium是一款数据库管理工具,是一个可多重连线资料库的管理工具，它可以让你以单一程式同时连线到 MySQL、SQLite、Oracle 及 PostgreSQL 资料库，让管理不同类型的资料库更加的方便。</p>\r\n\r\n<p><strong>1、首先需要到官网进行下载，目前官网已经更新到Navicat Premium15了，本教程为NavicatPremium的安装与使用教程。</strong></p>\r\n\r\n<p>　　官方下载地址为：<a href=\"https://www.navicat.com.cn/download/navicat-premium\">https://www.navicat.com.cn/download/navicat-premium</a></p>\r\n\r\n<p>　　<a data-widget=\"image\" href=\"https://img2018.cnblogs.com/i-beta/1924746/202001/1924746-20200118115723291-638713159.png\"><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9pbWcyMDE4LmNuYmxvZ3MuY29tL2ktYmV0YS8xOTI0NzQ2LzIwMjAwMS8xOTI0NzQ2LTIwMjAwMTE4MTE1NzIzMjkxLTYzODcxMzE1OS5wbmc?x-oss-process=image/format,png\" /></a></p>\r\n\r\n<p>Navicat Premium分为Windows、MacOS、Linux版，我的电脑是Windows10 64bit， 所以下载的为Windows10 64bit版的，随便选择一个位置下载即可。</p>\r\n\r\n<p><strong>2.双击运行文件按照提示进行安装</strong></p>\r\n\r\n<p><a data-widget=\"image\" href=\"https://img2018.cnblogs.com/i-beta/1924746/202001/1924746-20200118120215009-899804528.png\"><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9pbWcyMDE4LmNuYmxvZ3MuY29tL2ktYmV0YS8xOTI0NzQ2LzIwMjAwMS8xOTI0NzQ2LTIwMjAwMTE4MTIwMjE1MDA5LTg5OTgwNDUyOC5wbmc?x-oss-process=image/format,png\" /></a></p>\r\n\r\n<p>　　　　　　　　　　　　　　　　　　navicat premium15安装程序&nbsp;&nbsp;</p>\r\n\r\n<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<a data-widget=\"image\" href=\"https://img2018.cnblogs.com/i-beta/1924746/202001/1924746-20200118120413921-1078434436.png\"><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9pbWcyMDE4LmNuYmxvZ3MuY29tL2ktYmV0YS8xOTI0NzQ2LzIwMjAwMS8xOTI0NzQ2LTIwMjAwMTE4MTIwNDEzOTIxLTEwNzg0MzQ0MzYucG5n?x-oss-process=image/format,png\" /></a></p>\r\n\r\n<p>　　　　<a data-widget=\"image\" href=\"https://img2018.cnblogs.com/i-beta/1924746/202001/1924746-20200118120637433-1502646157.png\"><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9pbWcyMDE4LmNuYmxvZ3MuY29tL2ktYmV0YS8xOTI0NzQ2LzIwMjAwMS8xOTI0NzQ2LTIwMjAwMTE4MTIwNjM3NDMzLTE1MDI2NDYxNTcucG5n?x-oss-process=image/format,png\" /></a></p>\r\n\r\n<p>　　　　选择安装位置，可自己选择安装位置（要记清安装的位置，后面有用）</p>\r\n\r\n<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a data-widget=\"image\" href=\"https://img2018.cnblogs.com/i-beta/1924746/202001/1924746-20200118120741130-683759521.png\"><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9pbWcyMDE4LmNuYmxvZ3MuY29tL2ktYmV0YS8xOTI0NzQ2LzIwMjAwMS8xOTI0NzQ2LTIwMjAwMTE4MTIwNzQxMTMwLTY4Mzc1OTUyMS5wbmc?x-oss-process=image/format,png\" /></a></p>\r\n\r\n<p>　　　　此处为快捷方式的创建位置，下一步即可</p>\r\n\r\n<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<a data-widget=\"image\" href=\"https://img2018.cnblogs.com/i-beta/1924746/202001/1924746-20200118121110014-240304668.png\"><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9pbWcyMDE4LmNuYmxvZ3MuY29tL2ktYmV0YS8xOTI0NzQ2LzIwMjAwMS8xOTI0NzQ2LTIwMjAwMTE4MTIxMTEwMDE0LTI0MDMwNDY2OC5wbmc?x-oss-process=image/format,png\" /></a></p>\r\n\r\n<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a data-widget=\"image\" href=\"https://img2018.cnblogs.com/i-beta/1924746/202001/1924746-20200118121216533-1325601025.png\"><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9pbWcyMDE4LmNuYmxvZ3MuY29tL2ktYmV0YS8xOTI0NzQ2LzIwMjAwMS8xOTI0NzQ2LTIwMjAwMTE4MTIxMjE2NTMzLTEzMjU2MDEwMjUucG5n?x-oss-process=image/format,png\" /></a></p>\r\n\r\n<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a data-widget=\"image\" href=\"https://img2018.cnblogs.com/i-beta/1924746/202001/1924746-20200118121249023-373930539.png\"><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9pbWcyMDE4LmNuYmxvZ3MuY29tL2ktYmV0YS8xOTI0NzQ2LzIwMjAwMS8xOTI0NzQ2LTIwMjAwMTE4MTIxMjQ5MDIzLTM3MzkzMDUzOS5wbmc?x-oss-process=image/format,png\" /></a></p>\r\n\r\n<p>&nbsp;　&nbsp; &nbsp; &nbsp;　<a data-widget=\"image\" href=\"https://img2018.cnblogs.com/i-beta/1924746/202001/1924746-20200118121403000-198292239.png\"><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9pbWcyMDE4LmNuYmxvZ3MuY29tL2ktYmV0YS8xOTI0NzQ2LzIwMjAwMS8xOTI0NzQ2LTIwMjAwMTE4MTIxNDAzMDAwLTE5ODI5MjIzOS5wbmc?x-oss-process=image/format,png\" /></a></p>\r\n\r\n<p>&nbsp;　　tip:安装完成后先不要启动软件，此时为试用版（14天），下面为破解过程，仅供个人学习和使用，有能力的同学请支持正版。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><strong>3、Navicat Premium15破解过程</strong></p>\r\n\r\n<p><strong>　　</strong>首先需要下载注册工具&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;</p>\r\n\r\n<p>下载地址：<a href=\"http://wangshuo.jb51.net:81/201903/tools/NavicatKeygen_jb51.rar\">https://pan.baidu.com/s/1f937eT_i__hgbgnesrX7Ag</a>&nbsp;提取码:&nbsp;yg9j</p>\r\n\r\n<p>　　　若链接失效可自己搜索下载该工具，注意需要是新版的5.6.0或以上（博主目前能找到的最新的为5.6.0），亲测可注册navicat premium15及以下版本</p>\r\n\r\n<p>　　　<a data-widget=\"image\" href=\"https://img2018.cnblogs.com/i-beta/1924746/202001/1924746-20200118123550866-287802907.png\"><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9pbWcyMDE4LmNuYmxvZ3MuY29tL2ktYmV0YS8xOTI0NzQ2LzIwMjAwMS8xOTI0NzQ2LTIwMjAwMTE4MTIzNTUwODY2LTI4NzgwMjkwNy5wbmc?x-oss-process=image/format,png\" /></a></p>\r\n\r\n<p>　　　双击运行注册工具（无需断网或者关闭防火墙），选择对应的navicat版本，此处为v15,点击Path选择刚才安装navicat目录下的navicat.exe文件</p>\r\n\r\n<p>　　　注意此时不能开启navicat premium</p>\r\n\r\n<p>　　　<a data-widget=\"image\" href=\"https://img2018.cnblogs.com/i-beta/1924746/202001/1924746-20200118124128966-1994759081.png\"><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9pbWcyMDE4LmNuYmxvZ3MuY29tL2ktYmV0YS8xOTI0NzQ2LzIwMjAwMS8xOTI0NzQ2LTIwMjAwMTE4MTI0MTI4OTY2LTE5OTQ3NTkwODEucG5n?x-oss-process=image/format,png\" /></a></p>\r\n\r\n<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<a data-widget=\"image\" href=\"https://img2018.cnblogs.com/i-beta/1924746/202001/1924746-20200118124551736-404213722.png\"><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9pbWcyMDE4LmNuYmxvZ3MuY29tL2ktYmV0YS8xOTI0NzQ2LzIwMjAwMS8xOTI0NzQ2LTIwMjAwMTE4MTI0NTUxNzM2LTQwNDIxMzcyMi5wbmc?x-oss-process=image/format,png\" /></a></p>\r\n\r\n<p>　　<strong>出现此界面表示成功</strong></p>\r\n\r\n<p>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<a data-widget=\"image\" href=\"https://img2018.cnblogs.com/i-beta/1924746/202001/1924746-20200118124639272-1914369315.png\"><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9pbWcyMDE4LmNuYmxvZ3MuY29tL2ktYmV0YS8xOTI0NzQ2LzIwMjAwMS8xOTI0NzQ2LTIwMjAwMTE4MTI0NjM5MjcyLTE5MTQzNjkzMTUucG5n?x-oss-process=image/format,png\" /></a></p>\r\n\r\n<p>　　<strong>选择对应的版本和语言，输入Your Name和Your Organization,点击生成注册码，然后运行Navicat将注册码复制到软注册栏</strong></p>\r\n\r\n<p>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<a data-widget=\"image\" href=\"https://img2018.cnblogs.com/i-beta/1924746/202001/1924746-20200118131538103-2117524939.png\"><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9pbWcyMDE4LmNuYmxvZ3MuY29tL2ktYmV0YS8xOTI0NzQ2LzIwMjAwMS8xOTI0NzQ2LTIwMjAwMTE4MTMxNTM4MTAzLTIxMTc1MjQ5MzkucG5n?x-oss-process=image/format,png\" /></a></p>\r\n\r\n<p>&nbsp; &nbsp; &nbsp;</p>\r\n\r\n<p>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<a data-widget=\"image\" href=\"https://img2018.cnblogs.com/i-beta/1924746/202001/1924746-20200118125530749-292519554.png\"><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9pbWcyMDE4LmNuYmxvZ3MuY29tL2ktYmV0YS8xOTI0NzQ2LzIwMjAwMS8xOTI0NzQ2LTIwMjAwMTE4MTI1NTMwNzQ5LTI5MjUxOTU1NC5wbmc?x-oss-process=image/format,png\" /></a></p>\r\n\r\n<p>&nbsp; &nbsp; &nbsp;&nbsp;<strong>点击激活</strong></p>\r\n\r\n<p>&nbsp; &nbsp; &nbsp; &nbsp;<a data-widget=\"image\" href=\"https://img2018.cnblogs.com/i-beta/1924746/202001/1924746-20200118131631976-702086494.png\"><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9pbWcyMDE4LmNuYmxvZ3MuY29tL2ktYmV0YS8xOTI0NzQ2LzIwMjAwMS8xOTI0NzQ2LTIwMjAwMTE4MTMxNjMxOTc2LTcwMjA4NjQ5NC5wbmc?x-oss-process=image/format,png\" /></a></p>\r\n\r\n<p>　　<strong>选择手动激活</strong></p>\r\n\r\n<p>　　<a data-widget=\"image\" href=\"https://img2018.cnblogs.com/i-beta/1924746/202001/1924746-20200118125742205-1329729121.png\"><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9pbWcyMDE4LmNuYmxvZ3MuY29tL2ktYmV0YS8xOTI0NzQ2LzIwMjAwMS8xOTI0NzQ2LTIwMjAwMTE4MTI1NzQyMjA1LTEzMjk3MjkxMjEucG5n?x-oss-process=image/format,png\" /></a></p>\r\n\r\n<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<a data-widget=\"image\" href=\"https://img2018.cnblogs.com/i-beta/1924746/202001/1924746-20200118131718802-832486314.png\"><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9pbWcyMDE4LmNuYmxvZ3MuY29tL2ktYmV0YS8xOTI0NzQ2LzIwMjAwMS8xOTI0NzQ2LTIwMjAwMTE4MTMxNzE4ODAyLTgzMjQ4NjMxNC5wbmc?x-oss-process=image/format,png\" /></a></p>\r\n\r\n<p>&nbsp;　　<strong>将请求码复制到注册工具的Request Code中，点击Generate</strong></p>\r\n\r\n<p>　 　&nbsp;<a data-widget=\"image\" href=\"https://img2018.cnblogs.com/i-beta/1924746/202001/1924746-20200118131819754-206524835.png\"><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9pbWcyMDE4LmNuYmxvZ3MuY29tL2ktYmV0YS8xOTI0NzQ2LzIwMjAwMS8xOTI0NzQ2LTIwMjAwMTE4MTMxODE5NzU0LTIwNjUyNDgzNS5wbmc?x-oss-process=image/format,png\" /></a></p>\r\n\r\n<p>　　<strong>返回activation code即为成功</strong></p>\r\n\r\n<p>&nbsp;　　<a data-widget=\"image\" href=\"https://img2018.cnblogs.com/i-beta/1924746/202001/1924746-20200118131912464-1638319219.png\"><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9pbWcyMDE4LmNuYmxvZ3MuY29tL2ktYmV0YS8xOTI0NzQ2LzIwMjAwMS8xOTI0NzQ2LTIwMjAwMTE4MTMxOTEyNDY0LTE2MzgzMTkyMTkucG5n?x-oss-process=image/format,png\" /></a></p>\r\n\r\n<p>&nbsp;　　<strong>此时手动激活页面的激活码会被自动填充，点击激活即可</strong></p>\r\n\r\n<p>　　<a data-widget=\"image\" href=\"https://img2018.cnblogs.com/i-beta/1924746/202001/1924746-20200118132026365-1030641987.png\"><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9pbWcyMDE4LmNuYmxvZ3MuY29tL2ktYmV0YS8xOTI0NzQ2LzIwMjAwMS8xOTI0NzQ2LTIwMjAwMTE4MTMyMDI2MzY1LTEwMzA2NDE5ODcucG5n?x-oss-process=image/format,png\" /></a></p>\r\n\r\n<p>　　<strong>至此，Navicat Premium15的激活已经完成</strong></p>\r\n\r\n<p><strong>　　若激活失败可以卸载Navicat Premium卸载重新尝试几次</strong></p>\r\n\r\n<p>&nbsp;　　<a data-widget=\"image\" href=\"https://img2018.cnblogs.com/i-beta/1924746/202001/1924746-20200118132046914-315049494.png\"><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9pbWcyMDE4LmNuYmxvZ3MuY29tL2ktYmV0YS8xOTI0NzQ2LzIwMjAwMS8xOTI0NzQ2LTIwMjAwMTE4MTMyMDQ2OTE0LTMxNTA0OTQ5NC5wbmc?x-oss-process=image/format,png\" /></a></p>\r\n\r\n<p>&nbsp; &nbsp; &nbsp; &nbsp;<a data-widget=\"image\" href=\"https://img2018.cnblogs.com/i-beta/1924746/202001/1924746-20200118132217465-248991643.png\"><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9pbWcyMDE4LmNuYmxvZ3MuY29tL2ktYmV0YS8xOTI0NzQ2LzIwMjAwMS8xOTI0NzQ2LTIwMjAwMTE4MTMyMjE3NDY1LTI0ODk5MTY0My5wbmc?x-oss-process=image/format,png\" /></a></p>\r\n\r\n<p>　　<strong>激活完成就可以开始使用Navicat了</strong></p>\r\n\r\n<p>&nbsp; &nbsp; &nbsp; &nbsp;<a data-widget=\"image\" href=\"https://img2018.cnblogs.com/i-beta/1924746/202001/1924746-20200118132336256-352361425.png\"><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9pbWcyMDE4LmNuYmxvZ3MuY29tL2ktYmV0YS8xOTI0NzQ2LzIwMjAwMS8xOTI0NzQ2LTIwMjAwMTE4MTMyMzM2MjU2LTM1MjM2MTQyNS5wbmc?x-oss-process=image/format,png\" /></a></p>',
        '', '2020-02-25 08:17:00', '2020-02-25 08:17:00', 307, 1, 4, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (54, 'SQLAlchemy 学习笔记（一）：Engine 与 SQL 表达式语言',
        '<p>SQLAlchemy 是一个用 Python 实现的 ORM （Object Relational Mapping）框架，它由多个组件构成，这些组件可以单独使用，也能独立使用。它的组件层次结构如下：</p>\r\n\r\n<p><img alt=\"\" class=\"has\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9pbWcyMDE4LmNuYmxvZ3MuY29tL2Jsb2cvOTY4MTM4LzIwMTkwMS85NjgxMzgtMjAxOTAxMjAwOTAzMzY3NDItMTA3Mzc4NjAxOC5wbmc?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>其中最常用的组件，应该是&nbsp;<strong>ORM</strong>&nbsp;和&nbsp;<strong>SQL 表达式语言</strong>，这两者既可以独立使用，也能结合使用。</p>\r\n\r\n<p><strong>ORM</strong>&nbsp;的好处在于它</p>\r\n\r\n<ol>\r\n	<li>自动处理了数据库和 Python 对象之间的映射关系，屏蔽了两套系统之间的差异。程序员不需要再编写复杂的 SQL 语句，直接操作 Python 对象就行。</li>\r\n	<li>屏蔽了各数据库之间的差异，更换底层数据库不需要修改 SQL 语句，改下配置就行。</li>\r\n	<li>使数据库结构文档化，models 定义很清晰地描述了数据库的结构。</li>\r\n	<li>避免了不规范、冗余、风格不统一的 SQL 语句，可以避免很多人为 Bug，也方便维护。</li>\r\n</ol>\r\n\r\n<p>但是 ORM 需要消耗额外的性能来处理对象关系映射，此外用 ORM 做多表关联查询或复杂 SQL 查询时，效率低下。因此它适用于场景不太复杂，性能要求不太苛刻的场景。</p>\r\n\r\n<p>都说 ORM 学习成本高，我自己也更倾向于直接使用 SQL 语句（毕竟更熟悉），因此这一篇笔记不涉及 ORM 部分，只记录 SQLAlchemy 的 Engine 与 SQL 表达式语言。</p>\r\n\r\n<h2>一、直接使用&nbsp;<a href=\"https://docs.sqlalchemy.org/en/latest/core/engines.html#sqlalchemy.create_engine\">Engine</a>&nbsp;和 Connections</h2>\r\n\r\n<p>第一步是创建数据库引擎实例：</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">from sqlalchemy import create_engine\r\n\r\nengine = create_engine(\'sqlite:///:memory:\', \r\n                    echo=True,  # echo=True 表示打印出自动生成的 SQL 语句（通过 logging）\r\n                    pool_size=5,  # 连接池容量，默认为 5，生产环境下太小，需要修改。\r\n                    # 下面是 connection 回收的时间限制，默认 -1 不回收\r\n                    pool_recycle=7200)   # 超过 2 小时就重新连接（MySQL 默认的连接最大闲置时间为 8 小时）</code></pre>\r\n</div>\r\n\r\n<p><code>create_engine</code>&nbsp;接受的第一个参数是数据库 URI，格式为&nbsp;<code>dialect[+driver]://user:password@host/dbname[?key=value..]</code>，dialect 是具体的数据库名称，driver 是驱动名称。key-value 是可选的参数。举例：</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\"># PostgreSQL\r\npostgresql+psycopg2://scott:tiger@localhost/dbtest\r\n\r\n# MySQL + PyMySQL（或者用更快的  mysqlclient）\r\nmysql+pymysql://scott:tiger@localhost/dbtest\r\n\r\n# sqlite 内存数据库\r\n# 注意 sqlite 要用三个斜杠，表示不存在 hostname，sqlite://&lt;nohostname&gt;/&lt;path&gt;\r\nsqlite:///:memory:\r\n\r\n# sqlite 文件数据库\r\n# 四个斜杠是因为文件的绝对路径以 / 开头：/home/ryan/Codes/Python/dbtest.db\r\nsqlite:////home/ryan/Codes/Python/dbtest.db\r\n\r\n# SQL Server + pyodbc\r\n# 首选基于 dsn 的连接，dsn 的配置请搜索hhh\r\nmssql+pyodbc://scott:tiger@some_dsn</code></pre>\r\n</div>\r\n\r\n<p>如果你的密码中含有 &#39;@&#39; 等特殊字符，就不能直接放入 URI 中，必须使用&nbsp;<code>urllib.parse.quote_plus</code>&nbsp;编码，然后再插入 URI.</p>\r\n\r\n<p>引擎创建后，我们就可以直接获取 connection，然后执行 SQL 语句了。这种用法相当于把 SQLAlchemy 当成带 log 的数据库连接池使用：</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">with engine.connect() as conn:\r\n    res = conn.execute(\"select username from users\")  # 无参直接使用\r\n\r\n    # 使用问号作占位符，前提是下层的 DBAPI 支持。更好的方式是使用 text()，这个后面说\r\n    conn.execute(\"INSERT INTO table (id, value) VALUES (?, ?)\", 1, \"v1\")  # 参数不需要包装成元组\r\n\r\n    # 查询返回的是 ResultProxy 对象，有和 dbapi 相同的 fetchone()、fetchall()、first() 等方法，还有一些拓展方法\r\n    for row in result:\r\n        print(\"username:\", row[\'username\'])</code></pre>\r\n</div>\r\n\r\n<p>但是要注意的是，connection 的 execute 是自动提交的（autocommit），这就像在 shell 里打开一个数据库客户端一样，分号结尾的 SQL 会被自动提交。<br />\r\n只有在&nbsp;<code>BEGIN TRANSACTION</code>&nbsp;内部，<code>AUTOCOMMIT</code>&nbsp;会被临时设置为&nbsp;<code>FALSE</code>，可以通过如下方法开始一个内部事务：</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">def transaction_a(connection):\r\n    trans = connection.begin()  # 开启一个 transaction\r\n    try:\r\n        # do sthings\r\n        trans.commit()  # 这里需要手动提交\r\n    except:\r\n        trans.rollback()  # 出现异常则 rollback\r\n        raise\r\n# do other things\r\n\r\nwith engine.connect() as conn:\r\n    transaction_a(conn)</code></pre>\r\n</div>\r\n\r\n<h3>1. 使用&nbsp;<a href=\"https://docs.sqlalchemy.org/en/latest/core/sqlelement.html#sqlalchemy.sql.expression.text\">text()</a>&nbsp;构建 SQL</h3>\r\n\r\n<p>相比直接使用 string，text() 的优势在于它：</p>\r\n\r\n<ol>\r\n	<li>提供了统一的参数绑定语法，与具体的 DBAPI 无关。</li>\r\n</ol>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\"># 1. 参数绑定语法\r\nfrom sqlalchemy import text\r\n\r\nresult = connection.execute(\r\n            # 使用 :key 做占位符\r\n            text(\'select * from table where id &lt; :id and typeName=:type\'),\r\n            {\'id\': 2,\'type\':\'USER_TABLE\'})  # 用 dict 传参数，更易读\r\n\r\n# 2. 参数类型指定\r\nfrom sqlalchemy import DateTime\r\n\r\ndate_param=datetime.today()+timedelta(days=-1*10)\r\nsql=\"delete from caw_job_alarm_log  where alarm_time&lt;:alarm_time_param\"\r\n\r\n# bindparams 是 bindparam 的列表，bindparam 则提供参数的一些额外信息（类型、值、限制等）\r\nt=text(sql, bindparams=[bindparam(\'alarm_time_param\', type_=DateTime, required=True)])\r\nconnection.execute(t, {\"alarm_time_param\": date_param})</code></pre>\r\n</div>\r\n\r\n<ol>\r\n	<li>可以很方便地转换 Result 中列的类型</li>\r\n</ol>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">stmt = text(\"SELECT * FROM table\",\r\n            # 使用 typemap 指定将 id 列映射为 Integer 类型，name 映射为 String 类型\r\n            typemap={\'id\': Integer, \'name\': String},\r\n          )\r\nresult = connection.execute(stmt)\r\n# 对多个查询结果，可以用 for obj in result 遍历\r\n# 也可用 fetchone() 只获取一个</code></pre>\r\n</div>\r\n\r\n<h2>二、SQL 表达式语言</h2>\r\n\r\n<blockquote>\r\n<p>复杂的 SQL 查询可以直接用 raw sql 写，而增删改一般都是单表操作，用 SQL 表达式语言最方便。</p>\r\n</blockquote>\r\n\r\n<p>SQLAlchemy 表达式语言是一个使用 Python 结构表示关系数据库结构和表达式的系统。</p>\r\n\r\n<h3>1. 定义并创建表</h3>\r\n\r\n<p>SQL 表达式语言使用 Table 来定义表，而表的列则用 Column 定义。Column 总是关联到一个 Table 对象上。</p>\r\n\r\n<p>一组 Table 对象以及它们的子对象的集合就被称作「数据库元数据（database metadata）」。metadata 就像你的网页分类收藏夹，相关的 Table 放在一个 metadata 中。</p>\r\n\r\n<p>下面是创建元数据（一组相关联的表）的例子，：</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">from sqlalchemy import Table, Column, Integer, String, MetaData, ForeignKey\r\n\r\nmetadata = MetaData()  # 先创建元数据（收藏夹）\r\n\r\nusers = Table(\'user\', metadata,  # 创建 user 表，并放到 metadata 中\r\n              Column(\'id\', Integer, primary_key=True),\r\n              Column(\'name\', String),\r\n              Column(\'fullname\', String)\r\n             )\r\n\r\naddresses = Table(\'address\', metadata,\r\n                  Column(\'id\', Integer, primary_key=True),\r\n                  Column(\'user_id\', None, ForeignKey(\'user.id\')),  # 外键约束，引用 user 表的 id 列\r\n                  Column(\'email_address\', String, nullable=False)\r\n                 )\r\n\r\nmetadata.create_all(engine)  # 使用 engine 创建 metadata 内的所有 Tables（会检测表是否已经存在，所以可以重复调用）</code></pre>\r\n</div>\r\n\r\n<p>表定义中的约束</p>\r\n\r\n<blockquote>\r\n<p>应该给所有的约束命名，即为&nbsp;<code>name</code>&nbsp;参数指定一个不冲突的列名。详见&nbsp;<a href=\"https://alembic.sqlalchemy.org/en/latest/naming.html\">The Importance of Naming Constraints</a></p>\r\n</blockquote>\r\n\r\n<p>表还有一个属性：<a href=\"https://www.cnblogs.com/kirito-c/p/10295693.html\">约束条件</a>。下面一一进行说明。</p>\r\n\r\n<ol>\r\n	<li><strong>外键约束</strong>：用于在删除或更新某个值或行时，对主键/外键关系中一组数据列强制进行的操作限制。\r\n\r\n	<ol>\r\n		<li>用法一：<code>Column(&#39;user_id&#39;, None, ForeignKey(&#39;user.id&#39;))</code>，直接在&nbsp;<code>Column</code>&nbsp;中指定。这也是最常用的方法</li>\r\n		<li>用法二：通过&nbsp;<code>ForeignKeyConstraint(columns, refcolumns)</code>&nbsp;构建约束，作为参数传给&nbsp;<code>Table</code>.</li>\r\n	</ol>\r\n	</li>\r\n</ol>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">item = Table(\'item\', metadata,  # 商品 table\r\n    Column(\'id\', Integer, primary_key=True),\r\n    Column(\'name\', String(60), nullable=False),\r\n    Column(\'invoice_id\', Integer, nullable=False),  # 发票 id，是外键\r\n    Column(\'ref_num\', Integer, nullable=False),\r\n    ForeignKeyConstraint([\'invoice_id\', \'ref_num\'],  # 当前表中的外键名称\r\n                                        [\'invoice.id\', \'invoice.ref_num\'])  # 被引用的外键名称的序列（被引用的表）\r\n)</code></pre>\r\n</div>\r\n\r\n<ol>\r\n	<li><code>on delete</code>&nbsp;与&nbsp;<code>on update</code>：<strong>外键约束的两个约束条件</strong>，通过&nbsp;<code>ForeignKey()</code>&nbsp;或&nbsp;<code>ForeignKeyConstraint()</code>&nbsp;的关键字参数&nbsp;<code>ondelete/onupdate</code>&nbsp;传入。<br />\r\n	可选值有：\r\n	<ol>\r\n		<li><strong>默认行为&nbsp;<code>NO ACTION</code></strong>：什么都不做，直接报错。</li>\r\n		<li><code>CASCADE</code>：删除/更新 父表数据时，<strong>从表数据会同时被 删除/更新</strong>。（无报错）</li>\r\n		<li><code>RESTRICT</code>：<strong>不允许直接 删除/更新 父表数据</strong>，直接报错。（和默认行为基本一致）</li>\r\n		<li><code>SET NULL</code>&nbsp;or&nbsp;<code>SET DEFAULT</code>：删除/更新 父表数据时，将对应的从表数据重置为&nbsp;<code>NULL</code>&nbsp;或者默认值。</li>\r\n	</ol>\r\n	</li>\r\n	<li><strong>唯一性约束</strong>：<code>UniqueConstraint(&#39;col2&#39;, &#39;col3&#39;, name=&#39;uix_1&#39;)</code>，作为参数传给&nbsp;<code>Table</code>.</li>\r\n	<li><strong>CHECK 约束</strong>：<code>CheckConstraint(&#39;col2 &gt; col3 + 5&#39;, name=&#39;check1&#39;)</code>， 作为参数传给&nbsp;<code>Table</code>.</li>\r\n	<li>主键约束：不解释\r\n	<ol>\r\n		<li>方法一：通过&nbsp;<code>Column(&#39;id&#39;, Integer, primary_key=True)</code>&nbsp;指定主键。（参数&nbsp;<code>primary_key</code>&nbsp;可在多个&nbsp;<code>Column</code>&nbsp;上使用）</li>\r\n		<li>方法二：使用&nbsp;<code>PrimaryKeyConstraint</code></li>\r\n	</ol>\r\n	</li>\r\n</ol>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">from sqlalchemy import PrimaryKeyConstraint\r\n\r\nmy_table = Table(\'mytable\', metadata,\r\n            Column(\'id\', Integer),\r\n            Column(\'version_id\', Integer),\r\n            Column(\'data\', String(50)),\r\n            PrimaryKeyConstraint(\'id\', \'version_id\', name=\'mytable_pk\')\r\n        )</code></pre>\r\n</div>\r\n\r\n<h3>2. 增删改查语句</h3>\r\n\r\n<ol>\r\n	<li><strong>增</strong>:</li>\r\n</ol>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\"># 方法一，使用 values 传参\r\nins = users.insert().values(name=\"Jack\", fullname=\"Jack Jones\")  # 可以通过 str(ins) 查看自动生成的 sql\r\nconnection.execute(ins)\r\n\r\n# 方法二，参数传递给 execute()\r\nconn.execute(users.insert(), id=2, name=\'wendy\', fullname=\'Wendy Williams\')\r\n\r\n# 方法三，批量 INSERT，相当于 executemany\r\nconn.execute(addresses.insert(), [  # 插入到 addresses 表\r\n    {\'user_id\': 1, \'email_address\': \'jack@yahoo.com\'},  # 传入 dict 列表\r\n    {\'user_id\': 1, \'email_address\': \'jack@msn.com\'},\r\n    {\'user_id\': 2, \'email_address\': \'www@www.org\'},\r\n    {\'user_id\': 2, \'email_address\': \'wendy@aol.com\'}\r\n])\r\n\r\n# 此外，通过使用 bindparam，INSERT 还可以执行更复杂的操作\r\nstmt = users.insert() \\ \r\n         .values(name=bindparam(\'_name\') + \" .. name\")  # string 拼接\r\nconn.execute(stmt, [\r\n        {\'id\':4, \'_name\':\'name1\'},\r\n        {\'id\':5, \'_name\':\'name2\'},\r\n        {\'id\':6, \'_name\':\'name3\'},\r\n     ])</code></pre>\r\n</div>\r\n\r\n<ol>\r\n	<li><strong>删</strong>：</li>\r\n</ol>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">_table.delete() \\\r\n        .where(_table.c.f1==value1) \\\r\n        .where(_table.c.f2==value2)  # where 指定条件</code></pre>\r\n</div>\r\n\r\n<ol>\r\n	<li><strong>改</strong>：</li>\r\n</ol>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\"># 举例\r\nstmt = users.update() \\\r\n             .where(users.c.name == \'jack\') \\\r\n             .values(name=\'tom\')\r\nconn.execute(stmt)\r\n\r\n# 批量更新\r\nstmt = users.update() \\\r\n             .where(users.c.name == bindparam(\'oldname\')) \\\r\n             .values(name=bindparam(\'newname\'))\r\nconn.execute(stmt, [\r\n     {\'oldname\':\'jack\', \'newname\':\'ed\'},\r\n     {\'oldname\':\'wendy\', \'newname\':\'mary\'},\r\n     {\'oldname\':\'jim\', \'newname\':\'jake\'},\r\n     ])</code></pre>\r\n</div>\r\n\r\n<p>可以看到，所有的条件都是通过&nbsp;<code>where</code>&nbsp;指定的，它和后面 ORM 的 filter 接受的参数是一样的。（详细的会在第二篇文章里讲）</p>\r\n\r\n<ol>\r\n	<li><strong>查</strong></li>\r\n</ol>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">from sqlalchemy.sql import select\r\n\r\n# 1. 字段选择\r\ns1 = select([users])  # 相当于 select * from users\r\ns2 = select([users.c.name, users.c.fullname])  # 这个就是只 select 一部分\r\n\r\n# 2. 添加过滤条件\r\ns3 = select([users]) \\\r\n    .where(users.c.id == addresses.c.user_id) \r\n\r\nres = conn.execute(s1)\r\n# 可用 for row in res 遍历结果集，也可用 fetchone() 只获取一行</code></pre>\r\n</div>\r\n\r\n<p>查询返回的是 ResultProxy 对象，这是 SQLAlchemy 对 Python DB-API 的 cursor 的一个封装类，要从中获取结果行，主要有下列几个方法：</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">row1 = result.fetchone()  # 对应 cursor.fetchone()\r\nrow2 = result.fetchall()  # 对应 cursor.fetchall()\r\nrow3 = result.fetchmany(size=3)  # 对应 cursor.fetchmany(size=3)\r\n\r\nrow4 = result.first()  # 获取一行，然后立即调用 result 的 close() 方法\r\n\r\ncol = row[mytable.c.mycol] # 获取 mycol 这一列\r\n\r\nresult.rowcount  # 结果集的行数\r\n\r\n同时，result 也实现了 next protocol，因此可以直接用 for 循环遍历</code></pre>\r\n</div>\r\n\r\n<h3>where 进阶</h3>\r\n\r\n<p>通过使用 or_、and_、in_ model.join 等方法，where 可以构建更复杂的 SQL 语句。</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">from sqlalchemy.sql import and_, or_, not_\r\n\r\ns = select([(users.c.fullname +\r\n               \", \" + addresses.c.email_address).\r\n                label(\'title\')]).\\\r\n        where(users.c.id == addresses.c.user_id).\\\r\n        where(users.c.name.between(\'m\', \'z\')).\\\r\n        where(\r\n               or_(\r\n                  addresses.c.email_address.like(\'%@aol.com\'),\r\n                  addresses.c.email_address.like(\'%@msn.com\')\r\n               )\r\n        )</code></pre>\r\n<img src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" /><img src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" style=\"height:15px; width:15px\" title=\"点击并拖拽以移动\" /></div>\r\n\r\n<h2>链接</h2>\r\n\r\n<ul>\r\n	<li><a href=\"https://docs.sqlalchemy.org/en/latest/core/connections.html\">使用 Engines 和 Connections</a></li>\r\n	<li><a href=\"https://docs.sqlalchemy.org/en/latest/core/tutorial.html\">SQL 表达式语言入门</a></li>\r\n	<li><a href=\"https://docs.sqlalchemy.org/en/13/core/constraints.html\">SQLAlchemy - 定义约束</a></li>\r\n	<li><a href=\"https://www.cnblogs.com/harrychinese/archive/2012/09/12/My_Own_Tutorial_For_SqlAlchemy.html\">SQLAlchemy个人学习笔记完整汇总</a></li>\r\n</ul>',
        '', '2019-12-23 02:15:00', '2019-12-23 02:15:00', 96, 1, 1, 0, 0, 1);
INSERT INTO `tb_content`
VALUES (55, 'SQLAlchemy 学习笔记（二）：ORM 基础',
        '<p>照例先看层次图<br />\r\n<img alt=\"\" class=\"has\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9pbWcyMDE4LmNuYmxvZ3MuY29tL2Jsb2cvOTY4MTM4LzIwMTkwMS85NjgxMzgtMjAxOTAxMjAwOTAzMzY3NDItMTA3Mzc4NjAxOC5wbmc?x-oss-process=image/format,png\" /></p>\r\n\r\n<h3>一、声明映射关系</h3>\r\n\r\n<p>使用 ORM 时，我们首先需要定义要操作的表（通过&nbsp;<code>Table</code>），然后再定义该表对应的 Python class，并声明两者之间的映射关系（通过&nbsp;<code>Mapper</code>）。</p>\r\n\r\n<p>方便起见，SQLAlchemy 提供了 Declarative 系统来一次完成上述三个步骤，Declarative 系统提供 base class，这个 base class 会为继承了它的 Python class（可称作 model）创建 Table，并维护两者的映射关系。</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">from sqlalchemy.ext.declarative import declarative_base\r\nfrom SQLAlchemy import Column, Integer, String\r\n\r\nBase = declarative_base()  # 拿到 Base 类\r\n\r\n\r\nclass User(Base):\r\n    id = Column(Integer, primary_key=True)\r\n    username = Column(String(32), nullable=False, index=True)  # 添加 index 提升搜索效率\r\n    fullname = Column(String(64))\r\n    password = Column(String(32))  # 真实情况下一般只存 hash\r\n\r\n    def __repr__(self):\r\n        return f\"&lt;User {self.username}&gt;\"</code></pre>\r\n</div>\r\n\r\n<p>这样就声明好了一个对象-关系映射，上一篇文章说过所有的 Table 都在某个 MetaData 中，可以通过&nbsp;<code>Base.metadata</code>&nbsp;获取它。</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">Base.metadata.create_all(engine)  # 通过 metadata 创建表（或者说生成模式 schema）</code></pre>\r\n</div>\r\n\r\n<p>engine 的创建请见上篇文档&nbsp;<a href=\"https://www.cnblogs.com/kirito-c/p/10269485.html\">SQLAlchemy 学习笔记（一）：Engine 与 SQL 表达式语言</a></p>\r\n\r\n<p>约束条件</p>\r\n\r\n<blockquote>\r\n<p>可参考&nbsp;<a href=\"https://www.cnblogs.com/kirito-c/p/10295693.html\">SQL 基础笔记（三）：约束</a>&nbsp;与&nbsp;<a href=\"https://www.cnblogs.com/kirito-c/p/10269485.html#%E8%A1%A8%E5%AE%9A%E4%B9%89%E4%B8%AD%E7%9A%84%E7%BA%A6%E6%9D%9F\">SQLAlchemy 学习笔记（一）：Engine 与 SQL 表达式语言 - 表定义中的约束</a></p>\r\n</blockquote>\r\n\r\n<p>使用 ORM 来定义约束条件，与直接使用 SQL 表达式语言定义很类似，也有两种方法：</p>\r\n\r\n<ol>\r\n	<li>直接将约束条件作为&nbsp;<code>Column</code>、<code>ForeignKey</code>&nbsp;的参数传入。这种方式最简洁，也最常用。</li>\r\n	<li>使用&nbsp;<code>UniqueConstraint</code>、<code>CheckConstraint</code>&nbsp;等类构造约束，然后放入&nbsp;<code>__table_args__</code>&nbsp;属性中。举例：</li>\r\n</ol>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">class User(Base):\r\n    id = Column(Integer, primary_key=True)\r\n    username = Column(String(32), nullable=False, index=True)  # 添加 index 提升搜索效率\r\n    fullname = Column(String(64))\r\n    password = Column(String(32))  # 真实情况下一般只存 hash\r\n\r\n    # 顾名思义，这是 `Table` 类的参数的序列。里面的约束条件会被用于构建 __table__\r\n    __table_args__ = (UniqueConstraint(\'username\', name=\'c_user\'),)  # username 的唯一性约束\r\n\r\n    def __repr__(self):\r\n        return f\"&lt;User {self.username}&gt;\"</code></pre>\r\n</div>\r\n\r\n<h3>二、获取 session</h3>\r\n\r\n<p>上一节讲 engine 时，我们是通过 connection 来与数据库交互，而在 ORM 中我们使用 Session 访问数据库。</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">from sqlalchemy.orm import sessionmaker\r\n\r\nSession = sessionmaker(bind=engine)  # 获取 session</code></pre>\r\n</div>\r\n\r\n<h3>三、增删改查</h3>\r\n\r\n<p>直接使用 SQL 表达式语言时，我们使用 insert()、select()、update()、delete() 四个函数构造 SQL，使用 where() 添加条件，使用 model.join(another_model) 进行 join 操作。<br />\r\n而使用 ORM 时，数据库操作不再与 SQL 直接对应。我们现在是通过操作 Python 对象来操作数据库了。</p>\r\n\r\n<p>现在，我们通过 db.session.add()、db.session.delete() 进行添加与删除，使用 db.session.query(Model) 进行查询，通过 filter 和 filter_by 添加过滤条件。<br />\r\n而修改，则是先查询出对应的 row 对象，直接修改这个对象，然后 commit 就行。</p>\r\n\r\n<ol>\r\n	<li>增添：</li>\r\n</ol>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">ed_user = User(name=\'ed\', fullname=\'Ed Jones\', password=\'edspassword\')  # 用构造器构造对象\r\nsession.add(ed_user)  # 添加，此外还有批量添加 add_all([user1, user2...])\r\nsession.commit()  # 必须手动 commit</code></pre>\r\n</div>\r\n\r\n<ol>\r\n	<li>修改：</li>\r\n</ol>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">ed_user = session.query(User).filter_by(name=\'ed\').first()  # 先获取到 User 对象\r\ned_user.password = \'f8s7ccs\'  # 改了密码\r\nsession.commit()  # 提交\r\n\r\n# 批量修改\r\nsession.query(User).filter(User.home==\'shanghai\') \\\r\n    .update({User.login_num:0})  # 将所有上海的用户的 login_num 设为 0\r\nsession.commit()</code></pre>\r\n</div>\r\n\r\n<ol>\r\n	<li>删除：</li>\r\n</ol>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">ed_user = session.query(User).filter_by(name=\'ed\').first()  # 先获取到 User 对象\r\nsession.delete(ed_user)  # 直接删除（session 知道 ed_user 属于哪个表）\r\nsession.commit()  # 提交\r\n\r\n# 批量删除\r\nsession.query(User).filter(User.home==\'shanghai\') \\\r\n    .delete()  # 删除所有上海的用户\r\n\r\nsession.commit()</code></pre>\r\n</div>\r\n\r\n<p>同样的，也可以在外面检查异常，然后调用&nbsp;<code>session.rollback()</code>&nbsp;实现失败回滚。</p>\r\n\r\n<h3>四、进阶查询</h3>\r\n\r\n<ol>\r\n	<li>filter_by：使用关键字参数进行过滤，前面的演示中已经用过多次了。</li>\r\n	<li>filter：它对应 SQL 表达式语言中的 where，支持各种复杂的 SQL 语法。</li>\r\n	<li>group_by: 通过指定 column 分组</li>\r\n	<li>distinct(): 去重</li>\r\n	<li>join(): 关联</li>\r\n</ol>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">query.filter(User.name == \'ed\')  # 这个等同于 filter_by，但是更繁琐\r\nquery.filter(User.name != \'ed\')  # 不等于，这个就是 filter_by 无法做到的了\r\nquery.filter(User.name.like(\'%ed%\'))  # SQL like 的 like 语法\r\nquery.filter(User.name.in_([\'ed\', \'wendy\', \'jack\']))  # 包含\r\n\r\n# 查询还可以嵌套\r\nquery.filter(User.name.in_(\r\n    session.query(User.name).filter(User.name.like(\'%ed%\'))\r\n))\r\n\r\nquery.filter(~User.name.in_([\'ed\', \'wendy\', \'jack\']))  # 不包含\r\nquery.filter(User.name == None)  # NULL 对应 Python 的 None\r\n\r\nfrom sqlalchemy import or_, and_, in_\r\nquery.filter(or_(User.name == \'ed\', User.name == \'wendy\'))  # OR 语法\r\n\r\nquery.group_by(User.name)  # 分组\r\nquery.distinct()  # 去重\r\n\r\nfrom sqlalchemy import func  # SQL 函数包\r\nsession.query(func.count(User.name)).filter_by(xxx=xxx)  # 使用 count 函数\r\n\r\n# join 关联\r\n# 默认使用内联（inner），即只取两表的交集\r\nsession.query(User, Address).filter(User.id==Address.user_id)  # 方法一\r\n\r\nsession.query(User).join(Address).\\  # 方法二\r\n    filter(Address.email_address==\'jack@google.com\')\r\n\r\n# 外联 outer join，将另一表的列联结到主表，没有的行为 NULL\r\nsession.query(User).outerjoin(User.addresses) \\\r\n    .filter(Address.email_address==\'jack@google.com\')</code></pre>\r\n</div>\r\n\r\n<p>执行查询，获取数据</p>\r\n\r\n<p>查询返回 query 对象，但 SQL 还没有被执行，直到你调用下列几个方法：</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\"># 构造 query 对象\r\nquery = session.query(User).filter(User.name.like(\'%ed\')).order_by(User.id)\r\n\r\n# 1. all 返回所有结果的列表\r\nres_list = query.all()\r\n\r\n# 2. first 先在 SQL 中加入限制 `limit 1`，然后执行。\r\nres = query.first()\r\n\r\n# 3. one 执行 sql 并获取所有结果\r\n# 如果结果不止一行，抛出 MultipleResultsFound Error！！！\r\n# 如果结果为空，抛出 NoResultFound Error ！！！\r\nres = query.one()\r\n\r\n4. one_or_none 差别在于结果为空，它不抛出异常，而是返回 None\r\nres = query.one_or_none()</code></pre>\r\n<img src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" /><img src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" style=\"height:15px; width:15px\" title=\"点击并拖拽以移动\" /></div>\r\n\r\n<h3>参考</h3>\r\n\r\n<ul>\r\n	<li><a href=\"https://docs.sqlalchemy.org/en/latest/orm/tutorial.html\">SQLAlchemy 对象关系入门</a></li>\r\n	<li><a href=\"https://docs.sqlalchemy.org/en/latest/orm/basic_relationships.html\">SQLAlchemy ORM 的关联映射定义：一对多、多对多</a></li>\r\n</ul>',
        '', '2019-12-23 02:17:00', '2019-12-23 02:17:00', 83, 1, 1, 0, 0, 1);
INSERT INTO `tb_content`
VALUES (56, 'SQLAlchemy 学习笔记（三）：ORM 中的关系构建',
        '<h2>关系构建：<code>ForeignKey</code>&nbsp;与&nbsp;<code>relationship</code></h2>\r\n\r\n<p>关系构建的重点，在于搞清楚这两个函数的用法。<code>ForeignKey</code>&nbsp;的用法已经在&nbsp;<a href=\"https://www.cnblogs.com/kirito-c/p/10269485.html#%E8%A1%A8%E5%AE%9A%E4%B9%89%E4%B8%AD%E7%9A%84%E7%BA%A6%E6%9D%9F\">SQL表达式语言 - 表定义中的约束</a>&nbsp;讲过了。主要是&nbsp;<code>ondelete</code>&nbsp;和&nbsp;<code>onupdate</code>&nbsp;两个参数的用法。</p>\r\n\r\n<h2><code>relationship</code></h2>\r\n\r\n<p><code>relationship</code>&nbsp;函数在 ORM 中用于构建表之间的关联关系。与&nbsp;<code>ForeignKey</code>&nbsp;不同的是，它定义的关系不属于表定义，而是动态计算的。<br />\r\n用它定义出来的属性，相当于 SQL 中的视图。</p>\r\n\r\n<p>这个函数有点难用，一是因为它的有几个参数不太好理解，二是因为它的参数非常丰富，让人望而却步。下面通过<strong>一对多</strong>、<strong>多对一</strong>、<strong>多对多</strong>几个场景下&nbsp;<code>relationship</code>&nbsp;的使用，来一步步熟悉它的用法。</p>\r\n\r\n<p>首先初始化：</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">from sqlalchemy import Table, Column, Integer, ForeignKey\r\nfrom sqlalchemy.orm import relationship\r\nfrom sqlalchemy.ext.declarative import declarative_base\r\n\r\nBase = declarative_base()</code></pre>\r\n</div>\r\n\r\n<h3>一对多</h3>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">class Parent(Base):\r\n    __tablename__ = \'parent\'\r\n    id = Column(Integer, primary_key=True)\r\n\r\n    # 因为 Child 中有 Parent 的 ForeignKey，这边的声明不需要再额外指定什么。\r\n    children = relationship(\"Child\")  # children 的集合，相当于一个视图。\r\n\r\nclass Child(Base):\r\n    __tablename__ = \'child\'\r\n    id = Column(Integer, primary_key=True)\r\n    parent_id = Column(Integer, ForeignKey(\'parent.id\'))</code></pre>\r\n</div>\r\n\r\n<p>一个&nbsp;<code>Parent</code>&nbsp;可以有多个&nbsp;<code>Children</code>，通过&nbsp;<code>relationship</code>，我们就能直接通过&nbsp;<code>parent.children</code>&nbsp;得到结果，免去繁琐的 query 语句。</p>\r\n\r\n<p>反向引用</p>\r\n\r\n<p>1.&nbsp;<code>backref</code>&nbsp;与&nbsp;<code>back_populates</code></p>\r\n\r\n<p>那如果我们需要得知&nbsp;<code>child</code>&nbsp;的&nbsp;<code>parent</code>&nbsp;对象呢？能不能直接访问&nbsp;<code>child.parent</code>？</p>\r\n\r\n<p>为了实现这个功能，SQLAlchemy 提供了&nbsp;<code>backref</code>&nbsp;和&nbsp;<code>back_populates</code>&nbsp;两个参数。</p>\r\n\r\n<p>两个参数的效果完全一致，区别在于，<code>backref</code>&nbsp;只需要在&nbsp;<code>Parent</code>&nbsp;类中声明&nbsp;<code>children</code>，<code>Child.parent</code>&nbsp;会被动态创建。</p>\r\n\r\n<p>而&nbsp;<code>back_populates</code>&nbsp;必须在两个类中显式地使用&nbsp;<code>back_populates</code>，更显繁琐。（但是也更清晰？）</p>\r\n\r\n<p>先看&nbsp;<code>backref</code>&nbsp;版：</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">class Parent(Base):\r\n    __tablename__ = \'parent\'\r\n    id = Column(Integer, primary_key=True)\r\n    children = relationship(\"Child\",\r\n                            backref=\"parent\")  # backref 表示，在 Child 类中动态创建 parent 属性，指向当前类。\r\n\r\n# Child 类不需要修改</code></pre>\r\n</div>\r\n\r\n<p>再看&nbsp;<code>back_populates</code>&nbsp;版：</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">class Parent(Base):\r\n    __tablename__ = \'parent\'\r\n    id = Column(Integer, primary_key=True)\r\n    children = relationship(\"Child\", back_populates=\"parent\")  # back_populates \r\n\r\nclass Child(Base):\r\n    __tablename__ = \'child\'\r\n    id = Column(Integer, primary_key=True)\r\n    parent_id = Column(Integer, ForeignKey(\'parent.id\'))\r\n\r\n    # 这边也必须声明，不能省略！\r\n    parent = relationship(\"Parent\", back_populates=\"children\")  # parent 不是集合，是属性！</code></pre>\r\n</div>\r\n\r\n<p><strong>NOTE：声明的两个&nbsp;<code>relationship</code>&nbsp;不需要多余的说明，SQLAlchemy 能自动识别到&nbsp;<code>parent.children</code>&nbsp;是 collection，<code>child.parent</code>&nbsp;是 attribute.</strong></p>\r\n\r\n<p>2. 反向引用的参数：<code>sqlalchemy.orm.backref(name, **kwargs)</code></p>\r\n\r\n<p>使用&nbsp;<code>back_populates</code>&nbsp;时，我们可以很方便地在两个&nbsp;<code>relationship</code>&nbsp;函数中指定各种参数：</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">class Parent(Base):\r\n    __tablename__ = \'parent\'\r\n    id = Column(Integer, primary_key=True)\r\n    children = relationship(\"Child\", back_populates=\"parent\", \r\n                                        lazy=\'dynamic\')  # 指定 lazy 的值\r\n\r\nclass Child(Base):\r\n    __tablename__ = \'child\'\r\n    id = Column(Integer, primary_key=True)\r\n    parent_id = Column(Integer, ForeignKey(\'parent.id\'))\r\n    parent = relationship(\"Parent\", back_populates=\"children\", \r\n                                      lazy=\'dynamic\')  # 指定 lazy 的值</code></pre>\r\n</div>\r\n\r\n<p>但是如果使用&nbsp;<code>backref</code>，因为我们只有一个&nbsp;<code>relationship</code>&nbsp;函数，<code>Child.parent</code>&nbsp;是被隐式创建的，我们该如何指定这个属性的参数呢？</p>\r\n\r\n<p>答案就是&nbsp;<code>backref()</code>&nbsp;函数，使用它替代&nbsp;<code>backref</code>&nbsp;参数的值：</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">from sqlalchemy.orm import backref\r\n\r\nclass Parent(Base):\r\n    __tablename__ = \'parent\'\r\n    id = Column(Integer, primary_key=True)\r\n    children = relationship(\"Child\",\r\n                            backref=backref(\"parent\", lazy=\'dynamic\'))  # 使用 backref() 函数，指定 Child.parent 属性的参数\r\n\r\n# Child 类不需要修改</code></pre>\r\n</div>\r\n\r\n<p><code>backref()</code>&nbsp;的参数会被传递给&nbsp;<code>relationship()</code>，因此它俩的参数也完全一致。</p>\r\n\r\n<h3>多对一</h3>\r\n\r\n<p>A many-to-one is similar to a one-to-many relationship. The difference is that this relationship is looked at from the &quot;many&quot; side.</p>\r\n\r\n<h3>一对一</h3>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">class Parent(Base):\r\n    __tablename__ = \'parent\'\r\n    id = Column(Integer, primary_key=True)\r\n    child = relationship(\"Child\", \r\n                                    uselist=False,   # 不使用 collection！这是关键\r\n                                    back_populates=\"parent\")\r\n\r\nclass Child(Base):\r\n    __tablename__ = \'child\'\r\n    id = Column(Integer, primary_key=True)\r\n    parent_id = Column(Integer, ForeignKey(\'parent.id\'))\r\n\r\n     # 包含 ForeignKey 的类，此属性默认为 attribute，因此不需要 uselist=False\r\n    parent = relationship(\"Parent\", back_populates=\"child\") </code></pre>\r\n</div>\r\n\r\n<h3>多对多</h3>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\"># 多对多，必须要使用一个关联表！\r\nassociation_table = Table(\'association\', Base.metadata,\r\n    Column(\'left_id\', Integer, ForeignKey(\'left.id\')),  # 约定俗成的规矩，左边是 parent\r\n    Column(\'right_id\', Integer, ForeignKey(\'right.id\'))  # 右边是 child\r\n)\r\n\r\nclass Parent(Base):\r\n    __tablename__ = \'left\'\r\n    id = Column(Integer, primary_key=True)\r\n    children = relationship(\"Child\",\r\n                    secondary=association_table)  # 专用参数 secondary，用于指定使用的关联表\r\n\r\nclass Child(Base):\r\n    __tablename__ = \'right\'\r\n    id = Column(Integer, primary_key=True)</code></pre>\r\n</div>\r\n\r\n<p>要添加反向引用时，同样可以使用&nbsp;<code>backref</code>&nbsp;或&nbsp;<code>back_populates</code>.</p>\r\n\r\n<p>user2user</p>\r\n\r\n<p>如果多对多关系中的两边都是 user，即都是同一个表时，该怎么声明？</p>\r\n\r\n<p>例如用户的「关注」与「粉丝」，你是 user，你的粉丝是 user，你关注的账号也是 user。</p>\r\n\r\n<p>这个时候，关联表&nbsp;<code>association_table</code>&nbsp;的两个键都是&nbsp;<code>user</code>，<strong>SQLAlchemy 无法区分主次，需要手动指定</strong>，为此需要使用&nbsp;<code>primaryjoin</code>&nbsp;和&nbsp;<code>secondaryjoin</code>&nbsp;两个参数。</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\"># 关联表，左侧的 user 正在关注右侧的 user\r\nfollowers = db.Table(\'followers\',\r\n    db.Column(\'follower_id\', db.Integer, db.ForeignKey(\'user.id\')),  # 左侧\r\n    db.Column(\'followed_id\', db.Integer, db.ForeignKey(\'user.id\'))  # 右侧，被关注的 user\r\n)\r\n\r\nclass User(UserMixin, db.Model):\r\n    id = db.Column(db.Integer, primary_key=True)\r\n    username = db.Column(db.String(64), index=True, unique=True, nullable=False)\r\n    email = db.Column(db.String(120), index=True, unique=True, nullable=False)\r\n    password_hash = db.Column(db.String(128), nullable=False)\r\n\r\n    # 我关注的 users\r\n    followed = db.relationship(\r\n        \'User\',\r\n        secondary=followers,  # 指定多对多关联表\r\n        primaryjoin=(followers.c.follower_id == id),  # 左侧，用于获取「我关注的 users」的 join 条件\r\n        secondaryjoin=(followers.c.followed_id == id),  # 右侧，用于获取「我的粉丝」的 join 条件\r\n        lazy=\'dynamic\',  # 延迟求值，这样才能用 filter_by 等过滤函数\r\n        backref=db.backref(\'followers\', lazy=\'dynamic\'))  # followers 也要延迟求值</code></pre>\r\n<img src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" /><span style=\"background-color:rgba(220,220,220,0.5)\"><img src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" style=\"height:15px; width:15px\" title=\"点击并拖拽以移动\" /></span></div>\r\n\r\n<p>这里比较绕的，就是容易搞混&nbsp;<code>primaryjoin</code>&nbsp;和&nbsp;<code>secondaryjoin</code>&nbsp;两个参数。</p>\r\n\r\n<ol>\r\n	<li>primaryjoin：（多对多中）用于从子对象查询其父对象的 condition（child.parents），默认只考虑外键。</li>\r\n	<li>secondaryjoin：（多对多中）用于从父对象查询其所有子对象的 condition（parent.children），同样的，默认情况下只考虑外键。</li>\r\n</ol>\r\n\r\n<h2>ORM 层 的 &ldquo;delete&rdquo; cascade vs. FOREIGN KEY 层的 &ldquo;ON DELETE&rdquo; cascade</h2>\r\n\r\n<p>之前有讲过 Table 定义中的级联操作：<code>ON DELETE</code>&nbsp;和&nbsp;<code>ON UPDATE</code>，可以通过&nbsp;<code>ForeignKey</code>&nbsp;的参数指定为&nbsp;<code>CASCADE</code>.</p>\r\n\r\n<p>可 SQLAlchemy 还有一个&nbsp;<code>relationship</code>&nbsp;生成 SQL 语句时的配置参数&nbsp;<code>cascade</code>，另外&nbsp;<code>passive_deletes</code>&nbsp;也可以指定为&nbsp;<code>cascade</code>。</p>\r\n\r\n<p>有这么多的 cascade，我真的是很懵。这三个 cascade 到底有何差别呢？</p>\r\n\r\n<p>外键约束中的&nbsp;<code>ON DELETE</code>&nbsp;和&nbsp;<code>ON UPDATE</code>，与 ORM 层的&nbsp;<code>CASCADE</code>&nbsp;在功能上，确实有很多重叠的地方。<br />\r\n但是也有很多不同：</p>\r\n\r\n<ol>\r\n	<li>数据库层面的&nbsp;<code>ON DELETE</code>&nbsp;级联能高效地处理&nbsp;<strong>many-to-one</strong>&nbsp;的关联；我们在&nbsp;<code>many</code>&nbsp;方定义外键，也在这里添加&nbsp;<code>ON DELETE</code>&nbsp;约束。而在 ORM 层，就<strong>刚好相反</strong>。SQLAlchemy 在&nbsp;<code>one</code>&nbsp;方处理&nbsp;<code>many</code>&nbsp;方的删除操作，这意味着它更适合处理&nbsp;<strong>one-to-many</strong>&nbsp;的关联。</li>\r\n	<li>数据库层面上，不带&nbsp;<code>ON DELETE</code>&nbsp;的外键常用于防止父数据被删除，而导致子数据成为无法被索引到的垃圾数据。如果要在一个 one-to-many 映射上实现这个行为，SQLAlchemy 将外键设置为 NULL 的默认行为可以通过以下两种方式之一捕获：\r\n	<ol>\r\n		<li>最简单也最常用的方法，当然是将外键定义为&nbsp;<strong>NOT NULL</strong>. 尝试将该列设为 NULL 会触发 NOT NULL constraint exception.</li>\r\n		<li>另一种更特殊的方法，是将&nbsp;<code>passive_deletes</code>&nbsp;标志设置为字&nbsp;<code>all</code>. 这会完全禁用 SQLAlchemy 将外键列设置为 NULL 的行为，并且 DELETE 父数据而不会对子数据产生任何影响。这样才能触发数据库层面的&nbsp;<code>ON DELETE</code>&nbsp;约束，或者其他的触发器。</li>\r\n		<li>数据库层面的&nbsp;<code>ON DELETE</code>&nbsp;级联 比 ORM 层面的级联更高效。数据库可以同时在多个 relationship 中链接一系列级联操作。</li>\r\n		<li>SQLAlchemy 不需要这么复杂，因为我们通过将 passive_deletes 选项与正确配置的外键约束结合使用，提供与数据库的&nbsp;<code>ON DELETE</code>&nbsp;功能的平滑集成。</li>\r\n	</ol>\r\n	</li>\r\n</ol>\r\n\r\n<h3>方法一：ORM 层的 cascade 实现</h3>\r\n\r\n<p><code>relationship</code>&nbsp;的&nbsp;<code>cascade</code>&nbsp;参数决定了修改父表时，什么时候子表要进行级联操作。它的可选项有（str，选项之间用逗号分隔）：</p>\r\n\r\n<ol>\r\n	<li><code>save-update</code>：默认选项之一。在 add（对应 SQL 的 insert 或 update）一个对象的时候，会 add 所有它相关联的对象。</li>\r\n	<li><code>merge</code>：默认选项之一。在 merge（相当字典的update操作，有就替换掉，没有就合并）一个对象的时候，会 merge 所有和它相关联的对象。</li>\r\n	<li><code>expunge</code>&nbsp;：移除操作的时候，会将相关联的对象也进行移除。这个操作只是从session中移除，并不会真正的从数据库中删除。</li>\r\n	<li><code>delete</code>：删除父表数据时，同时删除与它关联的数据。</li>\r\n	<li><code>delete-orphan</code>：当子对象与父对象解除关系时，删除掉此子对象（孤儿）。（其实还是没懂。。）</li>\r\n	<li><code>refresh-expire</code>：不常用。</li>\r\n	<li><code>all</code>：表示选中除&nbsp;<code>delete-orphan</code>&nbsp;之外的所有选项。（因此&nbsp;<code>all, delete-orphan</code>&nbsp;很常用，它才是真正的&nbsp;<code>all</code>）</li>\r\n</ol>\r\n\r\n<p>默认属性是 &quot;save-update, merge&quot;.</p>\r\n\r\n<p>这只是简略的说明，上述几个参数的详细文档见&nbsp;<a href=\"https://docs.sqlalchemy.org/en/13/orm/cascades.html#unitofwork-cascades\">SQLAlchemy - Cascades</a></p>\r\n\r\n<h3>方法二：数据库层的 cascade 实现</h3>\r\n\r\n<ol>\r\n	<li>将&nbsp;<code>ForeignKey</code>&nbsp;的&nbsp;<code>ondelete</code>&nbsp;和&nbsp;<code>onupdate</code>&nbsp;参数指定为&nbsp;<code>CASCADE</code>，实现数据库层面的级联。</li>\r\n	<li>为&nbsp;<code>relationship</code>&nbsp;添加关键字参数&nbsp;<code>passive_deletes=&quot;all&quot;</code>，这样就完全禁用 SQLAlchemy 将外键列设置为 NULL 的行为，并且 DELETE 父数据不会对子数据产生任何影响。</li>\r\n</ol>\r\n\r\n<p>这样 DELETE 操作时，就会触发数据库的&nbsp;<code>ON DELETE</code>&nbsp;约束，从而级联删除子数据。</p>\r\n\r\n<h2>参考</h2>\r\n\r\n<ul>\r\n	<li><a href=\"https://docs.sqlalchemy.org/en/13/orm/relationships.html\">SQLAlchemy - Relationship Configuration</a></li>\r\n	<li><a href=\"https://docs.sqlalchemy.org/en/13/orm/cascades.html#unitofwork-cascades\">SQLAlchemy - Cascades</a></li>\r\n	<li><a href=\"https://ia.jifangcheng.com/p/46\">SQLAlchemy 中的 backref 和 back_populates</a></li>\r\n	<li><a href=\"https://blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-viii-followers\">The Flask Mega-Tutorial Part VIII: Followers</a></li>\r\n</ul>',
        '', '2019-12-23 02:19:00', '2019-12-23 02:19:00', 94, 1, 1, 0, 0, 1);
INSERT INTO `tb_content`
VALUES (57, 'Simple UI 让Django Admin简单而友好',
        '<h1><img alt=\"\" src=\"/media/upload/2020/03/11/logo.png\" style=\"height:129px; width:400px\" /></h1>\r\n\r\n<p>让Django Admin简单而友好</p>\r\n\r\n<p>Simple and friendly. Django admin theme the simpleui</p>\r\n\r\n<hr />\r\n<p>&nbsp;</p>\r\n\r\n<h2>介绍</h2>\r\n\r\n<p>simpleui 是django admin的一个主题 是一个基于element-ui+vue开发，重写和优化90%以上的页面。 与suit是同类产品。我们是一个更符合国人审美和使用习惯的一个主题。</p>\r\n\r\n<h2>特点</h2>\r\n\r\n<hr />\r\n<p>内置28款流行的主题</p>\r\n\r\n<p>pip闪电安装100%兼容原生admin无需修改代码</p>\r\n\r\n<p>多标签页面，各个模块更加清晰明了</p>\r\n\r\n<p>配置简单，极速上手，在settings.py中加入simpleui后启动立即生效，效率提升 100%！让后端开发得心应手。</p>\r\n\r\n<p>Element-UI + Vue 加持，让古老的django admin 焕然一新。</p>\r\n\r\n<h2>文档&amp;教程</h2>\r\n\r\n<p>文档详细的描述了安装使用方法，以及各种配置项的说明，请点击以下链接查阅。</p>\r\n\r\n<ul>\r\n	<li>重要的事情说3遍：</li>\r\n</ul>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>1.<a href=\"https://simpleui.88cto.com/docs/simpleui/QUICK.html\">simpleui文档教程使用说明</a>&nbsp;</p>\r\n\r\n<p>2.<a href=\"https://simpleui.88cto.com/docs/simpleui/QUICK.html\">simpleui文档教程使用说明</a></p>\r\n\r\n<p>3.<a href=\"https://simpleui.88cto.com/docs/simpleui/QUICK.html\">simpleui文档教程使用说明</a></p>\r\n\r\n<h2>开发初衷</h2>\r\n\r\n<p>Django Admin默认界面设计语言存在着的一些不足，比如色彩单一，大量线条的使用，分割化明显。将这些不足归类一下就是界面单调、雷同性明显、缺少惊喜。我们认为新的平台类视觉风格可以打破这些束缚，尝试一些新的探索，启发传统的设计认知,因此结合当下设计趋势，构思了Element+Django Admin的Simpleui。让Django Admin和Element产生完美的交互。配以最流行的后台设计风格，让Django Admin更加强大。</p>\r\n\r\n<h2>本地Demo</h2>\r\n\r\n<p>如果你没有任何python django基础，可以下载一个可以直接运行的demo进行体验。&nbsp;<a href=\"https://github.com/newpanjing/simpleui_demo\" rel=\"noopener noreferrer\" target=\"_blank\">DEMO源码</a></p>\r\n\r\n<h2>在线Demo</h2>\r\n\r\n<blockquote>\r\n<p>权限受限，只能查看模块的相关数据，不能操作。如果要体验全部功能，请在自己的系统安装simpleui查看效果。</p>\r\n</blockquote>\r\n\r\n<ul>\r\n	<li>地址：<a href=\"https://www.88cto.com/admin/\" rel=\"noopener noreferrer\" target=\"_blank\">https://www.88cto.com/admin/</a></li>\r\n	<li>用户名：demo</li>\r\n	<li>密码：demo123456</li>\r\n</ul>\r\n\r\n<h2>开始使用</h2>\r\n\r\n<p>详细步骤请浏览&nbsp;<a href=\"https://simpleui.88cto.com/docs/simpleui/QUICK.html\">使用文档</a>。 也可以参考<a href=\"https://simpleui.88cto.com/docs/simpleui/doc.html#%E5%9C%A8%E7%BA%BFDemo\">Demo</a></p>\r\n\r\n<h3>安装</h3>\r\n\r\n<pre>\r\n<code class=\"language-bash\">pip install django-simpleui\r\n</code></pre>\r\n\r\n<p>用pip或者<a href=\"https://simpleui.88cto.com/docs/simpleui/doc.html#%E5%85%8B%E9%9A%86%E6%BA%90%E7%A0%81%E6%9C%AC%E5%9C%B0%E5%AE%89%E8%A3%85\">源码方式</a>安装simpleui后，在自己项目的settings.py文件中INSTALLED_APPS的第一行加入<code>simpleui</code></p>\r\n\r\n<p>举个例子：</p>\r\n\r\n<pre>\r\n<code class=\"language-python\">  # Application definition\r\n\r\n  INSTALLED_APPS = [\r\n      \'simpleui\',\r\n      \'django.contrib.admin\',\r\n      \'django.contrib.auth\',\r\n      \'django.contrib.contenttypes\',\r\n      \'django.contrib.sessions\',\r\n      \'django.contrib.messages\',\r\n      \'django.contrib.staticfiles\',\r\n      ...\r\n  ]\r\n</code></pre>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>如果不知道怎么配置或者如何使用，请下载<a href=\"https://simpleui.88cto.com/docs/simpleui/doc.html#%E6%9C%AC%E5%9C%B0Demo%E4%B8%8B%E8%BD%BD\">本地demo</a>进行学习。或者加入QQ群：786576510 咨询。</p>\r\n\r\n<h3>升级simpleui</h3>\r\n\r\n<pre>\r\n<code class=\"language-bash\">pip install django-simpleui --upgrade\r\n</code></pre>\r\n\r\n<p>克隆源码本地安装</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">git clone https://github.com/newpanjing/simpleui\r\ncd simpleui\r\npython setup.py sdist install\r\n</code></pre>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h2><a href=\"https://simpleui.88cto.com/docs/simpleui/doc.html#%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98\">#</a>常见问题</h2>\r\n\r\n<ol>\r\n	<li>\r\n	<p>如果关闭debug模式后，请执行以下命令将simpleui静态文件静态文件克隆到根目录</p>\r\n\r\n	<pre>\r\n<code class=\"language-python\">python3 manage.py collectstatic\r\n</code></pre>\r\n\r\n	<p>&nbsp;</p>\r\n	</li>\r\n	<li>\r\n	<p>克隆静态文件出错 请在settings.py文件中加入：</p>\r\n\r\n	<pre>\r\n<code class=\"language-python\">STATIC_ROOT = os.path.join(BASE_DIR, \"static\")\r\n</code></pre>\r\n\r\n	<p>&nbsp;</p>\r\n	</li>\r\n	<li>\r\n	<p>其他问题请参考<a href=\"https://docs.djangoproject.com/zh-hans/2.2/\" rel=\"noopener noreferrer\" target=\"_blank\">django官方文档</a>。</p>\r\n	</li>\r\n	<li>\r\n	<p>i18n 国际化 采用js国际化，默认为英文和中文两种语言，随系统切换。具体请看<a href=\"https://simpleui.88cto.com/docs/simpleui/i18n.html\">国际化配置</a></p>\r\n	</li>\r\n</ol>\r\n\r\n<p>其他问题请查看<a href=\"https://simpleui.88cto.com/docs/simpleui/QUICK.html\">快速上手指南</a></p>\r\n\r\n<h2>支持django和python版本</h2>\r\n\r\n<h3>支持的Python版本</h3>\r\n\r\n<table>\r\n	<thead>\r\n		<tr>\r\n			<th>版本</th>\r\n			<th>说明</th>\r\n		</tr>\r\n	</thead>\r\n	<tbody>\r\n		<tr>\r\n			<td>Python2.7.x</td>\r\n			<td>不支持</td>\r\n		</tr>\r\n		<tr>\r\n			<td>Python3.x</td>\r\n			<td>支持</td>\r\n		</tr>\r\n		<tr>\r\n			<td>Python3.7.x</td>\r\n			<td>支持</td>\r\n		</tr>\r\n		<tr>\r\n			<td>Python3.8.x</td>\r\n			<td>支持</td>\r\n		</tr>\r\n		<tr>\r\n			<td>Python3.9.x</td>\r\n			<td>支持</td>\r\n		</tr>\r\n	</tbody>\r\n</table>\r\n\r\n<blockquote>\r\n<p>不支持是指未经官方测试，可能某些模块会报错。</p>\r\n</blockquote>\r\n\r\n<blockquote>\r\n<p>3.9由于未发布，PyCharm不支持，可以用命令行创建Python39虚拟环境</p>\r\n</blockquote>\r\n\r\n<pre>\r\n<code class=\"language-python\">python39 -m venv venv39\r\n</code></pre>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h3>支持的Django版本</h3>\r\n\r\n<table>\r\n	<thead>\r\n		<tr>\r\n			<th>版本</th>\r\n			<th>说明</th>\r\n		</tr>\r\n	</thead>\r\n	<tbody>\r\n		<tr>\r\n			<td>Django1.x</td>\r\n			<td>不支持</td>\r\n		</tr>\r\n		<tr>\r\n			<td>Django2.x</td>\r\n			<td>支持</td>\r\n		</tr>\r\n		<tr>\r\n			<td>Django3.x</td>\r\n			<td>支持</td>\r\n		</tr>\r\n	</tbody>\r\n</table>\r\n\r\n<blockquote>\r\n<p>不支持是指未经官方测试，可能某些模块会报错。</p>\r\n</blockquote>\r\n\r\n<h2>浏览器兼容性</h2>\r\n\r\n<table>\r\n	<thead>\r\n		<tr>\r\n			<th><img alt=\"Chrome\" src=\"https://raw.github.com/alrra/browser-logos/master/src/chrome/chrome_48x48.png\" /></th>\r\n			<th><img alt=\"Firefox\" src=\"https://raw.github.com/alrra/browser-logos/master/src/firefox/firefox_48x48.png\" /></th>\r\n			<th><img alt=\"Edge\" src=\"https://raw.github.com/alrra/browser-logos/master/src/edge/edge_48x48.png\" /></th>\r\n			<th><img alt=\"IE\" src=\"https://raw.github.com/alrra/browser-logos/master/src/archive/internet-explorer_9-11/internet-explorer_9-11_48x48.png\" /></th>\r\n			<th><img alt=\"Safari\" src=\"https://raw.github.com/alrra/browser-logos/master/src/safari/safari_48x48.png\" /></th>\r\n			<th><img alt=\"Opera\" src=\"https://raw.github.com/alrra/browser-logos/master/src/opera/opera_48x48.png\" /></th>\r\n			<th><img alt=\"UC\" src=\"https://raw.github.com/alrra/browser-logos/master/src/uc/uc_48x48.png\" /></th>\r\n		</tr>\r\n	</thead>\r\n	<tbody>\r\n		<tr>\r\n			<td>✔</td>\r\n			<td>✔</td>\r\n			<td>✔</td>\r\n			<td>11+ ✔</td>\r\n			<td>✔</td>\r\n			<td>✔</td>\r\n			<td>✔</td>\r\n		</tr>\r\n	</tbody>\r\n</table>\r\n\r\n<h2>预览图</h2>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h3>登录页</h3>\r\n\r\n<p><img alt=\"\" src=\"https://github.com/newpanjing/simpleui/raw/master/images/%E6%95%B0%E6%8D%AE%E9%A1%B5.png\" /></p>\r\n\r\n<h3>主页</h3>\r\n\r\n<p><img alt=\"\" src=\"https://github.com/newpanjing/simpleui/raw/master/images/%E4%B8%BB%E9%A1%B5.png\" /></p>\r\n\r\n<h3>列表页</h3>\r\n\r\n<p><img alt=\"\" src=\"https://github.com/newpanjing/simpleui/raw/master/images/%E5%88%97%E8%A1%A8%E9%A1%B5.png\" />&nbsp;<img alt=\"\" src=\"https://github.com/newpanjing/simpleui/raw/master/images/%E6%95%B0%E6%8D%AE%E9%A1%B5.png\" /></p>\r\n\r\n<h3>切换主题</h3>\r\n\r\n<p><img alt=\"\" src=\"https://github.com/newpanjing/simpleui/raw/master/images/%E5%88%87%E6%8D%A2%E4%B8%BB%E9%A2%98.png\" /></p>\r\n\r\n<h3>密码修改</h3>\r\n\r\n<p><img alt=\"\" src=\"https://github.com/newpanjing/simpleui/raw/master/images/%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9.png\" /></p>\r\n\r\n<h3>编辑页</h3>\r\n\r\n<p><img alt=\"\" src=\"https://github.com/newpanjing/simpleui/raw/master/images/%E7%BC%96%E8%BE%91%E9%A1%B5.png\" /></p>\r\n\r\n<h3>设置字体大小</h3>\r\n\r\n<p><img alt=\"\" src=\"https://github.com/newpanjing/simpleui/raw/master/images/%E8%AE%BE%E7%BD%AE%E5%AD%97%E4%BD%93%E5%A4%A7%E5%B0%8F.png\" /></p>',
        '', '2020-03-11 03:39:00', '2020-03-11 03:39:00', 84, 1, 5, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (58, 'Python Kite 使用教程 轻量级代码提示',
        '<h3><img alt=\"\" data-widget=\"image\" src=\"https://img-blog.csdnimg.cn/20200312114843237.png\" style=\"height:162px; width:761px\" /></h3>\r\n\r\n<h3>Kite介绍</h3>\r\n\r\n<blockquote>\r\n<p>介绍一款针对python代码自动补全的工具 &mdash;&mdash; Kite ，不需额外的环境配置，more importantly是免费的哦~~对于经常使用Python的朋友们，非常推荐一用，撸码效率大大提升。<br />\r\nKite is a plugin for your IDE that uses machine learning to give you<br />\r\nuseful code completions for Python. Start coding faster today.</p>\r\n</blockquote>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<ul>\r\n	<li>系统支持：Windows，Linux，Mac</li>\r\n	<li>解释器支持：PyCharm，VS Code，Vim，Sublime等。</li>\r\n</ul>\r\n\r\n<p>Python之父给予了很大的赞许，表示非常喜爱这个功能。</p>\r\n\r\n<p><img alt=\"\" data-widget=\"image\" src=\"https://img-blog.csdnimg.cn/20200312114903882.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:225px; width:1080px\" /></p>\r\n\r\n<p>简单介绍下效率：比如我们使用Pycharm可以直接调用函数并自动补全，但它们都是静态的，并不会随着开发者的编写过程而改变。下面我们写函数时，需要自己修改参数与子语句。</p>\r\n\r\n<p><img alt=\"\" data-widget=\"image\" src=\"https://img-blog.csdnimg.cn/2020031211493487.gif\" style=\"height:384px; width:640px\" /></p>\r\n\r\n<p><em>图片来源于Python数据科学 ，作者wlsq）</em></p>\r\n\r\n<p>而Kite会利用机器学习预测一些常用的编程模式，并在我们写代码时提供这些模式。<img alt=\"\" data-widget=\"image\" src=\"https://img-blog.csdnimg.cn/20200312114951254.gif\" style=\"height:329px; width:638px\" /></p>\r\n\r\n<p><em>（图片来源于Python数据科学 ，作者wlsq）</em></p>\r\n\r\n<h2>&nbsp;</h2>\r\n\r\n<h2>安装</h2>\r\n\r\n<p>&nbsp;下载链接 :<a href=\"https://kite.com/download/\">https://kite.com/download/</a>&nbsp;</p>\r\n\r\n<p>提供&nbsp;Install for&nbsp;<a href=\"https://alpha.kite.com/release/dls/mac/current\">macOS</a>&nbsp;or&nbsp;<a href=\"https://kite.com/download/#\">Linux</a>&nbsp;win&nbsp;三大版本支持&nbsp;</p>\r\n\r\n<p>编辑器:&nbsp;<a href=\"https://kite.com/integrations/atom-editor/\">Available for Atom,</a>&nbsp;<a href=\"https://kite.com/integrations/pycharm/\">PyCharm,</a>&nbsp;<a href=\"https://kite.com/integrations/sublime-text/\">Sublime,</a>&nbsp;<a href=\"https://kite.com/integrations/vs-code/\">VS Code,</a>&nbsp;<a href=\"https://kite.com/integrations/vim/\">and Vim</a>.&nbsp;</p>\r\n\r\n<p><strong>注意:&nbsp;默认是安装在C盘 ,不会给你选择安装盘符的选项</strong></p>\r\n\r\n<p><strong>安装完成后:&nbsp;输入你的邮箱&nbsp;进行绑定注册</strong></p>\r\n\r\n<p><img alt=\"\" data-widget=\"image\" src=\"https://img-blog.csdnimg.cn/20200312115143298.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:762px; width:404px\" /></p>\r\n\r\n<p>&nbsp;进入插件选项,选择&nbsp;你使用的编辑器插件,,这里我安装了&nbsp;<strong>pyecharm</strong></p>\r\n\r\n<p><img alt=\"\" data-widget=\"image\" src=\"https://img-blog.csdnimg.cn/20200312115148899.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:760px; width:400px\" /></p>',
        '', '2020-03-12 03:53:00', '2020-03-12 03:53:00', 77, 1, 2, 0, 0, 1);
INSERT INTO `tb_content`
VALUES (59, '给你的背景添加彩带',
        '<h2>预览：</h2>\r\n\r\n<p><a href=\"http://chenyinren.top/\" target=\"_blank\">页面浏览</a></p>\r\n\r\n<h2>配置</h2>\r\n\r\n<ul>\r\n	<li>size：功能区的大小，默认值：90。</li>\r\n	<li>alpha：行的不透明度（0~1），默认值：0.6。</li>\r\n	<li>zIndex：z空间的索引，默认值：-1。</li>\r\n</ul>\r\n\r\n<p>例：</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-html\">&lt;script type=\"text/javascript\" size=\"150\" alpha=\'0.3\' zIndex=\"-2\"&gt;js内容&lt;/script&gt;</code></pre>\r\n</div>\r\n\r\n<h2>js中参数设置1：</h2>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-javascript\">this._options = {\r\n    // 色带HSL饱和度\r\n    colorSaturation: \"80%\",\r\n    // 色带HSL亮度量\r\n    colorBrightness: \"60%\",\r\n    // 带状颜色不透明度\r\n    colorAlpha: 0.65,\r\n    // 在HSL颜色空间中循环显示颜色的速度有多快\r\n    colorCycleSpeed: 6,\r\n    // 从哪一侧开始Y轴 (top|min, middle|center, bottom|max, random)\r\n    verticalPosition: \"center\",\r\n    // 到达屏幕另一侧的速度有多快\r\n    horizontalSpeed: 200,\r\n    // 在任何给定时间，屏幕上会保留多少条带\r\n    ribbonCount: 3,\r\n    // 添加笔划以及色带填充颜色\r\n    strokeSize: 0,\r\n    // 通过页面滚动上的因子垂直移动色带\r\n    parallaxAmount: -0.5,\r\n    // 随着时间的推移，为每个功能区添加动画效果\r\n    animateSections: true\r\n};</code></pre>\r\n</div>\r\n\r\n<h2>参数设置2：</h2>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-javascript\">this._canvas = document.createElement(\"canvas\");\r\nthis._canvas.style[\"display\"] = \"block\";\r\nthis._canvas.style[\"position\"] = \"fixed\";\r\nthis._canvas.style[\"margin\"] = \"0\";\r\nthis._canvas.style[\"padding\"] = \"0\";\r\nthis._canvas.style[\"border\"] = \"0\";\r\nthis._canvas.style[\"outline\"] = \"0\";\r\nthis._canvas.style[\"left\"] = \"0\";\r\nthis._canvas.style[\"top\"] = \"0\";\r\nthis._canvas.style[\"width\"] = \"100%\";\r\nthis._canvas.style[\"height\"] = \"100%\";\r\nthis._canvas.style[\"z-index\"] = \"-1\";\r\nthis._canvas.id = \"bgCanvas\";\r\nthis._canvas.style[\"background-color\"]=\"#1f1f1f\";\r\nthis._onResize();</code></pre>\r\n</div>\r\n\r\n<h2>在typecho中使用</h2>\r\n\r\n<p>配置好并且最小化的懒人js&#39;</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-javascript\">&lt;script type=&quot;text/javascript&quot; size=&quot;150&quot; alpha=&#39;0.3&#39; zIndex=&quot;-2&quot;&gt;&quot;object&quot;==typeof window&amp;&amp;(window.Ribbons=function(){var t=window,i=document.body,n=document.documentElement,o=function(){if(1===arguments.length){if(Array.isArray(arguments[0])){var t=Math.round(o(0,arguments[0].length-1));return arguments[0][t]}return o(0,arguments[0])}return 2===arguments.length?Math.random()*(arguments[1]-arguments[0])+arguments[0]:0},s=function(o){var s=Math.max(0,t.innerWidth||n.clientWidth||i.clientWidth||0),h=Math.max(0,t.innerHeight||n.clientHeight||i.clientHeight||0),e=Math.max(0,t.pageXOffset||n.scrollLeft||i.scrollLeft||0)-(n.clientLeft||0),a=Math.max(0,t.pageYOffset||n.scrollTop||i.scrollTop||0)-(n.clientTop||0);return{width:s,height:h,ratio:s/h,centerx:s/2,centery:h/2,scrollx:e,scrolly:a}},h=function(t,i){this.x=0,this.y=0,this.set(t,i)};h.prototype={constructor:h,set:function(t,i){this.x=t||0,this.y=i||0},copy:function(t){return this.x=t.x||0,this.y=t.y||0,this},multiply:function(t,i){return this.x*=t||1,this.y*=i||1,this},divide:function(t,i){return this.x/=t||1,this.y/=i||1,this},add:function(t,i){return this.x+=t||0,this.y+=i||0,this},subtract:function(t,i){return this.x-=t||0,this.y-=i||0,this},clampX:function(t,i){return this.x=Math.max(t,Math.min(this.x,i)),this},clampY:function(t,i){return this.y=Math.max(t,Math.min(this.y,i)),this},flipX:function(){return this.x*=-1,this},flipY:function(){return this.y*=-1,this}};var e=function(t){this._canvas=null,this._context=null,this._sto=null,this._width=0,this._height=0,this._scroll=0,this._ribbons=[],this._options={colorSaturation:&quot;80%&quot;,colorBrightness:&quot;60%&quot;,colorAlpha:.65,colorCycleSpeed:6,verticalPosition:&quot;center&quot;,horizontalSpeed:150,ribbonCount:3,strokeSize:0,parallaxAmount:-.5,animateSections:!0},this._onDraw=this._onDraw.bind(this),this._onResize=this._onResize.bind(this),this._onScroll=this._onScroll.bind(this),this.setOptions(t),this.init()};return e.prototype={constructor:e,setOptions:function(t){if(&quot;object&quot;==typeof t)for(var i in t)t.hasOwnProperty(i)&amp;&amp;(this._options[i]=t[i])},init:function(){try{this._canvas=document.createElement(&quot;canvas&quot;),this._canvas.style.display=&quot;block&quot;,this._canvas.style.position=&quot;fixed&quot;,this._canvas.style.margin=&quot;0&quot;,this._canvas.style.padding=&quot;0&quot;,this._canvas.style.border=&quot;0&quot;,this._canvas.style.outline=&quot;0&quot;,this._canvas.style.left=&quot;0&quot;,this._canvas.style.top=&quot;0&quot;,this._canvas.style.width=&quot;100%&quot;,this._canvas.style.height=&quot;100%&quot;,this._canvas.style[&quot;z-index&quot;]=&quot;-1&quot;,this._canvas.id=&quot;bgCanvas&quot;,this._onResize(),this._context=this._canvas.getContext(&quot;2d&quot;),this._context.clearRect(0,0,this._width,this._height),this._context.globalAlpha=this._options.colorAlpha,window.addEventListener(&quot;resize&quot;,this._onResize),window.addEventListener(&quot;scroll&quot;,this._onScroll),document.body.appendChild(this._canvas)}catch(t){return void console.warn(&quot;Canvas Context Error: &quot;+t.toString())}this._onDraw()},addRibbon:function(){var t=Math.round(o(1,9))&gt;5?&quot;right&quot;:&quot;left&quot;,i=1e3,n=this._width+200,s=0,e=0,a=&quot;right&quot;===t?-200:n,r=Math.round(o(0,this._height));/^(top|min)$/i.test(this._options.verticalPosition)?r=200:/^(middle|center)$/i.test(this._options.verticalPosition)?r=this._height/2:/^(bottom|max)$/i.test(this._options.verticalPosition)&amp;&amp;(r=this._height-200);for(var l=[],c=new h(a,r),p=new h(a,r),_=null,d=Math.round(o(0,360)),u=0;!(i&lt;=0);){if(i--,s=Math.round((1*Math.random()-.2)*this._options.horizontalSpeed),e=Math.round((1*Math.random()-.5)*(.25*this._height)),(_=new h).copy(p),&quot;right&quot;===t){if(_.add(s,e),p.x&gt;=n)break}else if(&quot;left&quot;===t&amp;&amp;(_.subtract(s,e),p.x&lt;=-200))break;l.push({point1:new h(c.x,c.y),point2:new h(p.x,p.y),point3:_,color:d,delay:u,dir:t,alpha:0,phase:0}),c.copy(p),p.copy(_),u+=4,d+=this._options.colorCycleSpeed}this._ribbons.push(l)},_drawRibbonSection:function(t){if(t){if(t.phase&gt;=1&amp;&amp;t.alpha&lt;=0)return!0;if(t.delay&lt;=0){if(t.phase+=.02,t.alpha=1*Math.sin(t.phase),t.alpha=t.alpha&lt;=0?0:t.alpha,t.alpha=t.alpha&gt;=1?1:t.alpha,this._options.animateSections){var i=.1*Math.sin(1+t.phase*Math.PI/2);&quot;right&quot;===t.dir?(t.point1.add(i,0),t.point2.add(i,0),t.point3.add(i,0)):(t.point1.subtract(i,0),t.point2.subtract(i,0),t.point3.subtract(i,0)),t.point1.add(0,i),t.point2.add(0,i),t.point3.add(0,i)}}else t.delay-=.5;var n=this._options.colorSaturation,o=this._options.colorBrightness,s=&quot;hsla(&quot;+t.color+&quot;, &quot;+n+&quot;, &quot;+o+&quot;, &quot;+t.alpha+&quot; )&quot;;this._context.save(),0!==this._options.parallaxAmount&amp;&amp;this._context.translate(0,this._scroll*this._options.parallaxAmount),this._context.beginPath(),this._context.moveTo(t.point1.x,t.point1.y),this._context.lineTo(t.point2.x,t.point2.y),this._context.lineTo(t.point3.x,t.point3.y),this._context.fillStyle=s,this._context.fill(),this._options.strokeSize&gt;0&amp;&amp;(this._context.lineWidth=this._options.strokeSize,this._context.strokeStyle=s,this._context.lineCap=&quot;round&quot;,this._context.stroke()),this._context.restore()}return!1},_onDraw:function(){for(var t=0,i=this._ribbons.length;t&lt;i;++t)this._ribbons[t]||this._ribbons.splice(t,1);this._context.clearRect(0,0,this._width,this._height);for(var n=0;n&lt;this._ribbons.length;++n){for(var o=this._ribbons[n],s=o.length,h=0,e=0;e&lt;s;++e)this._drawRibbonSection(o[e])&amp;&amp;h++;h&gt;=s&amp;&amp;(this._ribbons[n]=null)}this._ribbons.length&lt;this._options.ribbonCount&amp;&amp;this.addRibbon(),requestAnimationFrame(this._onDraw)},_onResize:function(t){var i=s();this._width=i.width,this._height=i.height,this._canvas&amp;&amp;(this._canvas.width=this._width,this._canvas.height=this._height,this._context&amp;&amp;(this._context.globalAlpha=this._options.colorAlpha))},_onScroll:function(t){var i=s();this._scroll=i.scrolly}},e}());const config={animateSections:!0,colorAlpha:.5,colorBrightness:&quot;50%&quot;,colorCycleSpeed:5,colorSaturation:&quot;60%&quot;,horizontalSpeed:200,parallaxAmount:-.2,ribbonCount:3,strokeSize:0,verticalPosition:&quot;random&quot;};new Ribbons;&lt;/script&gt;\r\n</code></pre>\r\n<img src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" /><img src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" style=\"height:15px; width:15px\" title=\"点击并拖拽以移动\" /></div>\r\n\r\n<p><br />\r\n复制这段内容并添加在前面，handsome主题可以在 开发者设置 自定义输出body 尾部的HTML代码中添加。</p>',
        '', '2020-03-18 08:27:00', '2020-03-18 08:27:00', 138, 1, 6, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (60, '教你在Nginx上使用CertBot把自己网站设置成HTTPS',
        '<h3><img alt=\"\" src=\"https://img-blog.csdnimg.cn/20200319173220222.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:342px; width:800px\" /></h3>\r\n\r\n<h3>前言</h3>\r\n\r\n<p>自己做了一个博客，需要访问自己的网站获取数据，但是系统默认只能直接访问https的网站。不想让应用改用http的服务。因此，研究如何启用https，本文即是介绍如何在CentOS上配合Nginx使用CertBot。</p>\r\n\r\n<p><strong>环境</strong></p>\r\n\r\n<ul>\r\n	<li>\r\n	<p><strong>Ubuntu</strong></p>\r\n	</li>\r\n	<li>\r\n	<p>Nginx</p>\r\n	</li>\r\n</ul>\r\n\r\n<h3>安装CertBot</h3>\r\n\r\n<p>命令行，键入：</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-bash\">sudo apt-get update\r\nsudo apt-get install software-properties-common\r\nsudo add-apt-repository universe\r\nsudo add-apt-repository ppa:certbot/certbot\r\nsudo apt-get update</code></pre>\r\n</div>\r\n\r\n<p>然后，可以使用以下命令安装certbot：</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-bash\">sudo apt-get install certbot python-certbot-nginx</code></pre>\r\n</div>\r\n\r\n<h2>生成证书</h2>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-bash\">sudo certbot --nginx</code></pre>\r\n</div>\r\n\r\n<p>剩下的一切会自动完成。Certbot 会自动帮你注册账户，检测 Nginx 配置文件中的域名，询问你为哪些域名生成证书，是否将 Http 重定向到 Https 等等，最后帮你自动修改 Nginx 配置并重启，这时你的网站已经变成了 Https。</p>\r\n\r\n<p>但Certbot没有给你自动修改Nginx配置时,这时候需要自己配置</p>\r\n\r\n<p>如果提示：</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-bash\">IMPORTANT NOTES:\r\n - Congratulations! Your certificate and chain have been saved at\r\n   /etc/letsencrypt/live/your.domain.com/fullchain.pem. Your cert\r\n   will expire on 20XX-09-23. To obtain a new or tweaked version of\r\n   this certificate in the future, simply run certbot again. To\r\n   non-interactively renew *all* of your certificates, run \"certbot\r\n   renew\"\r\n - If you like Certbot, please consider supporting our work by:\r\n\r\n   Donating to ISRG / Let\'s Encrypt:   https://letsencrypt.org/donate\r\n   Donating to EFF:                    https://eff.org/donate-le</code></pre>\r\n</div>\r\n\r\n<p>证书生成成功！</p>\r\n\r\n<h3>配置Nginx</h3>\r\n\r\n<p>目前已经自动帮我们配置证书了，我们可以看下配置的形式，后续可以自己配置。</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-bash\">server {\r\n        server_name bbs.wzlinux.com;   # managed by Certbot\r\n        root         /usr/share/nginx/html;\r\n\r\n        # Load configuration files for the default server block.\r\n        include /etc/nginx/default.d/*.conf;\r\n\r\n        location / {\r\n        }\r\n\r\n        error_page 404 /404.html;\r\n            location = /40x.html {\r\n        }\r\n\r\n        error_page 500 502 503 504 /50x.html;\r\n            location = /50x.html {\r\n        }\r\n\r\n    listen [::]:443 ssl ipv6only=on; # managed by Certbot\r\n    listen 443 ssl; # managed by Certbot\r\n    ssl_certificate /etc/letsencrypt/live/bbs.wzlinux.com/fullchain.pem; # managed by Certbot\r\n    ssl_certificate_key /etc/letsencrypt/live/bbs.wzlinux.com/privkey.pem; # managed by Certbot\r\n    include /etc/letsencrypt/options-ssl-nginx.conf; # managed by Certbot\r\n    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem; # managed by Certbot\r\n\r\n}\r\n\r\nserver {\r\n    if ($host = bbs.wzlinux.com) {\r\n        return 301 https://$host$request_uri;\r\n    } # managed by Certbot\r\n\r\n    listen       80 ;\r\n    listen       [::]:80 ;\r\n    server_name bbs.wzlinux.com;\r\n    return 404; # managed by Certbot\r\n\r\n}</code></pre>\r\n</div>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>启用443端口</p>\r\n\r\n<p>同样，修改Nginx的虚拟主机配置文件，新建一个443端口的server配置：</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-bash\">server {\r\n        listen 443 ssl;\r\n        listen [::]:443 ssl ipv6only=on;\r\n\r\n        ssl_certificate /etc/letsencrypt/live/your.domain.com/fullchain.pem;\r\n        ssl_certificate_key /etc/letsencrypt/live/your.domain.com/privkey.pem;\r\n        ssl_trusted_certificate /etc/letsencrypt/live/your.domain.com/chain.pem;\r\n        \r\n        // ... other settings ...\r\n}</code></pre>\r\n</div>\r\n\r\n<p>上面记得替换<code>your.domain.com</code>为你自己的域名。</p>\r\n\r\n<p>接着重新加载Nginx配置：</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-bash\">sudo service nginx reload\r\n</code></pre>\r\n</div>\r\n\r\n<p>现在通过浏览器访问你的网站：<code>https://your.domain.com</code>试试，如果看到浏览器的绿色标志，恭喜你设置成功！</p>\r\n\r\n<p>不过由于这个证书的时效只有90天，我们需要设置自动更新的功能，帮我们自动更新证书的时效。</p>\r\n\r\n<h3>自动更新证书</h3>\r\n\r\n<p>先在命令行模拟证书更新：</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-bash\">sudo certbot renew --dry-run</code></pre>\r\n</div>\r\n\r\n<p>模拟更新成功的效果如下：</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-bash\">-------------------------------------------------------------------------------\r\nProcessing /etc/letsencrypt/renewal/your.domain.com.conf\r\n-------------------------------------------------------------------------------\r\n** DRY RUN: simulating \'certbot renew\' close to cert expiry\r\n**          (The test certificates below have not been saved.)\r\n\r\nCongratulations, all renewals succeeded. The following certs have been renewed:\r\n  /etc/letsencrypt/live/your.domain.com/fullchain.pem (success)\r\n** DRY RUN: simulating \'certbot renew\' close to cert expiry\r\n**          (The test certificates above have not been saved.)</code></pre>\r\n</div>\r\n\r\n<p>既然模拟成功，我们就使用<code>crontab -e</code>的命令来启用自动任务，命令行：</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-bash\">sudo crontab -e\r\n</code></pre>\r\n</div>\r\n\r\n<p>添加配置：</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-bash\">0 4 * * * /usr/bin/certbot renew  &gt;&gt; /var/log/le-renew.log\r\n</code></pre>\r\n<img src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" /><span style=\"background-color:rgba(220,220,220,0.5)\"><img src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" style=\"height:15px; width:15px\" title=\"点击并拖拽以移动\" /></span></div>\r\n\r\n<p>上面的执行时间为：每天凌晨4点执行renew任务。</p>\r\n\r\n<p>你可以在命令行执行<code>/usr/bin/certbot renew &gt;&gt; /var/log/le-renew.log</code>看看是否执行正常，如果一切OK，那么我们的配置到此结束！</p>\r\n\r\n<h3>参考</h3>\r\n\r\n<ul>\r\n	<li>\r\n	<p><a href=\"https://certbot.eff.org/\">Certbot官网</a></p>\r\n	</li>\r\n	<li>\r\n	<p>LetsEncrypt Nginx and Proxy Apps on Ubuntu</p>\r\n	</li>\r\n</ul>',
        '', '2020-03-19 09:34:00', '2020-03-19 09:34:00', 130, 1, 4, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (61, '如何并排输出两个Pandas数据框中的差异？',
        '<p>我试图强调两个数据框之间的确切变化。</p>\r\n\r\n<p>假设我有两个Python Pandas数据框：</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">\"StudentRoster Jan-1\":\r\nid   Name   score                    isEnrolled           Comment\r\n111  Jack   2.17                     True                 He was late to class\r\n112  Nick   1.11                     False                Graduated\r\n113  Zoe    4.12                     True       \r\n\r\n\"StudentRoster Jan-2\":\r\nid   Name   score                    isEnrolled           Comment\r\n111  Jack   2.17                     True                 He was late to class\r\n112  Nick   1.21                     False                Graduated\r\n113  Zoe    4.12                     False                On vacation</code></pre>\r\n</div>\r\n\r\n<p>我的目标是输出一个HTML表格：</p>\r\n\r\n<ol>\r\n	<li>标识已更改的行（可以是int，float，boolean，string）</li>\r\n	<li>输出具有相同，旧和新值的行（理想情况下放入HTML表格中），以便用户可以清楚地看到两个数据框之间的变化： <code>&quot;StudentRoster Difference Jan-1 - Jan-2&quot;: id Name score isEnrolled Comment 112 Nick was 1.11| now 1.21 False Graduated 113 Zoe 4.12 was True | now False was &quot;&quot; | now &quot;On vacation&quot;</code></li>\r\n</ol>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<hr />\r\n<p>第一部分与Constantine相似，你可以得到其中行为空的布尔值*：</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">In [21]: ne = (df1 != df2).any(1)\r\n\r\nIn [22]: ne\r\nOut[22]:\r\n0    False\r\n1     True\r\n2     True\r\ndtype: bool</code></pre>\r\n</div>\r\n\r\n<p>然后我们可以看到哪些条目已经改变：</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">In [23]: ne_stacked = (df1 != df2).stack()\r\n\r\nIn [24]: changed = ne_stacked[ne_stacked]\r\n\r\nIn [25]: changed.index.names = [\'id\', \'col\']\r\n\r\nIn [26]: changed\r\nOut[26]:\r\nid  col\r\n1   score         True\r\n2   isEnrolled    True\r\n    Comment       True\r\ndtype: bool</code></pre>\r\n</div>\r\n\r\n<p><em>这里第一项是索引，第二项是已更改的列。</em></p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">In [27]: difference_locations = np.where(df1 != df2)\r\n\r\nIn [28]: changed_from = df1.values[difference_locations]\r\n\r\nIn [29]: changed_to = df2.values[difference_locations]\r\n\r\nIn [30]: pd.DataFrame({\'from\': changed_from, \'to\': changed_to}, index=changed.index)\r\nOut[30]:\r\n               from           to\r\nid col\r\n1  score       1.11         1.21\r\n2  isEnrolled  True        False\r\n   Comment     None  On vacation</code></pre>\r\n<img src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" /><img src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" style=\"height:15px; width:15px\" title=\"点击并拖拽以移动\" /></div>\r\n\r\n<p>注意：<code>df1</code>并且<code>df2</code>共享相同的索引。为了克服这种模糊性，可以确保你只使用共享标签<code>df1.index &amp; df2.index</code></p>\r\n\r\n<p>&nbsp;</p>',
        '', '2020-03-20 08:36:00', '2020-03-20 08:36:00', 79, 1, 2, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (62, '稳定易用的 Django 分页库，完善分页功能',
        '<h2><img alt=\"\" src=\"https://img-blog.csdnimg.cn/20200321020959448.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:267px; width:800px\" /></h2>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h2>分页效果概述</h2>\r\n\r\n<p><a href=\"http://chenyinren.top\">分页效果</a></p>\r\n\r\n<p>一个比较完善的分页效果应该具有以下特性，就像上图展示的那样，很多网站都采用了类似这种的分页导航方式。</p>\r\n\r\n<ul>\r\n	<li>始终显示第一页和最后一页。</li>\r\n	<li>当前页码高亮显示。</li>\r\n	<li>显示当前页码前后几个连续的页码。</li>\r\n	<li>如果两个页码号间还有其它页码，中间显示省略号以提示用户。</li>\r\n</ul>\r\n\r\n<h2>分页思路</h2>\r\n\r\n<p>如果需要自己来实现分页效果，我们会怎么做呢？先来分析一下导航条的组成部分，可以看到整个分页导航条其实可以分成 七个部分：</p>\r\n\r\n<ol>\r\n	<li>第 1 页页码，这一页需要始终显示。</li>\r\n	<li>第 1 页页码后面的省略号部分。但要注意如果第 1 页的页码号后面紧跟着页码号 2，那么省略号就不应该显示。</li>\r\n	<li>当前页码的左边部分，比如这里的 3-4。</li>\r\n	<li>当前页码，比如这里的 5。</li>\r\n	<li>当前页码的右边部分，比如这里的 6-7。</li>\r\n	<li>最后一页页码前面的省略号部分。但要注意如果最后一页的页码号前面跟着的页码号是连续的，那么省略号就不应该显示。</li>\r\n	<li>最后一页的页码号。</li>\r\n</ol>\r\n\r\n<p>因此我们的思路是，在视图中依据上述规则生成页码列表，然后在模板中循环显示页码列表就可以了。有了思路，实现起来其实也并不很难。不过对于这类常见需求，别人早就帮我们实现好了，本着不重复造轮子的原则，直接拿来用就好。</p>\r\n\r\n<h2>第一个 Django 第三方拓展：django-pure-pagination</h2>\r\n\r\n<p>我们第一次开始接触 django 第三方拓展，在此之前我们一直都基于 django 本身我们提供的功能在开发，然而 django 强大的地方就在于海量的第三方应用供我们挑选，几乎大部分 web 开发中的需求，django 都能找到他人已经写好的第三方应用，拿来即用。</p>\r\n\r\n<p>事实上，正确的 django 开发姿势应该是这样的：</p>\r\n\r\n<ol>\r\n	<li>充分理解你的需求，想一想，如果自己实现，我会怎么做？</li>\r\n	<li>通过 Google、GitHub、开发者社区论坛等调研已有的实现类似需求的应用</li>\r\n	<li>拿来即用，并尝试理解他人是如何实现这个功能的</li>\r\n</ol>\r\n\r\n<p>以我们的分页功能举例：</p>\r\n\r\n<p>首先我们上面分析了分页需求的实现。然后我在 GitHub 上通过 django pagination 关键词进行搜索，在比较了多个 star 数比较高的项目后，发现 django-pure-pagination 文档最清晰，使用最简单，因此决定将这个应用集成到我们的博客来。值得一提的是，尽管这个应用显示作者最后一次更新代码在 4 年前，但我粗略浏览了一下源码，发现其依赖的 django api 4 年来异常稳定，所以确保能在 django 2.2 中使用。</p>\r\n\r\n<p>接下来我们就来使用它，首先安装它：</p>\r\n\r\n<div>\r\n<pre>\r\n<code>$ pip install django-pure-pagination</code></pre>\r\n</div>\r\n\r\n<p>然后将它注册到&nbsp;<code>INSTALLED_APPS</code>&nbsp;里：</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">INSTALLED_APPS = [\r\n    # ...\r\n    &#39;pure_pagination&#39;,  # 分页\r\n \r\n    &#39;blog.apps.BlogConfig&#39;,  # 注册 blog 应用\r\n    &#39;comments.apps.CommentsConfig&#39;,  # 注册 comments 应用\r\n]</code></pre>\r\n</div>\r\n\r\n<p>修改一下&nbsp;<code>IndexView</code>，让它继承 django-pure-pagination 提供的&nbsp;<code>PaginationMixin</code>，这个混入类将为我们提供上述提到的分页功能。</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">class IndexView(PaginationMixin, ListView):\r\n    model = Post\r\n    template_name = &#39;blog/index.html&#39;\r\n    context_object_name = &#39;post_list&#39;\r\n    paginate_by = 10</code></pre>\r\n</div>\r\n\r\n<p>然后我们可以在 common.py 配置中配置一下分页的效果，这是 django-pure-pagination 提供的配置项，用于个性化配置分页效果：</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\"># django-pure-pagination 分页设置\r\nPAGINATION_SETTINGS = {\r\n    &#39;PAGE_RANGE_DISPLAYED&#39;: 4, # 分页条当前页前后应该显示的总页数（两边均匀分布，因此要设置为偶数），\r\n    &#39;MARGIN_PAGES_DISPLAYED&#39;: 2, # 分页条开头和结尾显示的页数\r\n    &#39;SHOW_FIRST_PAGE_WHEN_INVALID&#39;: True, # 当请求了不存在页，显示第一页\r\n}</code></pre>\r\n</div>\r\n\r\n<p>在模板中需要分页的地方，调用分页对象的 render 方法就可以了，比如在 index.html 中：</p>\r\n\r\n<div>\r\n<pre>\r\n<code>{% if is_paginated %}\r\n    {{ page_obj.render }}\r\n{% endif %}</code></pre>\r\n</div>\r\n\r\n<p>注意这里 page_obj 是分页后的对象列表，具体请参考上一篇文章的讲解。render 方法会自动帮我们渲染一个预先定义好的分页条，至此，分页功能就完成了。</p>\r\n\r\n<h2>自定义模板</h2>\r\n\r\n<p>有时候预定义的分页条并不能满足我们的需求，我们可以通过自定义的模板来覆盖预定义的模板。django 查找模板的顺序是，首先在项目配置的模板根路径寻找（我们项目中配的是 templates 文件夹），没有找到的话，再去应用的 templates 目录下寻找。分页模板预定义的路径为 pure_pagination/pagination.html，所以我们可以在项目模板根路径下建立一个一模一样的文件结构，这样 django 就会首先找到我们的模板，从而应用我们自定义的模板，而不是预定义的模板。</p>\r\n\r\n<p>在 templates 目录下新建一个 pure_pagination 目录，然后建立一个 pagination.html 文件。</p>\r\n\r\n<p>接下来便是在模板中设置分页导航了，将导航条的七个部分的数据一一展现即可，示例代码如下：</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-html\">&lt;div class=&quot;text-center pagination&quot; style=&quot;width: 100%&quot;&gt;\r\n  &lt;ul&gt;\r\n    {% if page_obj.has_previous %}\r\n      &lt;li&gt;&lt;a href=&quot;?{{ page_obj.previous_page_number.querystring }}&quot;\r\n             class=&quot;prev&quot;&gt;&amp;lsaquo;&amp;lsaquo; &lt;/a&gt;&lt;/li&gt;\r\n    {% else %}\r\n      &lt;li&gt;&lt;span class=&quot;disabled prev&quot;&gt;&amp;lsaquo;&amp;lsaquo; &lt;/span&gt;&lt;/li&gt;\r\n    {% endif %}\r\n    {% for page in page_obj.pages %}\r\n      {% if page %}\r\n        {% ifequal page page_obj.number %}\r\n          &lt;li class=&quot;current&quot;&gt;&lt;a href=&quot;#&quot;&gt;{{ page }}&lt;/a&gt;&lt;/li&gt;\r\n        {% else %}\r\n          &lt;li&gt;&lt;a href=&quot;?{{ page.querystring }}&quot; class=&quot;page&quot;&gt;{{ page }}&lt;/a&gt;&lt;/li&gt;\r\n        {% endifequal %}\r\n      {% else %}\r\n        ...\r\n      {% endif %}\r\n    {% endfor %}\r\n    {% if page_obj.has_next %}\r\n      &lt;li&gt;&lt;a href=&quot;?{{ page_obj.next_page_number.querystring }}&quot; class=&quot;next&quot;&gt; &amp;rsaquo;&amp;rsaquo;&lt;/a&gt;\r\n      &lt;/li&gt;\r\n    {% else %}\r\n      &lt;li&gt;&lt;span class=&quot;disabled next&quot;&gt; &amp;rsaquo;&amp;rsaquo;&lt;/span&gt;&lt;/li&gt;\r\n    {% endif %}\r\n  &lt;/ul&gt;\r\n&lt;/div&gt;</code></pre>\r\n<img src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" /><img src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" style=\"height:15px; width:15px\" title=\"点击并拖拽以移动\" /></div>\r\n\r\n<p>多添加几篇文章，在示例中就可以看到分页效果了。要使分页导航更加美观，通过设置其 CSS 样式即可。&nbsp;</p>',
        '', '2020-03-20 18:11:00', '2020-03-20 18:11:00', 105, 1, 5, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (63, 'celery占用大内存-内存泄漏',
        '<p><strong>问题发现</strong></p>\r\n\r\n<p>本来top命令查看服务器实时内存情况,&nbsp; 突然发现32G内存 celery 占用到12%,&nbsp; 内存占用都快4G了.</p>\r\n\r\n<blockquote>\r\n<ol>\r\n	<li><code>top</code>命令下，<code>M</code>键开启按<code>MEM</code>列排序的进程列表，按<code>H</code>则查看线程列表，由于<code>worker</code>没有子线程，所以只显示一条记录；</li>\r\n	<li>按<code>c</code>命令，开始<code>COMMAND</code>列详细情况，可以找到对应的进程启动者；</li>\r\n	<li>按<code>o</code>键，开启筛选功能，输入<code>COMMAND=celery</code>只显示<code>celery</code>名的进程列表；</li>\r\n</ol>\r\n</blockquote>\r\n\r\n<p><strong>原因</strong></p>\r\n\r\n<blockquote>\r\n<p>默认情况下，celery的worker是工作进程可以被新任务替换之前执行的最大任务数,&nbsp;默认值是没有限制。</p>\r\n\r\n<p>见<a href=\"http://docs.celeryproject.org/en/latest/userguide/configuration.html#std:setting-worker_max_tasks_per_child\">官网说明</a></p>\r\n</blockquote>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">&quot;&quot;&quot;\r\ncelery配置\r\n&quot;&quot;&quot;\r\n\r\nfrom celery.schedules import crontab\r\n\r\n# 中间人\r\nBROKER_URL = &#39;redis://:xxx@xxx.xxx.xxx.xxx/x&#39;\r\n\r\nworker_prefetch_multiplier = 4  # celery worker并发数\r\nworker_max_tasks_per_child = 2  # 每个worker最大执行任务数\r\n\r\n\r\n# 指定时区，不指定默认为 &#39;UTC&#39;\r\nCELERY_TIMEZONE = &#39;Asia/Shanghai&#39;\r\n\r\n# 指定导入的任务模块\r\nCELERY_IMPORTS = (\r\n    &#39;celery_app.tasks&#39;,\r\n)</code></pre>\r\n</div>\r\n\r\n<p>需要配置celery设置 但是官网写的参数在执行执行过程中发生错误 &quot;无法将新设置名称与旧设置名称混合使用&quot;</p>\r\n\r\n<blockquote>\r\n<p>Cannot&nbsp;mix&nbsp;new&nbsp;setting&nbsp;names&nbsp;with&nbsp;old&nbsp;setting&nbsp;names,&nbsp;please<br />\r\nrename&nbsp;the&nbsp;following&nbsp;settings&nbsp;to&nbsp;use&nbsp;the&nbsp;old&nbsp;format:<br />\r\n<br />\r\nworker_max_tasks_per_child&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;CELERYD_MAX_TASKS_PER_CHILD<br />\r\nworker_prefetch_multiplier&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;CELERYD_PREFETCH_MULTIPLIER</p>\r\n</blockquote>\r\n\r\n<p><strong>需要修改配置名称:</strong></p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">&quot;&quot;&quot;\r\ncelery配置\r\n&quot;&quot;&quot;\r\n\r\nfrom celery.schedules import crontab\r\n\r\n# 中间人\r\nBROKER_URL = &#39;redis://:xxx@xxx.xxx.xxx.xxx/x&#39;\r\n\r\nCELERYD_PREFETCH_MULTIPLIER = 4  # celery worker并发数\r\nCELERYD_MAX_TASKS_PER_CHILD = 2  # 每个worker最大执行任务数\r\n\r\n# 指定时区，不指定默认为 &#39;UTC&#39;\r\nCELERY_TIMEZONE = &#39;Asia/Shanghai&#39;\r\n\r\n# 指定导入的任务模块\r\nCELERY_IMPORTS = (\r\n    &#39;celery_app.tasks&#39;,\r\n)</code></pre>\r\n</div>\r\n\r\n<p><strong>重新启动</strong></p>\r\n\r\n<p>执行</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-html\">celery beat -A celery_app -l info --detach</code></pre>\r\n</div>\r\n\r\n<p>启动celery，通过ps -ef | grep celery可以看到两个celery worker进程（8226，8228）</p>\r\n\r\n<p>利用celery worker进行某个任务，当worker没有执行到最大任务时（即销毁重建），每执行一次任务占用内存必然有所增加，任务数为9，10时（celery均匀调度，并发数*最大任务数），分别有原8228 worker被销毁，重新创建9386 worker及原8226 worker被销毁，重新创建9564 worker，此时，运行第9次时，占用总内存有所下降，运行第10次时，总内存回到初如值，同样任务执行第19、20次情况类似。</p>\r\n\r\n<p><strong>celery并发计算规则</strong><br />\r\ncelery任务并发只与celery配置项CELERYD_CONCURRENCY 有关，与CELERYD_MAX_TASKS_PER_CHILD没有关系，即CELERYD_CONCURRENCY=2，只能并发2个worker，此时任务处理较大的文件时，执行两次可以看到两个task任务并行执行，而执行第三个任务时，开始排队，直到两个worker执行完毕。</p>\r\n\r\n<p><strong>结论</strong><br />\r\ncelery执行完任务不释放内存与原worker一直没有被销毁有关，因此CELERYD_MAX_TASKS_PER_CHILD可以适当配置小点，而任务并发数与CELERYD_CONCURRENCY配置项有关，每增加一个worker必然增加内存消耗，同时也影响到一个worker何时被销毁，因为celery是均匀调度任务至每个worker，因此也不宜配置过大，适当配置。</p>',
        '', '2020-03-23 03:31:00', '2020-03-23 03:31:00', 89, 1, 2, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (64, 'Gunicorn快速入门详解',
        '<p>Gunicorn是一个unix上被广泛使用的高性能的Python WSGI UNIX HTTP Server。<br />\r\n和大多数的web框架兼容，并具有实现简单，轻量级，高性能等特点。</p>\r\n\r\n<h2>gunicorn 安装</h2>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">pip install gunicorn\r\n</code></pre>\r\n</div>\r\n\r\n<h2>gunicorn + flask 简单示例</h2>\r\n\r\n<p>flask程序需要先安装flask module，pip install flask。</p>\r\n\r\n<p>gunicorn_demo.py</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">from flask import Flask\r\n\r\napp = Flask(__name__)\r\n\r\n\r\n@app.route(\'/demo\', methods=[\'GET\'])\r\ndef demo():\r\n    return \"gunicorn and flask demo.\"\r\n</code></pre>\r\n</div>\r\n\r\n<p>通过gunicorn运行flask app</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-bash\"># gunicorn gunicorn_demo:app\r\n[2017-12-23 10:36:09 +0000] [24441] [INFO] Starting gunicorn 19.7.1\r\n[2017-12-23 10:36:09 +0000] [24441] [INFO] Listening at: http://127.0.0.1:8000 (24441)\r\n[2017-12-23 10:36:09 +0000] [24441] [INFO] Using worker: sync\r\n[2017-12-23 10:36:09 +0000] [24446] [INFO] Booting worker with pid: 24446\r\n</code></pre>\r\n</div>\r\n\r\n<p>测试结果</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-bash\"># curl http://127.0.0.1:8000/demo\r\ngunicorn and flask demo.\r\n</code></pre>\r\n</div>\r\n\r\n<h2>gunicorn 部署</h2>\r\n\r\n<p>gunicorn是一个wsgi http server，可以如上一章节所示直接起停，提供http服务。</p>\r\n\r\n<p>不过在production环境，起停和状态的监控最好用supervisior之类的监控工具，然后在gunicorn的前端放置一个http proxy server, 譬如nginx。</p>\r\n\r\n<p>下面是supervisor和nginx的配置。</p>\r\n\r\n<p>supervisor_gunicorn.conf</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-bash\">[program:gunicorn_demo]\r\nprocess_name=%(program_name)s\r\nnumprocs=1\r\npriority=901\r\ndirectory = /opt/gunicorn_demo/\r\ncommand = /opt/virtualenv/bin/python /opt/virtualenv/bin/gunicorn -c gunicorn_demo.py gunicorn_demo:app\r\nautostart = true\r\nstartsecs = 20\r\nautorestart = true\r\nstartretries = 3\r\nuser = root\r\nredirect_stderr = true\r\nstdout_logfile_maxbytes = 20MB\r\nstdout_logfile_backups = 10\r\nstdout_logfile = /dev/null\r\n</code></pre>\r\n</div>\r\n\r\n<p>-c gunicorn_demo.py, 即是gunicorn本身的配置文件，下面是gunicorn的基本配置，下一章节会详细说明gunicorn的配置项。</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-bash\">import multiprocessing\r\n\r\nbind = \'127.0.0.1:8000\'\r\nworkers = multiprocessing.cpu_count() * 2 + 1\r\n\r\nbacklog = 2048\r\nworker_class = \"gevent\"\r\nworker_connections = 1000\r\ndaemon = False\r\ndebug = True\r\nproc_name = \'gunicorn_demo\'\r\npidfile = \'./log/gunicorn.pid\'\r\nerrorlog = \'./log/gunicorn.log\'\r\n</code></pre>\r\n</div>\r\n\r\n<p>nginx.conf 部分配置</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-json\">server {\r\n    listen 80;\r\n    server_name sam_rui.com;\r\n    access_log  /var/log/nginx/access.log;\r\n\r\n    location / {\r\n        proxy_pass http://127.0.0.1:8000;\r\n        proxy_set_header Host $host;\r\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\r\n    }\r\n}\r\n</code></pre>\r\n<img src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" /><span style=\"background-color:rgba(220,220,220,0.5)\"><img src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" style=\"height:15px; width:15px\" title=\"点击并拖拽以移动\" /></span></div>\r\n\r\n<h2>gunicorn 详细配置</h2>\r\n\r\n<p>gunicorn配置项可以通过gunicorn的启动命令行中设定，也可以通过配置文件指定。强烈建议使用一个配置文件。</p>\r\n\r\n<p>配置项如下：</p>\r\n\r\n<h3>server socket</h3>\r\n\r\n<ul>\r\n	<li>\r\n	<p>bind<br />\r\n	监听地址和端口。</p>\r\n	</li>\r\n	<li>\r\n	<p>backlog<br />\r\n	服务器中在pending状态的最大连接数，即client处于waiting的数目。超过这个数目， client连接会得到一个error。<br />\r\n	建议值64-2048。</p>\r\n	</li>\r\n</ul>\r\n\r\n<h3>worker 进程</h3>\r\n\r\n<ul>\r\n	<li>\r\n	<p>workers<br />\r\n	worker进程的数量。建议值2-4 x $(NUM_CORES)， 缺省为1。</p>\r\n	</li>\r\n	<li>\r\n	<p>worker_class<br />\r\n	worker进程的工作方式。 有 sync, eventlet, gevent, tornado, gthread, 缺省值sync。</p>\r\n	</li>\r\n	<li>\r\n	<p>threads<br />\r\n	工作进程中线程的数量。建议值2-4 x $(NUM_CORES)， 缺省值1。<br />\r\n	此配置只适用于gthread 进程工作方式， 因为gevent这种使用的是协程工作方式。</p>\r\n	</li>\r\n	<li>\r\n	<p>worker_connections<br />\r\n	客户端最大同时连接数。只适用于eventlet， gevent工作方式。</p>\r\n	</li>\r\n	<li>\r\n	<p>max_requests<br />\r\n	worker重启之前处理的最大requests数， 缺省值为0表示自动重启disabled。主要是防止内存泄露。</p>\r\n	</li>\r\n	<li>\r\n	<p>max_requests_jitter<br />\r\n	抖动参数，防止worker全部同时重启。</p>\r\n	</li>\r\n	<li>\r\n	<p>timeout<br />\r\n	通常设为30。</p>\r\n	</li>\r\n	<li>\r\n	<p>graceful_timeout<br />\r\n	接收到restart信号后，worker可以在graceful_timeout时间内，继续处理完当前requests。</p>\r\n	</li>\r\n	<li>\r\n	<p>keepalive<br />\r\n	server端保持连接时间。</p>\r\n	</li>\r\n</ul>\r\n\r\n<h3>security</h3>\r\n\r\n<ul>\r\n	<li>\r\n	<p>limit_request_line<br />\r\n	http request line最大字节数。值范围0-8190， 0表示无限制。</p>\r\n	</li>\r\n	<li>\r\n	<p>limit_request_field<br />\r\n	http request中 header字段数的最大值。缺省为100，最大32768。</p>\r\n	</li>\r\n	<li>\r\n	<p>limit_request_field_size<br />\r\n	http request header字段最大字节数。0表示无限制。</p>\r\n	</li>\r\n</ul>\r\n\r\n<h3>调试</h3>\r\n\r\n<ul>\r\n	<li>\r\n	<p>reload<br />\r\n	当代码有修改时，自动重启workers。适用于开发环境。</p>\r\n	</li>\r\n	<li>\r\n	<p>reload_extra_files<br />\r\n	扩展reload配置，增加templates，configurations等文件修改监控。</p>\r\n	</li>\r\n	<li>\r\n	<p>spew<br />\r\n	跟踪程序执行的每一行。</p>\r\n	</li>\r\n	<li>\r\n	<p>check_config<br />\r\n	检查配置。</p>\r\n	</li>\r\n</ul>\r\n\r\n<h3>server 机制</h3>\r\n\r\n<ul>\r\n	<li>\r\n	<p>sendfile<br />\r\n	系统底层拷贝数据方式，提供performance。</p>\r\n	</li>\r\n	<li>\r\n	<p>chdir<br />\r\n	在app加载之前，进入到此目录。</p>\r\n	</li>\r\n	<li>\r\n	<p>daemon<br />\r\n	应用是否以daemon方式运行。</p>\r\n	</li>\r\n	<li>\r\n	<p>raw_env<br />\r\n	key=value, 传递环境参数。</p>\r\n	</li>\r\n	<li>\r\n	<p>pidfile<br />\r\n	pid存储文件路径。</p>\r\n	</li>\r\n	<li>\r\n	<p>worker_tmp_dir<br />\r\n	临时工作目录。</p>\r\n	</li>\r\n	<li>\r\n	<p>user<br />\r\n	指定worker进程的运行用户名。</p>\r\n	</li>\r\n	<li>\r\n	<p>group<br />\r\n	指定worker进程运行用户所在组。</p>\r\n	</li>\r\n	<li>\r\n	<p>umask<br />\r\n	gunicorn创建文件的缺省权限。</p>\r\n	</li>\r\n	<li>\r\n	<p>pythonpath<br />\r\n	附加到python path的目录列表。</p>\r\n	</li>\r\n</ul>\r\n\r\n<h3>日志</h3>\r\n\r\n<ul>\r\n	<li>\r\n	<p>accesslog<br />\r\n	访问日志文件路径。</p>\r\n	</li>\r\n	<li>\r\n	<p>access_log_format<br />\r\n	日志格式。 例如 %(h)s %(l)s %(u)s %(t)s &quot;%(r)s&quot; %(s)s %(b)s &quot;%(f)s&quot; &quot;%(a)s&quot; 。</p>\r\n	</li>\r\n	<li>\r\n	<p>errorlog<br />\r\n	错误日志路径。</p>\r\n	</li>\r\n	<li>\r\n	<p>loglever<br />\r\n	日志级别。debug, info, warning, error, critical.</p>\r\n	</li>\r\n	<li>\r\n	<p>capture_output<br />\r\n	重定向stdout/stderr到error log file。</p>\r\n	</li>\r\n	<li>\r\n	<p>logger_class<br />\r\n	日志实现类。缺省gunicorn.glogging.Logger 。</p>\r\n	</li>\r\n	<li>\r\n	<p>logconfig<br />\r\n	日志配置文件。同python标准日志模块logging的配置。</p>\r\n	</li>\r\n</ul>\r\n\r\n<h3>进程名</h3>\r\n\r\n<ul>\r\n	<li>proc_name<br />\r\n	设置进程名(setproctitle)，在ps，top等命令中会看到. 缺省值为default_proc_name配置。</li>\r\n</ul>\r\n\r\n<h3>server钩子</h3>\r\n\r\n<ul>\r\n	<li>on_starting</li>\r\n	<li>on_reload</li>\r\n	<li>when_ready</li>\r\n	<li>pre_fork</li>\r\n	<li>post_fork</li>\r\n	<li>post_worker_init</li>\r\n	<li>worker_init</li>\r\n	<li>worker_abort</li>\r\n	<li>pre_exec</li>\r\n	<li>pre_request</li>\r\n	<li>post_request</li>\r\n	<li>child_exit</li>\r\n	<li>worker-exit</li>\r\n	<li>nworkers_changed</li>\r\n	<li>on_exit</li>\r\n</ul>',
        '', '2020-03-17 16:44:00', '2020-03-17 16:44:00', 76, 1, 2, 0, 0, 1);
INSERT INTO `tb_content`
VALUES (65, 'Pandas DataFrames 中 merge 合并的坑点(出现重复连接键)',
        '<p>在我的实际开发中遇到的坑点,查阅了相关文档 总结一下</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\">\r\n<code class=\"language-python hljs\">left = pd.DataFrame({<span class=\"hljs-string\">&#39;A&#39;</span>: [<span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">2</span>], <span class=\"hljs-string\">&#39;B&#39;</span>: [<span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">2</span>]})\r\n</code></pre>\r\n</div>\r\n\r\n<p><img alt=\"\" class=\"has\" data-widget=\"image\" src=\"https://img-blog.csdnimg.cn/20190529094244657.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:206px; width:1184px\" /></p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\">\r\n<code class=\"language-python hljs\">right = pd.DataFrame({<span class=\"hljs-string\">&#39;A&#39;</span>: [<span class=\"hljs-number\">4</span>, <span class=\"hljs-number\">5</span>, <span class=\"hljs-number\">6</span>], <span class=\"hljs-string\">&#39;B&#39;</span>: [<span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">2</span>]})</code></pre>\r\n</div>\r\n\r\n<p><img alt=\"\" class=\"has\" data-widget=\"image\" src=\"https://img-blog.csdnimg.cn/20190529094318873.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:200px; width:1165px\" /></p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\">\r\n<code class=\"language-python hljs\">result = pd.merge(left, right, on=<span class=\"hljs-string\">&#39;B&#39;</span>, how=<span class=\"hljs-string\">&#39;outer&#39;</span>)</code></pre>\r\n</div>\r\n\r\n<p>&nbsp;<img alt=\"\" class=\"has\" data-widget=\"image\" src=\"https://img-blog.csdnimg.cn/20190529094353968.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:270px; width:1165px\" /></p>\r\n\r\n<blockquote>\r\n<p>&nbsp;<strong><span style=\"color:#3e4349\">警告:</span></strong><span style=\"color:#3e4349\">在重复键上加入/合并可能导致返回的帧是行维度的乘法，这可能导致内存溢出。在加入大型DataFrame之前，重复值。</span></p>\r\n</blockquote>\r\n\r\n<p><img alt=\"\" class=\"has\" data-widget=\"image\" src=\"https://img-blog.csdnimg.cn/20190529094545319.png\" style=\"height:189px; width:812px\" /></p>\r\n\r\n<blockquote>\r\n<p><span style=\"color:#212224\">检查重复键</span>&nbsp;</p>\r\n</blockquote>\r\n\r\n<p>&nbsp;如果知道右侧的重复项<code>DataFrame</code>但希望确保左侧DataFrame中没有重复项，则可以使用该&nbsp;<strong><code>validate=&#39;one_to_many&#39;</code></strong>参数，这不会引发异常。</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\">\r\n<code class=\"language-python hljs\">pd.merge(left, right, on=<span class=\"hljs-string\">&#39;B&#39;</span>, how=<span class=\"hljs-string\">&#39;outer&#39;</span>, validate=<span class=\"hljs-string\">&quot;one_to_many&quot;</span>)\r\n\r\n<span class=\"hljs-comment\"># 打印的结果:</span>\r\n   A_x  B  A_y\r\n<span class=\"hljs-number\">0</span>    <span class=\"hljs-number\">1</span>  <span class=\"hljs-number\">1</span>  NaN\r\n<span class=\"hljs-number\">1</span>    <span class=\"hljs-number\">2</span>  <span class=\"hljs-number\">2</span>  <span class=\"hljs-number\">4.0</span>\r\n<span class=\"hljs-number\">2</span>    <span class=\"hljs-number\">2</span>  <span class=\"hljs-number\">2</span>  <span class=\"hljs-number\">5.0</span>\r\n<span class=\"hljs-number\">3</span>    <span class=\"hljs-number\">2</span>  <span class=\"hljs-number\">2</span>  <span class=\"hljs-number\">6.0</span></code></pre>\r\n<img src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" /><span style=\"background:rgba(220, 220, 220, 0.5) url(&quot;https://chenyinren.top/root_static/ckeditor/ckeditor/plugins/widget/images/handle.png&quot;) repeat scroll 0% 0%; display:block; left:0px; top:-15px\"><img role=\"presentation\" src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" style=\"height:15px; width:15px\" title=\"点击并拖拽以移动\" /></span></div>\r\n\r\n<p><strong>&nbsp;官方文档连接:</strong></p>\r\n\r\n<p><a href=\"http://pandas.pydata.org/pandas-docs/stable/user_guide/merging.html\">Pandas文档中提及 merge</a></p>',
        '', '2019-05-29 01:50:06', '2019-05-29 01:50:06', 73, 1, 2, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (66, 'pandas DataFream 查找某列数据具体数据',
        '<p><strong>&nbsp;DataFream数据如下:</strong></p>\r\n\r\n<p><img alt=\"\" class=\"has\" data-widget=\"image\" src=\"https://img-blog.csdnimg.cn/20190528164305128.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:271px; width:600px\" /></p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\">\r\n<code class=\"language-python hljs\">df.loc[df[<span class=\"hljs-string\">&#39;webname&#39;</span>] == <span class=\"hljs-string\">&#39;中国货币网&#39;</span>]</code></pre>\r\n</div>\r\n\r\n<p><img alt=\"\" class=\"has\" data-widget=\"image\" src=\"https://img-blog.csdnimg.cn/20190528164529862.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:262px; width:600px\" /></p>\r\n\r\n<p>以下代码可以参考:&nbsp;</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\">\r\n<code class=\"language-python hljs\"><span class=\"hljs-comment\"># df.loc[index, column_name],选取指定行和列的数据</span>\r\ndf.loc[<span class=\"hljs-number\">0</span>,<span class=\"hljs-string\">&#39;id&#39;</span>] <span class=\"hljs-comment\"># &#39;Snow&#39;</span>\r\ndf.loc[<span class=\"hljs-number\">0</span>:<span class=\"hljs-number\">2</span>, [<span class=\"hljs-string\">&#39;id&#39;</span>,<span class=\"hljs-string\">&#39;title&#39;</span>]]  <span class=\"hljs-comment\"># 选取第0行到第2行，id和title列的数据, 注意这里的行选取是包含下标的。</span>\r\ndf.loc[[<span class=\"hljs-number\">2</span>,<span class=\"hljs-number\">3</span>],[<span class=\"hljs-string\">&#39;id&#39;</span>,<span class=\"hljs-string\">&#39;title&#39;</span>]]  <span class=\"hljs-comment\"># 选取指定的第2行和第3行，id和title列的数据</span>\r\ndf.loc[df[<span class=\"hljs-string\">&#39;webname&#39;</span>]==<span class=\"hljs-string\">&#39;中国货币网&#39;</span>,<span class=\"hljs-string\">&#39;id&#39;</span>]  <span class=\"hljs-comment\"># 选取webname列是中国货币网，id列的数据</span>\r\ndf.loc[df[<span class=\"hljs-string\">&#39;webname&#39;</span>]==<span class=\"hljs-string\">&#39;中国货币网&#39;</span>,[<span class=\"hljs-string\">&#39;id&#39;</span>,<span class=\"hljs-string\">&#39;title&#39;</span>]]  <span class=\"hljs-comment\"># 选取webname列是中国货币网，id和title列的数据</span></code></pre>\r\n<img src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" /><span style=\"background:rgba(220, 220, 220, 0.5) url(&quot;https://chenyinren.top/root_static/ckeditor/ckeditor/plugins/widget/images/handle.png&quot;) repeat scroll 0% 0%; display:block; left:0px; top:-15px\"><img role=\"presentation\" src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" style=\"height:15px; width:15px\" title=\"点击并拖拽以移动\" /></span></div>',
        '', '2019-05-28 08:49:25', '2019-05-28 08:49:25', 64, 1, 3, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (67, 'pandas 实现 in 和 not in 的用法及心得',
        '<p>经常在处理数据中从一个总数据中清洗出数据, 但是有时候需要把没有处理的数据也统计出来.</p>\r\n\r\n<p>这时候就需要使用:</p>\r\n\r\n<blockquote>\r\n<p style=\"margin-left:0px\"><span style=\"color:#212224\">pandas.DataFrame.isin</span></p>\r\n\r\n<p style=\"margin-left:0px\">DataFrame中的每个元素是否都包含在值中</p>\r\n</blockquote>\r\n\r\n<p><a href=\"http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.isin.html\">pandas文档位置</a></p>\r\n\r\n<p>例子:</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\">\r\n<code class=\"language-python hljs\">如何实现SQL的等价物IN和NOT IN?\r\n\r\n我有一个包含所需值的列表。下面是一个场景：\r\n\r\ndf = pd.DataFrame({&#39;countries&#39;:[&#39;US&#39;,&#39;UK&#39;,&#39;Germany&#39;,&#39;China&#39;]})\r\ncountries = [&#39;UK&#39;,&#39;China&#39;]\r\n\r\n# pseudo-code:\r\ndf[df[&#39;countries&#39;] not in countries]</code></pre>\r\n</div>\r\n\r\n<p>之前的做法是这样:</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\">\r\n<code class=\"language-python hljs\">df = pd.DataFrame({<span class=\"hljs-string\">&#39;countries&#39;</span>:[<span class=\"hljs-string\">&#39;US&#39;</span>,<span class=\"hljs-string\">&#39;UK&#39;</span>,<span class=\"hljs-string\">&#39;Germany&#39;</span>,<span class=\"hljs-string\">&#39;China&#39;</span>]})\r\ncountries = pd.DataFrame({<span class=\"hljs-string\">&#39;countries&#39;</span>:[<span class=\"hljs-string\">&#39;UK&#39;</span>,<span class=\"hljs-string\">&#39;China&#39;</span>], <span class=\"hljs-string\">&#39;matched&#39;</span>:<span class=\"hljs-keyword\">True</span>})\r\n\r\n<span class=\"hljs-comment\"># IN</span>\r\ndf.merge(countries,how=<span class=\"hljs-string\">&#39;inner&#39;</span>,on=<span class=\"hljs-string\">&#39;countries&#39;</span>)\r\n\r\n<span class=\"hljs-comment\"># NOT IN</span>\r\nnot_in = df.merge(countries,how=<span class=\"hljs-string\">&#39;left&#39;</span>,on=<span class=\"hljs-string\">&#39;countries&#39;</span>)\r\nnot_in = not_in[pd.isnull(not_in[<span class=\"hljs-string\">&#39;matched&#39;</span>])]</code></pre>\r\n</div>\r\n\r\n<p>但上面这样做觉得很不好, 也翻了文档才找到比较好解决方式.</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\">\r\n<code class=\"language-python hljs\"><span class=\"hljs-comment\"># IN</span>\r\nsomething.isin(somewhere)\r\n\r\n<span class=\"hljs-comment\"># NOT IN</span>\r\n~something.isin(somewhere)</code></pre>\r\n</div>\r\n\r\n<p>例子:</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\">\r\n<code class=\"language-python hljs\"><span class=\"hljs-meta\">&gt;&gt;&gt; </span>df\r\n  countries\r\n<span class=\"hljs-number\">0</span>        US\r\n<span class=\"hljs-number\">1</span>        UK\r\n<span class=\"hljs-number\">2</span>   Germany\r\n<span class=\"hljs-number\">3</span>     China\r\n<span class=\"hljs-meta\">&gt;&gt;&gt; </span>countries\r\n[<span class=\"hljs-string\">&#39;UK&#39;</span>, <span class=\"hljs-string\">&#39;China&#39;</span>]\r\n<span class=\"hljs-meta\">&gt;&gt;&gt; </span>df.countries.isin(countries)\r\n<span class=\"hljs-number\">0</span>    <span class=\"hljs-keyword\">False</span>\r\n<span class=\"hljs-number\">1</span>     <span class=\"hljs-keyword\">True</span>\r\n<span class=\"hljs-number\">2</span>    <span class=\"hljs-keyword\">False</span>\r\n<span class=\"hljs-number\">3</span>     <span class=\"hljs-keyword\">True</span>\r\nName: countries, dtype: bool\r\n<span class=\"hljs-meta\">&gt;&gt;&gt; </span>df[df.countries.isin(countries)]\r\n  countries\r\n<span class=\"hljs-number\">1</span>        UK\r\n<span class=\"hljs-number\">3</span>     China\r\n<span class=\"hljs-meta\">&gt;&gt;&gt; </span>df[~df.countries.isin(countries)]\r\n  countries\r\n<span class=\"hljs-number\">0</span>        US\r\n<span class=\"hljs-number\">2</span>   Germany</code></pre>\r\n<img src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" /><span style=\"background:rgba(220, 220, 220, 0.5) url(&quot;https://chenyinren.top/root_static/ckeditor/ckeditor/plugins/widget/images/handle.png&quot;) repeat scroll 0% 0%; display:block; left:0px; top:-15px\"><img role=\"presentation\" src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" style=\"height:15px; width:15px\" title=\"点击并拖拽以移动\" /></span></div>\r\n\r\n<p>&nbsp;</p>',
        '', '2019-06-10 06:14:28', '2019-06-10 06:14:28', 79, 1, 2, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (68, 'celery 定时任务 后台守护进程 多进程任务-实战踩坑',
        '<p>这个celery 调度项目很简单&nbsp;&nbsp;celery_conf.py 配置文件,&nbsp; __init__.py 加载celery实例对象 ,&nbsp;&nbsp;tasks.py 任务文件. 代码量也很少, 主要是对翻阅文档和查阅资料比较麻烦, 特总结一下.</p>\r\n\r\n<div>\r\n<pre>\r\n<code>├── celery_app\r\n│   ├── celery_conf.py\r\n│   ├── __init__.py\r\n│   └── tasks.py</code></pre>\r\n</div>\r\n\r\n<p>celery_conf.py</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\"># -*- coding:utf-8 -*-\r\n\r\n&quot;&quot;&quot;\r\ncelery配置\r\n&quot;&quot;&quot;\r\n\r\nfrom datetime import timedelta\r\nfrom celery.schedules import crontab\r\n\r\n# 中间人\r\nBROKER_URL = &#39;redis://127.0.0.1:6379/1&#39;\r\n\r\n# 指定时区，不指定默认为 &#39;UTC&#39;\r\nCELERY_TIMEZONE = &#39;Asia/Shanghai&#39;\r\n\r\n# 指定导入的任务模块\r\nCELERY_IMPORTS = (\r\n    &#39;celery_app.tasks&#39;,\r\n)\r\n\r\n# 定期任务\r\nCELERYBEAT_SCHEDULE = {\r\n    &#39;add_every_day_fps_bond_event&#39;: {\r\n        &#39;task&#39;: &#39;celery_app.tasks.schedule_fps_bond_event&#39;,  # 项目下任务文件\r\n        &#39;schedule&#39;: crontab(hour=13, minute=40)              # 可以使用crontab模式\r\n    }\r\n}\r\n</code></pre>\r\n</div>\r\n\r\n<p>__init__.py</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\"># -*- coding:utf-8 -*-\r\n\r\n&quot;&quot;&quot;\r\ncelery app\r\n&quot;&quot;&quot;\r\n\r\nfrom celery import Celery\r\nfrom celery_app import celery_conf\r\n\r\n# 创建实例\r\napp = Celery()\r\napp.config_from_object(celery_conf)\r\n</code></pre>\r\n</div>\r\n\r\n<p>tasks.py</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\"># -*- coding:utf-8 -*-\r\n\r\n&quot;&quot;&quot;\r\n定期任务及分布任务\r\n&quot;&quot;&quot;\r\n\r\nimport manage\r\nfrom celery_app import app\r\n\r\n\r\n\r\n@app.task\r\ndef schedule_fps_bond_event():\r\n    &quot;&quot;&quot;\r\n    数据处理\r\n    :return:\r\n    &quot;&quot;&quot;\r\n    manage.run()  # 这里是我数据处理的主入口, 使用了进程池 \r\n</code></pre>\r\n</div>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><code>crontab 执行时间表:</code></p>\r\n\r\n<table border=\"1\" cellpadding=\"1\" cellspacing=\"1\">\r\n	<tbody>\r\n		<tr>\r\n			<td style=\"width:512px\"><strong>Example</strong></td>\r\n			<td style=\"width:379px\"><strong>Meaning</strong></td>\r\n		</tr>\r\n		<tr>\r\n			<td style=\"width:512px\"><code>crontab()</code></td>\r\n			<td style=\"width:379px\">执行每一分钟。</td>\r\n		</tr>\r\n		<tr>\r\n			<td style=\"width:512px\"><code>crontab(minute=0,&nbsp;hour=0)</code></td>\r\n			<td style=\"width:379px\">每天午夜0:00执行。</td>\r\n		</tr>\r\n		<tr>\r\n			<td style=\"width:512px\"><code>crontab(minute=0,&nbsp;hour=&#39;*/3&#39;)</code></td>\r\n			<td style=\"width:379px\">每三个小时执行一次:午夜，凌晨3点，早上6点，早上9点，中午，下午3点，下午6点，晚上9点。</td>\r\n		</tr>\r\n		<tr>\r\n			<td style=\"width:512px\">\r\n			<p><code>crontab(minute=0,</code></p>\r\n\r\n			<p><code>hour=&#39;0,3,6,9,12,15,18,21&#39;)</code></p>\r\n			</td>\r\n			<td style=\"width:379px\">和?的一样.</td>\r\n		</tr>\r\n		<tr>\r\n			<td style=\"width:512px\"><code>crontab(minute=&#39;*/15&#39;)</code></td>\r\n			<td style=\"width:379px\">每15分钟执行一次。</td>\r\n		</tr>\r\n		<tr>\r\n			<td style=\"width:512px\"><code>crontab(day_of_week=&#39;sunday&#39;)</code></td>\r\n			<td style=\"width:379px\">星期日每分钟执行一次。</td>\r\n		</tr>\r\n		<tr>\r\n			<td style=\"width:512px\">\r\n			<p><code>crontab(minute=&#39;*&#39;,</code></p>\r\n\r\n			<p><code>hour=&#39;*&#39;,</code><code>day_of_week=&#39;sun&#39;)</code></p>\r\n			</td>\r\n			<td style=\"width:379px\">和?的一样.</td>\r\n		</tr>\r\n		<tr>\r\n			<td style=\"width:512px\">\r\n			<p><code>crontab(minute=&#39;*/10&#39;,</code></p>\r\n\r\n			<p><code>hour=&#39;3,17,22&#39;,</code><code>day_of_week=&#39;thu,fri&#39;)</code></p>\r\n			</td>\r\n			<td style=\"width:379px\">每十分钟执行一次，但仅在周四或周五的凌晨3-4点，下午5-6点和晚上10点至11点之间执行。</td>\r\n		</tr>\r\n		<tr>\r\n			<td style=\"width:512px\"><code>crontab(minute=0,hour=&#39;*/2,*/3&#39;)</code></td>\r\n			<td style=\"width:379px\">每隔一小时执行一次，每小时一次可以整除三次。 这意味着：每小时除外：凌晨1点，凌晨5点，早上7点，上午11点，下午1点，下午5点，晚上7点，晚上11点</td>\r\n		</tr>\r\n		<tr>\r\n			<td style=\"width:512px\"><code>crontab(minute=0,&nbsp;hour=&#39;*/5&#39;)</code></td>\r\n			<td style=\"width:379px\">执行小时可被5整除。这意味着它在下午3点触发，而不是在下午5点触发（因为下午3点等于24小时时钟值&ldquo;15&rdquo;，可以被5整除）。</td>\r\n		</tr>\r\n		<tr>\r\n			<td style=\"width:512px\"><code>crontab(minute=0,&nbsp;hour=&#39;*/3,8-17&#39;)</code></td>\r\n			<td style=\"width:379px\">每小时可被3整除，并在办公时间(上午8点至下午5点)每小时执行一次。</td>\r\n		</tr>\r\n		<tr>\r\n			<td style=\"width:512px\"><code>crontab(0,&nbsp;0,day_of_month=&#39;2&#39;)</code></td>\r\n			<td style=\"width:379px\">每月第二日执行。</td>\r\n		</tr>\r\n		<tr>\r\n			<td style=\"width:512px\">\r\n			<p><code>crontab(0,&nbsp;0,</code></p>\r\n\r\n			<p><code>day_of_month=&#39;2-30/2&#39;)</code></p>\r\n			</td>\r\n			<td style=\"width:379px\">每偶数天执行一次。</td>\r\n		</tr>\r\n		<tr>\r\n			<td style=\"width:512px\">\r\n			<p><code>crontab(0,&nbsp;0,</code></p>\r\n\r\n			<p><code>day_of_month=&#39;1-7,15-21&#39;)</code></p>\r\n			</td>\r\n			<td style=\"width:379px\">在每月的第一周和第三周执行。</td>\r\n		</tr>\r\n		<tr>\r\n			<td style=\"width:512px\">\r\n			<p><code>crontab(0,&nbsp;0,day_of_month=&#39;11&#39;,</code></p>\r\n\r\n			<p><code>month_of_year=&#39;5&#39;)</code></p>\r\n			</td>\r\n			<td style=\"width:379px\">每年5月11日执行。</td>\r\n		</tr>\r\n		<tr>\r\n			<td style=\"width:512px\">\r\n			<p><code>crontab(0,&nbsp;0,</code></p>\r\n\r\n			<p><code>month_of_year=&#39;*/3&#39;)</code></p>\r\n			</td>\r\n			<td style=\"width:379px\">在每个季度的第一个月每天执行。</td>\r\n		</tr>\r\n		<tr>\r\n			<td style=\"width:512px\">&nbsp;</td>\r\n			<td style=\"width:379px\">&nbsp;</td>\r\n		</tr>\r\n		<tr>\r\n			<td style=\"width:512px\">&nbsp;</td>\r\n			<td style=\"width:379px\">&nbsp;</td>\r\n		</tr>\r\n		<tr>\r\n			<td style=\"width:512px\">&nbsp;</td>\r\n			<td style=\"width:379px\">&nbsp;</td>\r\n		</tr>\r\n	</tbody>\r\n</table>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>第一个坑: 由于我的任务中<span style=\"color:#f33b45\">使用了进程池</span>, 也就是</p>\r\n\r\n<p>改进：用多进程对数据进行处理提高程序效率。这时就出问题了，在Celery进程中运行创建子进程时报错：<code>AssertionError: daemonic processes are not allowed to have children（&ldquo;不允许在守护进程中创建子进程&rdquo;）</code></p>\r\n\r\n<p><img alt=\"\" class=\"has\" src=\"https://img-blog.csdnimg.cn/20190719140052916.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:148px; width:600px\" /></p>\r\n\r\n<p>解决办法：</p>\r\n\r\n<p>1，在终端设置环境变量启用优化模式，export PYTHONOPTIMIZE=1，再执行celery -A app.celery.base worker -l info -n socwebai就行了</p>\r\n\r\n<p>2，如果用的multiprocessing，重写一个Mypool：<code>https://stackoverflow.com/questions/6974695/python-process-pool-non-daemonic（挺复杂）</code></p>\r\n\r\n<p><a href=\"https://www.cnblogs.com/sxqjava/p/10336274.html\" id=\"cb_post_title_url\">linux配置全局环境变量</a></p>\r\n\r\n<div>\r\n<pre>\r\n<code># 需要新增环境变量文件在\r\nvim /etc/profile\r\n\r\n# 将 export PYTHONOPTIMIZE=1 写入文件\r\nexport PYTHONOPTIMIZE=1\r\n\r\n# 保存文件\r\n:wq\r\n\r\n# 最后 生效profile文件\r\nsource /etc/profile</code></pre>\r\n</div>\r\n\r\n<p>第二个坑: 如何将celery设置成守护进程</p>\r\n\r\n<p>在这个查阅了很多资料, 使用<a href=\"https://www.cnblogs.com/restran/p/4854623.html\">Supervisor</a>管理celery. 把<a href=\"https://www.jianshu.com/p/222d85c3833e\">supervisor</a>配置都写好,报&nbsp;<a href=\"https://segmentfault.com/q/1010000010087997\">supervisorctl 错误 ERROR (no such process)</a>错误.</p>\r\n\r\n<p>最后也没使用成功.&nbsp;</p>\r\n\r\n<p>询问同事给出了最有效的方法, 可以使用&nbsp; Linux后台执行任务命令: <span style=\"color:#f33b45\">setsid&nbsp;</span></p>\r\n\r\n<p>简直就简单粗暴, 但是使用nohup 却让命令阻塞 这里需要注意.</p>\r\n\r\n<div>\r\n<pre>\r\n<code>setsid celery -A  celery_app worker 1&gt; ./not.out 2&gt;&amp;1</code></pre>\r\n</div>\r\n\r\n<div>\r\n<pre>\r\n<code>setsid celery beat -A celery_app 1&gt;./not_beat.out 2&gt;&amp;1</code></pre>\r\n</div>\r\n\r\n<p>虽然能解决守护进程方式运行, 但是后台top 显示的运行任务全是celery 却分不出是什么任务, 并且celery的log信息不会显示.</p>\r\n\r\n<p><span style=\"color:#f33b45\">为了解决输出log信息把翻源码&nbsp;翻文档终于找到最终解决方式</span>:</p>\r\n\r\n<div>\r\n<pre>\r\n<code>celery multi start -E --pidfile=\"./log/celery.pid\" --logfile=\"./log/celery_worker.log\" -A celery_app worker -l info  # 后台运行</code></pre>\r\n</div>\r\n\r\n<div>\r\n<pre>\r\n<code>celery multi stop worker -A celery_app --loglevel=INFO # 结束</code></pre>\r\n</div>\r\n\r\n<p>&nbsp;<img alt=\"\" class=\"has\" src=\"https://img-blog.csdnimg.cn/20190719180255541.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:378px; width:600px\" /></p>\r\n\r\n<p><img alt=\"\" class=\"has\" src=\"https://img-blog.csdnimg.cn/20190719180556183.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:207px; width:600px\" /></p>\r\n\r\n<hr />\r\n<p><span style=\"color:#3399ea\">更新: 7月20</span></p>\r\n\r\n<hr />\r\n<p>经过第二天测试, 后台运行命令还是不行, 当时在当时测试时候, 确实定时任务以及celery都运行正常. 第二天查看任务计划, 失败了.</p>\r\n\r\n<p>经过查看 celery挂了. 分析原因: 当时测试终端执行的celery命令的终端没有关闭, celery可以正常运行.&nbsp; 把执行的celery后台命令终端关闭,&nbsp; celery也会随之关闭. 出现了第二天任务没有执行.&nbsp;</p>\r\n\r\n<p><img alt=\"\" class=\"has\" src=\"https://img-blog.csdnimg.cn/2019072009093735.png\" style=\"height:104px; width:613px\" /></p>\r\n\r\n<p>放弃之前的后台执行终端所有命令, 改为官方推荐的supervosor 来管理 celery .(只能硬着头皮再怼)</p>\r\n\r\n<p>这里说明一下 配置supervosor 的 celery的信息:&nbsp;</p>\r\n\r\n<p>可以参考一下 需要注意的是:</p>\r\n\r\n<p>1. command 命令 不能使用&nbsp;</p>\r\n\r\n<p>这个命令在supervosor 会出现BOCKOFF状态, 所以需要修改</p>\r\n\r\n<div>\r\n<pre>\r\n<code>celery multi start -E --pidfile=\"./log/celery.pid\" --logfile=\"./log/celery_worker.log\" -A celery_app worker -l info  # 后台运行</code></pre>\r\n</div>\r\n\r\n<p>2. 需要加上开始等待时间和停止时间&nbsp;</p>\r\n\r\n<p>否则&nbsp;&nbsp;supervosor会出现 celery进程会随着终端退出而退出</p>\r\n\r\n<p>以下是参考配置:</p>\r\n\r\n<div>\r\n<pre>\r\n<code>[program:celeryworker]\r\n# command=celery worker -A celery_app --loglevel=INFO  --pidfile=\"/home/seeyii/chentong/SheYi-zhongxinjiantou/log/celery.pid\" --logfile=\"/home/seeyii/chentong/SheYi-zhongxinjiantou/log/celery_worker.log\"\r\ncommand=celery worker -A celery_app --loglevel=INFO  # 程序启动命令\r\ndirectory=/home/seeyii/chentong/SheYi-zhongxinjiantou  # 运行命令的目录\r\n\r\nnumprocs=1\r\n# 设置log的路径\r\nstdout_logfile=/home/seeyii/chentong/SheYi-zhongxinjiantou/log/celery_worker.log   # 标准输出日志\r\nstderr_logfile=/home/seeyii/chentong/SheYi-zhongxinjiantou/log/celery_worker.log   # 标准错误日志\r\nautostart=true  # 在Supervisord启动时，程序是否启动\r\nautorestart=true  # 程序退出后自动重启\r\nstartretries=5  # 启动失败自动重试次数，默认是3\r\npriority=15  # 数字越小，优先级越小，最先启动\r\n\r\n</code></pre>\r\n</div>\r\n\r\n<div>\r\n<pre>\r\n<code>[program:celerybeat]\r\n\r\n# 运行命令\r\ncommand=celery beat -A celery_app\r\n# 项目地址\r\ndirectory=xxxx/xxxx/xxxx\r\n\r\nnumprocs=1\r\nstdout_logfile=/var/log/celery/beat.log\r\nstderr_logfile=/var/log/celery/beat.log\r\nautostart=true\r\nautorestart=true\r\nstartsecs=10\r\n</code></pre>\r\n</div>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>ps: 具体实现supervosor的操作都在下面的链接&nbsp;</p>\r\n\r\n<p><a href=\"http://docs.celeryproject.org/en/latest/userguide/periodic-tasks.html\">celery: 定时任务文档</a></p>\r\n\r\n<p><a href=\"https://github.com/celery/celery/tree/master/extra/supervisord\">celery官网给的supervisord脚本例子</a></p>\r\n\r\n<p><a href=\"https://www.jianshu.com/p/222d85c3833e\">使用supervisor后台运行celery</a></p>\r\n\r\n<p><a href=\"https://www.cnblogs.com/restran/p/4854623.html\">Python 进程管理工具 Supervisor 使用教程</a></p>\r\n\r\n<p><a href=\"https://www.cnblogs.com/ldy-miss/p/10320495.html\">记一次Celery的仇</a></p>\r\n\r\n<p><a href=\"https://blog.csdn.net/Coxhuang/article/details/86921407\">celer守护进程 celery 后台运行beat worker 定时任务</a></p>\r\n\r\n<p><a href=\"https://blog.51cto.com/qiangsh/2153185\">Supervisor的安装部署</a></p>\r\n\r\n<hr />\r\n<p><span style=\"color:#3399ea\">更新: 7月22</span></p>\r\n\r\n<hr />\r\n<p>登上服务器查看发现:</p>\r\n\r\n<p><img alt=\"\" class=\"has\" src=\"https://img-blog.csdnimg.cn/20190722093110965.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:266px; width:600px\" /></p>\r\n\r\n<p>分析: 还是老问题,守护进程下不能创建子进程. 需要supervisor 任务的配置中添加一行命令&nbsp;</p>\r\n\r\n<div>\r\n<pre>\r\n<code>[program:celeryworker] # 文件下添加\r\nenvironment=PYTHONOPTIMIZE=1</code></pre>\r\n</div>\r\n\r\n<p><a href=\"https://stackoverflow.com/questions/17055951/how-to-set-environment-variables-in-supervisor-service\">如何在supervisor服务中设置环境变量</a></p>\r\n\r\n<p><a href=\"http://supervisord.org/subprocess.html#subprocess-environment\">supervisor - 子进程环境</a></p>\r\n\r\n<hr />\r\n<p><span style=\"color:#3399ea\">更新: 7月23</span></p>\r\n\r\n<hr />\r\n<p>&nbsp;查看日志现在定时任务确实在6点执行, 但是查看日志发现有一条是凌晨4点, 我并没有添加过这个定时任务, 于是查看发现大体意思是清理后端结果, celery自己给添加的.</p>\r\n\r\n<p><img alt=\"\" class=\"has\" src=\"https://img-blog.csdnimg.cn/20190723092748531.png\" style=\"height:43px; width:600px\" /></p>\r\n\r\n<p><img alt=\"\" class=\"has\" src=\"https://img-blog.csdnimg.cn/20190723093106719.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:273px; width:600px\" /></p>\r\n\r\n<hr />\r\n<p><span style=\"color:#3399ea\">更新: 9月25</span></p>\r\n\r\n<hr />\r\n<p>发现日志报错如下:</p>\r\n\r\n<p><img alt=\"\" class=\"has\" src=\"https://img-blog.csdnimg.cn/20190925111512114.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:80px; width:600px\" /></p>\r\n\r\n<p>引用<a href=\"https://stackoverflow.com/questions/21126948/workerlosterrorworker-exited-prematurely-signal-15-sigterm?answertab=votes#tab-top\">https://stackoverflow.com 上回答</a>&nbsp;</p>\r\n\r\n<blockquote>\r\n<p style=\"margin-left:0px\"><span style=\"color:#242729\">这些WorkerLostErrors的原因很可能是Celery和Heroku的行为之间不兼容：</span></p>\r\n\r\n<ul style=\"margin-left:30px\">\r\n	<li>Celery工作者期望父工作者进程上有一个SIGTERM，在这种情况下，它让其子进程完成其当前任务。</li>\r\n	<li>当对一个dyno进行&ldquo;热关机&rdquo;时，Heroku将SIGTERM发送给该dyno中的所有进程。</li>\r\n</ul>\r\n\r\n<p style=\"margin-left:0px\"><span style=\"color:#242729\">因此，所有worker子进程也将获得SIGTERM并立即开始终止，从而导致WorkerLostErrors。</span></p>\r\n\r\n<p style=\"margin-left:0px\"><span style=\"color:#242729\">已针对未发布的Celery 4.0准备了一种解决方法：<a href=\"https://github.com/celery/celery/issues/2839\">https</a>&nbsp;:&nbsp;<a href=\"https://github.com/celery/celery/issues/2839\">//github.com/celery/celery/issues/2839</a></span></p>\r\n\r\n<p style=\"margin-left:0px\"><span style=\"color:#242729\">我还没有找到3.1.19的解决方案。</span></p>\r\n</blockquote>\r\n\r\n<p>解决方式是启动celery中添加环境变量</p>\r\n\r\n<div>\r\n<pre>\r\n<code>$ REMAP_SIGTERM=SIGQUIT celery -A proj worker -l info</code></pre>\r\n</div>\r\n\r\n<p>如果是用的supervisor 需要修改conf文件并supervisor添加环境变量</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-bash\">[program:celeryworker]\r\n# PYTHONOPTIMIZE=1       终端设置环境变量启用优化模式-Celery进程中运行创建子进程时报错\r\n# REMAP_SIGTERM=SIGQUIT  强制工人关闭信号15错误\r\nenvironment=PYTHONOPTIMIZE=1, REMAP_SIGTERM=SIGQUIT                  # 配置子进程环境变量\r\ncommand=celery worker -A celery_app --loglevel=INFO --concurrency=1  # 程序启动命令\r\ndirectory=/database/chentong                                         # 运行命令的目录\r\nuser=seeyii\r\nnumprocs=1</code></pre>\r\n<img src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" /><img src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" style=\"height:15px; width:15px\" title=\"点击并拖拽以移动\" /></div>',
        '', '2019-07-19 06:29:00', '2019-07-19 06:29:00', 181, 1, 2, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (69, 'python中多个文件共用logger，重复打印问题的解决方案',
        '<p>问题背景&amp;现象</p>\r\n\r\n<p>最近在项目中，需要用python的logging库来将日志打印到文件中,然后将python脚本放到crontab中执行。所以写了一个logger的简单封装。如下：</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\">\r\n<code class=\"language-python hljs\"><span class=\"hljs-comment\">#!/usr/bin/python</span>\r\n<span class=\"hljs-comment\"># -*- coding:utf-8 -*-</span>\r\n\r\n<span class=\"hljs-keyword\">import</span> logging\r\n<span class=\"hljs-keyword\">import</span> time\r\n<span class=\"hljs-keyword\">import</span> os\r\n\r\n\r\n<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">Log</span><span class=\"hljs-params\">(object)</span>:</span>\r\n    <span class=\"hljs-string\">&#39;&#39;&#39;\r\n封装后的logging\r\n    &#39;&#39;&#39;</span>\r\n\r\n    <span class=\"hljs-function\"><span class=\"hljs-keyword\">def</span> <span class=\"hljs-title\">__init__</span><span class=\"hljs-params\">(self, logger=None, log_cate=<span class=\"hljs-string\">&#39;search&#39;</span>)</span>:</span>\r\n        <span class=\"hljs-string\">&#39;&#39;&#39;\r\n            指定保存日志的文件路径，日志级别，以及调用文件\r\n            将日志存入到指定的文件中\r\n        &#39;&#39;&#39;</span>\r\n\r\n        <span class=\"hljs-comment\"># 创建一个logger</span>\r\n        self.logger = logging.getLogger(logger)\r\n        self.logger.setLevel(logging.DEBUG)\r\n        <span class=\"hljs-comment\"># 创建一个handler，用于写入日志文件</span>\r\n        self.log_time = time.strftime(<span class=\"hljs-string\">&quot;%Y_%m_%d&quot;</span>)\r\n        file_dir = os.getcwd() + <span class=\"hljs-string\">&#39;/../log&#39;</span>\r\n        <span class=\"hljs-keyword\">if</span> <span class=\"hljs-keyword\">not</span> os.path.exists(file_dir):\r\n            os.mkdir(file_dir)\r\n        self.log_path = file_dir\r\n        self.log_name = self.log_path + <span class=\"hljs-string\">&quot;/&quot;</span> + log_cate + <span class=\"hljs-string\">&quot;.&quot;</span> + self.log_time + <span class=\"hljs-string\">&#39;.log&#39;</span>\r\n        <span class=\"hljs-comment\"># print(self.log_name)</span>\r\n\r\n        fh = logging.FileHandler(self.log_name, <span class=\"hljs-string\">&#39;a&#39;</span>)  <span class=\"hljs-comment\"># 追加模式  这个是python2的</span>\r\n        <span class=\"hljs-comment\"># fh = logging.FileHandler(self.log_name, &#39;a&#39;, encoding=&#39;utf-8&#39;)  # 这个是python3的</span>\r\n        fh.setLevel(logging.INFO)\r\n\r\n        <span class=\"hljs-comment\"># 再创建一个handler，用于输出到控制台</span>\r\n        ch = logging.StreamHandler()\r\n        ch.setLevel(logging.INFO)\r\n\r\n        <span class=\"hljs-comment\"># 定义handler的输出格式</span>\r\n        formatter = logging.Formatter(\r\n            <span class=\"hljs-string\">&#39;[%(asctime)s] %(filename)s-&gt;%(funcName)s line:%(lineno)d [%(levelname)s]%(message)s&#39;</span>)\r\n        fh.setFormatter(formatter)\r\n        ch.setFormatter(formatter)\r\n\r\n        <span class=\"hljs-comment\"># 给logger添加handler</span>\r\n        self.logger.addHandler(fh)\r\n        self.logger.addHandler(ch)\r\n\r\n        <span class=\"hljs-comment\">#  添加下面一句，在记录日志之后移除句柄</span>\r\n        <span class=\"hljs-comment\"># self.logger.removeHandler(ch)</span>\r\n        <span class=\"hljs-comment\"># self.logger.removeHandler(fh)</span>\r\n        <span class=\"hljs-comment\"># 关闭打开的文件</span>\r\n        fh.close()\r\n        ch.close()\r\n\r\n    <span class=\"hljs-function\"><span class=\"hljs-keyword\">def</span> <span class=\"hljs-title\">getlog</span><span class=\"hljs-params\">(self)</span>:</span>\r\n        <span class=\"hljs-keyword\">return</span> self.logger</code></pre>\r\n</div>\r\n\r\n<p>目的是让所有用到logger的地方，只import这个封装库就行，然后直接调用。比如调用logger的</p>\r\n\r\n<p>a.py</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\">\r\n<code class=\"language-python hljs\"><span class=\"hljs-comment\">#!/usr/bin/python</span>\r\n<span class=\"hljs-comment\"># -*- coding:utf-8 -*-</span>\r\n\r\n<span class=\"hljs-keyword\">from</span> common.log <span class=\"hljs-keyword\">import</span> Log\r\nlog = Log().getlog()\r\nlog.info(<span class=\"hljs-string\">&quot;I am a.py&quot;</span>)</code></pre>\r\n</div>\r\n\r\n<p>b.py</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\">\r\n<code class=\"language-python hljs\"><span class=\"hljs-comment\">#!/usr/bin/python</span>\r\n<span class=\"hljs-comment\"># -*- coding:utf-8 -*-</span>\r\n\r\n<span class=\"hljs-keyword\">from</span> common.log <span class=\"hljs-keyword\">import</span> Log\r\nlog = Log().getlog()\r\nlog.info(<span class=\"hljs-string\">&quot;I am b.py&quot;</span>)</code></pre>\r\n</div>\r\n\r\n<p>c.py</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\">\r\n<code class=\"language-python hljs\"><span class=\"hljs-comment\">#!/usr/bin/python</span>\r\n<span class=\"hljs-comment\"># -*- coding:utf-8 -*-</span>\r\n\r\n<span class=\"hljs-keyword\">import</span> a\r\n<span class=\"hljs-keyword\">import</span> b\r\n<span class=\"hljs-keyword\">from</span> common.log <span class=\"hljs-keyword\">import</span> Log\r\n\r\nlog = Log().getlog()\r\nlog.info(<span class=\"hljs-string\">&quot;I am c.py&quot;</span>)</code></pre>\r\n</div>\r\n\r\n<p>此时执行c.py的结果如下：</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\">\r\n<code class=\"hljs\">➜  search git:(master) ✗ python c.py\r\n[2019-01-14 15:58:35,807] a.py-&gt;&lt;module&gt; line:6 [INFO]I am a.py\r\n[2019-01-14 15:58:35,808] b.py-&gt;&lt;module&gt; line:6 [INFO]I am b.py\r\n[2019-01-14 15:58:35,808] b.py-&gt;&lt;module&gt; line:6 [INFO]I am b.py\r\n[2019-01-14 15:58:35,809] c.py-&gt;&lt;module&gt; line:8 [INFO]I am c.py\r\n[2019-01-14 15:58:35,809] c.py-&gt;&lt;module&gt; line:8 [INFO]I am c.py\r\n[2019-01-14 15:58:35,809] c.py-&gt;&lt;module&gt; line:8 [INFO]I am c.py</code></pre>\r\n</div>\r\n\r\n<p>可见，a.py, b.py,c.py的logger共用了，出现了重复打印。</p>\r\n\r\n<p>问题原因分析</p>\r\n\r\n<p>从现象可以得出，不同文件间的log系统是相互影响的，在a.py，b.py, c.py中，我们的调用方式是<code>log = Log().getlog()</code>, 即<code>self.logger = logging.getLogger(logger),logger参数并未传递</code> , 所以得到的self.logger是RootLogger。<br />\r\nRootLogger是一个python程序内全局唯一的，所有Logger对象的祖先。所以我们对RootLogger的设定，自然会影响到所有的日志输出。简言之，就是先打开的文件中对log的设置，后打开的文件都会受到影响,都会走一遍logger的继承关系。在这个示例中，b.py在a.py之后被import, 所以b.py会执行一次自己的logger，再执行一次a.py中打开的RootLogger, 以此类推.........</p>\r\n\r\n<p>问题解决方式</p>\r\n\r\n<p><strong>不用默认的RootLogger, 给每个Logger都加个名字。</strong><br />\r\na.py</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\">\r\n<code class=\"language-python hljs\"><span class=\"hljs-keyword\">from</span> common.log <span class=\"hljs-keyword\">import</span> Log\r\nlog = Log(__name__).getlog()\r\nlog.info(<span class=\"hljs-string\">&quot;I am a.py&quot;</span>)</code></pre>\r\n</div>\r\n\r\n<p>b.py</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\">\r\n<code class=\"language-python hljs\"><span class=\"hljs-keyword\">from</span> common.log <span class=\"hljs-keyword\">import</span> Log\r\nlog = Log(__name__).getlog()\r\nlog.info(<span class=\"hljs-string\">&quot;I am b.py&quot;</span>)\r\n</code></pre>\r\n</div>\r\n\r\n<p>c.py</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\">\r\n<code class=\"language-python hljs\"><span class=\"hljs-keyword\">import</span> b\r\n<span class=\"hljs-keyword\">import</span> a\r\n\r\n<span class=\"hljs-keyword\">from</span> common.log <span class=\"hljs-keyword\">import</span> Log\r\n\r\nlog = Log(__name__).getlog()\r\nlog.info(<span class=\"hljs-string\">&quot;I am c.py&quot;</span>)\r\n</code></pre>\r\n</div>\r\n\r\n<p>c.py的最新执行结果：</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\">\r\n<code class=\"language-python hljs\">➜  search git:(master) ✗ python c.py\r\n[2019-01-14 16:24:12,008] b.py-&gt;&lt;module&gt; line:6 [INFO]I am b.py\r\n[2019-01-14 16:24:12,009] a.py-&gt;&lt;module&gt; line:6 [INFO]I am a.py\r\n[2019-01-14 16:24:12,009] c.py-&gt;&lt;module&gt; line:10 [INFO]I am c.py\r\n</code></pre>\r\n<img src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" /><span style=\"background-color:rgba(220,220,220,0.5)\"><img role=\"presentation\" src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" style=\"height:15px; width:15px\" title=\"点击并拖拽以移动\" /></span></div>\r\n\r\n<p>没有重复了，符合预期。问题得以解决。</p>\r\n\r\n<p>参考资料</p>\r\n\r\n<ul>\r\n	<li><a href=\"https://www.cnblogs.com/dplearning/p/5088074.html\">[python]多个文件共用日志系统的重复打印问题</a></li>\r\n	<li><a href=\"https://segmentfault.com/a/1190000015852156\">python的logging 模块浅析</a></li>\r\n</ul>',
        '', '2019-07-25 13:04:56', '2019-07-25 13:04:56', 63, 1, 2, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (70, 'pandas.Series.str.extract 正则提取数据',
        '<h1 style=\"margin-left:0px\"><span style=\"color:#212224\">pandas.Series.str.extract&nbsp;<a class=\"headerlink\" href=\"https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.str.extract.html#pandas-series-str-extract\">&para;</a></span></h1>\r\n\r\n<p><code>Series.str.</code><code>extract</code>（<em>self</em>，<em>pat</em>，<em>flags = 0</em>，<em>expand = True&nbsp;</em>）<a class=\"reference external\" href=\"http://github.com/pandas-dev/pandas/blob/v0.25.1/pandas/core/strings.py#L2966-L2969\">[来源]</a></p>\r\n\r\n<p>提取的正则表达式捕获组拍作为一个数据帧列。</p>\r\n\r\n<p>对于系列中的每个主题字符串，从正则表达式pat的第一个匹配中提取组。</p>\r\n\r\n<table style=\"margin-left:1px\">\r\n	<tbody>\r\n		<tr>\r\n			<th style=\"text-align:left; vertical-align:middle\">参数：</th>\r\n			<td style=\"text-align:left; vertical-align:middle\">\r\n			<p><em>pat</em>&nbsp;：&nbsp;str</p>\r\n\r\n			<p style=\"margin-left:0px\">具有捕获组的正则表达式模式。</p>\r\n\r\n			<p><strong>flags&nbsp;</strong>：&nbsp;int，默认为0（无标志）</p>\r\n\r\n			<p style=\"margin-left:0px\">来自<code>re</code>模块的标志，例如<code>re.IGNORECASE</code>，修改正则表达式匹配，例如大小写，空格等。有关详细信息，请参阅<a class=\"reference external\" href=\"https://docs.python.org/3/library/re.html#module-re\"><code>re</code></a>。</p>\r\n\r\n			<p><strong>expand&nbsp;</strong>：&nbsp;bool，默认为True</p>\r\n\r\n			<p style=\"margin-left:0px\">如果为True，则返回DataFrame，每个捕获组一列。如果为False，如果有一个捕获组，则返回系列/索引;如果有多个捕获组，则返回DataFrame。</p>\r\n\r\n			<p style=\"margin-left:0px\"><em>版本0.18.0中的新功能。</em></p>\r\n			</td>\r\n		</tr>\r\n		<tr>\r\n			<th style=\"text-align:left; vertical-align:middle\">返回：</th>\r\n			<td style=\"text-align:left; vertical-align:middle\">\r\n			<p>DataFrame或系列或索引</p>\r\n\r\n			<p style=\"margin-left:0px\">一个DataFrame，每个主题字符串有一行，每个组有一列。正则表达式pat中的任何捕获组名称都将用于列名称;&nbsp;否则将使用捕获组编号。即使找不到匹配项，每个结果列的dtype也始终为object。如果&nbsp;<code>expand=False</code>和pat只有一个捕获组，则返回一个系列（如果主题是系列）或索引（如果主题是索引）。</p>\r\n			</td>\r\n		</tr>\r\n	</tbody>\r\n</table>\r\n\r\n<p><strong><span style=\"color:#3e4349\">例子</span></strong></p>\r\n\r\n<p><span style=\"color:#3e4349\">具有两个组的模式将返回具有两列的DataFrame。不匹配将是NaN。</span></p>\r\n\r\n<blockquote>\r\n<pre style=\"margin-left:0px\">\r\n<code class=\"language-html\">&gt;&gt;&gt; s = pd.Series([\'a1\', \'b2\', \'c3\'])\r\n&gt;&gt;&gt; s.str.extract(r\'([ab])(\\d)\')\r\n     0    1\r\n0    a    1\r\n1    b    2\r\n2  NaN  NaN\r\n</code></pre>\r\n</blockquote>\r\n\r\n<p><span style=\"color:#3e4349\">模式可以包含可选组。</span></p>\r\n\r\n<blockquote>\r\n<pre style=\"margin-left:0px\">\r\n<code class=\"language-html\">&gt;&gt;&gt; s.str.extract(r\'([ab])?(\\d)\')\r\n     0  1\r\n0    a  1\r\n1    b  2\r\n2  NaN  3\r\n</code></pre>\r\n</blockquote>\r\n\r\n<p><span style=\"color:#3e4349\">命名组将成为结果中的列名。</span></p>\r\n\r\n<blockquote>\r\n<pre style=\"margin-left:0px\">\r\n<code class=\"language-html\">&gt;&gt;&gt; s.str.extract(r\'(?P&lt;letter&gt;[ab])(?P&lt;digit&gt;\\d)\')\r\n  letter digit\r\n0      a     1\r\n1      b     2\r\n2    NaN   NaN\r\n</code></pre>\r\n</blockquote>\r\n\r\n<p><span style=\"color:#3e4349\">如果expand = True，则具有一个组的模式将返回一个具有一列的DataFrame。</span></p>\r\n\r\n<blockquote>\r\n<pre style=\"margin-left:0px\">\r\n<code class=\"language-html\">&gt;&gt;&gt; s.str.extract(r\'[ab](\\d)\', expand=True)\r\n     0\r\n0    1\r\n1    2\r\n2  NaN\r\n</code></pre>\r\n</blockquote>\r\n\r\n<p><span style=\"color:#3e4349\">如果expand = False，则具有一个组的模式将返回Series。</span></p>\r\n\r\n<blockquote>\r\n<pre style=\"margin-left:0px\">\r\n<code class=\"language-html\">&gt;&gt;&gt; s.str.extract(r\'[ab](\\d)\', expand=False)\r\n0      1\r\n1      2\r\n2    NaN\r\ndtype: object</code></pre>\r\n</blockquote>\r\n\r\n<p>需求: 将公司名称提取出来</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-bash\"># 测试数据\r\n\r\n99778                 上海昌腾机电设备有限公司（销售部）\r\n99812              上海昌达汽车配件有限公司（驻山东办事处）\r\n99821                  上海昌金企业管理（集团）有限公司\r\n99837                 上海昌雄机械设备有限公司（经营部）\r\n99874                 上海明丹信息科技有限公司(市场部)\r\n99878             上海明义木业有限公司(上海天廓建材经销部)\r\n99885                 上海明乾物流有限公司 广 州分公司\r\n99902                上海明伟家具厂&amp;lt;销售部&amp;gt;\r\n99903                      上海明伟家具厂&lt;销售部&gt;\r\n99917                   上海明先物资有限公司(销售部)\r\n99922              上海明克包装公司 纸袋 纸塑复合袋 吨袋\r\n99924                  上海明克包装制品有限公司 销售部\r\n99925                 上海明克包装制品有限公司【销售部】\r\n99940                    上海明凯电子有限公司 生产部\r\n99947               上海明利模具五金钢材有限公司(销售部)\r\n99948               上海明利模具五金钢材有限公司（销售部）\r\n99971          上海明可得照明电器有限公司/文安县可得照明电器厂\r\n99983            上海明和超音波股份有限公司(上海嘉定办事处)\r\n99984              上海明和超音波设备有限公司(嘉定办事处)\r\n99994                  上海明国(集团)塑胶制品有限公司\r\n99996                  上海明圣酒店设备(维修)有限公司\r\n99998                  上海明圣酒店设备（维修)有限公司</code></pre>\r\n</div>\r\n\r\n<p>需要提取规范的数据:</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-bash\">99924      上海明克包装制品有限公司\r\n99925      上海明克包装制品有限公司\r\n99940        上海明凯电子有限公司\r\n99947    上海明利模具五金钢材有限公司\r\n99948    上海明利模具五金钢材有限公司\r\n99971     上海明可得照明电器有限公司\r\n99983     上海明和超音波股份有限公司\r\n99984     上海明和超音波设备有限公司\r\n99994  上海明国(集团)塑胶制品有限公司\r\n99996  上海明圣酒店设备(维修)有限公司\r\n99998  上海明圣酒店设备（维修)有限公司</code></pre>\r\n</div>\r\n\r\n<p>按正则表示可以写成这样&nbsp;</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\"># 这是正则表达式\r\n# 表示\"xxxx有限公司\", \"(xxx)xxx\"有限公司\r\n\"[\\(\\)（）\\u4e00-\\u9fa5]+有限公司\"</code></pre>\r\n</div>\r\n\r\n<h1><strong>这里需要注意:</strong></h1>\r\n\r\n<p><code>Series.str.</code><code>extract</code>（<em>self</em>，<em>pat</em>，<em>flags = 0</em>，<em>expand = True&nbsp;</em>）&nbsp;</p>\r\n\r\n<p>正则表达式需要改一改</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\"># 需要改成这样\r\n([\\(\\)（）\\u4e00-\\u9fa5]+有限公司)</code></pre>\r\n</div>\r\n\r\n<p>代码是这样的</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\"># 按之前写的是匹配不出数据\r\n# 这里的意思 [] 是匹配不到数据 [\\(\\)（）\\u4e00-\\u9fa5]+ \r\n# 需要 在[]外在套一层()  ([\\(\\)（）\\u4e00-\\u9fa5]+)\r\n\r\nSeries.str.extract(&#39;([\\(\\)（）\\u4e00-\\u9fa5]+有限公司)&#39;)\r\n</code></pre>\r\n<img src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" /><img src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" style=\"height:15px; width:15px\" title=\"点击并拖拽以移动\" /></div>',
        '', '2019-08-29 08:14:00', '2019-08-29 08:14:00', 85, 1, 2, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (71, 'Scrapy 架构流程图(官方文档) - 翻译整理',
        '<h1><strong><span style=\"color:#404040\">架构概述</span></strong></h1>\r\n\r\n<p style=\"margin-left:0px\"><span style=\"color:#404040\">本文档描述了Scrapy的体系结构及其组件的交互方式。</span></p>\r\n\r\n<h2><span style=\"color:#404040\"><strong>概述</strong></span></h2>\r\n\r\n<p style=\"margin-left:0px\"><span style=\"color:#404040\">下图显示了Scrapy体系结构及其组件的概述以及系统内部发生的数据流的概述（由红色箭头显示）。下面包含组件的简要说明，并提供链接以获取有关它们的更多详细信息。数据流也在下面描述。</span></p>\r\n\r\n<h2><span style=\"color:#404040\"><strong>数据流</strong></span></h2>\r\n\r\n<p><span style=\"color:#404040\"><a class=\"reference internal image-reference\" data-widget=\"image\" href=\"https://docs.scrapy.org/en/latest/_images/scrapy_architecture_02.png\"><img alt=\"Scrapy架构\" class=\"has\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9kb2NzLnNjcmFweS5vcmcvZW4vbGF0ZXN0L19pbWFnZXMvc2NyYXB5X2FyY2hpdGVjdHVyZV8wMi5wbmc\" style=\"height:470px; width:700px\" /></a></span></p>\r\n\r\n<p style=\"margin-left:0px\"><span style=\"color:#404040\">Scrapy中的数据流由执行引擎控制，如下所示：</span></p>\r\n\r\n<ol style=\"margin-left:0px\">\r\n	<li><span style=\"color:#404040\">该<a class=\"reference internal\" href=\"https://docs.scrapy.org/en/latest/topics/architecture.html#component-engine\">引擎</a>获得初始请求从抓取&nbsp;<a class=\"reference internal\" href=\"https://docs.scrapy.org/en/latest/topics/architecture.html#component-spiders\">蜘蛛</a>。</span></li>\r\n	<li><span style=\"color:#404040\">该<a class=\"reference internal\" href=\"https://docs.scrapy.org/en/latest/topics/architecture.html#component-engine\">引擎</a>安排在请求&nbsp;<a class=\"reference internal\" href=\"https://docs.scrapy.org/en/latest/topics/architecture.html#component-scheduler\">调度程序</a>和要求下一个请求抓取。</span></li>\r\n	<li><span style=\"color:#404040\">该<a class=\"reference internal\" href=\"https://docs.scrapy.org/en/latest/topics/architecture.html#component-scheduler\">计划</a>返回下一请求的<a class=\"reference internal\" href=\"https://docs.scrapy.org/en/latest/topics/architecture.html#component-engine\">引擎</a>。</span></li>\r\n	<li><span style=\"color:#404040\">该<a class=\"reference internal\" href=\"https://docs.scrapy.org/en/latest/topics/architecture.html#component-engine\">引擎</a>发送请求到&nbsp;<a class=\"reference internal\" href=\"https://docs.scrapy.org/en/latest/topics/architecture.html#component-downloader\">下载器</a>，通过&nbsp;<a class=\"reference internal\" href=\"https://docs.scrapy.org/en/latest/topics/architecture.html#component-downloader-middleware\">下载器中间件</a>（见&nbsp;<a class=\"reference internal\" href=\"https://docs.scrapy.org/en/latest/topics/downloader-middleware.html#scrapy.downloadermiddlewares.DownloaderMiddleware.process_request\"><code>process_request()</code></a>）。</span></li>\r\n	<li><span style=\"color:#404040\">页面完成下载后，&nbsp;<a class=\"reference internal\" href=\"https://docs.scrapy.org/en/latest/topics/architecture.html#component-downloader\">Downloader会</a>生成一个Response（带有该页面）并将其发送到Engine，并通过&nbsp;<a class=\"reference internal\" href=\"https://docs.scrapy.org/en/latest/topics/architecture.html#component-downloader-middleware\">Downloader Middlewares</a>（请参阅&nbsp;<a class=\"reference internal\" href=\"https://docs.scrapy.org/en/latest/topics/architecture.html#component-downloader-middleware\">参考资料</a><a class=\"reference internal\" href=\"https://docs.scrapy.org/en/latest/topics/downloader-middleware.html#scrapy.downloadermiddlewares.DownloaderMiddleware.process_response\"><code>process_response()</code></a>）。</span></li>\r\n	<li><span style=\"color:#404040\">该<a class=\"reference internal\" href=\"https://docs.scrapy.org/en/latest/topics/architecture.html#component-engine\">引擎</a>接收来自响应&nbsp;<a class=\"reference internal\" href=\"https://docs.scrapy.org/en/latest/topics/architecture.html#component-downloader\">下载器</a>并将其发送到所述&nbsp;<a class=\"reference internal\" href=\"https://docs.scrapy.org/en/latest/topics/architecture.html#component-spiders\">蜘蛛</a>进行处理，通过<a class=\"reference internal\" href=\"https://docs.scrapy.org/en/latest/topics/architecture.html#component-spider-middleware\">蜘蛛中间件</a>（见<a class=\"reference internal\" href=\"https://docs.scrapy.org/en/latest/topics/spider-middleware.html#scrapy.spidermiddlewares.SpiderMiddleware.process_spider_input\"><code>process_spider_input()</code></a>）。</span></li>\r\n	<li><span style=\"color:#404040\">该<a class=\"reference internal\" href=\"https://docs.scrapy.org/en/latest/topics/architecture.html#component-spiders\">蜘蛛</a>处理响应并返回刮下的项目和新的要求（跟随）的&nbsp;<a class=\"reference internal\" href=\"https://docs.scrapy.org/en/latest/topics/architecture.html#component-engine\">引擎</a>，通过&nbsp;<a class=\"reference internal\" href=\"https://docs.scrapy.org/en/latest/topics/architecture.html#component-spider-middleware\">蜘蛛中间件</a>（见<a class=\"reference internal\" href=\"https://docs.scrapy.org/en/latest/topics/spider-middleware.html#scrapy.spidermiddlewares.SpiderMiddleware.process_spider_output\"><code>process_spider_output()</code></a>）。</span></li>\r\n	<li><span style=\"color:#404040\">该<a class=\"reference internal\" href=\"https://docs.scrapy.org/en/latest/topics/architecture.html#component-engine\">引擎</a>发送处理的项目，以&nbsp;<a class=\"reference internal\" href=\"https://docs.scrapy.org/en/latest/topics/architecture.html#component-pipelines\">项目管道</a>，然后把处理的请求的<a class=\"reference internal\" href=\"https://docs.scrapy.org/en/latest/topics/architecture.html#component-scheduler\">调度</a>，并要求今后可能要求抓取。</span></li>\r\n	<li><span style=\"color:#404040\">该过程重复（从步骤1开始），直到<a class=\"reference internal\" href=\"https://docs.scrapy.org/en/latest/topics/architecture.html#component-scheduler\">调度程序</a>不再有请求为止&nbsp;。</span></li>\r\n</ol>\r\n\r\n<h2 style=\"margin-left:24px\">白话版:</h2>\r\n\r\n<blockquote>\r\n<p>1.引擎：Hi！Spider, 你要处理哪一个网站？</p>\r\n\r\n<p>2.Spider：老大要我处理xxxx.com。</p>\r\n\r\n<p>3.引擎：你把第一个需要处理的URL给我吧。</p>\r\n\r\n<p>4.Spider：给你，第一个URL是xxxxxxx.com。</p>\r\n\r\n<p>5.引擎：Hi！调度器，我这有request请求你帮我排序入队一下。</p>\r\n\r\n<p>6.调度器：好的，正在处理你等一下。</p>\r\n\r\n<p>7.引擎：Hi！调度器，把你处理好的request请求给我。</p>\r\n\r\n<p>8.调度器：给你，这是我处理好的request</p>\r\n\r\n<p>9.引擎：Hi！下载器，你按照老大的下载中间件的设置帮我下载一下这个request请求</p>\r\n\r\n<p>10.下载器：好的！给你，这是下载好的东西。（如果失败：sorry，这个request下载失败了。然后引擎告诉调度器，这个request下载失败了，你记录一下，我们待会儿再下载）</p>\r\n\r\n<p>11.引擎：Hi！Spider，这是下载好的东西，并且已经按照老大的下载中间件处理过了，你自己处理一下（注意！这儿responses默认是交给def parse()这个函数处理的）</p>\r\n\r\n<p>12.Spider：（处理完毕数据之后对于需要跟进的URL），Hi！引擎，我这里有两个结果，这个是我需要跟进的URL，还有这个是我获取到的Item数据。</p>\r\n\r\n<p>13.引擎：Hi ！管道 我这儿有个item你帮我处理一下！调度器！这是需要跟进URL你帮我处理下。然后从第四步开始循环，直到获取完老大需要全部信息。&nbsp;<br />\r\n14.管道&ldquo;调度器：好的，现在就做！</p>\r\n</blockquote>\r\n\r\n<h2><span style=\"color:#404040\"><strong>组件</strong></span></h2>\r\n\r\n<h3><span style=\"color:#404040\"><strong>Scrapy引擎</strong></span></h3>\r\n\r\n<p style=\"margin-left:0px\"><span style=\"color:#404040\">引擎负责控制系统所有组件之间的数据流，并在发生某些操作时触发事件。有关详细信息，请参阅上面的&nbsp;<a class=\"reference internal\" href=\"https://docs.scrapy.org/en/latest/topics/architecture.html#data-flow\">数据流</a>部分。</span></p>\r\n\r\n<h3><span style=\"color:#404040\"><strong>调度程序</strong></span></h3>\r\n\r\n<p style=\"margin-left:0px\"><span style=\"color:#404040\">调度程序接收来自引擎的请求，并在引擎请求它们时将它们排入队列以便稍后（也引导到引擎）。</span></p>\r\n\r\n<h3><span style=\"color:#404040\"><strong>下载器</strong></span></h3>\r\n\r\n<p style=\"margin-left:0px\"><span style=\"color:#404040\">下载器负责获取网页并将其提供给引擎，引擎又将它们提供给蜘蛛。</span></p>\r\n\r\n<h3><span style=\"color:#404040\"><strong>蜘蛛</strong></span></h3>\r\n\r\n<p style=\"margin-left:0px\"><span style=\"color:#404040\">蜘蛛是由Scrapy用户编写的自定义类，用于解析响应并从中提取项目或其他要遵循的请求。有关更多信息，请参阅<a class=\"reference internal\" href=\"https://docs.scrapy.org/en/latest/topics/spiders.html#topics-spiders\">蜘蛛</a>。</span></p>\r\n\r\n<h3><span style=\"color:#404040\"><strong>管道</strong></span></h3>\r\n\r\n<p style=\"margin-left:0px\"><span style=\"color:#404040\">物品管道负责在物品被蜘蛛提取（搜罗）后处理物品。典型的任务包括清理，验证和持久性（如将项目存储在数据库中）。有关更多信息，请参阅<a class=\"reference internal\" href=\"https://docs.scrapy.org/en/latest/topics/item-pipeline.html#topics-item-pipeline\">项目管道</a>。</span></p>\r\n\r\n<p style=\"margin-left:0px\"><span style=\"color:#404040\">管道的典型用途是：</span></p>\r\n\r\n<ul style=\"margin-left:0px\">\r\n	<li>清理HTML数据</li>\r\n	<li>验证已删除的数据（检查项目是否包含某些字段）</li>\r\n	<li>检查重复项（并删除它们）</li>\r\n	<li>将已删除的项目存储在数据库中</li>\r\n</ul>\r\n\r\n<h3><span style=\"color:#404040\"><strong>下载中间件</strong></span></h3>\r\n\r\n<p>下载器中间件是Scrapy的请求/响应处理的钩子框架。它是一个轻量级的低级系统，用于全局改变Scrapy的请求和响应。<span style=\"color:#404040\">位于Engine和Downloader之间的钩子框架，当它们从Engine传递到Downloader时处理请求，以及从Downloader传递到Engine的响应。如果您需要执行以下操作之一，请使用Downloader中间件：</span></p>\r\n\r\n<ul style=\"margin-left:0px\">\r\n	<li><span style=\"color:#404040\">在将请求发送到下载程序之前处理请求（即在Scrapy将请求发送到网站之前）;</span></li>\r\n	<li><span style=\"color:#404040\">在将它传递给蜘蛛之前改变收到的响应;</span></li>\r\n	<li><span style=\"color:#404040\">发送新的请求，而不是将收到的响应传递给蜘蛛;</span></li>\r\n	<li><span style=\"color:#404040\">在没有抓取网页的情况下将响应传递给蜘蛛;</span></li>\r\n	<li><span style=\"color:#404040\">默默地放弃一些请求。</span></li>\r\n</ul>\r\n\r\n<p style=\"margin-left:0px\"><span style=\"color:#404040\">有关更多信息，请参阅<a class=\"reference internal\" href=\"https://docs.scrapy.org/en/latest/topics/downloader-middleware.html#topics-downloader-middleware\">下载器中间件</a>。</span></p>\r\n\r\n<h3><span style=\"color:#404040\"><strong>蜘蛛中间件</strong></span></h3>\r\n\r\n<p style=\"margin-left:0px\">蜘蛛中间件是一个钩入Scrapy蜘蛛处理机制的框架，您可以在其中插入自定义功能来处理发送给<a class=\"reference internal\" href=\"https://docs.scrapy.org/en/latest/topics/spiders.html#topics-spiders\">Spiders</a>的响应，以便处理和处理从蜘蛛生成的请求和项目,<span style=\"color:#404040\">位于Engine和Spider之间的特定钩子。</span></p>\r\n\r\n<p style=\"margin-left:0px\"><span style=\"color:#404040\">如果需要，请使用Spider中间件</span></p>\r\n\r\n<ul style=\"margin-left:0px\">\r\n	<li><span style=\"color:#404040\">蜘蛛回调的后期处理输出 - 更改/添加/删除请求或项目;</span></li>\r\n	<li><span style=\"color:#404040\">后处理start_requests;</span></li>\r\n	<li><span style=\"color:#404040\">处理蜘蛛异常;</span></li>\r\n	<li><span style=\"color:#404040\">根据响应内容调用errback而不是回调某些请求。</span></li>\r\n</ul>\r\n\r\n<p style=\"margin-left:0px\"><span style=\"color:#404040\">有关更多信息，请参阅<a class=\"reference internal\" href=\"https://docs.scrapy.org/en/latest/topics/spider-middleware.html#topics-spider-middleware\">Spider Middleware</a>。</span></p>\r\n\r\n<h2><span style=\"color:#404040\"><strong>事件驱动的网络</strong></span></h2>\r\n\r\n<p style=\"margin-left:0px\"><span style=\"color:#404040\">Scrapy是用<a class=\"reference external\" href=\"https://twistedmatrix.com/trac/\">Twisted</a>编写的，<a class=\"reference external\" href=\"https://twistedmatrix.com/trac/\">Twisted</a>是一个流行的事件驱动的Python网络框架。因此，它使用非阻塞（也称为异步）代码实现并发。</span></p>\r\n\r\n<p style=\"margin-left:0px\">但是，在日常工作和面试过程中，经常发现有些会笃定地认为 Scrapy 采用的是多线程并发模型。实际上，虽然 Twisted 框架提供了线程池支持，但是其核心网络部分处理逻辑依赖的是「单线程 IO 多路复用」技术，在 Linux 平台上，是围绕 <code>epoll()</code> 系统调用实现的 Reactor 模式。</p>\r\n\r\n<p style=\"margin-left:0px\"><span style=\"color:#404040\">有关异步编程和Twisted的更多信息，请参阅以下链接：</span></p>\r\n\r\n<ul style=\"margin-left:0px\">\r\n	<li><a class=\"reference external\" href=\"https://twistedmatrix.com/trac/\">Twisted</a><span style=\"color:#404040\"><a class=\"reference external\" href=\"https://twistedmatrix.com/documents/current/core/howto/defer-intro.html\">中的延迟介绍</a></span></li>\r\n	<li><span style=\"color:#404040\"><a class=\"reference external\" href=\"http://jessenoller.com/blog/2009/02/11/twisted-hello-asynchronous-programming/\">Twisted - 你好，异步编程</a></span></li>\r\n	<li><a class=\"reference external\" href=\"https://twistedmatrix.com/trac/\">Twisted</a><span style=\"color:#404040\"><a class=\"reference external\" href=\"http://krondo.com/an-introduction-to-asynchronous-programming-and-twisted/\">的介绍 - Krondo</a></span></li>\r\n</ul>',
        '', '2019-08-07 09:50:29', '2019-08-07 09:50:29', 73, 1, 2, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (72, 'HTML Marquee 标签实现文字滚动',
        '<p>Marquee是html的标签，所有的主流浏览器都能兼容，用于创建文字滚动。<br />\r\n来介绍下标签的属性</p>\r\n\r\n<p>之前自己做的博客页面风格觉得很死板, 无意间看到&nbsp;HTML Marquee标签可以动态.下图是加了标签的gif图</p>\r\n\r\n<p><img alt=\"\" class=\"has\" src=\"https://img-blog.csdnimg.cn/20190805090619855.gif\" style=\"height:450px; width:600px\" /></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-html\">参考链接\r\n\r\n滚动方向 direction\r\n\r\n&lt;!--滚动方向 direction 4个值 up down left right  默认从右向左--&gt;\r\n&lt;marquee direction=&quot;up&quot;&gt;我想上滚动&lt;/marquee&gt;\r\n\r\n滚动方式 behavior\r\n\r\n&lt;!--3个值 scroll-循环滚动 slide-只滚动一次 alternate-来回滚动  默认循环滚动--&gt;\r\n&lt;marquee behavior=&quot;slide&quot;&gt;我只滚动一次&lt;/marquee&gt;\r\n\r\n滚动速度 scrollamount\r\n\r\n&lt;!--值越大，滚动速度越快 一般5-10比较适宜消息观看--&gt;\r\n&lt;marquee scrollamount=&quot;5&quot;&gt;我是速度为5的滚动&lt;/marquee&gt;\r\n滚动延迟 scrolldelay\r\n\r\n&lt;!--值越大，滚动速度越慢，通常不设置--&gt;\r\n&lt;marquee scrolldelay=&quot;90&quot;&gt;我延迟滚动&lt;/marquee&gt;\r\n滚动循环 loop\r\n\r\n&lt;!-- 默认值-1或infinite 表示无限循环滚动 loop=&quot;数值&quot; 表示滚动相应的次数--&gt;\r\n&lt;marquee loop=&quot;2&quot;&gt;我是loop循环滚动&lt;/marquee&gt;\r\n滚动范围控制 width height\r\n\r\n滚动背景颜色 bgcolor\r\n\r\n//宽100px 高90px 背景色为#f5f5f5的滚动区域\r\n&lt;marquee direction=&quot;up&quot; width=&quot;100&quot; height=&quot;90&quot; bgcolor=&quot;#f5f5f5&quot; &gt;\r\n    &lt;p&gt;开发工程师&lt;/p&gt;\r\n    &lt;p&gt;设计师&lt;/p&gt;\r\n    &lt;p&gt;前端开发&lt;/p&gt;\r\n&lt;/marquee&gt;\r\n\r\n滚动空间 hspace-水平边距 vspace-垂直边距\r\n\r\n&lt;marquee direction=&quot;up&quot; width=&quot;50&quot; hspace=&quot;20&quot; vspace=&quot;10&quot; &gt;\r\n    &lt;p&gt;开发工程师&lt;/p&gt;\r\n    &lt;p&gt;设计师&lt;/p&gt;\r\n    &lt;p&gt;前端开发&lt;/p&gt;\r\n&lt;/marquee&gt;\r\n\r\n滚动事件\r\n\r\n//鼠标悬停，滚动停止   鼠标离开，滚动继续\r\n&lt;marquee direction=&quot;up&quot; onmouseover=&quot;this.stop()&quot; onmouseout=&quot;this.start()&quot;&gt;\r\n    &lt;p&gt;开发工程师&lt;/p&gt;\r\n    &lt;p&gt;设计师&lt;/p&gt;\r\n    &lt;p&gt;前端开发&lt;/p&gt;\r\n&lt;/marquee&gt;\r\n\r\n简单的一个标签，就能让文字随心所欲地走起来~</code></pre>\r\n<img src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" /><img src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" style=\"height:15px; width:15px\" title=\"点击并拖拽以移动\" /></div>',
        '', '2019-08-05 01:15:29', '2019-08-05 01:15:29', 77, 1, 6, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (73, 'pandas 数据排序.sort_index()和.sort_values()',
        '<p>&nbsp;</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre data-widget=\"codeSnippet\">\r\n<code class=\"language-python hljs\"><span class=\"hljs-keyword\">import</span> pandas <span class=\"hljs-keyword\">as</span> pd\r\ndf = pd.DataFrame(&hellip;&hellip;)\r\n说明：以下&ldquo;df&rdquo;为DataFrame对象。</code></pre>\r\n</div>\r\n\r\n<h1>1. df. sort_values()</h1>\r\n\r\n<p><strong>作用：既可以根据列数据，也可根据行数据排序。<br />\r\n注意：必须指定by参数，即必须指定哪几行或哪几列；无法根据index名和columns名排序（由.sort_index()执行）</strong></p>\r\n\r\n<h2>调用方式</h2>\r\n\r\n<p><strong>DataFrame.sort_values(by, axis=0, ascending=True, inplace=False, kind=&#39;quicksort&#39;, na_position=&#39;last&#39;)</strong><br />\r\naxis：{0 or &lsquo;index&rsquo;, 1 or &lsquo;columns&rsquo;}, default 0，默认按照列排序，即纵向排序；如果为1，则是横向排序。<br />\r\nby：str or list of str；如果axis=0，那么by=&quot;列名&quot;；如果axis=1，那么by=&quot;行名&quot;。<br />\r\nascending：布尔型，True则升序，如果by=[&#39;列名1&#39;,&#39;列名2&#39;]，则该参数可以是[True, False]，即第一字段升序，第二个降序。<br />\r\ninplace：布尔型，是否用排序后的数据框替换现有的数据框。<br />\r\nkind：排序方法，{&lsquo;quicksort&rsquo;, &lsquo;mergesort&rsquo;, &lsquo;heapsort&rsquo;}, default &lsquo;quicksort&rsquo;。似乎不用太关心。<br />\r\nna_position：{&lsquo;first&rsquo;, &lsquo;last&rsquo;}, default &lsquo;last&rsquo;，默认缺失值排在最后面。</p>\r\n\r\n<p>例：</p>\r\n\r\n<p>原数据</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre data-widget=\"codeSnippet\">\r\n<code class=\"language-python hljs\">df = pd.DataFrame({<span class=\"hljs-string\">&#39;b&#39;</span>:[<span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">2</span>,<span class=\"hljs-number\">3</span>,<span class=\"hljs-number\">2</span>],<span class=\"hljs-string\">&#39;a&#39;</span>:[<span class=\"hljs-number\">4</span>,<span class=\"hljs-number\">3</span>,<span class=\"hljs-number\">2</span>,<span class=\"hljs-number\">1</span>],<span class=\"hljs-string\">&#39;c&#39;</span>:[<span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">3</span>,<span class=\"hljs-number\">8</span>,<span class=\"hljs-number\">2</span>]},index=[<span class=\"hljs-number\">2</span>,<span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">3</span>]) \r\n    b   a   c\r\n<span class=\"hljs-number\">2</span>   <span class=\"hljs-number\">1</span>   <span class=\"hljs-number\">4</span>   <span class=\"hljs-number\">1</span>\r\n<span class=\"hljs-number\">0</span>   <span class=\"hljs-number\">2</span>   <span class=\"hljs-number\">3</span>   <span class=\"hljs-number\">3</span>\r\n<span class=\"hljs-number\">1</span>   <span class=\"hljs-number\">3</span>   <span class=\"hljs-number\">2</span>   <span class=\"hljs-number\">8</span>\r\n<span class=\"hljs-number\">3</span>   <span class=\"hljs-number\">2</span>   <span class=\"hljs-number\">1</span>   <span class=\"hljs-number\">2</span></code></pre>\r\n</div>\r\n\r\n<p>1.按b列升序排序</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre data-widget=\"codeSnippet\">\r\n<code class=\"language-python hljs\">df.sort_values(by=<span class=\"hljs-string\">&#39;b&#39;</span>) <span class=\"hljs-comment\">#等同于df.sort_values(by=&#39;b&#39;,axis=0)</span>\r\n    b   a   c\r\n<span class=\"hljs-number\">2</span>   <span class=\"hljs-number\">1</span>   <span class=\"hljs-number\">4</span>   <span class=\"hljs-number\">1</span>\r\n<span class=\"hljs-number\">0</span>   <span class=\"hljs-number\">2</span>   <span class=\"hljs-number\">3</span>   <span class=\"hljs-number\">3</span>\r\n<span class=\"hljs-number\">3</span>   <span class=\"hljs-number\">2</span>   <span class=\"hljs-number\">1</span>   <span class=\"hljs-number\">2</span>\r\n<span class=\"hljs-number\">1</span>   <span class=\"hljs-number\">3</span>   <span class=\"hljs-number\">2</span>   <span class=\"hljs-number\">8</span></code></pre>\r\n</div>\r\n\r\n<p>2.先按b列降序，再按a列升序排序</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre data-widget=\"codeSnippet\">\r\n<code class=\"language-python hljs\">df.sort_values(by=[<span class=\"hljs-string\">&#39;b&#39;</span>,<span class=\"hljs-string\">&#39;a&#39;</span>],axis=<span class=\"hljs-number\">0</span>,ascending=[<span class=\"hljs-keyword\">False</span>,<span class=\"hljs-keyword\">True</span>]) \r\n    b   a   c\r\n<span class=\"hljs-number\">1</span>   <span class=\"hljs-number\">3</span>   <span class=\"hljs-number\">2</span>   <span class=\"hljs-number\">8</span>\r\n<span class=\"hljs-number\">3</span>   <span class=\"hljs-number\">2</span>   <span class=\"hljs-number\">1</span>   <span class=\"hljs-number\">2</span>\r\n<span class=\"hljs-number\">0</span>   <span class=\"hljs-number\">2</span>   <span class=\"hljs-number\">3</span>   <span class=\"hljs-number\">3</span>\r\n<span class=\"hljs-number\">2</span>   <span class=\"hljs-number\">1</span>   <span class=\"hljs-number\">4</span>   <span class=\"hljs-number\">1</span></code></pre>\r\n</div>\r\n\r\n<p>3.按行3升序排列</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre data-widget=\"codeSnippet\">\r\n<code class=\"language-python hljs\">df.sort_values(by=<span class=\"hljs-number\">3</span>,axis=<span class=\"hljs-number\">1</span>) <span class=\"hljs-comment\">#必须指定axis=1</span>\r\n    a   b   c\r\n<span class=\"hljs-number\">2</span>   <span class=\"hljs-number\">4</span>   <span class=\"hljs-number\">1</span>   <span class=\"hljs-number\">1</span>\r\n<span class=\"hljs-number\">0</span>   <span class=\"hljs-number\">3</span>   <span class=\"hljs-number\">2</span>   <span class=\"hljs-number\">3</span>\r\n<span class=\"hljs-number\">1</span>   <span class=\"hljs-number\">2</span>   <span class=\"hljs-number\">3</span>   <span class=\"hljs-number\">8</span>\r\n<span class=\"hljs-number\">3</span>   <span class=\"hljs-number\">1</span>   <span class=\"hljs-number\">2</span>   <span class=\"hljs-number\">2</span></code></pre>\r\n</div>\r\n\r\n<p>4.按行3升序，行0降排列</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre data-widget=\"codeSnippet\">\r\n<code class=\"language-python hljs\">df.sort_values(by=[<span class=\"hljs-number\">3</span>,<span class=\"hljs-number\">0</span>],axis=<span class=\"hljs-number\">1</span>,ascending=[<span class=\"hljs-keyword\">True</span>,<span class=\"hljs-keyword\">False</span>])\r\n    a   c   b\r\n<span class=\"hljs-number\">2</span>   <span class=\"hljs-number\">4</span>   <span class=\"hljs-number\">1</span>   <span class=\"hljs-number\">1</span>\r\n<span class=\"hljs-number\">0</span>   <span class=\"hljs-number\">3</span>   <span class=\"hljs-number\">3</span>   <span class=\"hljs-number\">2</span>\r\n<span class=\"hljs-number\">1</span>   <span class=\"hljs-number\">2</span>   <span class=\"hljs-number\">8</span>   <span class=\"hljs-number\">3</span>\r\n<span class=\"hljs-number\">3</span>   <span class=\"hljs-number\">1</span>   <span class=\"hljs-number\">2</span>   <span class=\"hljs-number\">2</span></code></pre>\r\n</div>\r\n\r\n<p><strong>注意：指定多列（多行）排序时，先按排在前面的列（行）排序，如果内部有相同数据，再对相同数据内部用下一个列（行）排序，以此类推。如何内部无重复数据，则后续排列不执行。即首先满足排在前面的参数的排序，再排后面参数</strong></p>\r\n\r\n<h1>2. df. sort_index()</h1>\r\n\r\n<p><strong>作用：默认根据行标签对所有行排序，或根据列标签对所有列排序，或根据指定某列或某几列对行排序。<br />\r\n注意：df. sort_index()可以完成和df. sort_values()完全相同的功能，但python更推荐用只用df. sort_index()对&ldquo;根据行标签&rdquo;和&ldquo;根据列标签&rdquo;排序，其他排序方式用df.sort_values()。</strong></p>\r\n\r\n<p>调用方式</p>\r\n\r\n<p><strong>sort_index(axis=0, level=None, ascending=True, inplace=False, kind=&#39;quicksort&#39;, na_position=&#39;last&#39;, sort_remaining=True, by=None)</strong><br />\r\naxis：0按照行名排序；1按照列名排序<br />\r\nlevel：默认None，否则按照给定的level顺序排列---貌似并不是，文档<br />\r\nascending：默认True升序排列；False降序排列<br />\r\ninplace：默认False，否则排序之后的数据直接替换原来的数据框<br />\r\nkind：排序方法，{&lsquo;quicksort&rsquo;, &lsquo;mergesort&rsquo;, &lsquo;heapsort&rsquo;}, default &lsquo;quicksort&rsquo;。似乎不用太关心。<br />\r\nna_position：缺失值默认排在最后{&quot;first&quot;,&quot;last&quot;}<br />\r\nby：按照<strong>某一列或几列</strong>数据进行排序，但是by参数貌似不建议使用</p>\r\n\r\n<p>例：</p>\r\n\r\n<p>源数据</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre data-widget=\"codeSnippet\">\r\n<code class=\"language-python hljs\"><span class=\"hljs-keyword\">import</span> pandas <span class=\"hljs-keyword\">as</span> pd  \r\ndf = pd.DataFrame({<span class=\"hljs-string\">&#39;b&#39;</span>:[<span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">2</span>,<span class=\"hljs-number\">2</span>,<span class=\"hljs-number\">3</span>],<span class=\"hljs-string\">&#39;a&#39;</span>:[<span class=\"hljs-number\">4</span>,<span class=\"hljs-number\">3</span>,<span class=\"hljs-number\">2</span>,<span class=\"hljs-number\">1</span>],<span class=\"hljs-string\">&#39;c&#39;</span>:[<span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">3</span>,<span class=\"hljs-number\">8</span>,<span class=\"hljs-number\">2</span>]},index=[<span class=\"hljs-number\">2</span>,<span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">3</span>]) \r\n    b   a   c\r\n<span class=\"hljs-number\">2</span>   <span class=\"hljs-number\">1</span>   <span class=\"hljs-number\">4</span>   <span class=\"hljs-number\">1</span>\r\n<span class=\"hljs-number\">0</span>   <span class=\"hljs-number\">2</span>   <span class=\"hljs-number\">3</span>   <span class=\"hljs-number\">3</span>\r\n<span class=\"hljs-number\">1</span>   <span class=\"hljs-number\">3</span>   <span class=\"hljs-number\">2</span>   <span class=\"hljs-number\">8</span>\r\n<span class=\"hljs-number\">3</span>   <span class=\"hljs-number\">2</span>   <span class=\"hljs-number\">1</span>   <span class=\"hljs-number\">2</span></code></pre>\r\n</div>\r\n\r\n<p>1.默认按&ldquo;行标签&rdquo;升序排列（推荐）</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre data-widget=\"codeSnippet\">\r\n<code class=\"language-python hljs\">df.sort_index() <span class=\"hljs-comment\">#默认按&ldquo;行标签&rdquo;升序排序，或df.sort_index(axis=0, ascending=True)</span>\r\n    b   a   c\r\n<span class=\"hljs-number\">0</span>   <span class=\"hljs-number\">2</span>   <span class=\"hljs-number\">3</span>   <span class=\"hljs-number\">3</span>\r\n<span class=\"hljs-number\">1</span>   <span class=\"hljs-number\">3</span>   <span class=\"hljs-number\">2</span>   <span class=\"hljs-number\">8</span>\r\n<span class=\"hljs-number\">2</span>   <span class=\"hljs-number\">1</span>   <span class=\"hljs-number\">4</span>   <span class=\"hljs-number\">1</span>\r\n<span class=\"hljs-number\">3</span>   <span class=\"hljs-number\">2</span>   <span class=\"hljs-number\">1</span>   <span class=\"hljs-number\">2</span></code></pre>\r\n</div>\r\n\r\n<p>2.按&ldquo;列标签&rdquo;升序排列（推荐）</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre data-widget=\"codeSnippet\">\r\n<code class=\"language-python hljs\">df.sort_index(axis=<span class=\"hljs-number\">1</span>) <span class=\"hljs-comment\">#按&ldquo;列标签&rdquo;升序排序</span>\r\n    a   b   c\r\n<span class=\"hljs-number\">2</span>   <span class=\"hljs-number\">4</span>   <span class=\"hljs-number\">1</span>   <span class=\"hljs-number\">1</span>\r\n<span class=\"hljs-number\">0</span>   <span class=\"hljs-number\">3</span>   <span class=\"hljs-number\">2</span>   <span class=\"hljs-number\">3</span>\r\n<span class=\"hljs-number\">1</span>   <span class=\"hljs-number\">2</span>   <span class=\"hljs-number\">3</span>   <span class=\"hljs-number\">8</span>\r\n<span class=\"hljs-number\">3</span>   <span class=\"hljs-number\">1</span>   <span class=\"hljs-number\">2</span>   <span class=\"hljs-number\">2</span></code></pre>\r\n<img src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" /><span style=\"background:url(&quot;https://chenyinren.top/root_static/ckeditor/ckeditor/plugins/widget/images/handle.png&quot;) rgba(220, 220, 220, 0.5); display:block; left:0px; top:-15px\"><img role=\"presentation\" src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" style=\"height:15px; width:15px\" title=\"点击并拖拽以移动\" /></span></div>\r\n\r\n<p>&nbsp;</p>',
        '', '2020-03-25 06:10:00', '2020-03-25 06:10:00', 86, 1, 2, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (74, '博客优化-利用let\'s encrypt在七牛云上CDN加速',
        '<p>查了查网上没有一篇说的很明白的文章，以至于走了不少弯路，以下为我开启CDN加速的一种可行方案。</p>\r\n\r\n<h2>什么是CDN？</h2>\r\n\r\n<p>CDN 的全称是 Content Delivery Network，即内容分发网络。它可以存储你的站点的静态资源，分发到所有边缘节点，用户在访问的时候会从就近的 CDN 节点获取资源，从而达到访问加速的目的。</p>\r\n\r\n<p>形象点讲，可以拿快递物流来举例子，我们在京东购物的时候，通常会发现京东的配送速度很快，经常第二天就到了，甚至有的当天就到货，这是因为京东的仓库遍布全国的城市，用户买的东西会从就近的仓库发货，速度自然快多了！</p>\r\n\r\n<p>CDN加速也是同样的原理，开启了CDN加速可以大幅度提高网站的加载速度。</p>\r\n\r\n<h2>准备工作</h2>\r\n\r\n<p>完成本文的目的需要选择合适的CDN服务和域名解析服务：</p>\r\n\r\n<ul>\r\n	<li>CDN服务我们采用<strong>七牛云CDN</strong>，每个月有免费10G的流量，稳定可靠；</li>\r\n	<li>域名解析服务由于我用的是阿里云，所以我以<strong>阿里云域名解析</strong>为例子；</li>\r\n	<li>另外我的博客是基于 Django 的，这个影响不大，只要配置好了你的CDN加速域名，根据个人需要引用到自己的站点中即可；</li>\r\n	<li>另外你还需要一个备案的域名；</li>\r\n</ul>\r\n\r\n<h2>配置过程</h2>\r\n\r\n<h4>配置简述：</h4>\r\n\r\n<ol>\r\n	<li>在七牛云上创建一个<strong>存储空间</strong>，用于存储源站的资源；</li>\r\n	<li>配置一个七牛云CDN<strong>加速域名</strong>，作为访问存储空间资源的快速通道；</li>\r\n	<li>在阿里云域名解析中添加一个<strong>CNAME解析</strong>，创建一个二级域名将它解析到七牛云的加速域名CNAME；</li>\r\n	<li>配置 Django 博客，加载静态资源的时候使用；</li>\r\n</ol>\r\n\r\n<h4>配置详解：</h4>\r\n\r\n<h4>1. 在七牛云上注册账号，然后登录后台</h4>\r\n\r\n<h4>2. 创建存储空间</h4>\r\n\r\n<p><img alt=\"\" src=\"/media/upload/2020/03/31/d8d79658-f65e-42d1-84cf-9f1f6263aac1.png\" style=\"height:432px; width:600px\" /></p>\r\n\r\n<p>在七牛云的后台点击&ldquo;对象存储 -&gt; 新建存储空间&rdquo;，然后填写存储空间名称，用于存放你的网站静态资源，其它默认即可。</p>\r\n\r\n<h4>3. 配置七牛云CDN加速域名</h4>\r\n\r\n<p><img src=\"/media/upload/2020/03/31/1e425bce-d65f-4c52-96db-2d24420e75b9.png\" style=\"height:494px; width:600px\" /></p>\r\n\r\n<p>点击&ldquo;融合 CDN -&gt; 域名管理 -&gt; 添加域名&rdquo;，然后填写信息。</p>\r\n\r\n<ul>\r\n	<li><strong>域名类型</strong>我们使用&ldquo;普通域名&rdquo;，即选择一个二级域名作为我们的加速域名，你也可以选择泛域名，即包含你的域名下的所有子域名，但是我没试过；</li>\r\n	<li><strong>加速域名</strong>填写你指定的用于访问CDN资源的二级域名，注意配置的二级域名不能和你之前配置的重复；</li>\r\n	<li><strong>使用场景</strong>选择&ldquo;图片小文件&rdquo;，假如你需要加速的资源主要是几十M的安装包，那么可以选择下载分发。这里我需要对网站静态文件加速，所以保持默认；</li>\r\n	<li><strong>源站配置</strong>填写刚刚创建的存储空间，用于保存我的网站静态资源；</li>\r\n	<li>其它保持默认就好</li>\r\n</ul>\r\n\r\n<p>点击&ldquo;创建&rdquo;，等待几十分钟配置完成。</p>\r\n\r\n<h4>4. 配置镜像存储</h4>\r\n\r\n<p>在加速域名配置期间，我们可以先配置下刚创建的存储空间的镜像存储。</p>\r\n\r\n<p>七牛的镜像存储服务是一种快速的数据迁移和加速服务，可以帮助用户实现无缝数据迁移，迁移过程中并不影响原有业务系统的访问。</p>\r\n\r\n<p>也就说配置镜像存储后，源站资源（文件/图片等）初次访问会自动同步到七牛云存储，不需要我们手动同步网站资源。</p>\r\n\r\n<p><img src=\"/media/upload/2020/03/31/b5fb5afe-47ae-489f-a53e-651aca94993e.png\" style=\"height:284px; width:600px\" /></p>\r\n\r\n<p>点击&ldquo;对象存储 -&gt; my-cdn -&gt; 镜像存储&rdquo;，然后填写&ldquo;镜像源&rdquo;为你的网站域名，其它保持默认，点击保存设置。</p>\r\n\r\n<h4>5. 对CDN加速域名进行DNS解析</h4>\r\n\r\n<p>这个时候加速域名的配置差不多好了，完成后会在你的&ldquo;融合 CDN -&gt; 域名管理&rdquo;中多出一条记录：</p>\r\n\r\n<p><img src=\"/media/upload/2020/03/31/image_G5DAMnD.png\" style=\"height:94px; width:600px\" /></p>\r\n\r\n<p>然后点击加速域名的&ldquo;配置&rdquo;，在弹出的页面上方复制七牛云给加速域名分配的CNAME</p>\r\n\r\n<p><img src=\"/media/upload/2020/03/31/image_vFVefy1.png\" style=\"height:99px; width:600px\" /></p>\r\n\r\n<p>打开阿里云域名解析，点击&ldquo;添加记录&rdquo;。</p>\r\n\r\n<ul>\r\n	<li>记录类型选择&ldquo;CNAME&rdquo;</li>\r\n	<li>主机记录填写&ldquo;cdn&rdquo;（即刚才配置的加速域名，这里是要将它DNS解析到七牛云）</li>\r\n	<li>记录值填写从七牛云复制过来的加速域名的CNAME</li>\r\n	<li>其它保持默认</li>\r\n</ul>\r\n\r\n<p><img src=\"/media/upload/2020/03/31/c99ad09d-344d-4087-bc9f-0d29b1a0b3a6.png\" style=\"height:427px; width:600px\" /></p>\r\n\r\n<p>配置好之后点击确定，等待一小会试着访问&ldquo;cdn.chenyinren.top.com&rdquo;，发现是不是可以访问了呢？这就是对应的你的网站的镜像站点，主要用于存储静态资源。初次访问镜像站点的某个页面会比较慢，待同步之后，再访问会发现速度有了很大提高。</p>\r\n\r\n<h4>6. 配置 Django 博客中静态资源地址为加速域名</h4>\r\n\r\n<p>通过七牛云的CDN加速域名，我们就可以快速访问静态资源了，但是博客中还是用老域名访问静态资源，速度当然不会提升了！这里需要我们手动配置下博客，将 chenyinren.top/static/xxx.jpg 这样的静态资源访问链接改为 cdn.chenyinren.top/static/xxx.jpg 的格式。</p>\r\n\r\n<p>修改博客源码中 settings.py 文件：</p>\r\n\r\n<pre>\r\n<code># 静态文件\r\n# STATIC_URL = \'/static/\'\r\nSTATIC_URL = \'http://cdn.chenyinren.top/static/\'\r\n# 上传配置\r\n# MEDIA_URL   = \'/uploads/\'\r\nMEDIA_URL = \'http://cdn.chenyinren.top/uploads/\'\r\n</code></pre>\r\n\r\n<p>这样只要你在模板中静态文件 url 是用 {% static &#39;/static/xxx.jpg&#39; %} 渲染的，那么会自动更改。</p>\r\n\r\n<p>这一步我卡了好久，很多博客到七牛云加速域名配置完成后就没有继续介绍加速域名怎么应用到网站中，自己琢磨了一下找到了 Django 博客配置的可行方法，供大家参考。</p>\r\n\r\n<h4>参考资料</h4>\r\n\r\n<ul>\r\n	<li>\r\n	<p>融合CDN-快速入门（七牛云官方文档）&nbsp;<br />\r\n	https://developer.qiniu.com/fusion/manual/1228/fusion-quick-start</p>\r\n	</li>\r\n	<li>\r\n	<p>七牛云融合CDN到底怎么配置？&nbsp;<br />\r\n	https://blog.csdn.net/javaer_lee/article/details/53521176</p>\r\n	</li>\r\n</ul>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h2 style=\"font-style:normal; margin-left:-8px; text-align:start\">七牛云免费证书</h2>\r\n\r\n<p><img src=\"/media/upload/2020/03/31/image-20200331172048-14.png\" style=\"height:361px; width:600px\" /></p>\r\n\r\n<p><span style=\"background-color:#ffffff; color:#636b6f; font-family:&quot;PT Serif&quot;,Georgia,Times,&quot;Times New Roman&quot;,serif; font-size:15px\">这个提交很方便，但只对公司服务，对个人不友好。幸好还提供&nbsp;</span><strong>上传自有证书</strong><span style=\"background-color:#ffffff; color:#636b6f; font-family:&quot;PT Serif&quot;,Georgia,Times,&quot;Times New Roman&quot;,serif; font-size:15px\">的服务，使用这个服务可以自己弄到证书后往里填，比在自己的服务器里麻烦，总比没有的好。</span></p>\r\n\r\n<h2 style=\"font-style:normal; margin-left:-8px; text-align:start\">let&#39;s encrypt 证书</h2>\r\n\r\n<p style=\"text-align:start\">这里使用的工具是&nbsp;<code>acme.sh</code>，这是用纯脚本写的工具，在Unix系统下都可顺利安装运行。</p>\r\n\r\n<p style=\"text-align:start\"><a href=\"https://github.com/acmesh-official/acme.sh/wiki/%E8%AF%B4%E6%98%8E\">acme.sh GitHub</a></p>\r\n\r\n<h3 style=\"margin-left:0px; margin-right:0px; text-align:start\">1. 安装&nbsp;<strong>acme.sh</strong></h3>\r\n\r\n<p style=\"text-align:start\">安装很简单, 一个命令:</p>\r\n\r\n<pre style=\"text-align:start\">\r\n<code class=\"language-bash\">curl  https://get.acme.sh | sh\r\n或者:\r\nwget -O -  https://get.acme.sh | sh\r\n</code></pre>\r\n\r\n<p style=\"margin-left:0px; margin-right:0px; text-align:left\">使用喜欢Git命令也可以用以下命令安装:</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">git clone https://github.com/Neilpang/acme.sh.git\r\ncd ./acme.sh\r\n./acme.sh --install</code></pre>\r\n\r\n<p style=\"margin-left:0px; margin-right:0px; text-align:left\">脚本主要做了以下事情:</p>\r\n\r\n<blockquote>\r\n<p style=\"margin-left:0px; margin-right:0px\">1.生成复制了<code>acme.sh</code>&nbsp;到你的(<code>$HOME</code>):&nbsp;<code>~/.acme.sh/</code>目录下 ，后面所有的证书都会在这个目录生成.</p>\r\n\r\n<p style=\"margin-left:0px; margin-right:0px\">2.Create alias for:&nbsp;<code>acme.sh=~/.acme.sh/acme.sh</code>. 注意：<strong>安装完成后你需要关闭再打开终端才可以让alias 生效。</strong></p>\r\n\r\n<p style=\"margin-left:0px; margin-right:0px\">3.增加了一个定时任务，用于SSL证书更新.</p>\r\n</blockquote>\r\n\r\n<p style=\"text-align:start\">普通用户和 root 用户都可以安装使用. 安装过程进行了以下几步:</p>\r\n\r\n<ol>\r\n	<li>把 acme.sh 安装到你的&nbsp;<strong>home</strong>&nbsp;目录下:</li>\r\n</ol>\r\n\r\n<pre style=\"text-align:start\">\r\n<code class=\"language-bash\">~/.acme.sh/\r\n</code></pre>\r\n\r\n<p style=\"text-align:start\">并创建 一个 bash 的 alias, 方便你的使用:&nbsp;<code>alias acme.sh=~/.acme.sh/acme.sh</code></p>\r\n\r\n<p style=\"text-align:start\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2. 自动为你创建 cronjob, 每天 0:00 点自动检测所有的证书, 如果快过期了, 需要更新, 则会自动更新证书.</p>\r\n\r\n<p style=\"text-align:start\"><strong>安装过程不会污染已有的系统任何功能和文件</strong>, 所有的修改都限制在安装目录中:&nbsp;<code>~/.acme.sh/</code></p>\r\n\r\n<p style=\"text-align:start\">&nbsp;</p>\r\n\r\n<p style=\"text-align:start\">但你可能在安装时遇到下面的出错提示：</p>\r\n\r\n<blockquote>\r\n<pre style=\"margin-left:-15px; margin-right:-15px; text-align:start\">\r\n<code><span style=\"color:#859900\">Failed</span> <span style=\"color:#859900\">to</span> <span style=\"color:#859900\">connect</span> <span style=\"color:#859900\">to</span> <span style=\"color:#859900\">raw</span><span style=\"color:#268bd2\">.githubusercontent</span><span style=\"color:#268bd2\">.com</span> <span style=\"color:#859900\">port</span> 443: <span style=\"color:#859900\">Connection</span> <span style=\"color:#859900\">refused</span>\r\n</code></pre>\r\n</blockquote>\r\n\r\n<p style=\"text-align:start\">简单的解决方法是换个国外的VPS上运行</p>\r\n\r\n<p style=\"text-align:start\">如果安装成功则会出现下面提示：</p>\r\n\r\n<pre>\r\n<code>[Sat 15 Feb 2020 09:53:15 AM UTC] Installing from online archive.\r\n[Sat 15 Feb 2020 09:53:15 AM UTC] Downloading https://github.com/acmesh-official/acme.sh/archive/master.tar.gz\r\n[Sat 15 Feb 2020 09:53:16 AM UTC] Extracting master.tar.gz\r\n[Sat 15 Feb 2020 09:53:16 AM UTC] It is recommended to install socat first.\r\n[Sat 15 Feb 2020 09:53:16 AM UTC] We use socat for standalone server if you use standalone mode.\r\n[Sat 15 Feb 2020 09:53:16 AM UTC] If you don\'t use standalone mode, just ignore this warning.\r\n[Sat 15 Feb 2020 09:53:16 AM UTC] Installing to /root/.acme.sh\r\n[Sat 15 Feb 2020 09:53:16 AM UTC] Installed to /root/.acme.sh/acme.sh\r\n[Sat 15 Feb 2020 09:53:16 AM UTC] Installing alias to \'/root/.bashrc\'\r\n[Sat 15 Feb 2020 09:53:16 AM UTC] OK, Close and reopen your terminal to start using acme.sh\r\n[Sat 15 Feb 2020 09:53:16 AM UTC] Installing cron job\r\nno crontab for root\r\nno crontab for root\r\n[Sat 15 Feb 2020 09:53:16 AM UTC] Good, bash is found, so change the shebang to use bash as preferred.\r\n[Sat 15 Feb 2020 09:53:17 AM UTC] OK\r\n[Sat 15 Feb 2020 09:53:17 AM UTC] Install success!</code></pre>\r\n\r\n<p style=\"text-align:start\">程序会安装在当前用户的&nbsp;<strong>home</strong>&nbsp;目录下</p>\r\n\r\n<h3 style=\"color:#636b6f; font-style:normal; text-align:start\">验证域名所有权</h3>\r\n\r\n<p style=\"text-align:start\">acme.sh 实现了 acme 协议支持的所有验证协议。 一般有两种方式验证: http 和 dns 验证。</p>\r\n\r\n<p style=\"text-align:start\">由于域名已经<strong>cname</strong>给七牛了，这里要用&nbsp;<strong>dns</strong>&nbsp;方式验证，就是在域名解析了设置相关<strong>TXT</strong>记录&hellip;&hellip;实际不用登录到后台那么干，大多数域名服务商会提供<strong>API key</strong>，直接用接口设置。</p>\r\n\r\n<p style=\"text-align:start\">我这里以 阿里云 为例，<code>在</code><strong>acme.sh 文档中也有说明 </strong><a href=\"https://github.com/acmesh-official/acme.sh/wiki/dnsapi#11-use-aliyun-domain-api-to-automatically-issue-cert\">https://github.com/acmesh-official/acme.sh/wiki/dnsapi#11-use-aliyun-domain-api-to-automatically-issue-cert</a></p>\r\n\r\n<p style=\"text-align:start\"><img alt=\"\" src=\"/media/upload/2020/03/31/image-20200331173219-1.png\" style=\"height:279px; width:600px\" /></p>\r\n\r\n<p style=\"text-align:start\">这里需要打开阿里云API密钥链接&nbsp;&nbsp; 就弹出窗口，看到&nbsp;<code>id</code>&nbsp;和&nbsp;<code>Token</code>&nbsp;，应立刻记下来，放在其它地方，等会使用。</p>\r\n\r\n<p style=\"text-align:start\">实行命令添加Ali_Key&nbsp;和&nbsp;Ali_Secret：</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">export Ali_Key=\"xxxx\"\r\nexport Ali_Secret=\"xxxx\"</code></pre>\r\n\r\n<p style=\"text-align:start\"><img alt=\"\" src=\"/media/upload/2020/03/31/image-20200331173411-2.png\" style=\"height:131px; width:600px\" /></p>\r\n\r\n<h3 style=\"color:#636b6f; font-style:normal; text-align:start\">生成证书</h3>\r\n\r\n<p style=\"text-align:start\">再来一条命令搞定：</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">sh acme.sh --issue --dns dns_ali -d cdn.chenyinren.top -d www.cdn.chenyinren.top</code></pre>\r\n\r\n<p style=\"text-align:start\">上面是 两个域名申请证书，根据自己的情况增减。</p>\r\n\r\n<p style=\"text-align:start\"><span style=\"background-color:#ffffff; color:#636b6f; font-family:&quot;PT Serif&quot;,Georgia,Times,&quot;Times New Roman&quot;,serif; font-size:15px\">如果正常则会看到下面提示</span></p>\r\n\r\n<p style=\"text-align:start\">&nbsp;</p>\r\n\r\n<p style=\"text-align:start\">&nbsp;</p>\r\n\r\n<p style=\"text-align:start\"><span style=\"background-color:#ffffff; color:#636b6f; font-family:&quot;PT Serif&quot;,Georgia,Times,&quot;Times New Roman&quot;,serif; font-size:15px\">重要的是最后几行：</span></p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">[Tue Mar 31 06:46:36 UTC 2020] Your cert is in  /root/.acme.sh/cdn.chenyinren.top/cdn.chenyinren.top.cer \r\n[Tue Mar 31 06:46:36 UTC 2020] Your cert key is in  /root/.acme.sh/cdn.chenyinren.top/cdn.chenyinren.top.key \r\n[Tue Mar 31 06:46:36 UTC 2020] The intermediate CA cert is in  /root/.acme.sh/cdn.chenyinren.top/ca.cer \r\n[Tue Mar 31 06:46:36 UTC 2020] And the full chain certs is there:  /root/.acme.sh/cdn.chenyinren.top/fullchain.cer </code></pre>\r\n\r\n<h3 style=\"color:#636b6f; font-style:normal; text-align:start\">填写证书</h3>\r\n\r\n<p style=\"text-align:start\">把上面第4和第2个文件的内容分别填进七牛后台，参考下图</p>\r\n\r\n<p style=\"text-align:start\"><img alt=\"\" src=\"/media/upload/2020/03/31/231a93b00027ea6bf7189412d2a85c6a.png\" style=\"height:385px; width:600px\" />a</p>\r\n\r\n<h2 style=\"font-style:normal; margin-left:-8px; text-align:start\">配置启用 https</h2>\r\n\r\n<p style=\"text-align:start\">最后是到&nbsp;<code>CDN / 域名管理</code>&nbsp;选择对应的域名<code>配置</code></p>\r\n\r\n<p style=\"text-align:start\"><img src=\"/media/upload/2020/03/31/image_uhHeMF9.png\" style=\"height:188px; width:600px\" /></p>\r\n\r\n<p style=\"text-align:start\"><img src=\"/media/upload/2020/03/31/image.png\" style=\"height:127px; width:600px\" /></p>\r\n\r\n<p style=\"text-align:start\">&nbsp;</p>\r\n\r\n<p>一般等待两三分钟后就可以用&nbsp;<code>https</code>&nbsp;访问</p>\r\n\r\n<h2>参考</h2>\r\n\r\n<ul>\r\n	<li>acme.sh中文说明&nbsp;<a href=\"https://github.com/acmesh-official/acme.sh/wiki/%E8%AF%B4%E6%98%8E\" rel=\"nofollow\" target=\"_blank\">https://github.com/acmesh-official/acme.sh/wiki/%E8%AF%B4%E6%98%8E</a>&nbsp;</li>\r\n	<li>\r\n	<p>dns 接口详细说明&nbsp;<a href=\"https://github.com/acmesh-official/acme.sh/wiki/dnsapi\" rel=\"nofollow\" target=\"_blank\">https://github.com/acmesh-official/acme.sh/wiki/dnsapi</a>&nbsp;&nbsp;这里一定要看，不同的域名服务商，命令也不同</p>\r\n	</li>\r\n</ul>',
        '', '2020-03-31 09:41:00', '2020-03-31 09:41:00', 108, 1, 4, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (77, 'Redis 可设置中文语言 可视化客户端Redis Desktop Manager for Mac 0.9.3.39',
        '<blockquote>\r\n<p>链接:https://pan.baidu.com/s/1H87mj6zWprBHvJhGmpoQ1A &nbsp;密码:26gk</p>\r\n</blockquote>\r\n\r\n<p>&nbsp;此软件包下载后就直接能用，Redis Desktop Manager&nbsp; Mac版本</p>\r\n\r\n<p><img alt=\"\" class=\"has\" data-widget=\"image\" src=\"https://img-blog.csdnimg.cn/20191225134238601.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:448px; width:600px\" /></p>',
        '', '2019-12-25 05:43:40', '2019-12-25 05:43:40', 69, 1, 4, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (78, 'Mac 应用无法打开或文件损坏的处理方法',
        '<blockquote>\r\n<p>有些用户下载了一些程序之后，却发现无法在MAC中安装，安装时会弹出下图所示警告框：&ldquo;打不开 xxx，因为它来自身份不明的开发者&rdquo;。那么该如何解决这个问题呢？</p>\r\n</blockquote>\r\n\r\n<p>在MAC下安装一些软件时提示&quot;来自身份不明开发者&quot;，其实这是MAC新系统启用了新的安全机制。<br />\r\n默认只信任&nbsp;<strong>Mac App Store</strong>&nbsp;下载的软件和拥有开发者 ID 签名的应用程序。<br />\r\n换句话说就是 MAC 系统默认只能安装靠谱渠道（有苹果审核的&nbsp;<strong>Mac App Store</strong>）下载的软件或被认可的人开发的软件。</p>\r\n\r\n<p>这当然是为了用户不会稀里糊涂安装流氓软件中招，但没有开发者签名的 &ldquo;老实软件&rdquo; 也受影响了，安装就会弹出下图所示警告框：&ldquo;打不开 xxx，因为它来自身份不明的开发者&rdquo;。</p>\r\n\r\n<p><strong>出现这个问题的解决方法有2种：</strong></p>\r\n\r\n<ol>\r\n	<li>最简单的方式：按住Control后，再次点击软件图标，即可。</li>\r\n	<li>修改系统配置：系统偏好设置... -&gt; 安全性与隐私。</li>\r\n</ol>\r\n\r\n<p><strong>系统偏好设置</strong></p>\r\n\r\n<p><strong>安全性与隐私</strong></p>\r\n\r\n<p><strong>认证</strong></p>\r\n\r\n<p><strong>修改为任何来源</strong></p>\r\n\r\n<h1><code>高能预警！！！！！！！！(专门为不仔细看文章的准备的。。。。。。。没办法，只能放这么大了，要不老有人在评论里面问)</code></h1>\r\n\r\n<h2>如果没有这个选项的话（macOS Sierra 10.12）,打开<code>终端</code>，输入<code>sudo spctl --master-disable</code>然后按<code>回车</code>。然后会看见个password后面还有个钥匙图标，然后不用管他直接再继续输入你自己电脑解锁密码（输入的时候不显示你输入的密码，感觉就是输入不了东西一样，也不用管，凭感觉输入完按回车键）。然后再回到隐私里，就看见任何来源了。</h2>',
        '', '2019-09-03 03:30:33', '2019-09-03 03:30:33', 72, 1, 4, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (79, 'Python命名规范',
        '<ul>\r\n	<li><strong>所有命名规范都要准守这三条</strong></li>\r\n</ul>\r\n\r\n<p>1.命名只能以字母或者_下划线开头</p>\r\n\r\n<pre>\r\n<code class=\"language-python\">#错误类名\r\nclass 4_Person():\r\n  pass\r\n#错误函数名\r\ndef 漂亮():\r\n  pass</code></pre>\r\n\r\n<p>2.名字不能包含空格</p>\r\n\r\n<p>3.名字不能与关键字重合</p>\r\n\r\n<pre>\r\n<code class=\"language-python\">#错误函数名，与关键字and重合\r\ndef and():\r\n    pass</code></pre>\r\n\r\n<p><em>关键字参考<a href=\"https://zhuanlan.zhihu.com/p/73525721\">《如何写一个函数》</a></em></p>\r\n\r\n<ul>\r\n	<li>不能将字符l(小写字母l)，&#39;O&#39;&#39;o&#39;(大小写字母o)、&#39;I&#39;(大写字母I)用作变量名称，防止和数字0、1混淆</li>\r\n</ul>\r\n\r\n<h2>模块 module_name</h2>\r\n\r\n<ul>\r\n	<li>与包的规范相同，如mymodule</li>\r\n</ul>\r\n\r\n<pre>\r\n<code class=\"language-python\">import decoder\r\nimport html_parser\r\n#不推荐的这种命名\r\nimport Decoder</code></pre>\r\n\r\n<h2>包 package_name</h2>\r\n\r\n<ul>\r\n	<li>应该是简短的、小写的名字，如果下划线可以改善可读性可以加入，如mypackage</li>\r\n</ul>\r\n\r\n<h2>类 ClassName</h2>\r\n\r\n<ul>\r\n	<li>总是使用首字母大写单词串，如MyClass(CamelCase驼峰命名)</li>\r\n</ul>\r\n\r\n<pre>\r\n<code class=\"language-python\">class Person():\r\n    pass\r\nclass Elc_Car(Car):\r\n    pass\r\nclass _PrivateCar(Car):\r\n    pass</code></pre>\r\n\r\n<ul>\r\n	<li>内部类可以使用额外的前导下划线</li>\r\n</ul>\r\n\r\n<h2>函数 function_name</h2>\r\n\r\n<ul>\r\n	<li>全部小写，如有多个单词，用_下划线隔开，私有函数可用前导下划线，如例3</li>\r\n</ul>\r\n\r\n<pre>\r\n<code class=\"language-python\">def calculator():\r\n    pass\r\ndef private_computer():\r\n    pass\r\nclass Person():\r\n    def _private_func():\r\n        pass</code></pre>\r\n\r\n<h2>方法 method_name</h2>\r\n\r\n<ul>\r\n	<li>同函数，小写 + 下划线</li>\r\n</ul>\r\n\r\n<h2>变量 var_name</h2>\r\n\r\n<ul>\r\n	<li>变量名一般小写，多个单词用_下划线隔开，同函数命名</li>\r\n	<li>私有类成员使用单一下划线前缀标识</li>\r\n	<li>变量名不应该带有类型信息，如num_list,ani_dict等</li>\r\n</ul>\r\n\r\n<pre>\r\n<code class=\"language-python\">count = 0     \r\nanimal_count = 100</code></pre>\r\n\r\n<h2>全局变量</h2>\r\n\r\n<ul>\r\n	<li>全部大写，多个单词用_下划线隔开，如需要阻止导入模块内的全局变量，可以加一个前导下划线，GLOBAL_VAR_NAME，_GLOBAL_VAL</li>\r\n	<li>常量和全局变量命名规范相同</li>\r\n</ul>\r\n\r\n<h2>异常 ExceptionName</h2>\r\n\r\n<ul>\r\n	<li>以Error作为后缀</li>\r\n</ul>\r\n\r\n<pre>\r\n<code class=\"language-python\">try:         \r\n    pass     \r\nexcept ValueError as result:         \r\n    pass</code></pre>\r\n\r\n<h2>参数 function_parameter_name</h2>\r\n\r\n<ul>\r\n	<li>如果一个函数的参数名称和保留的关键字冲突，通常使用一个后缀下划线</li>\r\n</ul>\r\n\r\n<h2>常用的命名缩写</h2>\r\n\r\n<ul>\r\n	<li>function 缩写为fn</li>\r\n	<li>text 缩写为 txt</li>\r\n	<li>object 缩写为 obj</li>\r\n	<li>count 缩写为 cnt</li>\r\n	<li>number 缩写为 num</li>\r\n</ul>\r\n\r\n<h2>前导后缀下划线说明</h2>\r\n\r\n<ul>\r\n	<li>一个前导下划线：表示非公有</li>\r\n	<li>一个后缀下划线：避免关键字冲突</li>\r\n	<li>两个前导下划线：当命名一个类属性引起名称冲突时使用</li>\r\n	<li>两个前导和后缀下划线：有特殊用途的对象或者属性，例如__<em>init</em>__<em>和</em>__<em>str</em>__</li>\r\n</ul>',
        '', '2019-04-03 03:54:00', '2019-04-03 03:54:00', 89, 1, 2, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (80, '5个顶级异步Python框架',
        '<p>Python在3.4引入了 asyncio 库，3.6新增了关键字&nbsp;<code>async</code>和<code>await</code>，此后，异步框架迅速发展了起来，性能上能和Node.js比肩，除非是CPU密集型任务，否则没有理由不适用异步框架。</p>\r\n\r\n<p>如果你是Web开发者，现在异步Web框架上有了更多选择！</p>\r\n\r\n<h3>1、Tornado</h3>\r\n\r\n<p>Tornado 根本不是什么新框架，它最初是由FriendFeed（后被Facebook收购）在2009年发布。从一开始就提供有异步编程的功能。</p>\r\n\r\n<p><img alt=\"tornado-logo.png\" data-widget=\"image\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9mb29maXNoLm5ldC9pbWFnZXMvdG9ybmFkby1sb2dvLnBuZw?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>Tornado 不仅仅是Web框架，同时它内置了很多异步模块，可用于自己构建异步应用。这些模块包括：</p>\r\n\r\n<ul>\r\n	<li>协同程序和其他原语（tornado.gen，tornado.locks，tornado.queues等）</li>\r\n	<li>网络模块（tornado.ioloop，tornado.iostream等）</li>\r\n	<li>异步服务器和客户端（tornado.httpserver，tornado.httpclient，等）</li>\r\n</ul>\r\n\r\n<p>通过这些模块，Tornado 构建了自己的异步Web框架模块。</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre data-widget=\"codeSnippet\">\r\n<code class=\"language-python hljs\"><span class=\"hljs-keyword\">import</span> tornado.ioloop\r\n<span class=\"hljs-keyword\">import</span> tornado.web\r\n\r\n<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">MainHandler</span><span class=\"hljs-params\">(tornado.web.RequestHandler)</span>:</span>\r\n    <span class=\"hljs-function\"><span class=\"hljs-keyword\">def</span> <span class=\"hljs-title\">get</span><span class=\"hljs-params\">(self)</span>:</span>\r\n        self.write(<span class=\"hljs-string\">&quot;Hello, world&quot;</span>)\r\n\r\n<span class=\"hljs-function\"><span class=\"hljs-keyword\">def</span> <span class=\"hljs-title\">make_app</span><span class=\"hljs-params\">()</span>:</span>\r\n    <span class=\"hljs-keyword\">return</span> tornado.web.Application([\r\n        (<span class=\"hljs-string\">r&quot;/&quot;</span>, MainHandler),\r\n    ])\r\n\r\n<span class=\"hljs-keyword\">if</span> __name__ == <span class=\"hljs-string\">&quot;__main__&quot;</span>:\r\n    app = make_app()\r\n    app.listen(<span class=\"hljs-number\">8888</span>)\r\n    tornado.ioloop.IOLoop.current().start()</code></pre>\r\n</div>\r\n\r\n<p>Tornado在Python社区中拥有很多追随者，并且经验丰富的架构师使用它们来构建功能强大的系统。这个框架长期以来一直在解决并发问题，但是由于它不支持WSGI标准（大部分Python库仍在同步中），因此尚未成为主流。</p>\r\n\r\n<p>国内据说知乎是基于Torando构建的。</p>\r\n\r\n<h3>2、 Snaic</h3>\r\n\r\n<p>Sanic是一个诞生有3年的框架：它只支持3.6以上Python版本，支持通用的async / await语法，开箱即用，因此你无需阅读大量文档就可以写出你的一个HTTP 处理器。</p>\r\n\r\n<p><img alt=\"sanic-logo.webp\" data-widget=\"image\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9mb29maXNoLm5ldC9pbWFnZXMvc2FuaWMtbG9nby53ZWJw?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>除了<code>async</code>关键字之外，语法上和 flask 基于没差别。</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre data-widget=\"codeSnippet\">\r\n<code class=\"language-python hljs\"><span class=\"hljs-keyword\">from</span> sanic <span class=\"hljs-keyword\">import</span> Sanic\r\n<span class=\"hljs-keyword\">from</span> sanic.response <span class=\"hljs-keyword\">import</span> json\r\n\r\napp = Sanic()\r\n\r\n<span class=\"hljs-meta\">@app.route(&quot;/&quot;)</span>\r\n<span class=\"hljs-keyword\">async</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">def</span> <span class=\"hljs-title\">test</span><span class=\"hljs-params\">(request)</span>:</span>\r\n    <span class=\"hljs-keyword\">return</span> json({<span class=\"hljs-string\">&quot;hello&quot;</span>: <span class=\"hljs-string\">&quot;world&quot;</span>})\r\n\r\n<span class=\"hljs-keyword\">if</span> __name__ == <span class=\"hljs-string\">&quot;__main__&quot;</span>:\r\n    app.run(host=<span class=\"hljs-string\">&quot;0.0.0.0&quot;</span>, port=<span class=\"hljs-number\">8000</span>)</code></pre>\r\n</div>\r\n\r\n<p>Sanic可以说是Python世界中最流行和最受欢迎的异步框架。它具有你项目中需要的所有功能：路由，中间件，Cookie，版本控制，蓝图，基于类的视图，静态文件，流，sockets，此外你还可以集成模板，数据库驱动，文件I / O，队列等等。</p>\r\n\r\n<h3>3、Vibora</h3>\r\n\r\n<p>Vibora和Sanic非常像，致力于成为最快的Python Web服务器。他们网站首页有一个框架比较图：</p>\r\n\r\n<p><img alt=\"微信截图_20200103135346.png\" data-widget=\"image\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9mb29maXNoLm5ldC9pbWFnZXMvJUU1JUJFJUFFJUU0JUJGJUExJUU2JTg4JUFBJUU1JTlCJUJFXzIwMjAwMTAzMTM1MzQ2LnBuZw?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>Vibora声称比其它框架快几倍，比竞争对手Sanic还快两倍多。当然，这个基准测试要持怀疑态度。</p>\r\n\r\n<p>尽管在语法和功能上，Vibora可以与Sanic媲美但我认为Sanic更加成熟，因为它已经存在了很长一段时间并且具有更大的社区。</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre data-widget=\"codeSnippet\">\r\n<code class=\"language-python hljs\"><span class=\"hljs-keyword\">from</span> vibora <span class=\"hljs-keyword\">import</span> Vibora, JsonResponse\r\n\r\napp = Vibora()\r\n\r\n<span class=\"hljs-meta\">@app.route(&#39;/&#39;)</span>\r\n<span class=\"hljs-keyword\">async</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">def</span> <span class=\"hljs-title\">home</span><span class=\"hljs-params\">()</span>:</span>\r\n    <span class=\"hljs-keyword\">return</span> JsonResponse({<span class=\"hljs-string\">&#39;hello&#39;</span>: <span class=\"hljs-string\">&#39;world&#39;</span>})\r\n\r\n<span class=\"hljs-keyword\">if</span> __name__ == <span class=\"hljs-string\">&#39;__main__&#39;</span>:\r\n    app.run(host=<span class=\"hljs-string\">&quot;0.0.0.0&quot;</span>, port=<span class=\"hljs-number\">8000</span>)</code></pre>\r\n</div>\r\n\r\n<h3>4、Quart</h3>\r\n\r\n<p>如果您喜欢Flask，但又要支持异步， 那么Quart你一定会喜欢</p>\r\n\r\n<p><img alt=\"quart-logo-422x270.webp\" data-widget=\"image\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9mb29maXNoLm5ldC9pbWFnZXMvcXVhcnQtbG9nby00MjJ4MjcwLndlYnA?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>Quart符合ASGI标准，该标准是WSGI标准的后继产品，并提供异步支持。Quart不仅与Flask相似，而且与Flask API兼容！该框架的作者希望保留了Flask的风格，只是向其中添加异步、WebSocket和HTTP 2支持。因此，你可以从Flask文档中学习Quart的用法，只需要记住Quart中的函数是异步的就行。</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre data-widget=\"codeSnippet\">\r\n<code class=\"language-python hljs\"><span class=\"hljs-keyword\">from</span> quart <span class=\"hljs-keyword\">import</span> Quart\r\n\r\napp = Quart(__name__)\r\n\r\n<span class=\"hljs-meta\">@app.route(&#39;/&#39;)</span>\r\n<span class=\"hljs-keyword\">async</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">def</span> <span class=\"hljs-title\">hello</span><span class=\"hljs-params\">()</span>:</span>\r\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-string\">&#39;hello&#39;</span>\r\n\r\napp.run()</code></pre>\r\n</div>\r\n\r\n<p>几乎完全像Flask</p>\r\n\r\n<p>由于Quart是从Flask中演进过来的，因此Flask的所有功能均可用：路由，中间件，会话，模板，蓝图等。实际上，你甚至可以直接在Quart内部使用Flask的扩展插件。不过，有一个问题是它仅支持Python 3.7+。</p>\r\n\r\n<h3>5、FastAPI</h3>\r\n\r\n<p>FastAPI似乎是异步 Python 框架里功能、文档最丰富的框架。</p>\r\n\r\n<p><img alt=\"fast-api-logo.webp\" data-widget=\"image\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9mb29maXNoLm5ldC9pbWFnZXMvZmFzdC1hcGktbG9nby53ZWJw?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>该框架的作者深入研究了其他几个框架，从诸如Django到Sanic之类的现代框架，以及NestJS（Node.js，Typescript Web框架）。</p>\r\n\r\n<p>语法甚至可以说它比我们遇到的其他框架更有趣：</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre data-widget=\"codeSnippet\">\r\n<code class=\"language-python hljs\"><span class=\"hljs-keyword\">from</span> fastapi <span class=\"hljs-keyword\">import</span> FastAPI\r\n\r\napp = FastAPI()\r\n\r\n<span class=\"hljs-meta\">@app.get(&quot;/users/me&quot;)</span>\r\n<span class=\"hljs-keyword\">async</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">def</span> <span class=\"hljs-title\">read_user_me</span><span class=\"hljs-params\">()</span>:</span>\r\n    <span class=\"hljs-keyword\">return</span> {<span class=\"hljs-string\">&quot;user_id&quot;</span>: <span class=\"hljs-string\">&quot;the current user&quot;</span>}\r\n\r\n<span class=\"hljs-meta\">@app.get(&quot;/users/{user_id}&quot;)</span>\r\n<span class=\"hljs-keyword\">async</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">def</span> <span class=\"hljs-title\">read_user</span><span class=\"hljs-params\">(user_id: str)</span>:</span>\r\n    <span class=\"hljs-keyword\">return</span> {<span class=\"hljs-string\">&quot;user_id&quot;</span>: user_id}</code></pre>\r\n<img src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" /><span style=\"background-color:rgba(220,220,220,0.5)\"><img role=\"presentation\" src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" style=\"height:15px; width:15px\" title=\"点击并拖拽以移动\" /></span></div>\r\n\r\n<p>FastAPI胜过其他框架的杀手锏列表：</p>\r\n\r\n<ul>\r\n	<li>自动生成API文档：编写API接口后，你就可以使用符合标准的UI如SwaggerUI，ReDoc等来使用API​​。</li>\r\n</ul>\r\n\r\n<p><img alt=\"fast-api-swagger-558x628.webp\" data-widget=\"image\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9mb29maXNoLm5ldC9pbWFnZXMvZmFzdC1hcGktc3dhZ2dlci01NTh4NjI4LndlYnA?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>那性能呢？FastAPI是基于Starlette库构建的，其性能可与Node相匹配，在某些情况下甚至可以与Go相匹配。总而言之，我真的有一种感觉，FastAPI将成为Python的顶级异步框架。</p>\r\n\r\n<h3>总结</h3>\r\n\r\n<p>如今，Python异步生态正在发生很多事情。出现了新的框架，旧的框架正在重写，很多库开始支持异步行为。对于Web框架，Python已准备就绪，可提供出色的性能。如果很长一段时间你在考虑迁移到Node或者go，那现在不需要了。</p>\r\n\r\n<p>原文参考连接：https://geekflare.com/python-asynchronous-web-frameworks/</p>',
        '', '2020-04-07 03:41:00', '2020-04-07 03:41:00', 80, 1, 2, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (81, '操作数据库的命令行神器：mycli',
        '<p>MyCLI是MySQL，MariaDB和Percona的命令行界面，具有自动完成功能和语法突出显示功能。</p>\r\n\r\n<p>GitHub:&nbsp;<a href=\"https://github.com/dbcli/mycli\">https://github.com/dbcli/mycli</a></p>\r\n\r\n<p><img alt=\"\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9kMzN3dWJyZmtpMGw2OC5jbG91ZGZyb250Lm5ldC8wZjA3MzM3MzJlNzY2MjE5YWEwYTgzZTYzMWQ1Y2Q4Yjc4NGVkYWJjLzVkYzU3L2ltYWdlcy9tYWluLmdpZg\" style=\"height:434px; width:600px\" /></p>\r\n\r\n<h1>快速开始</h1>\r\n\r\n<p>如果您已经知道如何安装python软件包，则只​​需执行以下操作：</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-bash\">pip install mycli</code></pre>\r\n</div>\r\n\r\n<p>如果您使用的是macOS，则可以通过自制软件安装。</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-bash\">brew update &amp;&amp; brew install mycli</code></pre>\r\n</div>\r\n\r\n<p>如果您在快速入门时遇到麻烦，请查看<a href=\"https://www.mycli.net/install\">安装</a>页面以获取详细说明。</p>\r\n\r\n<h1>连接方式</h1>\r\n\r\n<p>mycli 支持多平台，包括 Windows、macOS、Linux 都支持。如何使用呢？mycli 完全继承了 mysql 命令中的参数，所以没有任何学习成本。</p>\r\n\r\n<p>连接数据库，mysql 也是这么操作的：</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-bash\">mycli -u your_user_name -h your_host -p your_password --database your_db_name</code></pre>\r\n</div>\r\n\r\n<pre>\r\n&nbsp;</pre>',
        '', '2020-04-07 05:41:00', '2020-04-07 05:41:00', 92, 1, 1, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (82, '强大，Nginx配置一键生成',
        '<h2><img alt=\"nginxconfig.io\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9naXRodWIuY29tL2RpZ2l0YWxvY2Vhbi9uZ2lueGNvbmZpZy5pby9yYXcvZG8vcHVibGljL2Fzc2V0cy9pbWcvZ2l0aHViLnBuZw?x-oss-process=image/format,png\" /></h2>\r\n\r\n<h3>⚙️ NGINX配置生成器&nbsp;💉</h3>\r\n\r\n<p>您唯一需要配置NGINX服务器的工具。</p>\r\n\r\n<p>✨&nbsp;<a href=\"https://nginxconfig.io/\" rel=\"nofollow\">nginxconfig.io</a></p>\r\n\r\n<p>NGINX不仅仅是一个网络服务器。您可能已经知道了。</p>\r\n\r\n<p>我们喜欢NGINX，因为：</p>\r\n\r\n<ul>\r\n	<li>低内存使用</li>\r\n	<li>高并发</li>\r\n	<li>异步事件驱动架构</li>\r\n	<li>负载均衡</li>\r\n	<li>反向代理</li>\r\n	<li>带有缓存的FastCGI支持（PHP）</li>\r\n	<li>快速处理静态文件</li>\r\n	<li>带有SNI的TLS / SSL</li>\r\n	<li><strong>性感的配置语法</strong></li>\r\n</ul>\r\n\r\n<p>许多功能具有相应的配置指令。您可以立即深入了解<a href=\"http://nginx.org/en/docs/\">NGINX文档，</a>也可以使用此工具检查NGINX的工作方式，观察您的输入如何影响输出，<strong>针对特定用例生成最佳配置</strong>（同时，您仍然可以使用docs）。</p>\r\n\r\n<h2>前因</h2>\r\n\r\n<p>关于Nginx部署，配置的文章网上已经发布过很多，包括我自己也私藏了不少还发布过两篇文章：</p>\r\n\r\n<ul>\r\n	<li><a href=\"https://blog.csdn.net/weixin_43064185/article/details/105405567\" target=\"blank\">初步必备Nginx配置</a></li>\r\n	<li><a href=\"https://blog.csdn.net/weixin_43064185/article/details/105405342\" target=\"blank\">前端必备Nginx配置</a></li>\r\n</ul>\r\n\r\n<p>整理出来为的就是需要的时候，复制，加入即可使用。</p>\r\n\r\n<p>然而千奇百怪的实际开发中，你肯定需要增删Nginx配置。你就得上网搜一下，复制粘贴出bug了又得调一下...</p>\r\n\r\n<p>搞定还得保存下来以备后患。多了不好找还得整理...就搞得很麻烦</p>\r\n\r\n<h2>使用</h2>\r\n\r\n<p>实现用户访问<code>*.myweb.com</code>域名自动重新迁移到<code>myweb.com</code>配置，并开启http强制重启到https的配置。</p>\r\n\r\n<p><img alt=\"图片描述\" class=\"inited lazyload loaded\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly91c2VyLWdvbGQtY2RuLnhpdHUuaW8vMjAxOS8xMS8xLzE2ZTI0OGViYTQ1NzY1ZDM?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"图片描述\" class=\"inited lazyload loaded\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly91c2VyLWdvbGQtY2RuLnhpdHUuaW8vMjAxOS8xMS8xLzE2ZTI0OGViNzI5ZjQxY2M?x-oss-process=image/format,png\" />配置完之后，下方还有<code>安装步骤</code>指导你配置才能。交互体验相当好</p>\r\n\r\n<p><img alt=\"图片描述\" class=\"inited lazyload loaded\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly91c2VyLWdvbGQtY2RuLnhpdHUuaW8vMjAxOS8xMS8xLzE2ZTI0OGViNzUwOThkOTU?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>生成配置<code>/etc/nginx/sites-available/myweb.com.conf</code>如下：</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-nginx\">server {\r\n	listen 443 ssl http2;\r\n	listen [::]:443 ssl http2;\r\n\r\n	server_name myweb.com;\r\n	root /var/www/myweb.com/public;\r\n\r\n	# SSL\r\n	ssl_certificate /etc/letsencrypt/live/myweb.com/fullchain.pem;\r\n	ssl_certificate_key /etc/letsencrypt/live/myweb.com/privkey.pem;\r\n	ssl_trusted_certificate /etc/letsencrypt/live/myweb.com/chain.pem;\r\n\r\n	# security\r\n	include nginxconfig.io/security.conf;\r\n\r\n	# index.html fallback\r\n	location / {\r\n		try_files $uri $uri/ /index.html;\r\n	}\r\n\r\n	# additional config\r\n	include nginxconfig.io/general.conf;\r\n}\r\n\r\n# subdomains redirect\r\nserver {\r\n	listen 443 ssl http2;\r\n	listen [::]:443 ssl http2;\r\n\r\n	server_name *.myweb.com;\r\n\r\n	# SSL\r\n	ssl_certificate /etc/letsencrypt/live/myweb.com/fullchain.pem;\r\n	ssl_certificate_key /etc/letsencrypt/live/myweb.com/privkey.pem;\r\n	ssl_trusted_certificate /etc/letsencrypt/live/myweb.com/chain.pem;\r\n\r\n	return 301 https://myweb.com$request_uri;\r\n}\r\n\r\n# HTTP redirect\r\nserver {\r\n	listen 80;\r\n	listen [::]:80;\r\n\r\n	server_name .myweb.com;\r\n\r\n	include nginxconfig.io/letsencrypt.conf;\r\n\r\n	location / {\r\n		return 301 https://myweb.com$request_uri;\r\n	}\r\n}\r\n复制代码</code></pre>\r\n</div>\r\n\r\n<hr />\r\n<p>网站下方还罗列了推荐的nginx配置，安全配置...以作参考</p>\r\n\r\n<p>/etc/nginx/nginx.conf</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-nginx\"># Generated by nginxconfig.io\r\n# https://nginxconfig.io/?0.domain=myweb.com&amp;0.php=false&amp;0.index=index.html&amp;0.fallback_html\r\n\r\nuser www-data;\r\npid /run/nginx.pid;\r\nworker_processes auto;\r\nworker_rlimit_nofile 65535;\r\n\r\nevents {\r\n	multi_accept on;\r\n	worker_connections 65535;\r\n}\r\n\r\nhttp {\r\n	charset utf-8;\r\n	sendfile on;\r\n	tcp_nopush on;\r\n	tcp_nodelay on;\r\n	server_tokens off;\r\n	log_not_found off;\r\n	types_hash_max_size 2048;\r\n	client_max_body_size 16M;\r\n\r\n	# MIME\r\n	include mime.types;\r\n	default_type application/octet-stream;\r\n\r\n	# logging\r\n	access_log /var/log/nginx/access.log;\r\n	error_log /var/log/nginx/error.log warn;\r\n\r\n	# SSL\r\n	ssl_session_timeout 1d;\r\n	ssl_session_cache shared:SSL:10m;\r\n	ssl_session_tickets off;\r\n\r\n	# Diffie-Hellman parameter for DHE ciphersuites\r\n	ssl_dhparam /etc/nginx/dhparam.pem;\r\n\r\n	# Mozilla Intermediate configuration\r\n	ssl_protocols TLSv1.2 TLSv1.3;\r\n	ssl_ciphers ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384;\r\n\r\n	# OCSP Stapling\r\n	ssl_stapling on;\r\n	ssl_stapling_verify on;\r\n	resolver 1.1.1.1 1.0.0.1 8.8.8.8 8.8.4.4 208.67.222.222 208.67.220.220 valid=60s;\r\n	resolver_timeout 2s;\r\n\r\n	# load configs\r\n	include /etc/nginx/conf.d/*.conf;\r\n	include /etc/nginx/sites-enabled/*;\r\n}\r\n复制代码</code></pre>\r\n</div>\r\n\r\n<p>/etc/nginx/nginxconfig.io/security.conf</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-nginx\"># security headers\r\nadd_header X-Frame-Options \"SAMEORIGIN\" always;\r\nadd_header X-XSS-Protection \"1; mode=block\" always;\r\nadd_header X-Content-Type-Options \"nosniff\" always;\r\nadd_header Referrer-Policy \"no-referrer-when-downgrade\" always;\r\nadd_header Content-Security-Policy \"default-src \'self\' http: https: data: blob: \'unsafe-inline\'\" always;\r\nadd_header Strict-Transport-Security \"max-age=31536000; includeSubDomains; preload\" always;\r\n\r\n# . files\r\nlocation ~ /\\.(?!well-known) {\r\n	deny all;\r\n}</code></pre>\r\n<img src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" /><img src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" style=\"height:15px; width:15px\" title=\"点击并拖拽以移动\" /></div>\r\n\r\n<h2>&nbsp;资源资源</h2>\r\n\r\n<ul>\r\n	<li><a href=\"https://ssl-config.mozilla.org/\">Mozilla SSL配置生成器v5</a></li>\r\n	<li><a href=\"https://mozilla.github.io/server-side-tls/ssl-config-generator/\">Mozilla SSL配置生成器</a></li>\r\n	<li><a href=\"https://github.com/OWASP/CheatSheetSeries/blob/master/cheatsheets/TLS_Cipher_String_Cheat_Sheet.md\">OWASP TLS密码字符串备忘单</a></li>\r\n	<li><a href=\"https://thoughts.t37.net/nginx-optimization-understanding-sendfile-tcp-nodelay-and-tcp-nopush-c55cdd276765\">Nginx优化：了解sendfile，tcp_nodelay和tcp_nopush</a></li>\r\n	<li><a href=\"https://gist.github.com/denji/8359866\">NGINX调整以获得最佳性能</a></li>\r\n	<li><a href=\"https://www.keycdn.com/blog/http-security-headers/\">强化HTTP安全标头</a></li>\r\n	<li><a href=\"https://github.com/h5bp/server-configs-nginx\">h5bp / server-configs-nginx</a></li>\r\n	<li><a href=\"https://security.stackexchange.com/questions/95178/diffie-hellman-parameters-still-calculating-after-24-hours/95184#95184\">类似于Diffie-Hellman DSA的参数</a></li>\r\n	<li><a href=\"https://hstspreload.org/\">hstspreload.org</a></li>\r\n	<li><a href=\"https://serverfault.com/questions/787919/optimal-value-for-nginx-worker-connections\">Nginx worker_connections的最佳值</a></li>\r\n</ul>',
        '', '2020-04-09 03:44:00', '2020-04-09 03:44:00', 101, 1, 4, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (83, 'Kali Linux使用基于airmon airodump aircrack破解wifi密码',
        '<h1>AirCrack 套件来破解无线网络的 WEP 密码</h1>\r\n\r\n<p>最近玩Kali Linux总结一下使用教程<br />\r\n要求：</p>\r\n\r\n<ol>\r\n	<li>Kali Linux的计算机(我用的是vmware)</li>\r\n	<li>要有一个外置的网卡,用于Kali Linux做无线网卡</li>\r\n	<li>密码字典</li>\r\n</ol>\r\n\r\n<pre>\r\n<code class=\"language-bash\">字典可以使用Kali Linux系统自带\r\ngzip -d /usr/share/wordlists/rockyou.txt.gz\r\n</code></pre>\r\n\r\n<h3>操作步骤</h3>\r\n\r\n<ul>\r\n	<li>打开终端窗口，并产生无线网络接口的列表</li>\r\n</ul>\r\n\r\n<pre>\r\n<code class=\"language-bash\">ifconfig\r\n</code></pre>\r\n\r\n<p><img alt=\"在这里插入图片描述\" src=\"https://img-blog.csdnimg.cn/20190321222609618.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:168px; width:600px\" /></p>\r\n\r\n<h3>开启无线网卡的监控模式</h3>\r\n\r\n<pre>\r\n<code class=\"language-bash\">airmon-ng start wlan0\r\n</code></pre>\r\n\r\n<p><img alt=\"标注\" src=\"https://img-blog.csdnimg.cn/20190321222901118.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:265px; width:600px\" /><br />\r\n执行成功之后网卡接口变为wlan0mon, 可以使用ifconfig命令查看</p>\r\n\r\n<h3>查看wifi网络</h3>\r\n\r\n<p>会使用&nbsp;<strong>airodump-ng wlan0mon</strong>&nbsp;来定位附近的可用无线网络<br />\r\n<img alt=\"在这里插入图片描述\" src=\"https://img-blog.csdnimg.cn/20190321223529564.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:199px; width:600px\" /><br />\r\n上面列出了周围的wifi和它们的详细信息，包括信号强度、加密类型、频道等。<br />\r\n记住要破解wifi的CH(频道号)和BSSID<br />\r\n按Ctrl-C结束</p>\r\n\r\n<h3>抓取握手包</h3>\r\n\r\n<p>使用网卡的监听模式抓取周围的无线网络数据包。其中，对我们最重要的数据包是：包含密码的包－也叫握手包。当有新用户或断开用户自动连接wifi时，会发送握手包。</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">开始抓包：\r\n</code></pre>\r\n\r\n<pre>\r\n<code class=\"language-bash\">    airodump-ng -c 6 --bssid C8:3A:35:30:3E:C8  -w ~/ wlan0mon\r\n    参数解释：\r\n		-c指定频道号\r\n		–bssid指定路由器bssid\r\n		-w指定抓取的数据包保存位置\r\n</code></pre>\r\n\r\n<p><img alt=\"在这里插入图片描述\" src=\"https://img-blog.csdnimg.cn/20190321224219523.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:224px; width:600px\" /></p>\r\n\r\n<h3>强制连接到wifi的设备重新连接路由器</h3>\r\n\r\n<ul>\r\n	<li>打开另一个终端窗口，为了尝试组合它们，运行 aireplay<br />\r\n	现在我们只要等用户连接/重连接wifi了，运气不好也许要很长时间。<br />\r\n	有一个叫aireplay-ng的工具，它可以强制用户断开wifi连接；原理是，给连接到wifi的一个设备发送一个deauth（反认证）包，让那个设备断开wifi，随后它自然会再次连接wifi。</li>\r\n</ul>\r\n\r\n<p>aireplay-ng的生效前提是，wifi网络中至少有一个连接的设备。从上图(4)可以看到哪些设备连接到了wifi，STATION就是连接设备的MAC地址，记住一个。打开新终端执行：</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">aireplay-ng -0 2 -a C8:3A:35:30:3E:C8 -c B8:E8:56:09:CC:9C wlan0mon</code></pre>\r\n\r\n<p>参数解释：<br />\r\n-0表示发起deauthentication攻击<br />\r\n-a指定无线路由器BSSID<br />\r\n-c指定强制断开的设备</p>\r\n\r\n<p><img alt=\"在这里插入图片描述\" src=\"https://img-blog.csdnimg.cn/20190321224830670.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:339px; width:600px\" /><br />\r\n如果成功第一个终端这里就会显示你要攻击的id<br />\r\n<img alt=\"在这里插入图片描述\" src=\"https://img-blog.csdnimg.cn/20190321224928636.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:257px; width:600px\" /><br />\r\n按Ctrl-C结束抓包。<br />\r\n已经得到了想要的握手包了，可以结束无线网卡的监控模式了：</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">airmon-ng stop wlan0mon\r\n</code></pre>\r\n\r\n<p><img alt=\"在这里插入图片描述\" src=\"https://img-blog.csdnimg.cn/20190321225255164.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:243px; width:600px\" /></p>\r\n\r\n<h3>开始破解密码</h3>\r\n\r\n<pre>\r\n<code class=\"language-bash\">aircrack-ng -a2 -b C8:3A:35:30:3E:C8 -w /usr/share/wordlists/rockyou.txt ~/*.cap\r\n参数解释：\r\n-a2代表WPA的握手包\r\n-b指定要破解的wifi BSSID。\r\n-w指定字典文件\r\n</code></pre>\r\n\r\n<h3>最后是抓取的包</h3>\r\n\r\n<p><img alt=\"在这里插入图片描述\" src=\"https://img-blog.csdnimg.cn/20190321225402889.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:334px; width:600px\" /></p>\r\n\r\n<p>密码找到(完全取决于字典多大)<br />\r\n当时没有截图 找的别人截好的图<br />\r\n<img alt=\"在这里插入图片描述\" src=\"https://img-blog.csdnimg.cn/20190321225536337.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" /></p>\r\n\r\n<h3>可选）使用显卡的运算能力</h3>\r\n\r\n<p>如果你有一个强大的GPU，为什么不使用GPU跑字典呢？</p>\r\n\r\n<p>Hashcat可以借助GPU的运算力破解各种不同算法的hash值。</p>\r\n\r\n<p>下载时要注意选择正确的显卡类型（AMD、NVidia）。Kali Linux自带这个工具。</p>\r\n\r\n<p>在破解cap文件之前，要把它转换为hccap文件：<br />\r\n<code>aircrack-ng file.cap -J out.hccap</code><br />\r\n使用GPU破解hash：<br />\r\n<code>hashcat -m 2500 out.hccap</code>字典文件</p>\r\n\r\n<h3>总结：</h3>\r\n\r\n<p>我一共测试了三个wifi 破解出2个, 防止这种攻击最简单的方法是将密码设置复杂一些 .</p>\r\n\r\n<p>不要使用WEP加密方式，非常容易被破解：<br />\r\n<a href=\"http://topspeedsnail.com/kali-linux-crack-wifi-password-wep/\">Kali Linux破解wifi密码(WEP)</a><br />\r\n现在的无线路由器都有WPS功能，关了吧：<br />\r\n<a href=\"http://topspeedsnail.com/kali-linux-crack-wifi-password-wps/\">使用Reaver破解开启了WPS功能的wifi密码(wpa/wpa2)</a></p>',
        '', '2019-03-21 15:04:40', '2019-03-21 15:04:40', 72, 1, 7, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (84, 'ES三节点重启后- timed out while waiting for initial discovery state - timeou',
        '<h2>问题</h2>\r\n\r\n<blockquote>\r\n<p>中台同事突然反馈说线上的查询很慢, 去查看集群资源内存爆满, 发现整个服务器操作都很卡, 集群服务都是物理机虚拟化, 本以为物理服务器资源满了,&nbsp; 无奈之下想重启清文件缓存. 集群我想着既然是集群一台一台重启应该不会有问题的，太高估了，重启一台后，服务器直接起不来......</p>\r\n</blockquote>\r\n\r\n<h1>操作过程</h1>\r\n\r\n<p>1、系统</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">[centos@ip-172-0-0-233 bin]$ cat /etc/redhat-release \r\nCentOS Linux release 7.6.1810 (Core) </code></pre>\r\n\r\n<p>2、ES版本</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">[centos@ip-172-0-0-233 bin]$ ./elasticsearch --version\r\nVersion: 5.0.2, Build: f6b4951/2016-11-24T10:07:18.101Z, JVM: 1.8.0_131</code></pre>\r\n\r\n<p>3、杀进程</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">ps -ef | grep pid\r\nkill -9 pid</code></pre>\r\n\r\n<p>这样操作完就后悔了，不是每个服务都是这么杀的，不知道这步操作对集群挂了有没有一定的影响。</p>\r\n\r\n<p>4、报错信息</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">[2020-04-16T01:17:36,421][INFO ][o.e.x.s.a.s.FileRolesStore] [es-node148] parsed [0] roles from file [/usr/share/elasticsearch/config/roles.yml]\r\n[2020-04-16T01:17:36,922][INFO ][o.e.x.m.j.p.l.CppLogMessageHandler] [es-node148] [controller/74] [Main.cc@109] controller (64 bit): Version 6.5.3 (Build f418a701d70c6e) Copyright (c) 2018 Elasticsearch BV\r\n[2020-04-16T01:17:37,914][INFO ][o.e.d.DiscoveryModule    ] [es-node148] using discovery type [zen] and host providers [settings]\r\n[2020-04-16T01:17:38,803][INFO ][o.e.n.Node               ] [es-node148] initialized\r\n[2020-04-16T01:17:38,803][INFO ][o.e.n.Node               ] [es-node148] starting ...\r\n[2020-04-16T01:17:38,992][INFO ][o.e.t.TransportService   ] [es-node148] publish_address {192.168.1.148:1483}, bound_addresses {0.0.0.0:1483}\r\n[2020-04-16T01:17:39,053][INFO ][o.e.b.BootstrapChecks    ] [es-node148] bound or publishing to a non-loopback address, enforcing bootstrap checks\r\n[2020-04-16T01:18:09,099][WARN ][o.e.n.Node               ] [es-node148] timed out while waiting for initial discovery state - timeout: 30s\r\n[2020-04-16T01:18:09,115][INFO ][o.e.x.s.t.n.SecurityNetty4HttpServerTransport] [es-node148] publish_address {192.168.1.148:1482}, bound_addresses {0.0.0.0:1482}\r\n[2020-04-16T01:18:09,115][INFO ][o.e.n.Node               ] [es-node148] started\r\n</code></pre>\r\n\r\n<p>5、配置文件</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">cluster.name: my-application\r\nnode.name: es-node148\r\nnetwork.host: 0.0.0.0\r\nnetwork.publish_host: 192.168.1.148\r\nhttp.port: 1482\r\ntransport.tcp.port: 1483\r\nhttp.cors.enabled: true\r\nhttp.cors.allow-origin: \"*\"\r\nnode.master: true\r\nnode.data: true\r\ndiscovery.zen.ping.unicast.hosts: [\"192.168.1.148:1483\",\"192.168.1.149:1493\",\"192.168.1.150:1503\"]\r\ndiscovery.zen.minimum_master_nodes: 1\r\nhttp.max_content_length: 800mb</code></pre>\r\n\r\n<h1>三、解决办法</h1>\r\n\r\n<p>各种重启都没有，在网上查到的，都是重启就好了，但是使劲的重启也没好。但是当discovery.zen.minimum_master_nodes这个值设置为1的时候，可以启动成功，但是三台都成了master了。后来看到有个这个参数，加上然后全部重启就好了。</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">discovery.zen.ping_timeout: 60s</code></pre>\r\n\r\n<p>四、分析原因</p>\r\n\r\n<p>还没细究，感觉是集群互相查找的时间太短了，没有找到对方，因为得2台才能形成集群</p>',
        '', '2020-04-16 02:40:00', '2020-04-16 02:40:00', 79, 1, 11, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (85, '使用Floccus + 坚果云无梯子跨平台同步 Chrome 浏览器书签',
        '<p>&nbsp;</p>\r\n\r\n<p data-widget=\"image\" style=\"text-align:center\"><span><img alt=\"\" src=\"https://img-blog.csdnimg.cn/20200417111855319.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:361px; width:800px\" /><span title=\"点击并拖拽以改变尺寸\">​</span></span></p>\r\n\r\n<p>采用的方案是 Chrome&nbsp; / Cent Browser / Firefox / yandex 等 + Floccus + 坚果云（WebDav）实现书签的跨平台多终端同步的。理论上，只要支持Floccus扩展的浏览器，都能实现。</p>\r\n\r\n<p>首先给出 FloccusGitHub的地址：<a href=\"https://github.com/marcelklehr/floccus\">https://github.com/marcelklehr/floccus</a></p>\r\n\r\n<p>Floccus 插件的地址：<a href=\"https://chrome.google.com/webstore/detail/fnaicdffflnofjppbagibeoednhnbjhg\">https://chrome.google.com/webstore/detail/fnaicdffflnofjppbagibeoednhnbjhg</a>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>安装好并配置完毕:&nbsp;</p>\r\n\r\n<p><img alt=\"\" data-widget=\"image\" src=\"https://img-blog.csdnimg.cn/20200417110449371.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:624px; width:600px\" /></p>\r\n\r\n<h3>开始</h3>\r\n\r\n<p>一、坚果云上的配置</p>\r\n\r\n<p>坚果云注册一个免费版个人账号（每日流量限制：上传1G，下载3G，够用了），注册成功登录后，点击右上角的用户名下拉菜单。</p>\r\n\r\n<p>注册:&nbsp;<a href=\"https://www.jianguoyun.com/\">https://www.jianguoyun.com/</a></p>\r\n\r\n<p>需要先注册应用</p>\r\n\r\n<p><img alt=\"\" data-widget=\"image\" src=\"https://img-blog.csdnimg.cn/20200417110739961.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:318px; width:800px\" /></p>\r\n\r\n<p>这里需要在我的书签添加自定义名称&nbsp; 在插件服务器地址中需要用到&nbsp;</p>\r\n\r\n<p><img alt=\"\" data-widget=\"image\" src=\"https://img-blog.csdnimg.cn/20200417111208573.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:161px; width:800px\" /></p>\r\n\r\n<p>二、浏览器上的配置</p>\r\n\r\n<p>添加账户</p>\r\n\r\n<p><img alt=\"\" data-widget=\"image\" src=\"https://img-blog.csdnimg.cn/20200417110859623.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:630px; width:600px\" /></p>\r\n\r\n<p>&nbsp;<img alt=\"\" data-widget=\"image\" src=\"https://img-blog.csdnimg.cn/20200417110925524.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:631px; width:600px\" /></p>\r\n\r\n<p><img alt=\"\" data-widget=\"image\" src=\"https://img-blog.csdnimg.cn/20200417111042580.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:688px; width:600px\" /></p>\r\n\r\n<p>位置1中填入 坚果云服务器地址，即：<a href=\"https://dav.jianguoyun.com/dav\">https://dav.jianguoyun.com/dav/自定义书签名称</a></p>\r\n\r\n<p>注意地址后面还有在坚果云添加的书签名称 例如&nbsp;&nbsp;<a href=\"https://dav.jianguoyun.com/dav/bookmarks\">https://dav.jianguoyun.com/dav/bookmarks</a></p>\r\n\r\n<p>位置2中填入你在坚果云中的注册的用户名，</p>\r\n\r\n<p>位置3中填入在坚果云中为第三方应用生产的应用管理密码。</p>\r\n\r\n<p><img alt=\"\" data-widget=\"image\" src=\"https://img-blog.csdnimg.cn/20200417111416545.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:688px; width:600px\" /></p>\r\n\r\n<p>将界面拖下来一点，看到有个&ldquo;本地文件夹&rdquo;配置，点击&ldquo;选择文件夹&rdquo;，出来的列表中，点击 &ldquo;书签栏&rdquo; 右边的&ldquo;选取&rdquo;按钮</p>\r\n\r\n<p>一般就选择根路径这样书签所有收藏网址都能同步</p>\r\n\r\n<p>修改自动同步时间间隔的，默认15分钟，这里我觉得没必要改，或者你觉得要同步间隔有必要调整，也可以修改一下。</p>\r\n\r\n<p>设置完毕后，拉倒最底部，点击&ldquo;保存&rdquo;。</p>\r\n\r\n<p>然后点击&ldquo;同步&rdquo;手动启动同步一次。 一般就能够成功把本地的&ldquo;书签栏&rdquo;目录中的浏览器同步保存到坚果云中的 我的文件 目录下的 bookmarks.xbel文件中了。</p>\r\n\r\n<p><img alt=\"\" data-widget=\"image\" src=\"https://img-blog.csdnimg.cn/20200417111604772.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:146px; width:800px\" /></p>\r\n\r\n<p>参考学习：</p>\r\n\r\n<p><a href=\"https://links.jianshu.com/go?to=https%3A%2F%2Fwww.appinn.com%2Ffloccus\">Floccus &ndash; 跨平台浏览器「书签同步」插件</a></p>\r\n\r\n<p><a href=\"https://links.jianshu.com/go?to=http%3A%2F%2Fwww.jianguoyun.com%2Fs%2Fcontent%2F3991.html\">WebDAV是什么？网盘的WebDAV有什么用？</a></p>\r\n\r\n<p><a href=\"https://links.jianshu.com/go?to=https%3A%2F%2Fwww.cccitu.com%2F982.html\">yandex的Floccus插件安装教程</a></p>',
        '', '2020-04-17 03:23:00', '2020-04-17 03:23:00', 113, 1, 4, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (86, 'jQuery弹出窗口插件 FancyBox',
        '<p>FancyBox是一款基于<span style=\"color:#3498db\">jquery</span>开发的类<a href=\"http://fancyapps.com/fancybox/3\">Lightbox</a>插件。支持对放大的图片添加阴影效果，对于一组相关的图片添加导航操作按纽，该lightbox除了能够展示图片之外，还可以展示iframed内容， 通过css自定义外观。</p>\r\n\r\n<p>相对与Lightbox而言，阴影效果更好。但是比Lightbox绚丽。</p>\r\n\r\n<p>使用很是简单，可以参照Lightbox，修改添加代码。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><strong>示例代码：</strong></p>\r\n\r\n<pre>\r\n<code class=\"language-python\">&lt;a class=\"fancybox\" rel=\"group\" href=\"big_image_1.jpg\"&gt;&lt;img src=\"small_image_1.jpg\" alt=\"\" /&gt;&lt;/a&gt;\r\n&lt;a class=\"fancybox\" rel=\"group\" href=\"big_image_2.jpg\"&gt;&lt;img src=\"small_image_2.jpg\" alt=\"\" /&gt;&lt;/a&gt;\r\n \r\n$(document).ready(function() {\r\n        $(\".fancybox\").fancybox();\r\n    });</code></pre>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><strong>使用效果图：</strong></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://cdn.ch3nnn.cn/upload/2020/04/17/96b9a6a8a2c14ae3a42fbf413f598319.png\" style=\"height:400px; width:400px\" /></p>\r\n\r\n<p><strong>参考资料:</strong></p>\r\n\r\n<p><a href=\"http://fancyapps.com/fancybox/3/docs/#usage\">fancybox3文档</a></p>\r\n\r\n<p><a href=\"https://codepen.io/fancyapps/pen/wEVOPa?editors=1000\">fancybox v3.5 - Basics 效果图</a></p>\r\n\r\n<p>&nbsp;</p>',
        '', '2020-04-17 10:34:00', '2020-04-17 10:34:00', 96, 1, 6, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (87, 'Mysql插入emoji表情符号错误 😊😂🤣❤😍😒👌😘',
        '<blockquote>\r\n<h1>InternalError Incorrect string value: &#39;\\\\xF0\\\\x9F\\\\x91\\\\x87&#39; for column</h1>\r\n</blockquote>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>遇到这个问题，有两种解决方式：</p>\r\n\r\n<p>&nbsp; &nbsp;程序里转换一下如emoji Util之类的解决方式将特殊字符替换成&quot;&quot; 空字符串<br />\r\n&nbsp;&nbsp;&nbsp;单独设置字符集 将&nbsp;库/表/字段 都设置为utf8mb</p>\r\n\r\n<p>连接数据库也需要设置mysql_url = mysql+pymysql://%(user)s:%(password)s@%(host)s:%(port)s/%(database)s?charset=utf8mb</p>\r\n\r\n<pre>\r\n<code class=\"language-sql\">修改库的字符集\r\n语法：alter database 库名 default character set 字符集;\r\nalter database test default character set utf8mb4;\r\n修改表的字符集\r\n语法：alter table 表名 convert to character set 字符集;\r\nalter table test1 convert to character set utf8mb4;\r\n修改字段的字符集\r\n语法：alter table 表名 modify 字段名 字段属性 character set 字符集；\r\nalter table test1 modify name char(10) character set utf8mb4;</code></pre>\r\n\r\n<p>&nbsp;</p>',
        '', '2020-02-25 10:39:00', '2020-02-25 10:39:00', 102, 1, 1, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (88, 'nginx隐藏server信息和版本信息',
        '<h1>&nbsp;</h1>\r\n\r\n<p>1.隐藏版本信息</p>\r\n\r\n<p>在nginx.conf里面添加</p>\r\n\r\n<pre>\r\n<code class=\"language-nginx\">server_tokens off;</code></pre>\r\n\r\n<p>2.隐藏server信息</p>\r\n\r\n<p>需要重新编译ngnix<br />\r\n进入解压出来的nginx&nbsp;源码目录</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">vi src/http/ngx_http_header_filter_module.c</code></pre>\r\n\r\n<p>将</p>\r\n\r\n<pre>\r\n<code class=\"language-nginx\">static char ngx_http_server_string[] = \"Server: nginx\" CRLF;\r\nstatic char ngx_http_server_full_string[] = \"Server: \" NGINX_VER CRLF;</code></pre>\r\n\r\n<p>改为</p>\r\n\r\n<pre>\r\n<code class=\"language-nginx\">static char ngx_http_server_string[] = \"Server: X-Web\" CRLF;\r\nstatic char ngx_http_server_full_string[] = \"Server:X-Web \" CRLF;</code></pre>\r\n\r\n<p>重新编译nginx</p>\r\n\r\n<p>再看header里面Server信息变成了自定义的名字&nbsp;X-Web</p>',
        '', '2020-04-27 10:35:00', '2020-04-27 10:35:00', 78, 1, 4, 0, 0, 1);
INSERT INTO `tb_content`
VALUES (89, 'Docker：Docker Compose 详解',
        '<h2>Docker Compose 概述与安装？</h2>\r\n\r\n<ul>\r\n	<li>前面我们使用 Docker 的时候，定义 Dockerfile 文件，然后使用 docker build、docker run 等命令操作容器。然而微服务架构的应用系统一般包含若干个微服务，每个微服务一般都会部署多个实例，如果每个微服务都要手动启停，那么效率之低，维护量之大可想而知</li>\r\n	<li><strong>使用 Docker Compose 可以轻松、高效的管理容器，它是一个用于定义和运行多容器 Docker 的应用程序工具</strong></li>\r\n</ul>\r\n\r\n<h3>安装 Docker Compose</h3>\r\n\r\n<ul>\r\n	<li>安装 Docker Compose 可以通过下面命令自动下载适应版本的 Compose，并为安装脚本添加执行权限</li>\r\n</ul>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">sudo curl -L https://github.com/docker/compose/releases/download/1.21.2/docker-compose-$(uname -s)-$(uname -m) -o /usr/local/bin/docker-compose\r\nsudo chmod +x /usr/local/bin/docker-compose\r\n</code></pre>\r\n\r\n<ul>\r\n	<li>查看安装是否成功</li>\r\n</ul>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">docker-compose -v\r\n</code></pre>\r\n\r\n<h3>快速入门</h3>\r\n\r\n<ul>\r\n	<li>打包项目，获得 jar 包 docker-demo-0.0.1-SNAPSHOT.jar</li>\r\n</ul>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">mvn clean package\r\n</code></pre>\r\n\r\n<ul>\r\n	<li>在 jar 包所在路径创建 Dockerfile 文件，添加以下内容</li>\r\n</ul>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">FROM java:8\r\nVOLUME /tmp\r\nADD docker-demo-0.0.1-SNAPSHOT.jar app.jar\r\nRUN bash -c \'touch /app.jar\'\r\nEXPOSE 9000\r\nENTRYPOINT [\"java\",\"-Djava.security.egd=file:/dev/./urandom\",\"-jar\",\"app.jar\"]\r\n</code></pre>\r\n\r\n<ul>\r\n	<li>在 jar 包所在路径创建文件 docker-compose.yml，添加以下内容</li>\r\n</ul>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">version: \'2\' # 表示该 Docker-Compose 文件使用的是 Version 2 file\r\nservices:\r\n  docker-demo:  # 指定服务名称\r\n    build: .  # 指定 Dockerfile 所在路径\r\n    ports:    # 指定端口映射\r\n      - \"9000:8761\"\r\n</code></pre>\r\n\r\n<ul>\r\n	<li>在 docker-compose.yml 所在路径下执行该命令 Compose 就会自动构建镜像并使用镜像启动容器</li>\r\n</ul>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">docker-compose up\r\ndocker-compose up -d  // 后台启动并运行容器\r\n</code></pre>\r\n\r\n<ul>\r\n	<li>访问 <a href=\"http://localhost:9000/hello\" rel=\"nofollow\" target=\"_blank\">http://localhost:9000/hello</a> 即可访问微服务接口</li>\r\n</ul>\r\n\r\n<h3>工程、服务、容器</h3>\r\n\r\n<ul>\r\n	<li><strong>Docker Compose 将所管理的容器分为三层，分别是工程（project）、服务（service）、容器（container）</strong></li>\r\n	<li><strong>Docker Compose 运行目录下的所有文件（docker-compose.yml）组成一个工程,一个工程包含多个服务，每个服务中定义了容器运行的镜像、参数、依赖，一个服务可包括多个容器实例</strong></li>\r\n</ul>\r\n\r\n<h2>Docker Compose 常用命令与配置</h2>\r\n\r\n<h3>常见命令</h3>\r\n\r\n<ul>\r\n	<li><strong>ps</strong>：列出所有运行容器</li>\r\n</ul>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">docker-compose ps\r\n</code></pre>\r\n\r\n<ul>\r\n	<li><strong>logs</strong>：查看服务日志输出</li>\r\n</ul>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">docker-compose logs\r\n</code></pre>\r\n\r\n<ul>\r\n	<li><strong>port</strong>：打印绑定的公共端口，下面命令可以输出 eureka 服务 8761 端口所绑定的公共端口</li>\r\n</ul>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">docker-compose port eureka 8761\r\n</code></pre>\r\n\r\n<ul>\r\n	<li><strong>build</strong>：构建或者重新构建服务</li>\r\n</ul>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">docker-compose build\r\n</code></pre>\r\n\r\n<ul>\r\n	<li><strong>start</strong>：启动指定服务已存在的容器</li>\r\n</ul>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">docker-compose start eureka\r\n</code></pre>\r\n\r\n<ul>\r\n	<li><strong>stop</strong>：停止已运行的服务的容器</li>\r\n</ul>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">docker-compose stop eureka\r\n</code></pre>\r\n\r\n<ul>\r\n	<li><strong>rm</strong>：删除指定服务的容器</li>\r\n</ul>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">docker-compose rm eureka\r\n</code></pre>\r\n\r\n<ul>\r\n	<li><strong>up</strong>：构建、启动容器</li>\r\n</ul>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">docker-compose up\r\n</code></pre>\r\n\r\n<ul>\r\n	<li><strong>kill</strong>：通过发送 SIGKILL 信号来停止指定服务的容器</li>\r\n</ul>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">docker-compose kill eureka\r\n</code></pre>\r\n\r\n<ul>\r\n	<li><strong>pull</strong>：下载服务镜像</li>\r\n	<li><strong>scale</strong>：设置指定服务运气容器的个数，以 service=num 形式指定</li>\r\n</ul>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">docker-compose scale user=3 movie=3\r\n</code></pre>\r\n\r\n<ul>\r\n	<li><strong>run</strong>：在一个服务上执行一个命令</li>\r\n</ul>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">docker-compose run web bash\r\n</code></pre>\r\n\r\n<h3>docker-compose.yml 属性</h3>\r\n\r\n<ul>\r\n	<li><strong>version</strong>：指定 docker-compose.yml 文件的写法格式</li>\r\n	<li><strong>services</strong>：多个容器集合</li>\r\n	<li><strong>build</strong>：配置构建时，Compose 会利用它自动构建镜像，该值可以是一个路径，也可以是一个对象，用于指定 Dockerfile 参数</li>\r\n</ul>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">build: ./dir\r\n---------------\r\nbuild:\r\n    context: ./dir\r\n    dockerfile: Dockerfile\r\n    args:\r\n        buildno: 1\r\n</code></pre>\r\n\r\n<ul>\r\n	<li><strong>command</strong>：覆盖容器启动后默认执行的命令</li>\r\n</ul>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">command: bundle exec thin -p 3000\r\n----------------------------------\r\ncommand: [bundle,exec,thin,-p,3000]\r\n</code></pre>\r\n\r\n<ul>\r\n	<li><strong>dns</strong>：配置 dns 服务器，可以是一个值或列表</li>\r\n</ul>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">dns: 8.8.8.8\r\n------------\r\ndns:\r\n    - 8.8.8.8\r\n    - 9.9.9.9\r\n</code></pre>\r\n\r\n<ul>\r\n	<li><strong>dns_search</strong>：配置 DNS 搜索域，可以是一个值或列表</li>\r\n</ul>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">dns_search: example.com\r\n------------------------\r\ndns_search:\r\n    - dc1.example.com\r\n    - dc2.example.com\r\n</code></pre>\r\n\r\n<ul>\r\n	<li><strong>environment</strong>：环境变量配置，可以用数组或字典两种方式</li>\r\n</ul>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">environment:\r\n    RACK_ENV: development\r\n    SHOW: \'ture\'\r\n-------------------------\r\nenvironment:\r\n    - RACK_ENV=development\r\n    - SHOW=ture\r\n</code></pre>\r\n\r\n<ul>\r\n	<li><strong>env_file</strong>：从文件中获取环境变量，可以指定一个文件路径或路径列表，其优先级低于 environment 指定的环境变量</li>\r\n</ul>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">env_file: .env\r\n---------------\r\nenv_file:\r\n    - ./common.env\r\n</code></pre>\r\n\r\n<ul>\r\n	<li><strong>expose</strong>：暴露端口，只将端口暴露给连接的服务，而不暴露给主机</li>\r\n</ul>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">expose:\r\n    - \"3000\"\r\n    - \"8000\"\r\n</code></pre>\r\n\r\n<ul>\r\n	<li><strong>image</strong>：指定服务所使用的镜像</li>\r\n</ul>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">image: java\r\n</code></pre>\r\n\r\n<ul>\r\n	<li><strong>network_mode</strong>：设置网络模式</li>\r\n</ul>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">network_mode: \"bridge\"\r\nnetwork_mode: \"host\"\r\nnetwork_mode: \"none\"\r\nnetwork_mode: \"service:[service name]\"\r\nnetwork_mode: \"container:[container name/id]\"\r\n</code></pre>\r\n\r\n<ul>\r\n	<li><strong>ports</strong>：对外暴露的端口定义，和 expose 对应</li>\r\n</ul>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">ports:   # 暴露端口信息  - \"宿主机端口:容器暴露端口\"\r\n- \"8763:8763\"\r\n- \"8763:8763\"\r\n</code></pre>\r\n\r\n<ul>\r\n	<li><strong>links</strong>：将指定容器连接到当前连接，可以设置别名，避免ip方式导致的容器重启动态改变的无法连接情况</li>\r\n</ul>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">links:    # 指定服务名称:别名 \r\n    - docker-compose-eureka-server:compose-eureka\r\n</code></pre>\r\n\r\n<ul>\r\n	<li><strong>volumes</strong>：卷挂载路径</li>\r\n</ul>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">volumes:\r\n  - /lib\r\n  - /var\r\n</code></pre>\r\n\r\n<ul>\r\n	<li><strong>logs</strong>：日志输出信息</li>\r\n</ul>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">--no-color          单色输出，不显示其他颜.\r\n-f, --follow        跟踪日志输出，就是可以实时查看日志\r\n-t, --timestamps    显示时间戳\r\n--tail              从日志的结尾显示，--tail=200\r\n</code></pre>\r\n\r\n<h2>Docker Compose 其它</h2>\r\n\r\n<h3>更新容器</h3>\r\n\r\n<ul>\r\n	<li>当服务的配置发生更改时，可使用 docker-compose up 命令更新配置</li>\r\n	<li>此时，Compose 会删除旧容器并创建新容器，新容器会以不同的 IP 地址加入网络，名称保持不变，任何指向旧容起的连接都会被关闭，重新找到新容器并连接上去</li>\r\n</ul>\r\n\r\n<h3>links</h3>\r\n\r\n<ul>\r\n	<li>服务之间可以使用服务名称相互访问，links 允许定义一个别名，从而使用该别名访问其它服务</li>\r\n</ul>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">version: \'2\'\r\nservices:\r\n    web:\r\n        build: .\r\n        links:\r\n            - \"db:database\"\r\n    db:\r\n        image: postgres\r\n</code></pre>\r\n\r\n<ul>\r\n	<li>这样 Web 服务就可以使用 db 或 database 作为 hostname 访问 db 服务了</li>\r\n</ul>',
        '', '2020-04-28 08:03:00', '2020-04-28 08:03:00', 73, 1, 12, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (90, 'elasticsearch之highlighter高亮检索详解',
        '<p>允许突出显示一个或多个字段的搜索结果。 实现使用 lucene 普通荧光笔，快速向量荧光笔（fvh）或 postings 荧光笔。 以下是一个搜索请求正文的示例：</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">GET /_search\r\n{\r\n    \"query\" : {\r\n        \"match\": { \"user\": \"kimchy\" }\r\n    },\r\n    \"highlight\" : {\r\n        \"fields\" : {\r\n            \"content\" : {}\r\n        }\r\n    }\r\n}</code></pre>\r\n\r\n<p>在上述情况下，内容字段将为每个搜索命中突出显示（每个搜索命中内将有另一个元素，称为突出显示，其中包括突出显示的字段和突出显示的片段）。</p>\r\n\r\n<p>Note：</p>\r\n\r\n<p>为了执行突出显示，需要字段的实际内容。 如果有问题的字段被存储（在映射中存储设置为 true），它将被使用，否则，实际的 _source 将被加载，并且相关字段将从中提取。</p>\r\n\r\n<p>_all 字段不能从 _source 中提取，因此它只能用于突出显示，如果它映射到将 store 设置为 true。</p>\r\n\r\n<p>字段名称支持通配符符号。 例如，使用 comment_ * 将导致所有与表达式匹配的文本和关键字字段（以及 5.0 之前的字符串）被突出显示。 请注意，所有其他字段将不会突出显示。 如果您使用自定义映射器并要在字段上突出显示，则必须显式提供字段名称。</p>\r\n\r\n<h3><a href=\"https://elasticsearch.apachecn.org/#/docs/106?id=plain-highlighter\">Plain highlighter</a></h3>\r\n\r\n<p>荧光笔的默认选择是普通类型，并使用Lucene荧光笔。 它试图在理解词重要性和短语查询中的任何词定位标准方面反映查询匹配逻辑。</p>\r\n\r\n<p>warning：</p>\r\n\r\n<p>如果你想突出很多文档中的大量字段与复杂的查询，这个荧光笔不会快。 在努力准确地反映查询逻辑，它创建一个微小的内存索引，并通过 Lucene 的查询执行计划程序重新运行原始查询条件，以获取当前文档的低级别匹配信息。 这对于每个字段和需要突出显示的每个文档重复。 如果这在您的系统中出现性能问题，请考虑使用替代荧光笔。</p>\r\n\r\n<h3><a href=\"https://elasticsearch.apachecn.org/#/docs/106?id=postings-highlighter\">Postings highlighter</a></h3>\r\n\r\n<p>如果 index_options 设置为映射中的偏移，则将使用 postings highlighter 而不是纯色荧光笔。 帖子荧光笔：</p>\r\n\r\n<ul>\r\n	<li>速度更快，因为它不需要重新分析要突出显示的文本：文档越大，性能增益越好</li>\r\n	<li>比快速向量荧光笔所需的 term_vectors 需要更少的磁盘空间</li>\r\n	<li>将文本分成句子并突出显示。 非常适合自然语言，而不是与包含例如 html 标记的字段</li>\r\n	<li>将文档视为整个语料库，并使用 BM25 算法对单个句子进行评分，如同它们是该语料库中的文档</li>\r\n</ul>\r\n\r\n<p>以下是一个在索引映射中设置内容字段的示例，以允许使用其上的 postings highlighter 来突出显示：</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">{\r\n    \"type_name\" : {\r\n        \"content\" : {\"index_options\" : \"offsets\"}\r\n    }\r\n}</code></pre>\r\n\r\n<p>Note：</p>\r\n\r\n<p>请注意，postings highlighter 指的是执行简单的查询术语突出显示，而不考虑其位置。 这意味着，当与短语查询结合使用时，它将突出显示查询所构成的所有术语，而不管它们是否实际上是查询匹配的一部分，从而有效地忽略了它们的位置。</p>\r\n\r\n<p>Warning：</p>\r\n\r\n<p>postings highlighter 不支持突出显示一些复杂的查询，例如类型设置为match_phrase_prefix的匹配查询。 在这种情况下，不会返回高亮显示的片段。</p>\r\n\r\n<h3><a href=\"https://elasticsearch.apachecn.org/#/docs/106?id=fast-vector-highlighter\">Fast vector highlighter</a></h3>\r\n\r\n<p>如果通过在映射中将 term_vector 设置为 with_positions_offsets 来提供 term_vector 信息，则将使用快速向量荧光笔而不是普通荧光笔。 快速矢量荧光笔：</p>\r\n\r\n<ul>\r\n	<li>是更快，特别是对于大字段（&gt; 1MB）</li>\r\n	<li>可以使用 boundary_chars，boundary_max_scan 和 fragment_offset 进行定制（见下文）</li>\r\n	<li>需要将 term_vector 设置为 with_positions_offsets，这会增加索引的大小</li>\r\n	<li>可以将多个字段的匹配合并为一个结果。请参阅 matched_fields</li>\r\n	<li>可以为不同位置的匹配分配不同的权重，以便在突出显示促销词组匹配的 Boosting Query 时，可以将词组匹配排在匹配项上</li>\r\n</ul>\r\n\r\n<p>下面是一个设置内容字段以允许使用快速向量荧光笔突出显示的示例（这将导致索引更大）：</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">{\r\n    \"type_name\" : {\r\n        \"content\" : {\"term_vector\" : \"with_positions_offsets\"}\r\n    }\r\n}</code></pre>\r\n\r\n<h3><a href=\"https://elasticsearch.apachecn.org/#/docs/106?id=force-highlighter-type\">Force highlighter type</a></h3>\r\n\r\n<p>类型字段允许强制特定的荧光笔类型。 这对于需要在启用 term_vectors 的字段上使用纯色荧光笔时非常有用。 允许的值是：plain，postings 和 fvh。 以下是强制使用纯荧光笔的示例：</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">GET /_search\r\n{\r\n    \"query\" : {\r\n        \"match\": { \"user\": \"kimchy\" }\r\n    },\r\n    \"highlight\" : {\r\n        \"fields\" : {\r\n            \"content\" : {\"type\" : \"plain\"}\r\n        }\r\n    }\r\n}</code></pre>\r\n\r\n<h3><a href=\"https://elasticsearch.apachecn.org/#/docs/106?id=force-highlighting-on-source\">Force highlighting on source</a></h3>\r\n\r\n<p>强制高亮显示源上的高亮显示字段，即使字段单独存储。 默认为 false。</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">GET /_search\r\n{\r\n    \"query\" : {\r\n        \"match\": { \"user\": \"kimchy\" }\r\n    },\r\n    \"highlight\" : {\r\n        \"fields\" : {\r\n            \"content\" : {\"force_source\" : true}\r\n        }\r\n    }\r\n}</code></pre>\r\n\r\n<h3><a href=\"https://elasticsearch.apachecn.org/#/docs/106?id=highlighting-tags\">Highlighting Tags</a></h3>\r\n\r\n<pre>\r\n<code class=\"language-json\">GET /_search\r\n{\r\n    \"query\" : {\r\n        \"match\": { \"user\": \"kimchy\" }\r\n    },\r\n    \"highlight\" : {\r\n        \"pre_tags\" : [\"&lt;tag1&gt;\"],\r\n        \"post_tags\" : [\"&lt;/tag1&gt;\"],\r\n        \"fields\" : {\r\n            \"_all\" : {}\r\n        }\r\n    }\r\n}</code></pre>\r\n\r\n<p>使用快速向量荧光笔可以有更多的标签，&ldquo;重要性&rdquo;是有序的。</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">GET /_search\r\n{\r\n    \"query\" : {\r\n        \"match\": { \"user\": \"kimchy\" }\r\n    },\r\n    \"highlight\" : {\r\n        \"pre_tags\" : [\"&lt;tag1&gt;\", \"&lt;tag2&gt;\"],\r\n        \"post_tags\" : [\"&lt;/tag1&gt;\", \"&lt;/tag2&gt;\"],\r\n        \"fields\" : {\r\n            \"_all\" : {}\r\n        }\r\n    }\r\n}</code></pre>\r\n\r\n<p>还有内置的&ldquo;标签&rdquo;模式，当前有一个模式称为样式与以下 pre_tags：</p>\r\n\r\n<pre>\r\n<code class=\"language-html\">&lt;em class=\"hlt1\"&gt;, &lt;em class=\"hlt2\"&gt;, &lt;em class=\"hlt3\"&gt;,\r\n&lt;em class=\"hlt4\"&gt;, &lt;em class=\"hlt5\"&gt;, &lt;em class=\"hlt6\"&gt;,\r\n&lt;em class=\"hlt7\"&gt;, &lt;em class=\"hlt8\"&gt;, &lt;em class=\"hlt9\"&gt;,\r\n&lt;em class=\"hlt10\"&gt;</code></pre>\r\n\r\n<p>和 &lt;/ em&gt; 作为 post_tags。 如果你认为更好的内置标签模式，只是发送电子邮件到邮件列表或打开一个问题。 以下是切换标记模式的示例：</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">GET /_search\r\n{\r\n    \"query\" : {\r\n        \"match\": { \"user\": \"kimchy\" }\r\n    },\r\n    \"highlight\" : {\r\n        \"tags_schema\" : \"styled\",\r\n        \"fields\" : {\r\n            \"content\" : {}\r\n        }\r\n    }\r\n}</code></pre>\r\n\r\n<h3><a href=\"https://elasticsearch.apachecn.org/#/docs/106?id=encoder\">Encoder</a></h3>\r\n\r\n<p>编码器参数可用于定义高亮显示的文本的编码方式。 它可以是默认（无编码）或 html（将转义 html，如果你使用 html 突出显示标签）。</p>\r\n\r\n<h3><a href=\"https://elasticsearch.apachecn.org/#/docs/106?id=highlighted-fragments\">Highlighted Fragments</a></h3>\r\n\r\n<p>每个高亮显示的字段可以控制高亮的片段的大小（以字符为单位）（默认值为 100 ），以及要返回的最大片段数（默认值为 5 ）。例如：</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">GET /_search\r\n{\r\n    \"query\" : {\r\n        \"match\": { \"user\": \"kimchy\" }\r\n    },\r\n    \"highlight\" : {\r\n        \"fields\" : {\r\n            \"content\" : {\"fragment_size\" : 150, \"number_of_fragments\" : 3}\r\n        }\r\n    }\r\n}</code></pre>\r\n\r\n<p>当使用 postings highlighter 时，fragment_size 被忽略，因为它输出句子不考虑它们的长度。</p>\r\n\r\n<p>除此之外，还可以指定高亮显示的片段需要按照分数排序：</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">GET /_search\r\n{\r\n    \"query\" : {\r\n        \"match\": { \"user\": \"kimchy\" }\r\n    },\r\n    \"highlight\" : {\r\n        \"order\" : \"score\",\r\n        \"fields\" : {\r\n            \"content\" : {\"fragment_size\" : 150, \"number_of_fragments\" : 3}\r\n        }\r\n    }\r\n}</code></pre>\r\n\r\n<p>如果 number_of_fragments 值设置为 0，则不会生成片段，而是返回字段的整个内容，当然它会突出显示。如果短文本（例如文档标题或地址）需要高亮显示，但不需要分段，这可能非常方便。请注意，在这种情况下会忽略 fragment_size。</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">GET /_search\r\n{\r\n    \"query\" : {\r\n        \"match\": { \"user\": \"kimchy\" }\r\n    },\r\n    \"highlight\" : {\r\n        \"fields\" : {\r\n            \"_all\" : {},\r\n            \"bio.title\" : {\"number_of_fragments\" : 0}\r\n        }\r\n    }\r\n}</code></pre>\r\n\r\n<p>当使用 fvh 时，可以使用 fragment_offset 参数来控制从开始突出显示的边距。</p>\r\n\r\n<p>在没有匹配的片段高亮的情况下，默认是不返回任何东西。相反，我们可以通过将 no_match_size（默认为 0 ）设置为要返回的文本的长度，从字段的开头返回一段文本。实际长度可能比指定的短，因为它试图在单词边界上断开。当使用 postings 荧光笔时，不可能控制片段的实际大小，因此当 no_match_size 大于 0 时，第一个句子返回。</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">GET /_search\r\n{\r\n    \"query\" : {\r\n        \"match\": { \"user\": \"kimchy\" }\r\n    },\r\n    \"highlight\" : {\r\n        \"fields\" : {\r\n            \"content\" : {\r\n                \"fragment_size\" : 150,\r\n                \"number_of_fragments\" : 3,\r\n                \"no_match_size\": 150\r\n            }\r\n        }\r\n    }\r\n}</code></pre>\r\n\r\n<h3><a href=\"https://elasticsearch.apachecn.org/#/docs/106?id=highlight-query\">Highlight query</a></h3>\r\n\r\n<p>也可以通过设置 highlight_query 来高亮显示搜索查询之外的查询。 如果使用 rescore 查询，这是特别有用的，因为这些查询在默认情况下不会通过高亮显示来考虑。 Elasticsearch 不会验证 highlight_query 以任何方式包含搜索查询，因此可以定义它，因此合法的查询结果根本不会突出显示。 通常最好在 highlight_query 中包含搜索查询。 下面是在 highlight_query 中包含搜索查询和 rescore 查询的示例。</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">GET /_search\r\n{\r\n    \"stored_fields\": [ \"_id\" ],\r\n    \"query\" : {\r\n        \"match\": {\r\n            \"content\": {\r\n                \"query\": \"foo bar\"\r\n            }\r\n        }\r\n    },\r\n    \"rescore\": {\r\n        \"window_size\": 50,\r\n        \"query\": {\r\n            \"rescore_query\" : {\r\n                \"match_phrase\": {\r\n                    \"content\": {\r\n                        \"query\": \"foo bar\",\r\n                        \"slop\": 1\r\n                    }\r\n                }\r\n            },\r\n            \"rescore_query_weight\" : 10\r\n        }\r\n    },\r\n    \"highlight\" : {\r\n        \"order\" : \"score\",\r\n        \"fields\" : {\r\n            \"content\" : {\r\n                \"fragment_size\" : 150,\r\n                \"number_of_fragments\" : 3,\r\n                \"highlight_query\": {\r\n                    \"bool\": {\r\n                        \"must\": {\r\n                            \"match\": {\r\n                                \"content\": {\r\n                                    \"query\": \"foo bar\"\r\n                                }\r\n                            }\r\n                        },\r\n                        \"should\": {\r\n                            \"match_phrase\": {\r\n                                \"content\": {\r\n                                    \"query\": \"foo bar\",\r\n                                    \"slop\": 1,\r\n                                    \"boost\": 10.0\r\n                                }\r\n                            }\r\n                        },\r\n                        \"minimum_should_match\": 0\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}</code></pre>\r\n\r\n<p>注意，在这种情况下，文本片段的分数是由 Lucene 高亮显示框架计算的。 对于实现细节，您可以检查 ScoreOrderFragmentsBuilder.java 类。 另一方面，当使用过帐突出显示器时，如上所述，使用&nbsp;<strong>BM25</strong>&nbsp;算法对分段进行打分。</p>\r\n\r\n<h3><a href=\"https://elasticsearch.apachecn.org/#/docs/106?id=global-settings\">Global Settings</a></h3>\r\n\r\n<p>高亮设置可以在全局级别设置，然后在字段级别覆盖。</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">GET /_search\r\n{\r\n    \"query\" : {\r\n        \"match\": { \"user\": \"kimchy\" }\r\n    },\r\n    \"highlight\" : {\r\n        \"number_of_fragments\" : 3,\r\n        \"fragment_size\" : 150,\r\n        \"fields\" : {\r\n            \"_all\" : { \"pre_tags\" : [\"&lt;em&gt;\"], \"post_tags\" : [\"&lt;/em&gt;\"] },\r\n            \"bio.title\" : { \"number_of_fragments\" : 0 },\r\n            \"bio.author\" : { \"number_of_fragments\" : 0 },\r\n            \"bio.content\" : { \"number_of_fragments\" : 5, \"order\" : \"score\" }\r\n        }\r\n    }\r\n}</code></pre>\r\n\r\n<h3><a href=\"https://elasticsearch.apachecn.org/#/docs/106?id=require-field-match\">Require Field Match</a></h3>\r\n\r\n<p>require_field_match 可以设置为 false，这将导致任何字段被高亮显示，而不管查询是否与它们具体匹配。 默认行为是 true，这意味着只有包含查询匹配的字段才会高亮显示。</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">GET /_search\r\n{\r\n    \"query\" : {\r\n        \"match\": { \"user\": \"kimchy\" }\r\n    },\r\n    \"highlight\" : {\r\n        \"require_field_match\": false,\r\n        \"fields\": {\r\n                \"_all\" : { \"pre_tags\" : [\"&lt;em&gt;\"], \"post_tags\" : [\"&lt;/em&gt;\"] }\r\n        }\r\n    }\r\n}</code></pre>\r\n\r\n<h3><a href=\"https://elasticsearch.apachecn.org/#/docs/106?id=boundary-characters\">Boundary Characters</a></h3>\r\n\r\n<p>当使用快速向量荧光笔高亮显示字段时，可以配置 boundary_chars 以定义什么构成用于高亮显示的边界。 它是一个单字符串，其中定义了每个边界字符。 它默认为。，！？ \\ t \\ n。</p>\r\n\r\n<p>boundary_max_scan 允许控制查找边界字符的距离，默认值为 20。</p>\r\n\r\n<h3><a href=\"https://elasticsearch.apachecn.org/#/docs/106?id=matched-fields\">Matched Fields</a></h3>\r\n\r\n<p>快速矢量荧光笔可以组合多个字段上的匹配，以使用 matched_fields 突出显示单个字段。 这对于以不同方式分析相同字符串的多字段来说是最直观的。 所有 matched_fields 必须将 term_vector 设置为with_positions_offsets，但只会加载匹配的组合字段，因此只有该字段可以从 store 设置为 yes 时受益。</p>\r\n\r\n<p>在下面的示例中，content 由英语分析器分析，content.plain 由标准分析器分析。</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">GET /_search\r\n{\r\n    \"query\": {\r\n        \"query_string\": {\r\n            \"query\": \"content.plain:running scissors\",\r\n            \"fields\": [\"content\"]\r\n        }\r\n    },\r\n    \"highlight\": {\r\n        \"order\": \"score\",\r\n        \"fields\": {\r\n            \"content\": {\r\n                \"matched_fields\": [\"content\", \"content.plain\"],\r\n                \"type\" : \"fvh\"\r\n            }\r\n        }\r\n    }\r\n}</code></pre>\r\n\r\n<p>以上匹配 &ldquo;run with scissors&rdquo; 和 &ldquo;running with scissors&rdquo;，并高亮显示 &ldquo;running&rdquo; 和 &ldquo;scissors&rdquo;，但不是 &ldquo;run&rdquo;。 如果两个短语出现在一个大的文档中，则 &ldquo;running with scissors&rdquo; 在片段列表中的 &ldquo;run with scissors&rdquo; 上排序，因为该片段中有更多匹配项。</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">GET /_search\r\n{\r\n    \"query\": {\r\n        \"query_string\": {\r\n            \"query\": \"running scissors\",\r\n            \"fields\": [\"content\", \"content.plain^10\"]\r\n        }\r\n    },\r\n    \"highlight\": {\r\n        \"order\": \"score\",\r\n        \"fields\": {\r\n            \"content\": {\r\n                \"matched_fields\": [\"content\", \"content.plain\"],\r\n                \"type\" : \"fvh\"\r\n            }\r\n        }\r\n    }\r\n}</code></pre>\r\n\r\n<p>The above highlights &quot;run&quot; as well as &quot;running&quot; and &quot;scissors&quot; but still sorts &quot;running with scissors&quot; above &quot;run with scissors&quot; because the plain match (&quot;running&quot;) is boosted.</p>\r\n\r\n<p>上面高亮了 &quot;run&quot; 以及 &quot;running&quot; 和 &quot;scissors&quot;，但仍然排序 &ldquo;&quot;running with scissors&quot; 上面 &quot;run with scissors&quot;，因为 plain match (&quot;running&quot;) 提高。</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">GET /_search\r\n{\r\n    \"query\": {\r\n        \"query_string\": {\r\n            \"query\": \"running scissors\",\r\n            \"fields\": [\"content\", \"content.plain^10\"]\r\n        }\r\n    },\r\n    \"highlight\": {\r\n        \"order\": \"score\",\r\n        \"fields\": {\r\n            \"content\": {\r\n                \"matched_fields\": [\"content.plain\"],\r\n                \"type\" : \"fvh\"\r\n            }\r\n        }\r\n    }\r\n}</code></pre>\r\n\r\n<p>上面的查询不会突出显示 &quot;run&quot; 或 &quot;scissor&quot;，但显示没有列出在匹配字段中匹配匹配的字段（内容）。</p>\r\n\r\n<p>Note：</p>\r\n\r\n<p>从技术上讲，也可以将字段添加到与共同匹配的字段不共享相同底层字符串的 matched_fields。 结果可能没有什么意义，如果一个匹配是在文本的末尾，那么整个查询将失败。</p>\r\n\r\n<p>Note：</p>\r\n\r\n<p>将 matching_fields 设置为非空数组时涉及少量开销，因此始终优选</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">\"highlight\": {\r\n        \"fields\": {\r\n            \"content\": {}\r\n        }\r\n    }</code></pre>\r\n\r\n<p>较于</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">\"highlight\": {\r\n        \"fields\": {\r\n            \"content\": {\r\n                \"matched_fields\": [\"content\"],\r\n                \"type\" : \"fvh\"\r\n            }\r\n        }\r\n    }</code></pre>\r\n\r\n<p>。</p>\r\n\r\n<h3><a href=\"https://elasticsearch.apachecn.org/#/docs/106?id=phrase-limit\">Phrase Limit</a></h3>\r\n\r\n<p>快速向量荧光笔有一个 phrase_limit 参数，阻止它分析太多的短语和吃大量的内存。 它默认为 256，所以只有文档中前 256 个匹配的短语被考虑。 您可以使用 phrase_limit 参数提高限制，但请记住，评分更多的短语会消耗更多的时间和内存。</p>\r\n\r\n<p>如果使用 matched_fields，请记住每个匹配字段的 phrase_limit 短语会被考虑。</p>\r\n\r\n<h3><a href=\"https://elasticsearch.apachecn.org/#/docs/106?id=field-highlight-order\">Field Highlight Order</a></h3>\r\n\r\n<p>Elasticsearch 按照它们发送的顺序高亮显示字段。 每个 json spec 对象是无序的，但如果你需要明确的字段的高亮显示的顺序，你可以使用数组的字段，如：</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">\"highlight\": {\r\n        \"fields\": [\r\n            {\"title\":{ /*params*/ }},\r\n            {\"text\":{ /*params*/ }}\r\n        ]\r\n    }</code></pre>\r\n\r\n<p>没有一个内置于 Elasticsearch 的荧光笔关心字段高亮显示的顺序，但插件可能。</p>',
        '', '2020-01-30 10:01:00', '2020-01-30 10:01:00', 77, 1, 11, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (91, 'Locust：简介和基本用法',
        '<p><img src=\"https://cdn.ch3nnn.cn/upload/2020/05/12/57c4b1f3bdfa4226afb89be0c65d9f6c.png?imageMogr2/auto-orient/thumbnail/1000x/interlace/1/blur/1x0/quality/70|watermark/2/text/Q2gzbm5ubm7nmoTljZrlrqIgfOaKmOiFvuS4jeaBryDCtyDkuZDmraTkuI3nlrI=/font/6buR5L2T/fontsize/260/fill/I0ZDRkNGQw==/dissolve/75/gravity/SouthEast/dx/10/dy/10\" style=\"height:292px; width:800px\" /></p>\r\n\r\n<p>官方文档：<a href=\"https://docs.locust.io/en/stable/index.html\" target=\"_blank\">Locust说明文档</a></p>\r\n\r\n<p><strong>一、认识Locust</strong></p>\r\n\r\n<p><strong>1、定义</strong></p>\r\n\r\n<p>Locust是一款易于使用的分布式负载测试工具，完全基于事件，即一个locust节点也可以在一个进程中支持数千并发用户，不使用回调，通过<a href=\"http://www.gevent.org/\" target=\"_blank\">gevent</a>使用轻量级过程（即在自己的进程内运行）。</p>\r\n\r\n<p><strong>2、特点</strong></p>\r\n\r\n<p>①、不需要编写笨重的UI或者臃肿的XML代码，基于协程而不是回调，脚本编写简单易读；</p>\r\n\r\n<p>②、有一个基于we简洁的HTML+JS的UI用户界面，可以实时显示相关的测试结果；</p>\r\n\r\n<p>③、支持分布式测试，用户界面基于网络，因此具有跨平台且易于扩展的特点；</p>\r\n\r\n<p>④、所有繁琐的I / O和协同程序都被委托给gevent，替代其他工具的局限性；</p>\r\n\r\n<p><strong>二、安装Locust</strong></p>\r\n\r\n<p>1、支持的python版本：2.7、3.4、3.5、3.6；</p>\r\n\r\n<p>2、Windows系统安装locust</p>\r\n\r\n<p>①、直接通过&nbsp;pip install locustio&nbsp;命令安装；</p>\r\n\r\n<p>②、通过为pyzmq、gevent和greenlet安装预先构建的二进制包，然后在<a href=\"https://www.lfd.uci.edu/~gohlke/pythonlibs/\" target=\"_blank\">这里</a>找到非官方的预制包，下载.whl文件后，使用&nbsp;pip install name-of-file.whl&nbsp;命令安装；</p>\r\n\r\n<p>安装成功后可以输入&nbsp;pip show locust&nbsp;命令查看是否安装成功，以及通过&nbsp;locust -help&nbsp;命令查看帮助信息。</p>\r\n\r\n<p><strong>PS</strong>：运行大规模测试时，建议在Linux机器上执行此操作，因为gevent在Windows下的性能很差。</p>\r\n\r\n<p><strong>三、一个简单的示例</strong></p>\r\n\r\n<p>locust的脚本里，模拟负载的请求和python的<a href=\"http://cn.python-requests.org/zh_CN/latest/\" target=\"_blank\">requests库使用方法</a>基本一样，示例如下：</p>\r\n\r\n<p>创建文件test_blog.py</p>\r\n\r\n<pre>\r\n<code class=\"language-python\"># coding=utf-8\r\nimport requests\r\nfrom locust import HttpLocust,TaskSet,task\r\nfrom requests.packages.urllib3.exceptions import InsecureRequestWarning\r\n# 禁用安全请求警告\r\nrequests.packages.urllib3.disable_warnings(InsecureRequestWarning)\r\n\r\nclass MyBlogs(TaskSet):\r\n    # 访问我的博客首页\r\n    @task(1)\r\n    def get_blog(self):\r\n        # 定义请求头\r\n        header = {\"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.100 Safari/537.36\"}\r\n\r\n        req = self.client.get(\"/archives\",  headers=header, verify=False)\r\n        if req.status_code == 200:\r\n            print(\"success\")\r\n        else:\r\n            print(\"fails\")\r\n\r\nclass websitUser(HttpLocust):\r\n    task_set = MyBlogs\r\n    min_wait = 3000  # 单位为毫秒\r\n    max_wait = 6000  # 单位为毫秒\r\n\r\nif __name__ == \"__main__\":\r\n    import os\r\n    os.system(\"locust -f locusttest.py --host=https://chenyinren.top\")</code></pre>\r\n\r\n<p><strong>脚本说明</strong>：</p>\r\n\r\n<p>新建一个类MyBlogs(TaskSet)，继承TaskSet，该类下面写需要请求的接口以及相关信息；</p>\r\n\r\n<p>self.client调用get和post方法，和requests一样；</p>\r\n\r\n<p>@task装饰该方法表示为用户行为，括号里面参数表示该行为的执行权重：数值越大，执行频率越高，不设置默认是1；</p>\r\n\r\n<p>WebsiteUser()类用于设置生成负载的基本属性：</p>\r\n\r\n<table border=\"0\">\r\n	<tbody>\r\n		<tr>\r\n			<td>属性</td>\r\n			<td>说明</td>\r\n		</tr>\r\n		<tr>\r\n			<td>task_set&nbsp;</td>\r\n			<td>指向定义了用户行为的类</td>\r\n		</tr>\r\n		<tr>\r\n			<td>min_wait&nbsp;</td>\r\n			<td>模拟负载的任务之间执行时的最小等待时间，单位为毫秒</td>\r\n		</tr>\r\n		<tr>\r\n			<td>max_wait&nbsp;</td>\r\n			<td>模拟负载的任务之间执行时的最大等待时间，单位为毫秒</td>\r\n		</tr>\r\n	</tbody>\r\n</table>\r\n\r\n<p><strong>PS</strong>：默认情况下，时间是在min_wait和max_wait之间随机选择，但是可以通过将wait_function设置为任意函数来使用任何用户定义的时间分布。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><strong>四、启动Locust</strong></p>\r\n\r\n<p>1、如果启动的locust文件名为locustfile.py并位于当前工作目录中，可以在编译器中直接运行该文件，或者通过cmd，执行如下命令：</p>\r\n\r\n<p>&nbsp;locust --host=<a href=\"https://chenyinren.top/\">https://chenyinren.top/</a></p>\r\n\r\n<p>2、如果Locust文件位于子目录下且名称不是locustfile.py，可以使用-f命令启动上面的示例locust文件：</p>\r\n\r\n<p>&nbsp;locust&nbsp;-f&nbsp;testscript/locusttest.py --host=<a href=\"https://chenyinren.top/\">https://chenyinren.top/</a></p>\r\n\r\n<p>3、如果要运行分布在多个进程中的Locust，通过指定<code>-master</code>以下内容来启动主进程&nbsp;：</p>\r\n\r\n<p>&nbsp;locust&nbsp;-f&nbsp;testscript/locusttest.py --master --host=<a href=\"https://chenyinren.top/\">https://chenyinren.top/</a></p>\r\n\r\n<p>4、如果要启动任意数量的从属进程，可以通过-salve命令来启动locust文件：</p>\r\n\r\n<p>&nbsp;locust&nbsp;-f&nbsp;testscript/locusttest.py --salve --host=<a href=\"https://chenyinren.top/\">https://chenyinren.top/</a></p>\r\n\r\n<p>5、如果要运行分布式Locust，必须在启动从机时指定主机（运行分布在单台机器上的Locust时不需要这样做，因为主机默认为127.0.0.1）：</p>\r\n\r\n<p>&nbsp;locust&nbsp;-f&nbsp;testscript/locusttest.py --slave --master-host=192.168.0.100 --host=<a href=\"https://chenyinren.top/\">https://chenyinren.top/</a>&nbsp;</p>\r\n\r\n<p>6、启动locust文件成功后，编译器控制台会显示如下信息：</p>\r\n\r\n<p>&nbsp;[2018-10-09 01:01:44,727] IMYalost/INFO/locust.main: Starting web monitor at *:8089</p>\r\n\r\n<p>[2018-10-09 01:01:44,729] IMYalost/INFO/locust.main: Starting Locust 0.8&nbsp;</p>\r\n\r\n<p><strong>PS</strong>：8089是该服务启动的端口号，如果是本地启动，可以直接在浏览器输入http://localhost:8089打开UI界面，如果是其他机器搭建locust服务，则输入该机器的IP+端口即可；</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><strong>五、locust的UI界面</strong></p>\r\n\r\n<p><strong>1、启动界面</strong></p>\r\n\r\n<p><img src=\"https://cdn.ch3nnn.cn/upload/2020/05/07/47e54cd31b5c492d9d98a2d19cd24fac.png?imageMogr2/auto-orient/thumbnail/1000x/interlace/1/blur/1x0/quality/95|watermark/2/text/Q2gzbm5ubm7nmoTljZrlrqIgfOaKmOiFvuS4jeaBryDCtyDkuZDmraTkuI3nlrI=/font/6buR5L2T/fontsize/260/fill/I0ZDRkNGQw==/dissolve/75/gravity/SouthEast/dx/10/dy/10\" style=\"height:402px; width:800px\" /></p>\r\n\r\n<p>Number of users to simulate：设置模拟的用户总数</p>\r\n\r\n<p>Hatch rate (users spawned/second)：每秒启动的虚拟用户数</p>\r\n\r\n<p>Start swarming：执行locust脚本</p>\r\n\r\n<p><strong>2、测试结果界面</strong></p>\r\n\r\n<p><strong>PS</strong>：点击STOP可以停止locust脚本运行：</p>\r\n\r\n<p><img src=\"https://cdn.ch3nnn.cn/upload/2020/05/07/6e6896e08eb247afb22f665095c763b9.png?imageMogr2/auto-orient/thumbnail/1000x/interlace/1/blur/1x0/quality/95|watermark/2/text/Q2gzbm5ubm7nmoTljZrlrqIgfOaKmOiFvuS4jeaBryDCtyDkuZDmraTkuI3nlrI=/font/6buR5L2T/fontsize/260/fill/I0ZDRkNGQw==/dissolve/75/gravity/SouthEast/dx/10/dy/10\" style=\"height:402px; width:800px\" /></p>\r\n\r\n<p>Type：请求类型，即接口的请求方法；</p>\r\n\r\n<p>Name：请求路径；</p>\r\n\r\n<p>requests：当前已完成的请求数量；</p>\r\n\r\n<p>fails：当前失败的数量；</p>\r\n\r\n<p>Median：响应时间的中间值，即50%的响应时间在这个数值范围内，单位为毫秒；</p>\r\n\r\n<p>Average：平均响应时间，单位为毫秒；</p>\r\n\r\n<p>Min：最小响应时间，单位为毫秒；</p>\r\n\r\n<p>Max：最大响应时间，单位为毫秒；</p>\r\n\r\n<p>Content Size：所有请求的数据量，单位为字节；</p>\r\n\r\n<p>reqs/sec：每秒钟处理请求的数量，即QPS；</p>\r\n\r\n<p><strong>3、各模块说明</strong></p>\r\n\r\n<p><img src=\"https://cdn.ch3nnn.cn/upload/2020/05/07/866195ba0aa64da48b38ca54de21ce51.png?imageMogr2/auto-orient/thumbnail/1000x/interlace/1/blur/1x0/quality/95|watermark/2/text/Q2gzbm5ubm7nmoTljZrlrqIgfOaKmOiFvuS4jeaBryDCtyDkuZDmraTkuI3nlrI=/font/6buR5L2T/fontsize/260/fill/I0ZDRkNGQw==/dissolve/75/gravity/SouthEast/dx/10/dy/10\" style=\"height:170px; width:800px\" /></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>New test：点击该按钮可对模拟的总虚拟用户数和每秒启动的虚拟用户数进行编辑；</p>\r\n\r\n<p>Statistics：类似于jmeter中Listen的聚合报告；</p>\r\n\r\n<p>Charts：测试结果变化趋势的曲线展示图，分别为每秒完成的请求数（RPS）、响应时间、不同时间的虚拟用户数；</p>\r\n\r\n<p>Failures：失败请求的展示界面；</p>\r\n\r\n<p>Exceptions：异常请求的展示界面；</p>\r\n\r\n<p>Download Data：测试数据下载模块， 提供三种类型的CSV格式的下载，分别是：Statistics、responsetime、exceptions；</p>\r\n\r\n<p>以上即为locust的介绍和简单使用以及说明，更多详细的内容请参考官方文档。。。</p>\r\n\r\n<p>&nbsp;</p>',
        '', '2020-05-08 07:27:00', '2020-05-08 07:27:00', 74, 1, 4, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (92, '博客优化-django静态页面处理',
        '<blockquote>\r\n<p>前言:&nbsp; 我看很多资料使用celery, 定时任务去执行首页静态化,&nbsp; 觉得博客基本都是自己修改内容,&nbsp; 首页基本不会经常发生变化.也不需要定时更新静态文件,&nbsp;&nbsp;所以就没有采用celery.</p>\r\n</blockquote>\r\n\r\n<p>&nbsp;<strong>可以瞅瞅地址:&nbsp;&nbsp;</strong><a href=\"http://chenyinren.top\">博客地址</a></p>\r\n\r\n<p>以下是我想到的实现方法思路如下：</p>\r\n\r\n<p>1、根据文章 id，生成该文章的静态文件名称；</p>\r\n\r\n<p>2、静态文件名配上它存放的路径；</p>\r\n\r\n<p>3、判断此文章是否已静态化，如没有，则静态化</p>\r\n\r\n<p>&nbsp; &nbsp;i)取文章数据、首页数据等其它数据；</p>\r\n\r\n<p>&nbsp; ii)将取出的数据渲染到模板中;</p>\r\n\r\n<p>&nbsp; iii)将生成的文章内容写到静态文件中去</p>\r\n\r\n<p>4、根据request,访问生成的静态文件</p>\r\n\r\n<p>5、管理员登录修改增加删除文章需要自动生成静态文件</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>由于首页详情页都做成了静态页面导致游客所在地天气出现了死数据无法实时获取, 为了解决这个问题.</p>\r\n\r\n<p><img alt=\"\" src=\"https://img-blog.csdnimg.cn/20200512180549867.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"width:800px\" /></p>\r\n\r\n<p>采用Ajax异步请求数据在展示&nbsp;</p>\r\n\r\n<p>请忽视我前端代码有点low, 这里只是提出解决思路</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-javascript\">//    天气ajax请求\r\n//    {\'last_update\': \'15:09\', \'city\': \'北京\', \'text\': \'晴\', \'code\': \'0\', \'temperature\': \'27\'}\r\n    $.ajax({\r\n        type: \"GET\",\r\n        dataType: \"JSON\",\r\n        url: \'/weather\',\r\n        success: function (result) {\r\n            var code = result[\"code\"];\r\n            var div_img = document.createElement(\"div\");\r\n            div_img.className = \"div_img\";\r\n            div_img.style.cssText = \"width: 48px; height: 48px; background-size: 100% 100%; background-repeat: no-repeat; margin: 0 auto;\";\r\n            div_img.style.backgroundImage = \"url(/root_static/img/black/\" + code + \"@1x.png)\";\r\n\r\n            $(\"#weather_img\").append(div_img);\r\n            var span_1 = document.createElement(\"span\");\r\n            span_1.innerText = result[\'city\'];\r\n            var span_2 = document.createElement(\"span\");\r\n            span_2.innerText = result[\'text\'];\r\n            $(\".weather_city\").append(span_1, \"&lt;br&gt;\", span_2);\r\n\r\n            var div_temperature = document.createElement(\"div\");\r\n            div_temperature.style.cssText = \"height: 48px; width: 75px; font-size:40px; text-align:center; margin: 0 auto;line-height: 60px;\";\r\n            div_temperature.innerText = result[\'temperature\'] + \"°\";\r\n\r\n            var div_last_update = document.createElement(\"div\");\r\n            div_last_update.style.cssText = \"line-height: 50px;\";\r\n            div_last_update.innerText = \"更新于\" + result[\'last_update\'];\r\n            $(\".weather_num\").append(div_temperature, div_last_update);\r\n        },\r\n        error: function () {\r\n            alert(\"获取天气api失败\");\r\n        }\r\n    });</code></pre>\r\n</div>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>为了解决管理员登录修改增加删除文章需要自动生成静态文件</p>\r\n\r\n<p>这里需要重写下面三个方法&nbsp;&nbsp;<strong>save_model&nbsp; &nbsp; delete_model&nbsp; delete_queryset</strong><br />\r\n<br />\r\nadmin.py 代码&nbsp;</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\"># Register your models here.\r\nimport os\r\n\r\nfrom django.contrib import admin\r\nfrom django.template.loader import render_to_string\r\nfrom pure_pagination import Paginator\r\n\r\nfrom blogproject.settings import BASE_DIR\r\nfrom user.models import UserProfile\r\n\r\nfrom .models import Post, Category, Tag, Comments, BookMark, Bulletin, FriendLink\r\n\r\n\r\nclass BasesAction(admin.ModelAdmin):\r\n    \"\"\"重写adminModel模型方法\"\"\"\r\n\r\n    @staticmethod\r\n    def writeIndexStaticHTML():\r\n        \"\"\"将首页静态化 =&gt; html写入指定目录 用于前端展示\"\"\"\r\n\r\n        post_list = Post.objects.all().order_by(\'-top\', \'-modified_time\')\r\n        post_list = Paginator(post_list, 5).page(1)\r\n        content = render_to_string(\'blog/index.html\', context={\'page_obj\': post_list})\r\n        with open(os.path.join(BASE_DIR, \'templates/static/index.html\'), \'w\', encoding=\"utf-8\") as f:\r\n            f.write(content)\r\n\r\n    def save_model(self, request, obj, form, change):\r\n        super(BasesAction, self).save_model(request, obj, form, change)\r\n        BasesAction.writeIndexStaticHTML()\r\n\r\n    def delete_model(self, request, obj):\r\n        super().delete_model(request, obj)\r\n        BasesAction.writeIndexStaticHTML()\r\n\r\n    def delete_queryset(self, request, queryset):\r\n        super(BasesAction, self).delete_queryset(request, queryset)\r\n        BasesAction.writeIndexStaticHTML()\r\n\r\n\r\nclass PostAdmin(BasesAction):\r\n    list_display = [\'title\', \'created_time\', \'modified_time\', \'category\', \'author\', \'top\']\r\n\r\n    @staticmethod\r\n    def writeDetailStaticHTML(pk):\r\n        \"\"\"\r\n        将详情页面静态化 =&gt; html写入指定目录 用于前端展示\r\n        :param pk: 详情文章id\r\n        \"\"\"\r\n        from django.shortcuts import get_object_or_404\r\n        post = get_object_or_404(Post, pk=pk)\r\n        # 获取评论\r\n        comments = Comments.objects.filter(new_id=pk).order_by(\'created_time\')\r\n\r\n        context = {\r\n            \'post\': post, \'comments\': comments, \'is_superuser\': False, \'is_login\': False, \'username\': None, \'img\': \'\'\r\n        }\r\n        content = render_to_string(\'blog/detail.html\', context=context)\r\n        with open(os.path.join(BASE_DIR, \'templates/static/detail/{}.html\'.format(pk)), \'w\', encoding=\"utf-8\") as f:\r\n            f.write(content)\r\n        return content\r\n\r\n    @staticmethod\r\n    def deleteStaticHTML(queryset=None, pk=None):\r\n        \"\"\"\r\n        删除静态html\r\n        :param queryset: 详情文章list对象\r\n        :param pk: 单个详情文章id\r\n        \"\"\"\r\n        if pk:\r\n            static_file = os.path.join(BASE_DIR, \'templates/static/detail/{}.html\'.format(pk))\r\n            if not os.path.exists(static_file):\r\n                os.remove(static_file)\r\n        if not queryset:\r\n            return\r\n        for obj in queryset:\r\n            static_file = os.path.join(BASE_DIR, \'templates/static/detail/{}.html\'.format(obj.id))\r\n            if os.path.exists(static_file):\r\n                os.remove(static_file)\r\n\r\n    def save_model(self, request, obj, form, change):\r\n        super(PostAdmin, self).save_model(request, obj, form, change)\r\n        PostAdmin.writeDetailStaticHTML(pk=obj.id)\r\n\r\n    def delete_model(self, request, obj):\r\n        PostAdmin.deleteStaticHTML(pk=obj.id)\r\n        super(PostAdmin, self).delete_model(request, obj)\r\n\r\n    def delete_queryset(self, request, queryset):\r\n        PostAdmin.deleteStaticHTML(queryset=queryset)\r\n        super(PostAdmin, self).delete_queryset(request, queryset)\r\n\r\n\r\nadmin.site.register(Post, PostAdmin)\r\n...\r\n...\r\n...\r\nadmin.site.register(FriendLink, BasesAction)\r\n</code></pre>\r\n<img src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" /><img src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" style=\"height:15px; width:15px\" title=\"点击并拖拽以移动\" /></div>\r\n\r\n<p>资料:</p>\r\n\r\n<p><a href=\"https://code.ziqiangxuetang.com/django/django-generate-static-html.html\">Django 生成静态页面</a></p>\r\n\r\n<p><a href=\"https://www.jianshu.com/p/ceb98eb63627\">django开发的网站优化:页面静态化+数据缓存</a></p>\r\n',
        '', '2020-05-11 16:00:00', '2020-05-11 16:00:00', 234234234, 16, 5, 0, 1, 0);
INSERT INTO `tb_content`
VALUES (93, '博客优化-使用django-compressor压缩静态css js文件',
        '<p>在网站开发阶段，对于静态资源文件比如JS，CSS等文件都是未经过压缩合并处理的，这对于访问量巨大的网站来说不仅浪费带宽，而且也会影响网站的访问速度。<a href=\"https://github.com/django-compressor/django-compressor\">django-compressor</a>的作用就是将静态文件压缩合并成一个文件，不仅减少了网站的请求次数，还能节省网络带宽。</p>\r\n\r\n<p>本文分为两部分，第一部分介绍settings文件相关配置对静态文件的影响，然后再讨论Compressor的如何使用。如果你对setting文件非常了解不妨直接从第二部分开始阅读。</p>\r\n\r\n<h2><a name=\"t0\"></a>第一部分：Setting文件配置</h2>\r\n\r\n<p>早期的django处理静态资源要比较啰嗦，还要配置urlpatterns，不过自从django1.6开始加入了<code>django.contrib.staticfiles</code>这个内置app后，开发环境下处理静态资源就方便很多。<code>django.contrib.staticfiles</code>是django的内置(build-in)app，用于处理js、css、images等静态资源。首先确保这个app已经包含在<code>INSTALLED_APPS</code>中，django1.6及以上版本是默认包含该app在其中的。</p>\r\n\r\n<p><a name=\"t1\"></a>一：指定STATIC_URL</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\">\r\n<code class=\"language-python hljs\">STATIC_URL = <span class=\"hljs-string\">&#39;/static/&#39;</span>\r\n</code></pre>\r\n</div>\r\n\r\n<p>STATIC_URL是客户端访问静态资源的根路径，比如：模版中定义的资源路径是：</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\">\r\n<code class=\"language-html hljs\">{% load staticfiles %}\r\n<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">script</span> <span class=\"hljs-attr\">src</span>=<span class=\"hljs-string\">&quot;{% static &quot;</span><span class=\"hljs-attr\">js</span>/<span class=\"hljs-attr\">blog.js</span>&quot; %}&quot;&gt;</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">script</span>&gt;</span>\r\n</code></pre>\r\n</div>\r\n\r\n<p>最终渲染后的效果是：</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\">\r\n<code class=\"language-html hljs\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">script</span> <span class=\"hljs-attr\">src</span>=<span class=\"hljs-string\">&quot;/static/js/blog.js&quot;</span>&gt;</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">script</span>&gt;</span>\r\n\r\n</code></pre>\r\n</div>\r\n\r\n<p>默认django会从每个app目录的static子目录下查找静态文件，因此通常情况下你都是将相关静态文件放在各自的app/static目录下。Django怎么知道从app/static目录查找静态文件呢？原来django有个默认配置项<code>STATICFILES_FINDERS</code>，默认值：</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\">\r\n<code class=\"language-python hljs\">(<span class=\"hljs-string\">&quot;django.contrib.staticfiles.finders.FileSystemFinder&quot;</span>,\r\n<span class=\"hljs-string\">&quot;django.contrib.staticfiles.finders.AppDirectoriesFinder&quot;</span>)\r\n\r\n</code></pre>\r\n</div>\r\n\r\n<p><code>AppDirectoriesFinder</code>模块就是负责在app/static目录下找静态文件的。至于FileSystemFinder我们稍后介绍。</p>\r\n\r\n<p><a name=\"t2\"></a>二：指定STATICFILES_DIRS</p>\r\n\r\n<p>像<a href=\"http://lib.csdn.net/base/22\">jQuery</a>，bootstrap等公用的静态资源文件在很多个app中都会共用到，如果是放在某个app中显得不符<a href=\"http://lib.csdn.net/base/11\">Python</a>哲学，因此django提供了一个配置可以指定任意目录来存放这些公用的资源文件。配置参数是：<code>STATICFILES_DIRS</code>，比如：</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\">\r\n<code class=\"language-python hljs\">STATICFILES_DIRS = (\r\n    os.path.join(BASE_DIR, <span class=\"hljs-string\">&quot;static&quot;</span>),\r\n    <span class=\"hljs-string\">&#39;/var/www/static/&#39;</span>,\r\n)\r\n</code></pre>\r\n</div>\r\n\r\n<p>这意味着静态文件可以放在磁盘的任何一个位置（只要有权限访问）现在应该明白FileSystemFinder的作用了吧。就是用来查找定义在STATICFILES_DIRS中的静态文件的。</p>\r\n\r\n<p><a name=\"t3\"></a>三：指定STATIC_ROOT</p>\r\n\r\n<p>上面的配置就是在开发环境下Django对静态资源的处理过程，那么在生产环境下是怎么处理的呢？如果还是这样由django自己来处理，那么累死Django了，对于静态资源直接由Nginx这样的代理去处理就行，而且Nginx处理这些非逻辑的资源性能也非常高。于是Django提供了一个非常方便的静态资源管理命令<code>django.contrib.staticfiles</code>将系统要用的资源文件从不同目录收集到统一的目录中去，然后在Nginx的配置中指定这些静态资源的位置即可。</p>\r\n\r\n<p>收集这些静态文件需要先指定存放这些静态资源的目录：<code>STATIC_ROOT</code></p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\">\r\n<code class=\"language-python hljs\">STATIC_ROOT = os.path.join(BASE_DIR, <span class=\"hljs-string\">&#39;root_static&#39;</span>)\r\n</code></pre>\r\n</div>\r\n\r\n<p>运行collectstatic管理命令</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\">\r\n<code class=\"language-bash hljs\">python3 manage.py collectstatic</code></pre>\r\n</div>\r\n\r\n<p>运行该命令，所有静态资源都将拷贝到STATIC_ROOT指定的目录中。</p>\r\n\r\n<p><a name=\"t4\"></a>四：配置Nginx</p>\r\n\r\n<p><strong>这里一定要注意修改!!!&nbsp; 否则会出现加载不到静态文件</strong></p>\r\n\r\n<p><strong>在Nginx的配置文件中指定凡是来自<code>/static/</code>路径的请求直接访问<code>STATIC_ROOT</code>。</strong></p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\">\r\n<code class=\"language-bash hljs\">     location /static {\r\n        <span class=\"hljs-built_in\">alias</span> /xxx/项目名/static/; <span class=\"hljs-comment\"># your Django project&#39;s static files</span>\r\n    }\r\n\r\n</code></pre>\r\n</div>\r\n\r\n<h2><a name=\"t5\"></a>第二部分：Compressor的使用</h2>\r\n\r\n<p>django-compressor 的安装配置非常简单</p>\r\n\r\n<p><a name=\"t6\"></a>安装:</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\">\r\n<code class=\"hljs\">pip3 install django_compressor</code></pre>\r\n</div>\r\n\r\n<p><a name=\"t7\"></a>配置:</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\">\r\n<code class=\"language-python hljs\">COMPRESS_ENABLED = <span class=\"hljs-keyword\">True</span>\r\n\r\nINSTALLED_APPS = (\r\n    <span class=\"hljs-comment\"># other apps</span>\r\n    <span class=\"hljs-string\">&quot;compressor&quot;</span>,\r\n)\r\n\r\nSTATICFILES_FINDERS = (\r\n<span class=\"hljs-string\">&#39;django.contrib.staticfiles.finders.AppDirectoriesFinder&#39;</span>,\r\n<span class=\"hljs-string\">&#39;django.contrib.staticfiles.finders.FileSystemFinder&#39;</span>,\r\n<span class=\"hljs-string\">&#39;compressor.finders.CompressorFinder&#39;</span>,)\r\n\r\n</code></pre>\r\n</div>\r\n\r\n<p>Django-Compressor开启与否取决于DEBUG参数，默认是COMPRESS_ENABLED与DEBUG的值相反。因为Django-Compressor的功能本身是用在生产环境下项目发布前对静态文件压缩处理的。因此想在开发阶段(DEBUG=True)的时候做测试使用，需要手动设置COMPRESS_ENABLED=True</p>\r\n\r\n<p><a name=\"t8\"></a>使用</p>\r\n\r\n<p>在模板文件中添加模板标签&nbsp;<code>{% load compress %}</code></p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\">\r\n<code class=\"language-html hljs\">{% load compress %}\r\n#处理css\r\n{% compress css %}\r\n<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">link</span> <span class=\"hljs-attr\">href</span>=<span class=\"hljs-string\">&quot;{% static &quot;</span><span class=\"hljs-attr\">css</span>/<span class=\"hljs-attr\">bootstrap.min.css</span>&quot; %}&quot; <span class=\"hljs-attr\">rel</span>=<span class=\"hljs-string\">&quot;stylesheet&quot;</span>&gt;</span>\r\n<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">link</span> <span class=\"hljs-attr\">href</span>=<span class=\"hljs-string\">&quot;{% static &quot;</span><span class=\"hljs-attr\">css</span>/<span class=\"hljs-attr\">blog-home.css</span>&quot; %}&quot; <span class=\"hljs-attr\">rel</span>=<span class=\"hljs-string\">&quot;stylesheet&quot;</span>&gt;</span>\r\n<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">link</span> <span class=\"hljs-attr\">href</span>=<span class=\"hljs-string\">&quot;{% static &quot;</span><span class=\"hljs-attr\">css</span>/<span class=\"hljs-attr\">github.css</span>&quot; %}&quot; <span class=\"hljs-attr\">rel</span>=<span class=\"hljs-string\">&quot;stylesheet&quot;</span>&gt;</span>\r\n{% endcompress %}\r\n\r\n#处理js\r\n{% compress js %}\r\n<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">script</span> <span class=\"hljs-attr\">src</span>=<span class=\"hljs-string\">&quot;{% static &quot;</span><span class=\"hljs-attr\">js</span>/<span class=\"hljs-attr\">jquery-1.10.2.js</span>&quot; %}&quot;&gt;</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">script</span>&gt;</span>\r\n<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">script</span> <span class=\"hljs-attr\">src</span>=<span class=\"hljs-string\">&quot;{% static &quot;</span><span class=\"hljs-attr\">js</span>/<span class=\"hljs-attr\">bootstrap.js</span>&quot; %}&quot;&gt;</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">script</span>&gt;</span>\r\n<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">script</span> <span class=\"hljs-attr\">src</span>=<span class=\"hljs-string\">&quot;{% static &quot;</span><span class=\"hljs-attr\">js</span>/<span class=\"hljs-attr\">blog.js</span>&quot; %}&quot;&gt;</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">script</span>&gt;</span>\r\n{% endcompress %}\r\n</code></pre>\r\n</div>\r\n\r\n<p>执行命令：<code>python manage.py compress</code>&nbsp;,最终文件将合并成:</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\">\r\n<code class=\"language-html hljs\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">link</span> <span class=\"hljs-attr\">rel</span>=<span class=\"hljs-string\">&quot;stylesheet&quot;</span> <span class=\"hljs-attr\">href</span>=<span class=\"hljs-string\">&quot;/static/CACHE/css/f18b10165eed.css&quot;</span> <span class=\"hljs-attr\">type</span>=<span class=\"hljs-string\">&quot;text/css&quot;</span>&gt;</span>\r\n<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">script</span> <span class=\"hljs-attr\">type</span>=<span class=\"hljs-string\">&quot;text/javascript&quot;</span> <span class=\"hljs-attr\">src</span>=<span class=\"hljs-string\">&quot;/static/CACHE/js/9d1f64ba50fc.js&quot;</span>&gt;</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">script</span>&gt;</span>\r\n</code></pre>\r\n</div>\r\n\r\n<p><code>f18b10165eed.css</code>、<code>9d1f64ba50fc.js</code>这两文件在<code>STATIC_ROOT</code>目录下面。</p>\r\n\r\n<p>每次修改了js、css文件后，都需要重新加载最新的文件到<code>STATIC_ROOT</code>目录下去，因此需要重新运行命令：</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\">\r\n<code class=\"language-bash hljs\">python manage.py collectstatic\r\npython manage.py compress</code></pre>\r\n</div>\r\n\r\n<h3>踩过的坑:</h3>\r\n\r\n<p>按着以上配置完成部署, 打开网站发现并没有加载css及js文件, 以为是setting配置文件有问题,&nbsp; 改了很久也没成功.</p>\r\n\r\n<p><img alt=\"\" class=\"has\" data-widget=\"image\" src=\"https://img-blog.csdnimg.cn/20190918091301971.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:256px; width:600px\" /></p>\r\n\r\n<p>&nbsp;最后是nginx的配置出现问题, 访问的静态文件路径错误</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\">\r\n<code class=\"language-bash hljs\"><span class=\"hljs-comment\"># 之前的配置</span>\r\nlocation /static {\r\n                <span class=\"hljs-comment\"># 写静态文件夹路径</span>\r\n                <span class=\"hljs-built_in\">alias</span> /xxx/项目名/static;\r\n        }\r\n\r\n\r\n</code></pre>\r\n</div>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre class=\"has\" data-widget=\"codeSnippet\">\r\n<code class=\"language-bash hljs\"><span class=\"hljs-comment\"># 需要改成你setting文件中static_root中的路径</span>\r\n<span class=\"hljs-comment\"># 我这里是把文件名改为了root_static</span>\r\nlocation /static {\r\n                <span class=\"hljs-comment\"># 写静态文件夹路径</span>\r\n                <span class=\"hljs-built_in\">alias</span> /xxx/项目名/root_static;\r\n        }</code></pre>\r\n<img src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" /><span style=\"background:url(&quot;https://chenyinren.top/root_static/ckeditor/ckeditor/plugins/widget/images/handle.png&quot;) rgba(220, 220, 220, 0.5); left:0px; top:-15px\"><img role=\"presentation\" src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" style=\"height:15px; width:15px\" title=\"点击并拖拽以移动\" /></span></div>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h3><strong><a href=\"https://github.com/mintchaos/django_compressor\">github: django_compressor</a>&nbsp;</strong></h3>\r\n\r\n<hr />\r\n<p>更新: 0918</p>\r\n\r\n<p>在自己项目中实践操作一发,&nbsp; 放两张没有压缩和压缩过的对比 确实提升了很多</p>\r\n\r\n<p><img alt=\"\" class=\"has\" data-widget=\"image\" src=\"https://img-blog.csdnimg.cn/20190918090642581.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:136px; width:600px\" /></p>\r\n\r\n<p><img alt=\"\" class=\"has\" data-widget=\"image\" src=\"https://img-blog.csdnimg.cn/20190918090717827.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:136px; width:600px\" /></p>',
        '', '2019-09-17 08:47:32', '2019-09-17 08:47:32', 130, 1, 5, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (94, '博客优化-使用nginx缓存服务器上的静态文件html',
        '<h2>一、nginx缓存的优点<br />\r\n&nbsp;<img src=\"https://cdn.ch3nnn.cn/upload/2020/05/20/4ce24c67a0dc48c285a933d8ebd31abe.png\" style=\"height:311px; width:800px\" />&nbsp;</h2>\r\n\r\n<blockquote>\r\n<p>原因是前段时间博客做了全面的静态化处理, 所有详情及首页都是静态化html, 想着是不是可以通过nginx直接缓存html. 有了请求直接nginx去处理, 可以一定程度上减少web服务器的处理请求压力.</p>\r\n</blockquote>\r\n\r\n<h2>&nbsp;二、如何进行设置</h2>\r\n\r\n<p>先上个栗子：</p>\r\n\r\n<pre>\r\n<code class=\"language-nginx\">http{\r\n    proxy_connect_timeout 10;\r\n    proxy_read_timeout 180;\r\n    proxy_send_timeout 5;\r\n    proxy_buffer_size 16k;\r\n    proxy_buffers 4 32k;\r\n    proxy_busy_buffers_size 96k;\r\n    proxy_temp_file_write_size 96k;\r\n    proxy_temp_path /tmp/temp_dir;\r\n    proxy_cache_path /tmp/cache levels=1:2 keys_zone=cache_one:100m inactive=1d max_size=10g;\r\n\r\n\r\n    server {\r\n        listen       80 default_server;\r\n        server_name  localhost;\r\n        root /blog/;\r\n\r\n        location / {\r\n\r\n        }\r\n\r\n        # 静态文件html缓存\r\n        location ~ /archives/.*\\.html$ {\r\n              proxy_pass http://127.0.0.1:8000$request_uri;\r\n              proxy_redirect off;\r\n              proxy_cache cache_one;\r\n              proxy_cache_valid 200 304 12h;\r\n              proxy_cache_valid 301 302 1d;\r\n              proxy_cache_valid any 5m;\r\n              expires 1d;\r\n              add_header wall  \"hey, nginx静态文件缓存\";\r\n        }\r\n}</code></pre>\r\n\r\n<p>接下来讲一下配置项：</p>\r\n\r\n<h3>2.1 http层设置</h3>\r\n\r\n<pre>\r\n<code class=\"language-nginx\">    proxy_connect_timeout 10;\r\n    proxy_read_timeout 180;\r\n    proxy_send_timeout 5;\r\n    proxy_buffer_size 16k;\r\n    proxy_buffers 4 32k;\r\n    proxy_busy_buffers_size 96k;\r\n    proxy_temp_file_write_size 96k;\r\n    proxy_temp_path /tmp/temp_dir;\r\n    proxy_cache_path /tmp/cache levels=1:2 keys_zone=cache_one:100m inactive=1d max_size=10g;\r\n</code></pre>\r\n\r\n<ul>\r\n	<li>proxy_connect_timeout&nbsp;<code>服务器连接的超时时间</code></li>\r\n	<li>proxy_read_timeout&nbsp;<code>连接成功后,等候后端服务器响应时间</code></li>\r\n	<li>proxy_send_timeout&nbsp;<code>后端服务器数据回传时间</code></li>\r\n	<li>proxy_buffer_size&nbsp;<code>缓冲区的大小</code></li>\r\n	<li>proxy_buffers&nbsp;<code>每个连接设置缓冲区的数量为number，每块缓冲区的大小为size</code></li>\r\n	<li>proxy_busy_buffers_size&nbsp;<code>开启缓冲响应的功能以后，在没有读到全部响应的情况下，写缓冲到达一定大小时，nginx一定会向客户端发送响应，直到缓冲小于此值。</code></li>\r\n	<li>proxy_temp_file_write_size&nbsp;<code>设置nginx每次写数据到临时文件的size(大小)限制</code></li>\r\n	<li>proxy_temp_path&nbsp;<code>从后端服务器接收的临时文件的存放路径</code></li>\r\n	<li>proxy_cache_path&nbsp;<code>设置缓存的路径和其他参数。被缓存的数据如果在inactive参数（当前为1天）指定的时间内未被访问，就会被从缓存中移除</code></li>\r\n</ul>\r\n\r\n<h3>2.2 server层设置</h3>\r\n\r\n<h4>2.2.1 缓存代理服务器</h4>\r\n\r\n<pre>\r\n<code class=\"language-nginx\">    server {\r\n        listen       80 default_server;\r\n        server_name  localhost;\r\n        root /mnt/blog/;\r\n\r\n        location / {\r\n\r\n        }\r\n\r\n        # 静态文件html缓存\r\n            location ~ /archives/(\\d+\\.html$) {\r\n                  proxy_pass http://127.0.0.1:8000/archives/$1;\r\n                  proxy_redirect off;\r\n                  proxy_cache cache_one;\r\n                  proxy_cache_valid 200 304 12h;\r\n                  proxy_cache_valid 301 302 1d;\r\n                  proxy_cache_valid any 5m;\r\n                  expires 1d;\r\n                  add_header wall  \"hey, nginx静态文件缓存\";\r\n            }\r\n}\r\n</code></pre>\r\n\r\n<ul>\r\n	<li><code><code>/archives/(\\d+\\.html$) <code>这里说是正则匹配/archives/数字以.html结尾的url进行匹配</code></code></code></li>\r\n	<li><code><code><code><code>proxy_pass&nbsp;<code>nginx缓存里拿不到资源，向该地址转发请求，拿到新的资源，并进行缓存</code></code></code></code></code></li>\r\n	<li><code><code><code><code>proxy_redirect&nbsp;<code>设置后端服务器&ldquo;Location&rdquo;响应头和&ldquo;Refresh&rdquo;响应头的替换文本</code></code></code></code></code></li>\r\n	<li><code><code><code><code>proxy_set_header&nbsp;<code>允许重新定义或者添加发往后端服务器的请求头</code></code></code></code></code></li>\r\n	<li><code><code><code><code>proxy_cache&nbsp;<code>指定用于页面缓存的共享内存，对应http层设置的keys_zone</code></code></code></code></code></li>\r\n	<li><code><code><code><code>proxy_cache_valid&nbsp;<code>为不同的响应状态码设置不同的缓存时间</code></code></code></code></code></li>\r\n	<li><code><code><code><code>expires&nbsp;<code>缓存时间</code></code></code></code></code></li>\r\n</ul>\r\n\r\n<hr />\r\n<p><code><code>这里我设置了详情页html静态资源进行缓存。<br />\r\n当用户输入<a href=\"https://cdn.ch3nnn.cn/archives/94.html\">https://chenyinren.top/archives/94.html</a>时，解析得到访问地址。所以页面请求会被当前server截取到，进行请求处理。<br />\r\n当解析到上述文件名结尾的静&nbsp;态资源，会到缓存区获取静态资源。<br />\r\n如果获取到对应资源，则直接返回数据。<br />\r\n如果获取不到，则将请求转发给<code>proxy_pass</code>指向的地址进行处理。</code></code></p>\r\n\r\n<h2><code><code>三、如何验证缓存是否有效</code></code></h2>\r\n\r\n<p><code><code>细心的应该发现，在第二段栗子里，留了个彩蛋&nbsp;<span style=\"color:#e74c3c\">add_header wall &quot;hey, nginx静态文件缓存&quot;;</span></code></code><br />\r\n<code><code><strong><code>add_header</code></strong>是用于在报头设置自定义的信息。<br />\r\n所以，如果缓存有效的话，那么静态资源返回的报头，一定会带上这个信息。</code></code></p>\r\n\r\n<p><code><code>访问<a href=\"https://cdn.ch3nnn.cn/archives/94.html\">https://chenyinren.top/archives/94.html</a>结果如下：</code></code></p>\r\n\r\n<p><code><code><img alt=\"\" src=\"https://cdn.ch3nnn.cn/upload/2020/05/20/bf99c55bf24e495b96d195d9bda8c15a.png\" style=\"height:406px; width:800px\" /></code></code></p>',
        '', '2020-05-20 03:20:00', '2020-05-20 03:20:00', 164, 1, 13, 0, 0, 1);
INSERT INTO `tb_content`
VALUES (95, '什么是elasticsearch',
        '<h1>前言</h1>\r\n\r\n<p>观今宜鉴古，无古不成今。<br />\r\n在学习elasticsearch之前，我们要知道，elasticsearch是什么？为什么要学习elasticsearch？以及用它能干什么？</p>\r\n\r\n<h1>关于elasticsearch</h1>\r\n\r\n<p>现在，你还离得开搜索吗？无论是Google还是百度提供的搜索入口，还是项目自己的搜索，比如QQ提供的搜索入口等等，都大大的方便了我们的工作、生活。但是你有没有想过&mdash;&mdash;搭建属于自己的搜索服务，应用于你的博客项目、公司项目&hellip;&hellip;<br />\r\n无论你想不想，都要学习！因为随着公司业务的增长，数据也爆炸性增长。对于数据的处理、日志分析，如果还采用传统的方法，这恐怕是灾难性的。所以，我们是时候学习一个先进的搜索引擎了。<br />\r\nElasticsearch是一个基于Apache Lucene(TM)的开源搜索引擎。无论在开源还是专有领域，Lucene可以被认为是迄今为止最先进、性能最好的、功能最全的搜索引擎库。<br />\r\n但是，Lucene只是一个库。想要使用它，你必须使用Java来作为开发语言并将其直接集成到你的应用中，更糟糕的是，Lucene非常复杂，你需要深入了解检索的相关知识来理解它是如何工作的。<br />\r\nElasticsearch也使用Java开发并使用Lucene作为其核心来实现所有索引和搜索的功能，但是它的目的是通过简单的RESTful API来隐藏Lucene的复杂性，从而让全文搜索变得简单。<br />\r\n你以为这些就完了？elasticsearch除了Lucene和全文搜索，我们还可以描述它：</p>\r\n\r\n<ul>\r\n	<li>分布式的实时文件存储，每个字段都被索引并可被搜索</li>\r\n	<li>分布式的实时分析搜索引擎</li>\r\n	<li>可以扩展到上百台服务器，处理PB级结构化或非结构化数据。</li>\r\n</ul>\r\n\r\n<p>并且，这些功能都被集成到一个服务里面，elasticsearch也提供的与其它语言的接口，其中包括：</p>\r\n\r\n<ul>\r\n	<li>Java</li>\r\n	<li>JavaScript</li>\r\n	<li>Groovy</li>\r\n	<li>.NET</li>\r\n	<li>PHP</li>\r\n	<li>Perl</li>\r\n	<li>Python</li>\r\n	<li>Ruby</li>\r\n	<li>以及社区贡献的<a href=\"https://www.elastic.co/guide/en/elasticsearch/client/community/current/index.html\">更多接口</a></li>\r\n</ul>\r\n\r\n<p>使用我们喜欢的语言通过RESTful API接口，访问9200端口，就可以与elasticsearch玩耍了。<br />\r\n上手elasticsearch非常容易，它提供了许多合理的缺省值，并对初学者隐藏了复杂的搜索引擎理论。它开箱即用（安装即可使用），只需很少的学习既可在生产环境中使用。<br />\r\n随着越学越深入，还可以利用Elasticsearch更多高级的功能，整个引擎可以很灵活地进行配置。可以根据自身需求来定制属于自己的Elasticsearch。</p>\r\n\r\n<h1>elasticsearch的模糊历史</h1>\r\n\r\n<p>多年前，一个叫做Shay Banon的刚结婚不久的失业开发者，由于妻子要去伦敦学习厨师，他便跟着也去了。在他找工作的过程中，为了给妻子构建一个食谱的搜索引擎，他开始构建一个早期版本的Lucene。<br />\r\n直接基于Lucene工作会比较困难，所以Shay开始抽象Lucene代码以便Java程序员可以在应用中添加搜索功能。他发布了他的第一个开源项目，叫做&ldquo;Compass&rdquo;。</p>\r\n\r\n<p>后来Shay找到一份工作，这份工作处在高性能和内存数据网格的分布式环境中，因此高性能的、实时的、分布式的搜索引擎也是理所当然需要的。然后他决定重写Compass库使其成为一个独立的服务叫做Elasticsearch。<br />\r\n第一个公开版本出现在2010年2月，在那之后Elasticsearch已经成为Github上最受欢迎的项目之一，代码贡献者超过300人。一家主营Elasticsearch的公司就此成立，他们一边提供商业支持一边开发新功能，不过Elasticsearch将永远开源且对所有人可用。<br />\r\nShay的妻子依旧等待着她的食谱搜索&hellip;&hellip;</p>\r\n\r\n<h1>elasticsearch：面向文档</h1>\r\n\r\n<p>我们知道，关系型数据库以记录和行的形式存储数据，但是在elasticsearch中，是以文档的形式存储数据。<br />\r\n但区别在于，文档要比数据表的行更加灵活。因为文档可以是多层次的，它（文档）鼓励你将属于一个逻辑实体的数据保存在同一个文档中，而不是散落在各个表的不同行中。这样查询效率很高，因为我们无需连接其他的表，我们学习关系型数据库时，一定知道连表查询（尤其是连接多张表）是多么的费时吧！<br />\r\n我们将在后续文章做更多的讲解。</p>\r\n\r\n<h1>没有成熟的案例？</h1>\r\n\r\n<p>之前有人说，elasticsearch的缺点之一是没有成熟的案例加持，那我们就来看看elasticsearch都有哪些成熟的案例：</p>\r\n\r\n<ul>\r\n	<li>维基百科使用Elasticsearch来进行全文搜做并高亮显示关键词，以及提供search-as-you-type、did-you-mean等搜索建议功能。</li>\r\n	<li>英国卫报使用Elasticsearch来处理访客日志，以便能将公众对不同文章的反应实时地反馈给各位编辑。</li>\r\n	<li>StackOverflow将全文搜索与地理位置和相关信息进行结合，以提供more-like-this相关问题的展现。</li>\r\n	<li>GitHub使用Elasticsearch来检索超过1300亿行代码，可以参考<a href=\"https://github.blog/2013-01-23-a-whole-new-code-search/\">A Whole New Code Search</a></li>\r\n	<li>每天，Goldman Sachs使用它来处理5TB数据的索引，还有很多投行使用它来分析股票市场的变动。</li>\r\n	<li>苏宁在大数据平台使用es存储600TB数据，集群规模包括：搭建超过500+物理机，30万shards，80000index。<a href=\"https://elasticsearch.cn/slides/203#page=5\">参考</a></li>\r\n	<li>腾讯在日志实时分析中采用es，处理高并发100W/S，PE级数据。</li>\r\n	<li>更多<a href=\"https://elasticsearch.cn/slides/category-38\">参考</a></li>\r\n</ul>\r\n\r\n<p>所以，elasticsearch可以灵活的应用于我们的项目中。</p>\r\n\r\n<h1>如何学好elasticsearch</h1>\r\n\r\n<p>除了万能的百度和Google 之外，我们还有一些其他的学习途径：</p>\r\n\r\n<ul>\r\n	<li>elasticsearch<a href=\"https://www.elastic.co/guide/index.html\">官方文档</a>：这个比较好点，可以多多参考</li>\r\n	<li>elasticsearch<a href=\"https://www.elastic.co/cn/blog?ultron=cn-es-getting-started-webinar&amp;blade=touch&amp;hulk=email&amp;mkt_tok=eyJpIjoiWXpBeE9UbG1OemMwTnpBNCIsInQiOiI5SUlMWkNjaXZPRWxOb3B2ZnUyOVZDcFwvTDQ2MXVTUEdPcnpPR1RobDc4NEtURTAwZWkrVDZKSDVPemdVb0drbk5QXC9rVkpCZWVUcTRYMkEzazVKdzdKV2JGT01IWW1yMTZwdjlOcDdOeUYzWGdjZ2ZDSTQyN2J5bWNWVlNmdUdNIn0%3D\">博客</a>：这个吧，看看就行</li>\r\n	<li>elasticsearch<a href=\"https://elasticsearch.cn/?ultron=cn-es-getting-started-webinar&amp;blade=touch&amp;hulk=email&amp;mkt_tok=eyJpIjoiWXpBeE9UbG1OemMwTnpBNCIsInQiOiI5SUlMWkNjaXZPRWxOb3B2ZnUyOVZDcFwvTDQ2MXVTUEdPcnpPR1RobDc4NEtURTAwZWkrVDZKSDVPemdVb0drbk5QXC9rVkpCZWVUcTRYMkEzazVKdzdKV2JGT01IWW1yMTZwdjlOcDdOeUYzWGdjZ2ZDSTQyN2J5bWNWVlNmdUdNIn0%3D\">社区</a>：社区还是很好的</li>\r\n	<li>elasticsearch<a href=\"https://www.elastic.co/cn/videos/\">视频</a>：包括入门视频什么的</li>\r\n	<li>elasticsearch实战：该书籍的质量还是不错的。</li>\r\n	<li>elasticsearch权威指南：同样的，这个也不错。</li>\r\n</ul>\r\n\r\n<h1>最后，你一定很好奇，elasticsearch索引能处理多大的数据</h1>\r\n\r\n<p>一个很好地问题，不幸的是，单一索引的极限取决于存储索引的硬件、索引的设计、如何处理数据以及你为索引备份了多少副本。</p>\r\n\r\n<p>通常来说，一个Lucene索引（也就是一个elasticsearch分片）不能处理多于21亿篇文档，或者多于2740亿的唯一词条。但达到这个极限之前，我们可能就没有足够的磁盘空间了！<br />\r\n当然，一个分片如何很大的话，读写性能将会变得非常差。</p>\r\n\r\n<p>扯了半天的淡，让我们开始一个灵活的学习之旅吧。</p>',
        '', '2020-01-28 01:46:00', '2020-01-28 01:46:00', 90, 1, 11, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (96, 'elasticsearch之相关配置',
        '<h1>前言</h1>\r\n\r\n<p>在<code>elasticsearch\\config</code>目录下，有三个核心的配置文件：</p>\r\n\r\n<ul>\r\n	<li>elasticsearch.yml，es相关的配置。</li>\r\n	<li>jvm.options，Java jvm相关参数的配置。</li>\r\n	<li>log4j2.properties，日志相关的配置，因为es采用了<a href=\"https://baike.baidu.com/item/log4j/480673?fr=aladdin\">log4j</a>的日志框架。</li>\r\n</ul>\r\n\r\n<p>这里以elasticsearch6.5.4版本为例，并且由于版本不同，配置也不太也一样，仅作参考！</p>\r\n\r\n<h2>elasticsearch.yml</h2>\r\n\r\n<h3>Cluster</h3>\r\n\r\n<ul>\r\n	<li>配置集群名称，由多个es实例组成的集群，有一个共同的名称。</li>\r\n</ul>\r\n\r\n<p><code>cluster.name: my-application </code></p>\r\n\r\n<ul>\r\n	<li>集群端口设置。</li>\r\n</ul>\r\n\r\n<p><code>transport.tcp.port: 9300 </code></p>\r\n\r\n<ul>\r\n	<li>防止同一个shard的主副本存在同一个物理机上。</li>\r\n</ul>\r\n\r\n<p><code>cluster.routing.allocation.same_shard.host:true </code></p>\r\n\r\n<ul>\r\n	<li>初始化数据恢复时，并发恢复线程的个数，默认是4个。</li>\r\n</ul>\r\n\r\n<p><code>cluster.routing.allocation.node_initial_primaries_recoveries: 4 </code></p>\r\n\r\n<ul>\r\n	<li>添加删除节点或者负载均衡时并发恢复线程的个数。默认是4个。</li>\r\n</ul>\r\n\r\n<p><code>cluster.routing.allocation.node_concurrent_recoveries: 4 </code></p>\r\n\r\n<h3>Node</h3>\r\n\r\n<ul>\r\n	<li>节点名称配置，一个es实例其实是一个es进程，在集群中被称为节点。如果一个服务器上配置集群，各节点的名称不能重复。</li>\r\n</ul>\r\n\r\n<p><code>node.name: node-1 </code></p>\r\n\r\n<ul>\r\n	<li>为节点添加自定义属性，</li>\r\n</ul>\r\n\r\n<p><code>node.attr.rack: r1 </code></p>\r\n\r\n<ul>\r\n	<li>该节点是否有资格成为主节点，默认为true。</li>\r\n</ul>\r\n\r\n<p><code>node.master: true </code></p>\r\n\r\n<ul>\r\n	<li>设置节点是否存储数据。</li>\r\n</ul>\r\n\r\n<p><code>node.data: true </code></p>\r\n\r\n<ul>\r\n	<li>设置默认主分片的个数，默认为5片，需要说明的是，主分片一经分配则无法更改。</li>\r\n</ul>\r\n\r\n<p><code>index.number_of_shards: 5 </code></p>\r\n\r\n<ul>\r\n	<li>设置默认复制分片的个数，默认一个主分片对应一个复制分片，需要说明的是，复制分片可以手动调整。</li>\r\n</ul>\r\n\r\n<p><code>index.number_of_replicas: 1 </code></p>\r\n\r\n<ul>\r\n	<li>设置数据恢复时限制的带宽，默认0及不限制。</li>\r\n</ul>\r\n\r\n<p><code>indices.recovery.max_size_per_ser: 0 </code></p>\r\n\r\n<ul>\r\n	<li>设置这个参数来限制从其它分片恢复数据时最大同时打开并发流的个数，默认为5。</li>\r\n</ul>\r\n\r\n<p><code>indices.recovery.concurrent_streams: 5 </code></p>\r\n\r\n<ul>\r\n	<li>设置数据恢复时限制的带宽，默认0及不限制。</li>\r\n</ul>\r\n\r\n<p><code>indices.recovery.max_size_per_ser: 0 </code></p>\r\n\r\n<ul>\r\n	<li>设置这个参数来限制从其它分片恢复数据时最大同时打开并发流的个数，默认为5。</li>\r\n</ul>\r\n\r\n<p><code>indices.recovery.concurrent_streams: 5 </code></p>\r\n\r\n<h3>Paths</h3>\r\n\r\n<ul>\r\n	<li>存储数据路径设置，多个路径以英文状态的逗号分隔，默认根目录下的<code>conf</code>目录。</li>\r\n</ul>\r\n\r\n<p><code>path.data: /path/to/data # path.data: /path/to/data1,/path/to/data1 </code></p>\r\n\r\n<ul>\r\n	<li>设置临时文件存储路径，默认是es目录下的work目录。</li>\r\n</ul>\r\n\r\n<p><code>path.work: /path/to/work </code></p>\r\n\r\n<ul>\r\n	<li>日志文件路径，默认为根目录下的<code>logs</code>目录。</li>\r\n</ul>\r\n\r\n<p><code>path.logs: /path/to/logs </code></p>\r\n\r\n<ul>\r\n	<li>设置日志文件的存储路径，默认是es目录下的<code>logs</code>目录。</li>\r\n</ul>\r\n\r\n<p><code>path.logs: /path/to/logs </code></p>\r\n\r\n<ul>\r\n	<li>设置插件的存放路径，默认是es目录下的<code>plugins</code>目录。</li>\r\n</ul>\r\n\r\n<p><code>path.plugins: /path/to/plugins </code></p>\r\n\r\n<h3>Network</h3>\r\n\r\n<ul>\r\n	<li>为es实例绑定特定的IP地址。</li>\r\n</ul>\r\n\r\n<p><code>network.host: 192.168.0.1 </code></p>\r\n\r\n<p>上面的设置可以拆分为两个参数。</p>\r\n\r\n<p><code>network.bind_host: 192.168.0.1 # 设置绑定的ip地址，ipv4或ipv6都可以 network.publish_host: 192.168.0.1 # 设置其它节点和该节点交互的ip地址，如果不设置它会自动判断，值必须是个真实的ip地址 </code></p>\r\n\r\n<ul>\r\n	<li>为es实例设置特定的端口，默认为9200端口。</li>\r\n</ul>\r\n\r\n<p><code>http.port: 9200 </code></p>\r\n\r\n<h3>Discovery</h3>\r\n\r\n<ul>\r\n	<li>设置是否打开多播发现节点，默认是true。</li>\r\n</ul>\r\n\r\n<p><code>discovery.zen.ping.multicast.enabled: true </code></p>\r\n\r\n<ul>\r\n	<li>配置es<a href=\"https://www.cnblogs.com/Neeo/articles/10567476.html#%E5%8D%95%E6%92%AD\">单播发现列表</a>，在es启动时，通过这个列表发现别的es实例，从而加入集群。</li>\r\n</ul>\r\n\r\n<p><code>discovery.zen.ping.unicast.hosts: [&quot;host1&quot;, &quot;host2&quot;] discovery.zen.ping.unicast.hosts: [&quot;10.0.0.1&quot;, &quot;10.0.0.3:9300&quot;, &quot;10.0.0.6[9300-9400]&quot;] </code></p>\r\n\r\n<ul>\r\n	<li><code>discovery.zen.minimum_master_nodes</code>设置是告诉集群有多少个节点有资格成为主节点，一般的规则是集群节点数除以2（向下取整）再加一。比如3个节点集群要设置为2，这个试着是为了防止<a href=\"https://www.cnblogs.com/Neeo/articles/10567476.html#%E4%BB%80%E4%B9%88%E6%98%AF%E8%84%91%E8%A3%82\">脑裂问题</a>。</li>\r\n	<li>设置集群中自动发现其它节点时ping连接超时时间，默认为3秒，对于比较差的网络环境可以高点的值来防止自动发现时出错。</li>\r\n</ul>\r\n\r\n<p><code>discovery.zen.ping.timeout: 3s </code></p>\r\n\r\n<h3>Memory</h3>\r\n\r\n<ul>\r\n	<li>启动时锁定内存，默认为true，因为当jvm开始swapping时es的效率 会降低，所以要保证它不swap，可以把ES_MIN_MEM和ES_MAX_MEM两个环境变量设置成同一个值，并且保证机器有足够的内存分配给es。 同时也要允许elasticsearch的进程可以锁住内存，linux下可以通过ulimit -l unlimited命令</li>\r\n</ul>\r\n\r\n<p><code>bootstrap.memory_lock: true </code></p>\r\n\r\n<ul>\r\n	<li>禁止swapping交换。</li>\r\n</ul>\r\n\r\n<p><code>bootstrap.mlockall: true </code></p>\r\n\r\n<h3>Gateway</h3>\r\n\r\n<ul>\r\n	<li>设置是否压缩tcp传输时的数据。默认是false不压缩。</li>\r\n</ul>\r\n\r\n<p><code>transport.tcp.compress: true </code></p>\r\n\r\n<ul>\r\n	<li>设置内容的最大容量，默认是100mb。</li>\r\n</ul>\r\n\r\n<p><code>http.max_content_length: 100mb </code></p>\r\n\r\n<ul>\r\n	<li>是否使用http协议对外提供服务。默认为true。</li>\r\n</ul>\r\n\r\n<p><code>http.enabled: false </code></p>\r\n\r\n<ul>\r\n	<li>设置gateway的类型，默认为本地文件系统，也可以设置分布式文件系统、Hadoop的HDFS或者AWS的都可以。</li>\r\n</ul>\r\n\r\n<p><code>gateway.type: local </code></p>\r\n\r\n<ul>\r\n	<li>在完全重新启动集群之后阻塞初始恢复，直到启动N个节点为止，详情参见<a href=\"https://www.cnblogs.com/Neeo/articles/10843759.html\">Recovery</a></li>\r\n</ul>\r\n\r\n<p><code>gateway.recover_after_nodes: 3 </code></p>\r\n\r\n<ul>\r\n	<li>设置初始化数据恢复进程的超时时间。默认是5分钟。</li>\r\n</ul>\r\n\r\n<p><code>gateway.recover_after_time: 5m </code></p>\r\n\r\n<ul>\r\n	<li>设置该集群中节点的数量，默认为2个，一旦这N个节点启动，就会立即进行数据恢复。</li>\r\n</ul>\r\n\r\n<p><code>gateway.expected_nodes: 2 </code></p>\r\n\r\n<h3>Various</h3>\r\n\r\n<ul>\r\n	<li>删除索引时需要显式名称。</li>\r\n</ul>\r\n\r\n<p><code>action.destructive_requires_name: true </code></p>\r\n\r\n<h2>jvm.options</h2>\r\n\r\n<ul>\r\n	<li>设置jvm堆的大小，最大值和最小值，应该是一致的，并且应该根据你的物理内存决定。</li>\r\n</ul>\r\n\r\n<p><code>-Xms1g # 设置最小堆为1g -Xmx1g # 设置最大堆为1g </code></p>\r\n\r\n<h2>log4j2.properties<a href=\"https://www.cnblogs.com/Neeo/articles/10564494.html#2879123244\">#</a></h2>\r\n\r\n<p>这个配置文件，我们一般不修改其配置。</p>',
        '', '2020-01-28 01:49:00', '2020-01-28 01:49:00', 88, 1, 11, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (97, 'elasticsearch之term和match',
        '<h1>前言</h1>\r\n\r\n<p>现在，是时候学习两种最常用的查询方法了，match和term了。<br />\r\n车速太快，系好安全带，睁大眼，不要在前进的道路上迷失了！</p>\r\n\r\n<h1>match查询</h1>\r\n\r\n<h2>准备数据</h2>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">PUT zhifou/doc/1\r\n{\r\n  \"name\":\"顾老二\",\r\n  \"age\":30,\r\n  \"from\": \"gu\",\r\n  \"desc\": \"皮肤黑、武器长、性格直\",\r\n  \"tags\": [\"黑\", \"长\", \"直\"]\r\n}\r\n\r\nPUT zhifou/doc/2\r\n{\r\n  \"name\":\"大娘子\",\r\n  \"age\":18,\r\n  \"from\":\"sheng\",\r\n  \"desc\":\"肤白貌美，娇憨可爱\",\r\n  \"tags\":[\"白\", \"富\",\"美\"]\r\n}\r\n\r\nPUT zhifou/doc/3\r\n{\r\n  \"name\":\"龙套偏房\",\r\n  \"age\":22,\r\n  \"from\":\"gu\",\r\n  \"desc\":\"mmp，没怎么看，不知道怎么形容\",\r\n  \"tags\":[\"造数据\", \"真\",\"难\"]\r\n}\r\n\r\n\r\nPUT zhifou/doc/4\r\n{\r\n  \"name\":\"石头\",\r\n  \"age\":29,\r\n  \"from\":\"gu\",\r\n  \"desc\":\"粗中有细，狐假虎威\",\r\n  \"tags\":[\"粗\", \"大\",\"猛\"]\r\n}\r\n\r\nPUT zhifou/doc/5\r\n{\r\n  \"name\":\"魏行首\",\r\n  \"age\":25,\r\n  \"from\":\"广云台\",\r\n  \"desc\":\"仿佛兮若轻云之蔽月,飘飘兮若流风之回雪,mmp，最后竟然没有嫁给顾老二！\",\r\n  \"tags\":[\"闭月\",\"羞花\"]\r\n}</code></pre>\r\n\r\n<h2>match系列之match（按条件查询）</h2>\r\n\r\n<p>我们查看来自顾家的都有哪些人。</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">GET zhifou/doc/_search\r\n{\r\n  \"query\": {\r\n    \"match\": {\r\n      \"from\": \"gu\"\r\n    }\r\n  }\r\n}</code></pre>\r\n\r\n<p>上例，查询条件是一步步构建出来的，将查询条件添加到<code>match</code>中即可，而<code>match</code>则是查询所有<code>from</code>字段的值中含有<code>gu</code>的结果就会返回。<br />\r\n结果如下</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">{\r\n  \"took\" : 0,\r\n  \"timed_out\" : false,\r\n  \"_shards\" : {\r\n    \"total\" : 5,\r\n    \"successful\" : 5,\r\n    \"skipped\" : 0,\r\n    \"failed\" : 0\r\n  },\r\n  \"hits\" : {\r\n    \"total\" : 3,\r\n    \"max_score\" : 0.6931472,\r\n    \"hits\" : [\r\n      {\r\n        \"_index\" : \"zhifou\",\r\n        \"_type\" : \"doc\",\r\n        \"_id\" : \"4\",\r\n        \"_score\" : 0.6931472,\r\n        \"_source\" : {\r\n          \"name\" : \"石头\",\r\n          \"age\" : 29,\r\n          \"from\" : \"gu\",\r\n          \"desc\" : \"粗中有细，狐假虎威\",\r\n          \"tags\" : [\r\n            \"粗\",\r\n            \"大\",\r\n            \"猛\"\r\n          ]\r\n        }\r\n      },\r\n      {\r\n        \"_index\" : \"zhifou\",\r\n        \"_type\" : \"doc\",\r\n        \"_id\" : \"1\",\r\n        \"_score\" : 0.2876821,\r\n        \"_source\" : {\r\n          \"name\" : \"顾老二\",\r\n          \"age\" : 30,\r\n          \"from\" : \"gu\",\r\n          \"desc\" : \"皮肤黑、武器长、性格直\",\r\n          \"tags\" : [\r\n            \"黑\",\r\n            \"长\",\r\n            \"直\"\r\n          ]\r\n        }\r\n      },\r\n      {\r\n        \"_index\" : \"zhifou\",\r\n        \"_type\" : \"doc\",\r\n        \"_id\" : \"3\",\r\n        \"_score\" : 0.2876821,\r\n        \"_source\" : {\r\n          \"name\" : \"龙套偏房\",\r\n          \"age\" : 22,\r\n          \"from\" : \"gu\",\r\n          \"desc\" : \"mmp，没怎么看，不知道怎么形容\",\r\n          \"tags\" : [\r\n            \"造数据\",\r\n            \"真\",\r\n            \"难\"\r\n          ]\r\n        }\r\n      }\r\n    ]\r\n  }\r\n}</code></pre>\r\n\r\n<h2>match系列之match_all（查询全部）</h2>\r\n\r\n<p>除了按条件查询之外，我们还可以查询<code>zhifou</code>索引下的<code>doc</code>类型中的所有文档，那就是查询全部：</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">GET zhifou/doc/_search\r\n{\r\n  \"query\": {\r\n    \"match_all\": {}\r\n  }\r\n}</code></pre>\r\n\r\n<p><code>match_all</code>的值为空，表示没有查询条件，那就是查询全部。就像<code>select * from table_name</code>一样。</p>\r\n\r\n<p>查询结果如下：</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">{\r\n  \"took\" : 0,\r\n  \"timed_out\" : false,\r\n  \"_shards\" : {\r\n    \"total\" : 5,\r\n    \"successful\" : 5,\r\n    \"skipped\" : 0,\r\n    \"failed\" : 0\r\n  },\r\n  \"hits\" : {\r\n    \"total\" : 5,\r\n    \"max_score\" : 1.0,\r\n    \"hits\" : [\r\n      {\r\n        \"_index\" : \"zhifou\",\r\n        \"_type\" : \"doc\",\r\n        \"_id\" : \"5\",\r\n        \"_score\" : 1.0,\r\n        \"_source\" : {\r\n          \"name\" : \"魏行首\",\r\n          \"age\" : 25,\r\n          \"from\" : \"广云台\",\r\n          \"desc\" : \"仿佛兮若轻云之蔽月,飘飘兮若流风之回雪,mmp，最后竟然没有嫁给顾老二！\",\r\n          \"tags\" : [\r\n            \"闭月\",\r\n            \"羞花\"\r\n          ]\r\n        }\r\n      },\r\n      {\r\n        \"_index\" : \"zhifou\",\r\n        \"_type\" : \"doc\",\r\n        \"_id\" : \"2\",\r\n        \"_score\" : 1.0,\r\n        \"_source\" : {\r\n          \"name\" : \"大娘子\",\r\n          \"age\" : 18,\r\n          \"from\" : \"sheng\",\r\n          \"desc\" : \"肤白貌美，娇憨可爱\",\r\n          \"tags\" : [\r\n            \"白\",\r\n            \"富\",\r\n            \"美\"\r\n          ]\r\n        }\r\n      },\r\n      {\r\n        \"_index\" : \"zhifou\",\r\n        \"_type\" : \"doc\",\r\n        \"_id\" : \"4\",\r\n        \"_score\" : 1.0,\r\n        \"_source\" : {\r\n          \"name\" : \"石头\",\r\n          \"age\" : 29,\r\n          \"from\" : \"gu\",\r\n          \"desc\" : \"粗中有细，狐假虎威\",\r\n          \"tags\" : [\r\n            \"粗\",\r\n            \"大\",\r\n            \"猛\"\r\n          ]\r\n        }\r\n      },\r\n      {\r\n        \"_index\" : \"zhifou\",\r\n        \"_type\" : \"doc\",\r\n        \"_id\" : \"1\",\r\n        \"_score\" : 1.0,\r\n        \"_source\" : {\r\n          \"name\" : \"顾老二\",\r\n          \"age\" : 30,\r\n          \"from\" : \"gu\",\r\n          \"desc\" : \"皮肤黑、武器长、性格直\",\r\n          \"tags\" : [\r\n            \"黑\",\r\n            \"长\",\r\n            \"直\"\r\n          ]\r\n        }\r\n      },\r\n      {\r\n        \"_index\" : \"zhifou\",\r\n        \"_type\" : \"doc\",\r\n        \"_id\" : \"3\",\r\n        \"_score\" : 1.0,\r\n        \"_source\" : {\r\n          \"name\" : \"龙套偏房\",\r\n          \"age\" : 22,\r\n          \"from\" : \"gu\",\r\n          \"desc\" : \"mmp，没怎么看，不知道怎么形容\",\r\n          \"tags\" : [\r\n            \"造数据\",\r\n            \"真\",\r\n            \"难\"\r\n          ]\r\n        }\r\n      }\r\n    ]\r\n  }\r\n}</code></pre>\r\n\r\n<p>返回的是<code>zhifou</code>索引下<code>doc</code>类型的所有文档！</p>\r\n\r\n<h2>match系列之match_phrase（短语查询）<a href=\"https://www.cnblogs.com/Neeo/articles/10578482.html#4242953374\">#</a></h2>\r\n\r\n<p>我们现在已经对match有了基本的了解，match查询的是散列映射，包含了我们希望搜索的字段和字符串。也就说，只要文档中只要有我们希望的那个关键字，但也因此带来了一些问题。<br />\r\n首先来创建一些示例：</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">PUT t1/doc/1 { \"title\": \"中国是世界上人口最多的国家\" } PUT t1/doc/2 { \"title\": \"美国是世界上军事实力最强大的国家\" } PUT t1/doc/3 { \"title\": \"北京是中国的首都\" }</code></pre>\r\n\r\n<p>现在，当我们以<code>中国</code>作为搜索条件，我们希望只返回和<code>中国</code>相关的文档。我们首先来使用<code>match</code>查询：</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">GET t1/doc/_search { \"query\": { \"match\": { \"title\": \"中国\" } } }</code></pre>\r\n\r\n<p>结果如下：</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">{\r\n  \"took\" : 1,\r\n  \"timed_out\" : false,\r\n  \"_shards\" : {\r\n    \"total\" : 5,\r\n    \"successful\" : 5,\r\n    \"skipped\" : 0,\r\n    \"failed\" : 0\r\n  },\r\n  \"hits\" : {\r\n    \"total\" : 3,\r\n    \"max_score\" : 0.68324494,\r\n    \"hits\" : [\r\n      {\r\n        \"_index\" : \"t1\",\r\n        \"_type\" : \"doc\",\r\n        \"_id\" : \"1\",\r\n        \"_score\" : 0.68324494,\r\n        \"_source\" : {\r\n          \"title\" : \"中国是世界上人口最多的国家\"\r\n        }\r\n      },\r\n      {\r\n        \"_index\" : \"t1\",\r\n        \"_type\" : \"doc\",\r\n        \"_id\" : \"3\",\r\n        \"_score\" : 0.5753642,\r\n        \"_source\" : {\r\n          \"title\" : \"北京是中国的首都\"\r\n        }\r\n      },\r\n      {\r\n        \"_index\" : \"t1\",\r\n        \"_type\" : \"doc\",\r\n        \"_id\" : \"2\",\r\n        \"_score\" : 0.39556286,\r\n        \"_source\" : {\r\n          \"title\" : \"美国是世界上军事实力最强大的国家\"\r\n        }\r\n      }\r\n    ]\r\n  }\r\n}</code></pre>\r\n\r\n<p>虽然如期的返回了<code>中国</code>的文档。但是却把和<code>美国</code>的文档也返回了，这并不是我们想要的。是怎么回事呢？因为这是elasticsearch在内部对文档做分词的时候，对于中文来说，就是一个字一个字分的，所以，我们搜<code>中国</code>，<code>中</code>和<code>国</code>都符合条件，返回，而美国的<code>国</code>也符合。<br />\r\n而我们认为<code>中国</code>是个短语，是一个有具体含义的词。所以elasticsearch在处理中文分词方面比较弱势。后面会讲针对中文的插件。<br />\r\n但目前我们还有办法解决，那就是使用短语查询：</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">GET t1/doc/_search { \"query\": { \"match_phrase\": { \"title\": { \"query\": \"中国\" } } } }</code></pre>\r\n\r\n<p>这里<code>match_phrase</code>是在文档中搜索指定的词组，而<code>中国</code>则正是一个词组，所以愉快的返回了。<br />\r\n那么，现在我们要想搜索<code>中国</code>和<code>世界</code>相关的文档，但又忘记其余部分了，怎么做呢？用<code>match</code>也不行，那就继续用<code>match_phrase</code>试试：</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">GET t1/doc/_search { \"query\": { \"match_phrase\": { \"title\": \"中国世界\" } } }</code></pre>\r\n\r\n<p>返回结果也是空的，因为没有<code>中国世界</code>这个短语。<br />\r\n我们搜索<code>中国</code>和<code>世界</code>这两个指定词组时，但又不清楚两个词组之间有多少别的词间隔。那么在搜的时候就要留有一些余地。这时就要用到了<code>slop</code>了。相当于正则中的<code>中国.*?世界</code>。这个间隔默认为0，导致我们刚才没有搜到,现在我们指定一个间隔。</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">GET t1/doc/_search { \"query\": { \"match_phrase\": { \"title\": { \"query\": \"中国世界\", \"slop\": 2 } } } }</code></pre>\r\n\r\n<p>现在，两个词组之间有了2个词的间隔，这个时候，就可以查询到结果了：</p>\r\n\r\n<pre>\r\n&nbsp;</pre>\r\n\r\n<pre>\r\n<code class=\"language-json\">{\r\n  \"took\" : 1,\r\n  \"timed_out\" : false,\r\n  \"_shards\" : {\r\n    \"total\" : 5,\r\n    \"successful\" : 5,\r\n    \"skipped\" : 0,\r\n    \"failed\" : 0\r\n  },\r\n  \"hits\" : {\r\n    \"total\" : 1,\r\n    \"max_score\" : 0.7445889,\r\n    \"hits\" : [\r\n      {\r\n        \"_index\" : \"t1\",\r\n        \"_type\" : \"doc\",\r\n        \"_id\" : \"1\",\r\n        \"_score\" : 0.7445889,\r\n        \"_source\" : {\r\n          \"title\" : \"中国是世界上人口最多的国家\"\r\n        }\r\n      }\r\n    ]\r\n  }\r\n}</code></pre>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><code>slop</code>间隔你可以根据需要适当改动。</p>\r\n\r\n<h2>match系列之match_phrase_prefix（最左前缀查询）<a href=\"https://www.cnblogs.com/Neeo/articles/10578482.html#674690692\">#</a></h2>\r\n\r\n<p>现在凌晨2点半，单身狗小黑为了缓解寂寞，就准备搜索几个<code>beautiful girl</code>来陪伴自己。但是由于英语没过2级，但单词<code>beautiful</code>拼到<code>bea</code>就不知道往下怎么拼了。这个时候，我们的智能搜索要帮他啊，elasticsearch就看自己的词库有啥事<code>bea</code>开头的词，结果还真发现了两个：<br />\r\n&nbsp;</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">PUT t3/doc/1 { \"title\": \"maggie\", \"desc\": \"beautiful girl you are beautiful so\" } PUT t3/doc/2 { \"title\": \"sun and beach\", \"desc\": \"I like basking on the beach\" }</code></pre>\r\n\r\n<p>但这里用<code>match</code>和<code>match_phrase</code>都不太合适，因为小黑输入的不是完整的词。那怎么办呢？我们用<code>match_phrase_prefix</code>来搞：</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">GET t3/doc/_search { \"query\": { \"match_phrase_prefix\": { \"desc\": \"bea\" } } }</code></pre>\r\n\r\n<p>结果如下：</p>\r\n\r\n<pre>\r\n&nbsp;</pre>\r\n\r\n<pre>\r\n<code class=\"language-json\">{\r\n  \"took\" : 1,\r\n  \"timed_out\" : false,\r\n  \"_shards\" : {\r\n    \"total\" : 5,\r\n    \"successful\" : 5,\r\n    \"skipped\" : 0,\r\n    \"failed\" : 0\r\n  },\r\n  \"hits\" : {\r\n    \"total\" : 2,\r\n    \"max_score\" : 0.39556286,\r\n    \"hits\" : [\r\n      {\r\n        \"_index\" : \"t3\",\r\n        \"_type\" : \"doc\",\r\n        \"_id\" : \"1\",\r\n        \"_score\" : 0.39556286,\r\n        \"_source\" : {\r\n          \"title\" : \"maggie\",\r\n          \"desc\" : \"beautiful girl,you are beautiful so\"\r\n        }\r\n      },\r\n      {\r\n        \"_index\" : \"t3\",\r\n        \"_type\" : \"doc\",\r\n        \"_id\" : \"2\",\r\n        \"_score\" : 0.2876821,\r\n        \"_source\" : {\r\n          \"title\" : \"sun and beach\",\r\n          \"desc\" : \"I like basking on the beach\"\r\n        }\r\n      }\r\n    ]\r\n  }\r\n}</code></pre>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>前缀查询是短语查询类似，但前缀查询可以更进一步的搜索词组，只不过它是和词组中最后一个词条进行前缀匹配（如搜这样的<code>you are bea</code>）。应用也非常的广泛，比如搜索框的提示信息，当使用这种行为进行搜索时，最好通过<code>max_expansions</code>来设置最大的前缀扩展数量，因为产生的结果会是一个很大的集合，不加限制的话，影响查询性能。</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">GET t3/doc/_search { \"query\": { \"match_phrase_prefix\": { \"desc\": { \"query\": \"bea\", \"max_expansions\": 1 } } } }</code></pre>\r\n\r\n<p>但是，如果此时你去尝试加上<code>max_expansions</code>测试后，你会发现并没有如你想想的一样，仅返回一条数据，而是返回了多条数据。<br />\r\n<code>max_expansions</code>执行的是搜索的编辑（Levenshtein）距离。那什么是编辑距离呢？编辑距离是一种计算两个字符串间的差异程度的字符串度量（string metric）。我们可以认为编辑距离就是从一个字符串修改到另一个字符串时，其中编辑单个字符（比如修改、插入、删除）所需要的最少次数。俄罗斯科学家Vladimir Levenshtein于1965年提出了这一概念。<br />\r\n我们再引用elasticsearch官网的一段话：<strong>该max_expansions设置定义了在停止搜索之前模糊查询将匹配的最大术语数，也可以对模糊查询的性能产生显着影响。但是，减少查询字词会产生负面影响，因为查询提前终止可能无法找到某些有效结果。重要的是要理解max_expansions查询限制在分片级别工作，这意味着即使设置为1，多个术语可能匹配，所有术语都来自不同的分片。此行为可能使其看起来好像max_expansions没有生效，因此请注意，计算返回的唯一术语不是确定是否有效的有效方法max_expansions。</strong>。<br />\r\n我想你也没看懂这句话是啥意思，但我们只需知道该参数工作于分片层，也就是Lucene部分，超出我们的研究范围了。<br />\r\n我们快刀斩乱麻的记住，使用前缀查询会非常的影响性能，要对结果集进行限制，就加上这个参数。</p>\r\n\r\n<h2>match系列之multi_match（多字段查询）</h2>\r\n\r\n<p>现在，我们有一个50个字段的索引，我们要在多个字段中查询同一个关键字，该怎么做呢？</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">PUT t3/doc/1 { \"title\": \"maggie is beautiful girl\", \"desc\": \"beautiful girl you are beautiful so\" } PUT t3/doc/2 { \"title\": \"beautiful beach\", \"desc\": \"I like basking on the beach,and you? beautiful girl\" }</code></pre>\r\n\r\n<p>我们先用原来的方法查询：</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">GET t3/doc/_search { \"query\": { \"bool\": { \"must\": [ { \"match\": { \"title\": \"beautiful\" } }, { \"match\": { \"desc\": \"beautiful\" } } ] } } }</code></pre>\r\n\r\n<p>使用<code>must</code>来限制两个字段（值）中必须同时含有关键字。这样虽然能达到目的，但是当有很多的字段呢，我们可以用<code>multi_match</code>来做：</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">GET t3/doc/_search { \"query\": { \"multi_match\": { \"query\": \"beautiful\", \"fields\": [\"title\", \"desc\"] } } }\r\n</code></pre>\r\n\r\n<p>我们将多个字段放到<code>fields</code>列表中即可。以达到匹配多个字段的目的。<br />\r\n除此之外，<code>multi_match</code>甚至可以当做<code>match_phrase</code>和<code>match_phrase_prefix</code>使用，只需要指定<code>type</code>类型即可：</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">GET t3/doc/_search { \"query\": { \"multi_match\": { \"query\": \"gi\", \"fields\": [\"title\"], \"type\": \"phrase_prefix\" } } } GET t3/doc/_search { \"query\": { \"multi_match\": { \"query\": \"girl\", \"fields\": [\"title\"], \"type\": \"phrase\" } } }</code></pre>\r\n\r\n<p>小结：</p>\r\n\r\n<ul>\r\n	<li>match：返回所有匹配的分词。</li>\r\n	<li>match_all：查询全部。</li>\r\n	<li>match_phrase：短语查询，在match的基础上进一步查询词组，可以指定<code>slop</code>分词间隔。</li>\r\n	<li>match_phrase_prefix：前缀查询，根据短语中最后一个词组做前缀匹配，可以应用于搜索提示，但注意和<code>max_expanions</code>搭配。其实默认是50.......</li>\r\n	<li>multi_match：多字段查询，使用相当的灵活，可以完成<code>match_phrase</code>和<code>match_phrase_prefix</code>的工作。</li>\r\n</ul>\r\n\r\n<h1>term查询</h1>\r\n\r\n<p>默认情况下，elasticsearch在对文档分析期间（将文档分词后保存到倒排索引中），会对文档进行分词，比如默认的标准分析器会对文档进行：</p>\r\n\r\n<ul>\r\n	<li>删除大多数的标点符号。</li>\r\n	<li>将文档分解为单个词条，我们称为token。</li>\r\n	<li>将token转为小写。</li>\r\n</ul>\r\n\r\n<p>完事再保存到倒排索引上，当然，原文件还是要保存一分的，而倒排索引使用来查询的。<br />\r\n例如<code>Beautiful girl!</code>，在经过分析后是这样的了：</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">POST _analyze { \"analyzer\": \"standard\", \"text\": \"Beautiful girl!\" } # 结果 [\"beautiful\", \"girl\"] </code></pre>\r\n\r\n<p>而当在使用match查询时，elasticsearch同样会对查询关键字进行分析：</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">PUT w10 { \"mappings\": { \"doc\":{ \"properties\":{ \"t1\":{ \"type\": \"text\" } } } } } PUT w10/doc/1 { \"t1\": \"Beautiful girl!\" } PUT w10/doc/2 { \"t1\": \"sexy girl!\" } GET w10/doc/_search { \"query\": { \"match\": { \"t1\": \"Beautiful girl!\" } } }</code></pre>\r\n\r\n<p>也就是对查询关键字<code>Beautiful girl!</code>进行分析，得到<code>[&quot;beautiful&quot;, &quot;girl&quot;]</code>，然后分别将这两个单独的token去索引<code>w10</code>中进行查询，结果就是将两篇文档都返回。</p>\r\n\r\n<p>这在有些情况下是非常好用的，但是，如果我们想查询确切的词怎么办？也就是精确查询，将<code>Beautiful girl!</code>当成一个token而不是分词后的两个token。</p>\r\n\r\n<p>这就要用到了term查询了，term查询的是没有经过分析的查询关键字。</p>\r\n\r\n<p>但是，这同样需要限制，如果你要查询的字段类型（如上例中的字段<code>t1</code>类型是<code>text</code>）是<code>text</code>（因为elasticsearch会对文档进行分析，上面说过），那么你得到的可能是不尽如人意的结果或者压根没有结果：</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">GET w10/doc/_search { \"query\": { \"term\": { \"t1\": \"Beautiful girl!\" } } }</code></pre>\r\n\r\n<p>如上面的查询，将不会有结果返回，因为索引<code>w10</code>中的两篇文档在经过elasticsearch分析后没有一个分词是<code>Beautiful girl!</code>，那此次查询结果为空也就好理解了。</p>\r\n\r\n<p>所以，我们这里得到一个论证结果：<strong>不要使用term对类型是text的字段进行查询</strong>，要查询text类型的字段，请改用match查询。</p>\r\n\r\n<p>学会了吗？那再来一个示例，你说一下结果是什么：</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">GET w10/doc/_search { \"query\": { \"term\": { \"t1\": \"Beautiful\" } } }</code></pre>\r\n\r\n<p>答案是，没有结果返回！因为elasticsearch在对文档进行分析时，会经过小写！人家倒排索引上存的是小写的<code>beautiful</code>，而我们查询的是大写的<code>Beautiful</code>。</p>\r\n\r\n<p>所以，要想有结果你这样：</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">GET w10/doc/_search { \"query\": { \"term\": { \"t1\": \"beautiful\" } } }</code></pre>\r\n\r\n<p>那，term查询可以查询哪些类型的字段呢，例如elasticsearch会将keyword类型的字段当成一个token保存到倒排索引上，你可以将term和keyword结合使用。</p>\r\n\r\n<p>最后，要想使用term查询多个精确的值怎么办？我只能说：亲，这里推荐卸载es呢！低调又不失尴尬的玩笑！</p>\r\n\r\n<p>这里推荐使用<code>terms</code>查询：</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">GET w10/doc/_search { \"query\": { \"terms\": { \"t1\": [\"beautiful\", \"sexy\"] } } }</code></pre>\r\n\r\n<p>&nbsp;</p>',
        '', '2020-01-28 01:53:00', '2020-01-28 01:53:00', 92, 1, 11, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (98, 'elasticsearch之建议器简介',
        '<p>首先，环境是elasticsearch版本是5.x以上。低版本的没有测试！</p>\r\n\r\n<p>目前为止，浏览器都已经具备<code>Suggest as you type</code>功能，即在我们输入搜索的过程中，进行自动的补全或者纠错功能，协助用户输入更精确的关键词，提高搜索阶段的文档匹配程度。例如我们在百度或谷歌浏览器输入搜索关键词时，虽然我们输入的有误，但是浏览器依然能够提示出我们想要的正确结果。</p>\r\n\r\n<p><img src=\"https://cdn.ch3nnn.cn/upload/2020/05/27/63857f7eb8a247ada42c82b3d4bfafe3.png\" style=\"height:237px; width:600px\" /></p>\r\n\r\n<p><img src=\"https://cdn.ch3nnn.cn/upload/2020/05/27/5f2c396d7106400fa3374171e95a049f.png\" style=\"height:222px; width:600px\" /></p>\r\n\r\n<p>在谷歌浏览器中，再输入刚开始时，会自动补全，而当输入内容达到一定长度时，如果因为单词拼写错误而无法补全时，就开始尝试提示相似的词。</p>\r\n\r\n<p>这些功能，我们能通过elasticsearch实现吗？答案就在Suggesters API中。<br />\r\n在elasticsearch中，建议功能通过使用建议器基于提供的文本建议类似的词（官网说部分功能仍在开发中.........）。<br />\r\n注意，目前<code>_suggest</code>已经弃用，我们可以通过<code>_search</code>来做建议器的查询。在5.0版本中，<code>_search</code>经过优化，变得非常的方便。</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">PUT s1\r\n{\r\n  \"mappings\": {\r\n    \"doc\": {\r\n      \"properties\": {\r\n        \"title\": {\r\n          \"type\": \"text\",\r\n          \"analyzer\": \"standard\"\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nPUT s1/doc/1\r\n{\r\n  \"title\": \"Lucene is cool\"\r\n}\r\n\r\nPUT s1/doc/2\r\n{\r\n  \"title\":\"Elasticsearch builds on top of lucene\"\r\n}\r\n\r\nGET s1/doc/_search\r\n{\r\n  \"query\": {\r\n    \"match\": {\r\n      \"title\": \"Lucene\"\r\n    }\r\n  },\r\n  \"suggest\": {\r\n    \"my_suggest\": {\r\n      \"text\": \"Elasticsear lucen\",\r\n      \"term\": {\r\n        \"field\": \"title\"\r\n      }\r\n    }\r\n  }\r\n}</code></pre>\r\n\r\n<p>上例是一个包含建议的查询请求，查询<code>query</code>我们已经了然。<br />\r\n让我们注意<code>suggest</code>，每个建议器都有自己名称<code>my-suggestion</code>，es根据<code>text</code>字段返回建议结果。建议类型是<code>term</code>。从<code>field</code>字段生成建议。</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">{\r\n  \"took\" : 3,\r\n  \"timed_out\" : false,\r\n  \"_shards\" : {\r\n    \"total\" : 5,\r\n    \"successful\" : 5,\r\n    \"skipped\" : 0,\r\n    \"failed\" : 0\r\n  },\r\n  \"hits\" : {\r\n    \"total\" : 2,\r\n    \"max_score\" : 0.2876821,\r\n    \"hits\" : [\r\n      {\r\n        \"_index\" : \"s1\",\r\n        \"_type\" : \"doc\",\r\n        \"_id\" : \"2\",\r\n        \"_score\" : 0.2876821,\r\n        \"_source\" : {\r\n          \"title\" : \"Elasticsearch builds on top of lucene\"\r\n        }\r\n      },\r\n      {\r\n        \"_index\" : \"s1\",\r\n        \"_type\" : \"doc\",\r\n        \"_id\" : \"1\",\r\n        \"_score\" : 0.2876821,\r\n        \"_source\" : {\r\n          \"title\" : \"Lucene is cool\"\r\n        }\r\n      }\r\n    ]\r\n  },\r\n  \"suggest\" : {\r\n    \"my_suggest\" : [\r\n      {\r\n        \"text\" : \"elasticsear\",\r\n        \"offset\" : 0,\r\n        \"length\" : 11,\r\n        \"options\" : [\r\n          {\r\n            \"text\" : \"elasticsearch\",\r\n            \"score\" : 0.8181818,\r\n            \"freq\" : 1\r\n          }\r\n        ]\r\n      },\r\n      {\r\n        \"text\" : \"lucen\",\r\n        \"offset\" : 12,\r\n        \"length\" : 5,\r\n        \"options\" : [\r\n          {\r\n            \"text\" : \"lucene\",\r\n            \"score\" : 0.8,\r\n            \"freq\" : 2\r\n          }\r\n        ]\r\n      }\r\n    ]\r\n  }\r\n}</code></pre>\r\n\r\n<p>正如结果所示。对于输入的每个词条的建议结果，es都会放在<code>options</code>中，如果没有建议结果，<code>options</code>将会为空。<br />\r\n如果我们仅需要建议而不需要查询功能，我们可以忽略<code>query</code>而直接使用<code>suggest</code>对象返回建议：</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">GET s1/doc/_search\r\n{\r\n  \"suggest\": {\r\n    \"my_sugget\": {\r\n      \"text\": \"Elasticsear lucen\",\r\n      \"term\": {\r\n        \"field\": \"title\"\r\n      }\r\n    }\r\n  }\r\n}</code></pre>\r\n\r\n<p>可以根据需要指定几组建议器，每组建议器都有自己的名称。如下例的<code>my_suggest1</code>和<code>my_suggest2</code>。</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">GET s1/doc/_search\r\n{\r\n  \"suggest\": {\r\n    \"my_sugget1\": {\r\n      \"text\": \"Elasticsear\",\r\n      \"term\": {\r\n        \"field\": \"title\"\r\n      }\r\n    },\r\n    \"my_suggest2\": {\r\n      \"text\": \"lucen\",\r\n      \"term\": {\r\n        \"field\": \"title\"\r\n      }\r\n    }\r\n  }\r\n}</code></pre>\r\n\r\n<p>在多个建议器中，如果输入的<code>text</code>字段值一致，可以单独写出来，以适用于<code>my_suggest1</code>和<code>my_suggest2</code>两个建议器：</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">GET s1/doc/_search\r\n{\r\n  \"suggest\": {\r\n    \"text\": \"Elasticsear lucen\",\r\n    \"my_sugget1\": {\r\n      \"term\": {\r\n        \"field\": \"title\"\r\n      }\r\n    },\r\n    \"my_suggest2\": {\r\n      \"term\": {\r\n        \"field\": \"title\"\r\n      }\r\n    }\r\n  }\r\n}</code></pre>\r\n\r\n<p>根据需求不同elasticsearch设计了4种suggester，分别是：</p>\r\n\r\n<ul>\r\n	<li><a href=\"https://www.cnblogs.com/Neeo/articles/10694969.html\">词条建议器（term suggester）</a>：对于给定文本的每个词条，该键议器从索引中抽取要建议的关键词，这对于短字段（如分类标签）很有效。</li>\r\n	<li><a href=\"https://www.cnblogs.com/Neeo/articles/10694996.html\">词组建议器（phrase suggester）</a>：我们可以认为它是词条建议器的扩展，为整个文本（而不是单个词条）提供了替代方案，它考虑了各词条彼此临近出现的频率，使得该建议器更适合较长的字段，比如商品的描述。</li>\r\n	<li><a href=\"https://www.cnblogs.com/Neeo/articles/10695019.html\">完成建议器（completion suggester）</a>：该建议器根据词条的前缀，提供自动完成的功能（智能提示，有点最左前缀查询的意思），为了实现这种实时的建议功能，它得到了优化，工作在内存中。所以，速度要比之前说的<code>match_phrase_prefix</code>快的多！</li>\r\n	<li><a href=\"https://www.cnblogs.com/Neeo/articles/10695031.html\">上下文建议器（context suggester）</a>：它是完成建议器的扩展，允许我们根据词条或分类亦或是地理位置对结果进行过滤。</li>\r\n</ul>',
        '', '2020-01-28 02:08:00', '2020-01-28 02:08:00', 105, 1, 11, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (99, 'elasticsearch之term suggester',
        '<p>在建议器简介部分，我们已经对<code>term suggest</code>建议器有所了解。<br />\r\n词条建议器接收输入的文本，对其进行分析并且分为词条，然后为每个词条提供一系列的建议。<br />\r\n准备数据：</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">PUT s2\r\n{\r\n  \"mappings\": {\r\n    \"doc\": {\r\n      \"properties\": {\r\n        \"title\": {\r\n          \"type\": \"text\",\r\n          \"analyzer\": \"standard\"\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nPUT s2/doc/1\r\n{\r\n  \"title\": \"Lucene is cool\"\r\n}\r\n\r\nPUT s2/doc/2\r\n{\r\n  \"title\": \"Elasticsearch builds on top of lucene\"\r\n}\r\n\r\nPUT s2/doc/3\r\n{\r\n  \"title\": \"Elasticsearch rocks\"\r\n}\r\n\r\nPUT s2/doc/4\r\n{\r\n  \"title\": \"Elastic is the company behind ELK stack\"\r\n}\r\n\r\nPUT s2/doc/5\r\n{\r\n  \"title\": \"elk rocks\"\r\n}\r\nPUT s2/doc/6\r\n{\r\n  \"title\": \"elasticsearch is rock solid\"\r\n}</code></pre>\r\n\r\n<p>我们创建一个新的索引并且添加了几条文档。现在，我们来查询一下吧。</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">GET s2/doc/_search\r\n{\r\n  \"suggest\": {\r\n    \"my_suggest\": {\r\n      \"text\": \"luenc\",\r\n      \"term\": {\r\n        \"field\": \"title\"\r\n      }\r\n    }\r\n  }\r\n}</code></pre>\r\n\r\n<p>返回的了建议结果：</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">{\r\n  \"took\" : 3,\r\n  \"timed_out\" : false,\r\n  \"_shards\" : {\r\n    \"total\" : 5,\r\n    \"successful\" : 5,\r\n    \"skipped\" : 0,\r\n    \"failed\" : 0\r\n  },\r\n  \"hits\" : {\r\n    \"total\" : 0,\r\n    \"max_score\" : 0.0,\r\n    \"hits\" : [ ]\r\n  },\r\n  \"suggest\" : {\r\n    \"my_suggest\" : [\r\n      {\r\n        \"text\" : \"luenc\",\r\n        \"offset\" : 0,\r\n        \"length\" : 5,\r\n        \"options\" : [\r\n          {\r\n            \"text\" : \"lucene\",\r\n            \"score\" : 0.6,\r\n            \"freq\" : 2\r\n          }\r\n        ]\r\n      }\r\n    ]\r\n  }\r\n}</code></pre>\r\n\r\n<p>上例中，在<code>options</code>字段中，建议结果是<code>lucene</code>。我们来看看，在建议器中，都有哪些字段。</p>\r\n\r\n<ul>\r\n	<li>text：建议文本，建议文本是必需的选项，可以通过全局（多个建议器中查询相同的内容）或者按照单个建议器的格式来。</li>\r\n	<li>field：从field字段中获取候选建议的字段。这是一个必需的选项，需要全局设置或根据建议设置。</li>\r\n	<li>analyzer：用于分析建议文本的分析器。默认为建议字段的搜索分析器。</li>\r\n	<li>size：个建议文本标记返回的最大条目。</li>\r\n	<li>sort：定义如何根据建议文本术语对建议进行排序。它有两个可能的值。\r\n	<ul>\r\n		<li>score，先按分数排序，然后按文档频率排序，再按术语本身排序。</li>\r\n		<li>frequency，首先按文档频率排序，然后按相似性分数排序，然后按术语本身排序。也可以理解为按照流行度排序。</li>\r\n	</ul>\r\n	</li>\r\n	<li>suggest_mode：控制建议的模式，有3个模式可选择。\r\n	<ul>\r\n		<li>missing，仅为不在索引中的建议文本术语提供建议。这是默认值。</li>\r\n		<li>popular，仅建议在比原始建议文本术语更多的文档中出现的建议。也就是说提供比原有输入词频更高的词条</li>\r\n		<li>always，根据建议文本中的条款建议任何匹配的建议。说白了就是无论如何都会提供建议。</li>\r\n	</ul>\r\n	</li>\r\n	<li>lowercase_terms：在文本分析之后降低建议文本术语的大小写。</li>\r\n	<li>min_word_length：建议文本术语必须具有的最小长度才能包含在内。默认为4.（旧名称<code>min_word_len</code>已弃用）。</li>\r\n	<li>shard_size：设置从每个单独分片中检索的最大建议数。在减少阶段，仅根据size选项返回前N个建议。默认为该 size选项。将此值设置为高于该值的值size可能非常有用，以便以性能为代价获得更准确的拼写更正文档频率。由于术语在分片之间被划分，因此拼写校正频率的分片级文档可能不准确。增加这些将使这些文档频率更精确。</li>\r\n	<li>max_inspections：用于乘以的因子， shards_size以便在碎片级别上检查更多候选拼写更正。可以以性能为代价提高准确性。默认为5。</li>\r\n	<li>string_distance：用于比较类似建议术语的字符串距离实现。\r\n	<ul>\r\n		<li>internal，默认值基于damerau_levenshtein，但高度优化用于比较索引中术语的字符串距离。</li>\r\n		<li>damerau_levenshtein，基于Damerau-Levenshtein算法的字符串距离算法。</li>\r\n		<li>levenshtein，基于Levenshtein编辑距离算法的字符串距离算法。</li>\r\n		<li>jaro_winkler，基于Jaro-Winkler算法的字符串距离算法。</li>\r\n		<li>ngram，基于字符n-gram的字符串距离算法。</li>\r\n	</ul>\r\n	</li>\r\n</ul>\r\n\r\n<h3>选择哪些词条被建议</h3>\r\n\r\n<p>了解了各字段的大致含义，我们来探讨一下，词条建议器是如何运作的。以便理解如何确定哪些建议将成为第一名。<br />\r\n词条建议器使用了Lucene的错拼检查器模块，该模块会根据给定词条的<strong>编辑距离</strong>（es使用了叫做Levenstein edit distance的算法，其核心思想就是一个词改动多少字符就可以和另外一个词一致），从索引中返回最大编辑距离不超过某个值的那些词条。比如说为了从<code>mik</code>得到<code>mick</code>，需要加入一个字母（也就是说需要至少要改动一次），所以这两个词的编辑距离就是1。我们可以通过配置一系列的选项，来均衡灵活和性能：</p>\r\n\r\n<ul>\r\n	<li>max_edits：最大编辑距离候选建议可以具有以便被视为建议。只能是介于1和2之间的值。任何其他值都会导致抛出错误的请求错误。默认为2。</li>\r\n	<li>prefix_length：必须匹配的最小前缀字符的数量才是候选建议。默认为1.增加此数字可提高拼写检查性能。通常拼写错误不会出现在术语的开头。（旧名<code>prefix_len</code>已弃用）。</li>\r\n	<li>min_doc_freq：建议应出现的文档数量的最小阈值。可以指定为绝对数字或文档数量的相对百分比。这可以仅通过建议高频项来提高质量。默认为0f且未启用。如果指定的值大于1，则该数字不能是小数。分片级文档频率用于此选项。</li>\r\n	<li>max_term_freq：建议文本令牌可以存在的文档数量的最大阈值，以便包括在内。可以是表示文档频率的相对百分比数（例如0.4）或绝对数。如果指定的值大于1，则不能指定小数。默认为0.01f。这可用于排除高频术语的拼写检查。高频术语通常拼写正确，这也提高了拼写检查的性能。分片级文档频率用于此选项。</li>\r\n</ul>\r\n\r\n<p>小结，<code>term suggester</code>首先将输入文本经过分析器（所以，分析结果由于采用的分析器不同而有所不同）分析，处理为单个词条，然后根据单个词条去提供建议，并不会考虑多个词条之间的关系。然后将每个词条的建议结果（有或没有）封装到<code>options</code>列表中。最后由建议器统一返回。</p>',
        '', '2020-01-28 02:27:00', '2020-01-28 02:27:00', 104, 1, 11, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (100, 'elasticsearch之phrase suggester',
        '<p>词组建议器和词条建议器一样，不过它不再为单个词条提供建议，而是为整个文本提供建议。<br />\r\n准备数据：</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">PUT s4\r\n{\r\n  \"mappings\": {\r\n    \"doc\": {\r\n      \"properties\": {\r\n        \"title\": {\r\n          \"type\": \"text\",\r\n          \"analyzer\": \"standard\"\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nPUT s4/doc/1\r\n{\r\n  \"title\": \"Lucene is cool\"\r\n}\r\n\r\nPUT s4/doc/2\r\n{\r\n  \"title\": \"Elasticsearch builds on top of lucene\"\r\n}\r\n\r\nPUT s4/doc/3\r\n{\r\n  \"title\": \"Elasticsearch rocks\"\r\n}\r\n\r\nPUT s4/doc/4\r\n{\r\n  \"title\": \"Elastic is the company behind ELK stack\"\r\n}\r\n\r\nPUT s4/doc/5\r\n{\r\n  \"title\": \"elk rocks\"\r\n}\r\n\r\nPUT s4/doc/6\r\n{\r\n  \"title\": \"elasticsearch is rock solid\"\r\n}</code></pre>\r\n\r\n<p>现在我们来看看<code>phrase</code>是如何建议的：</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">GET s4/doc/_search\r\n{\r\n  \"suggest\": {\r\n    \"my_s4\": {\r\n      \"text\": \"lucne and elasticsear rock\",\r\n      \"phrase\": {\r\n        \"field\": \"title\"\r\n      }\r\n    }\r\n  }\r\n}</code></pre>\r\n\r\n<p><code>text</code>是输入带有拼错的文本。而建议类型则换成了<code>phrase</code>。来看查询结果：</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">{\r\n  \"took\" : 6,\r\n  \"timed_out\" : false,\r\n  \"_shards\" : {\r\n    \"total\" : 5,\r\n    \"successful\" : 5,\r\n    \"skipped\" : 0,\r\n    \"failed\" : 0\r\n  },\r\n  \"hits\" : {\r\n    \"total\" : 0,\r\n    \"max_score\" : 0.0,\r\n    \"hits\" : [ ]\r\n  },\r\n  \"suggest\" : {\r\n    \"my_s4\" : [\r\n      {\r\n        \"text\" : \"lucne and elasticsear rock\",\r\n        \"offset\" : 0,\r\n        \"length\" : 26,\r\n        \"options\" : [\r\n          {\r\n            \"text\" : \"lucne and elasticsearch rocks\",\r\n            \"score\" : 0.12709484\r\n          },\r\n          {\r\n            \"text\" : \"lucne and elasticsearch rock\",\r\n            \"score\" : 0.10422645\r\n          },\r\n          {\r\n            \"text\" : \"lucne and elasticsear rocks\",\r\n            \"score\" : 0.10036137\r\n          }\r\n        ]\r\n      }\r\n    ]\r\n  }\r\n}</code></pre>\r\n\r\n<p>可以看到<code>options</code>直接返回了相关短语列表。虽然<code>lucene</code>建议的并不好。但<code>elasticserch</code>和<code>rock</code>很不错。除此之外，我们还可以使用高亮来向用户展示哪些原有的词条被纠正了。</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">GET s4/doc/_search\r\n{\r\n  \"suggest\": {\r\n    \"my_s4\": {\r\n      \"text\": \"lucne and elasticsear rock\",\r\n      \"phrase\": {\r\n        \"field\": \"title\",\r\n        \"highlight\":{\r\n          \"pre_tag\":\"&lt;em&gt;\",\r\n          \"post_tag\":\"&lt;/em&gt;\"\r\n        }\r\n      }\r\n    }\r\n  }\r\n}</code></pre>\r\n\r\n<p>除了默认的，还可以自定义高亮显示：</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">GET s4/doc/_search\r\n{\r\n  \"suggest\": {\r\n    \"my_s4\": {\r\n      \"text\": \"lucne and elasticsear rock\",\r\n      \"phrase\": {\r\n        \"field\": \"title\",\r\n        \"highlight\":{\r\n          \"pre_tag\":\"&lt;b id=\'d1\' class=\'t1\' style=\'color:red;font-size:18px;\'&gt;\",\r\n          \"post_tag\":\"&lt;/b&gt;\"\r\n        }\r\n      }\r\n    }\r\n  }\r\n}</code></pre>\r\n\r\n<p>需要注意的是，建议器结果的高亮显示和查询结果高亮显示有些许区别，比如说，这里的自定义标签是<code>pre_tag</code>和<code>post_tag</code>而不是之前如这样的：</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">GET s4/doc/_search\r\n{\r\n  \"query\": {\r\n    \"match\": {\r\n      \"title\": \"rock\"\r\n    }\r\n  },\r\n  \"highlight\": {\r\n    \"pre_tags\": \"&lt;b style=\'color:red\'&gt;\",\r\n    \"post_tags\": \"&lt;/b&gt;\",\r\n    \"fields\": {\r\n      \"title\": {}\r\n    }\r\n  }\r\n}</code></pre>\r\n\r\n<p><code>phrase suggester</code>在<code>term suggester</code>的基础上，会考虑多个<code>term</code>之间的关系，比如是否同时出现索引的原文中，临近程度，词频等。</p>',
        '', '2020-01-28 02:32:00', '2020-01-28 02:32:00', 129, 1, 11, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (101, 'elasticsearch之completion suggester',
        '<h1>前言</h1>\r\n\r\n<p>我们来看一下自动完成的建议器&mdash;&mdash;是一个导航功能，提供自动完成、搜索功能，可以在用户输入时引导用户查看相关结果，从而提高搜索精度。但并不适用于拼接检查或者像<code>term</code>和<code>phrase</code>建议那样的功能。<br />\r\n如果说在2000年左右，自动完成还是很炫酷的功能，那么现在它是必备的了&mdash;&mdash;任何没有自动完成功能的搜索引擎都是很古老的。用户期望一个良好的自动完成来帮助用户实现更快的（特别是移动端）以及更好的（比如输入<code>e</code>，搜索引擎就应该知道用户想要查找的是<code>elasticsearch</code>）搜索。<br />\r\n一个优秀的自动完成将降低搜索引擎的负载，特别是在用户有一些快速搜索可用时，也就是直接跳转到主流的搜索结果而无须执行完整的搜索。</p>\r\n\r\n<h1>完成建议器：completion suggester</h1>\r\n\r\n<p>为了告诉elasticsearch我们准备将建议存储在自动完成的FST中，需要在映射中定义一个字段并将其<code>type</code>类型设置为<code>completion</code>：</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">PUT s5\r\n{\r\n  \"mappings\":{\r\n    \"doc\":{\r\n      \"properties\": {\r\n        \"title\": {\r\n          \"type\": \"completion\",\r\n          \"analyzer\": \"standard\"\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nPUT s5/doc/1\r\n{\r\n  \"title\":\"Lucene is cool\"\r\n}\r\n\r\nPUT s5/doc/2\r\n{\r\n  \"title\":\"Elasticsearch builds on top of lucene\"\r\n}\r\n\r\nPUT s5/doc/3\r\n{\r\n  \"title\":\"Elasticsearch rocks\"\r\n}\r\n\r\nPUT s5/doc/4\r\n{\r\n  \"title\":\"Elastic is the company behind ELK stack\"\r\n}\r\n\r\nPUT s5/doc/5\r\n{\r\n  \"title\":\"the elk stack rocks\"\r\n}\r\n\r\nPUT s5/doc/6\r\n{\r\n  \"title\":\"elasticsearch is rock solid\"\r\n}\r\n\r\nGET s5/doc/_search\r\n{\r\n  \"suggest\": {\r\n    \"my_s5\": {\r\n      \"text\": \"elas\",\r\n      \"completion\": {\r\n        \"field\": \"title\"\r\n      }\r\n    }\r\n  }\r\n}</code></pre>\r\n\r\n<p>建议结果不展示了！<br />\r\n上例的特殊映射中，支持以下参数：</p>\r\n\r\n<ul>\r\n	<li>analyzer，要使用的索引分析器，默认为simple。</li>\r\n	<li>search_analyzer，要使用的搜索分析器，默认值为analyzer。</li>\r\n	<li>preserve_separators，保留分隔符，默认为true。 如果您禁用，您可以找到以Foo Fighters开头的字段，如果您建议使用foof。</li>\r\n	<li>preserve_position_increments，启用位置增量，默认为true。如果禁用并使用停用词分析器The Beatles，如果您建议，可以从一个字段开始b。注意：您还可以通过索引两个输入来实现此目的，Beatles并且 The Beatles，如果您能够丰富数据，则无需更改简单的分析器。</li>\r\n	<li>max_input_length，限制单个输入的长度，默认为50UTF-16代码点。此限制仅在索引时使用，以减少每个输入字符串的字符总数，以防止大量输入膨胀基础数据结构。大多数用例不受默认值的影响，因为前缀完成很少超过前缀长于少数几个字符。</li>\r\n</ul>\r\n\r\n<p>除此之外，该建议映射还可以定义在已存在索引字段的多字段：</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">PUT s6\r\n{\r\n  \"mappings\": {\r\n    \"doc\": {\r\n      \"properties\": {\r\n        \"name\": {\r\n          \"type\": \"text\",\r\n          \"fields\": {\r\n            \"suggest\": {\r\n              \"type\": \"completion\"\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nPUT s6/doc/1\r\n{\r\n  \"name\":\"KFC\"\r\n}\r\nPUT s6/doc/2\r\n{\r\n  \"name\":\"kfc\"\r\n}\r\n\r\nGET s6/doc/_search\r\n{\r\n  \"suggest\": {\r\n    \"my_s6\": {\r\n      \"text\": \"K\",\r\n      \"completion\": {\r\n        \"field\": \"name.suggest\"\r\n      }\r\n    }\r\n  }\r\n}</code></pre>\r\n\r\n<p>如上示例中，我们需要索引餐厅这样的地点，而且每个地点的<code>name</code>名称字段添加<code>suggest</code>子字段。<br />\r\n上例的查询将肯德基（KFC）和开封菜（kfc）都返回。</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">PUT s7\r\n{\r\n  \"mappings\": {\r\n    \"doc\": {\r\n      \"properties\": {\r\n        \"name\": {\r\n          \"type\": \"text\",\r\n          \"fields\": {\r\n            \"suggest\": {\r\n              \"type\": \"completion\",\r\n              \"analyzer\":\"keyword\",\r\n              \"search_analyzer\":\"keyword\"\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nPUT s7/doc/1\r\n{\r\n  \"name\":\"KFC\"\r\n}\r\nPUT s7/doc/2\r\n{\r\n  \"name\":\"kfc\"\r\n}\r\nGET s7/doc/_search\r\n{\r\n  \"suggest\": {\r\n    \"my_s7\": {\r\n      \"text\": \"K\",\r\n      \"completion\": {\r\n        \"field\": \"name.suggest\"\r\n      }\r\n    }\r\n  }\r\n}</code></pre>\r\n\r\n<p>建议结果如下：</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">{\r\n  \"took\" : 0,\r\n  \"timed_out\" : false,\r\n  \"_shards\" : {\r\n    \"total\" : 5,\r\n    \"successful\" : 5,\r\n    \"skipped\" : 0,\r\n    \"failed\" : 0\r\n  },\r\n  \"hits\" : {\r\n    \"total\" : 0,\r\n    \"max_score\" : 0.0,\r\n    \"hits\" : [ ]\r\n  },\r\n  \"suggest\" : {\r\n    \"my_s7\" : [\r\n      {\r\n        \"text\" : \"K\",\r\n        \"offset\" : 0,\r\n        \"length\" : 1,\r\n        \"options\" : [\r\n          {\r\n            \"text\" : \"KFC\",\r\n            \"_index\" : \"s7\",\r\n            \"_type\" : \"doc\",\r\n            \"_id\" : \"1\",\r\n            \"_score\" : 1.0,\r\n            \"_source\" : {\r\n              \"name\" : \"KFC\"\r\n            }\r\n          }\r\n        ]\r\n      }\r\n    ]\r\n  }\r\n}</code></pre>\r\n\r\n<p>上述的建议结果中，只有<code>KFC</code>被返回。更多的细节控制可以搭配不同的分析器来完成。<br />\r\n多数的情况下，我们将在单独的字段中、单独的索引中甚至是单独的集群中保存建议。这对于主搜索引擎的性能提升和扩展建议器都是非常有利的。</p>\r\n\r\n<p>除此之外，还可以使用<code>input</code>和可选的<code>weight</code>属性，<code>input</code>是建议查询匹配的预期文本，<code>weight</code>是建议评分方式（也就是权重）。例如：</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">PUT s8\r\n{\r\n  \"mappings\": {\r\n    \"doc\":{\r\n      \"properties\":{\r\n        \"title\":{\r\n          \"type\": \"completion\"\r\n        }\r\n      }\r\n    }\r\n  }\r\n}</code></pre>\r\n\r\n<p>添加数据的几种形式：</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">PUT s8/doc/1\r\n{\r\n  \"title\":{\r\n    \"input\":\"blow\",\r\n    \"weight\": 2\r\n  }\r\n}\r\nPUT s8/doc/2\r\n{\r\n  \"title\":{\r\n    \"input\":\"block\",\r\n    \"weight\": 3\r\n  }\r\n}</code></pre>\r\n\r\n<p>上例分别添加两个建议并设置各自的权重值。</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">PUT s8/doc/3\r\n{\r\n  \"title\": [  \r\n    {\r\n      \"input\":\"appel\",\r\n      \"weight\": 2\r\n    },\r\n    {\r\n      \"input\":\"apple\",\r\n      \"weight\": 3\r\n    }\r\n  ]\r\n}</code></pre>\r\n\r\n<p>上例以列表的形式添加建议，设置不同的权重。</p>\r\n\r\n<pre>\r\n上例是为多个建议设置相同的权重。\r\n查询的结果由权重决定：\r\n</pre>\r\n\r\n<pre>\r\n<code class=\"language-json\">GET s8/doc/_search\r\n{\r\n  \"suggest\": {\r\n    \"my_s8\": {\r\n      \"text\": \"app\",\r\n      \"completion\": {\r\n        \"field\": \"title\"\r\n      }\r\n    }\r\n  }\r\n}</code></pre>\r\n\r\n<h2>其他</h2>\r\n\r\n<p><strong>_source</strong><br />\r\n为了减少不必要的响应，我们可以对建议结果做一些过滤，比如加上<code>_source</code>：</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">GET s8/doc/_search\r\n{\r\n  \"suggest\": {\r\n    \"completion_suggest\": {\r\n      \"text\": \"appl\",\r\n      \"completion\": {\r\n        \"field\": \"title\"\r\n      }\r\n    }\r\n  },\r\n  \"_source\": \"title\"\r\n}</code></pre>\r\n\r\n<p>好吧，虽然我们只有一个字段！</p>\r\n\r\n<p><strong>size</strong><br />\r\n除了<code>_source</code>，我们还可以指定<code>size</code>参数：</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">GET s8/doc/_search\r\n{\r\n  \"suggest\": {\r\n    \"completion_suggest\": {\r\n      \"prefix\": \"app\",\r\n      \"completion\": {\r\n        \"field\": \"title\",\r\n        \"size\": 1\r\n      }\r\n    }\r\n  },\r\n  \"_source\": \"title\"\r\n}</code></pre>\r\n\r\n<pre>\r\n<code>size</code>参数指定返回建议数（默认为5），需要注意的是，<code>size must be positive</code>，也就是说<code>size</code>参数必须是积极的&mdash;&mdash;非0非负数！\r\n\r\n<strong>skip_duplicates</strong>\r\n我们的建议可能是来自不同的文档，这其中就会有一些重复建议项，我们可以通过设置<code>skip_duplicates:true</code>来修改此行为，如果为<code>true</code>则会过滤掉结果中的重复建议文档：</pre>\r\n\r\n<pre>\r\n<code class=\"language-json\">GET s8/doc/_search\r\n{\r\n  \"suggest\": {\r\n    \"completion_suggest\": {\r\n      \"prefix\": \"app\",\r\n      \"completion\": {\r\n        \"field\": \"title\",\r\n        \"size\": 5,\r\n        \"skip_duplicates\":true\r\n      }\r\n    }\r\n  },\r\n  \"_source\": \"title\"\r\n}</code></pre>\r\n\r\n<p>但需要注意的是，该参数设置为<code>true</code>的话，可能会降低搜索速度，因为需要访问更多的建议结果项，才能过滤出来前N个。<br />\r\n最后，完成建议器还支持正则表达式查询，这意味着我们可以将前缀表示为正则表达式：</p>\r\n\r\n<pre>\r\n<code class=\"language-json\">GET s5/doc/_search\r\n{\r\n  \"suggest\": {\r\n    \"completion_suggest\": {\r\n      \"regex\": \"e[l|e]a\",\r\n      \"completion\": {\r\n        \"field\": \"title\"\r\n      }\r\n    }\r\n  }\r\n}</code></pre>\r\n\r\n<p>&nbsp;</p>',
        '', '2020-01-28 02:37:00', '2020-01-28 02:37:00', 81, 1, 11, 0, 0, 0);
INSERT INTO `tb_content`
VALUES (102, '关于博客',
        '<h1><strong>DjangoBlog</strong></h1>\r\n\r\n<p>基于<code>python3.7</code>和<code>Django2.1</code>的博客。</p>\r\n\r\n<h2><strong>主要功能</strong>：</h2>\r\n\r\n<ul>\r\n	<li>网站容器化部署。</li>\r\n	<li>文章，页面，分类目录，标签的添加，删除，编辑等。文章及页面支持富文本编辑，支持代码高亮。</li>\r\n	<li>侧边栏功能，搜索入口, 最新文章，最多阅读，标签云,&nbsp; 游客当地天气温度等。</li>\r\n	<li>采用elasticsearch支持文章全文搜索, 关键字纠正,&nbsp; 高亮, 标题前缀建议。</li>\r\n	<li>完整的评论功能。</li>\r\n	<li><code>采用Redis</code>缓存，支持缓存自动刷新。</li>\r\n	<li>SEO功能，新建文章等会自动通知Google和百度。</li>\r\n	<li>自定义存储系统, 集成CDN加速功能。</li>\r\n	<li>实现全站静态化处理。</li>\r\n	<li>适配移动端页面和PC端页面。</li>\r\n</ul>\r\n\r\n<hr />\r\n<h1><strong>更新日志</strong></h1>\r\n\r\n<h2>v2.1</h2>\r\n\r\n<p><strong>2020/04/24</strong></p>\r\n\r\n<p>主要修复和优化新增了如下功能:</p>\r\n\r\n<ul>\r\n	<li>实现页面静态化</li>\r\n	<li>优化将搜索替换为es搜索引擎</li>\r\n	<li>自定义存储系统实现cdn加速</li>\r\n	<li>优化分页功能</li>\r\n	<li>界面调整。</li>\r\n</ul>\r\n\r\n<h2>v2.0</h2>\r\n\r\n<p><strong>2020/02/17</strong><br />\r\n这个版本修复了大量的bug，将服务器从阿里云迁移到腾讯云。 主要修复和优化了如下功能:</p>\r\n\r\n<ul>\r\n	<li>实现Docker-compose 编排。</li>\r\n	<li>实现网站页面缓存</li>\r\n	<li>增加文章归档功能</li>\r\n	<li>移动端和PC端页面适配</li>\r\n	<li>增加游客实时当地天气情况</li>\r\n</ul>\r\n\r\n<h2>v1.4</h2>\r\n\r\n<p><strong>2019/12/20</strong></p>\r\n\r\n<p>这个版本修复了大量的bug并记录一次服务器被黑。 主要疏忽大意, 吸取教训.&nbsp;&nbsp;总结如下:</p>\r\n\r\n<blockquote>\r\n<p>为了实现网站缓存, 起了Docker的redis容器,&nbsp;&nbsp;没有修改默认端口和无用户认证, 测试完忘记关掉安全组. 导致黑客通过redis获得服务器权限, 在Docker起了挖矿服务, 阿里云发送服务器异常邮件, 发现CPU飙到99%。</p>\r\n</blockquote>\r\n\r\n<ul>\r\n	<li>修复: 排查修改服务默认端口, 开放指定安全组</li>\r\n	<li>修复:&nbsp;ALLOWED_HOSTS 限定请求中的host值，以防止黑客构造包来发送请求</li>\r\n</ul>\r\n\r\n<h2>v1.3</h2>\r\n\r\n<p><strong>2019/09/25</strong></p>\r\n\r\n<p>主要优化修复新增了如下几个问题：</p>\r\n\r\n<ul>\r\n	<li>增加: simpleui django-admin主题</li>\r\n	<li>增加: 首页看板娘插件</li>\r\n	<li>增加:&nbsp;站长统计为百度统计</li>\r\n	<li>增加: sitemap网站地图</li>\r\n	<li>优化: 首页部分搜索不显示内容情况</li>\r\n</ul>\r\n\r\n<h2>v1.2</h2>\r\n\r\n<p><strong>2019/04/07</strong></p>\r\n\r\n<p>主要新增如下几个功能：</p>\r\n\r\n<ul>\r\n	<li>新增文章内容代码块高亮, 图片上传</li>\r\n	<li>新增css, js代码压缩</li>\r\n	<li>新增评论功能</li>\r\n	<li>从Markdown改为富文本编辑器</li>\r\n	<li>将侧边栏-标签云改为随机动态</li>\r\n</ul>\r\n\r\n<h2>v1.1</h2>\r\n\r\n<p><strong>2018/09/12</strong></p>\r\n\r\n<p>主要优化修复了如下几个问题：</p>\r\n\r\n<ul>\r\n	<li>修复了部分界面跳转错误</li>\r\n	<li>添加搜索功能</li>\r\n	<li>去掉部分无用代码</li>\r\n	<li>修复菜单bug无选中高亮</li>\r\n</ul>\r\n\r\n<h2>v1.0</h2>\r\n\r\n<p><strong>2018/06/01</strong></p>\r\n\r\n<p>终于实现第一个版本了，主要完成了如下功能&nbsp;:</p>\r\n\r\n<ul>\r\n	<li>博客文章功能</li>\r\n	<li>分类目录，文章标签功能</li>\r\n	<li>侧边栏</li>\r\n	<li>这个版本暂时还只是预发布版本，功能等还不是很完善，待后续改进</li>\r\n</ul>',
        '', '2020-06-01 08:59:00', '2020-06-01 08:59:00', 12, 1, 5, 0, 1, 1);
INSERT INTO `tb_content`
VALUES (103, '如何在移动端不加载不必要的js和动画等',
        '<p>网页特效越来越多，如上期分享的蜂窝特效就是直接引用了大神们的JS，在PC端运行还不错，炫酷，但似乎对移动端就不那么友好了，必竟对于移动端来说：</p>\r\n\r\n<p>1、硬件情况并比不上PC端（暂时），运行特效js需要手机GPU很好，但也会发烫<br />\r\n2、屏幕不大、特效太多影响美观，其实由于自适应的原因，特效并没有一直在，所以在白白浪费资源。</p>\r\n\r\n<p>所以对于引用的一些js来说，如蜂窝特效：</p>\r\n\r\n<pre>\r\n<code class=\"language-javascript\">&lt;script src=\"canvas-nest.min.js\" type=\"text/javascript\"&gt;&lt;/script&gt;</code></pre>\r\n\r\n<p>这样的代码肯定在web和wap端都会加载的，那如何在wap不加载呢？</p>\r\n\r\n<pre>\r\n<code class=\"language-javascript\">&lt;script&gt;\r\nif (screen &amp;&amp; screen.width &gt;768 ) {\r\ndocument.write(\'&lt;script src=\"canvas-nest.min.js\" type=\"text/javascript\"&gt;&lt;\\/script&gt;\');\r\n}\r\n&lt;/script&gt;</code></pre>\r\n\r\n<p>改成以上形式，即在屏幕宽大于768的时候则加载js,如果低于，那么不加载。</p>\r\n\r\n<p>PS：</p>\r\n\r\n<p>同样你也可以用其它的判断，比如说判断手机本身android或iphone等等都可以。</p>\r\n\r\n<p>再同样你也可以用它去减少许多不需要在移动端运行的动画、事件等等。</p>\r\n\r\n<p><a href=\"https://www.skyarea.cn/share/168/\">如何在移动端不加载不必要的js和动画等</a></p>',
        '', '2020-06-03 10:10:00', '2020-06-03 10:10:00', 78, 1, 6, 0, 0, 1);
INSERT INTO `tb_content`
VALUES (114, '简洁的 Mac 图床客户端 uPic',
        '<p><br />\r\n<a href=\"https://cdn.jsdelivr.net/gh/gee1k/oss@master/screenshot/uPic/logo.png\"><img alt=\"uPic\" src=\"https://cdn.jsdelivr.net/gh/gee1k/oss@master/screenshot/uPic/logo.png\" /></a></p>\r\n\r\n<h1>☁️ 简洁的 Mac 图床客户端 uPic</h1>\r\n\r\n<h2>📑 简介</h2>\r\n\r\n<blockquote>\r\n<p><strong>uPic(upload Picture) 是一款 Mac 端的图床(文件)上传客户端</strong><br />\r\n可将图片、各种文件上传到配置好的指定提供商的对象存储中。<br />\r\n然后快速获取可供互联网访问的文件 URL</p>\r\n</blockquote>\r\n\r\n<p><strong>💡 特点：</strong>&nbsp;无论是本地文件、或者屏幕截图都可自动上传，菜单栏显示实时上传进度。上传完成后文件链接自动复制到剪切板，让你无论是在写博客、灌水聊天都能快速插入图片。<br />\r\n连接格式可以是普通 URL、HTML 或者 Markdown，仍由你掌控。</p>\r\n\r\n<p><strong>🔋 支持图床：</strong>&nbsp;<a href=\"https://sm.ms/\" rel=\"external nofollow noopener noreferrer\" target=\"_blank\">smms</a>、&nbsp;<a href=\"https://www.upyun.com/products/file-storage\" rel=\"external nofollow noopener noreferrer\" target=\"_blank\">又拍云 USS</a>、<a href=\"https://www.qiniu.com/products/kodo\" rel=\"external nofollow noopener noreferrer\" target=\"_blank\">七牛云 KODO</a>、&nbsp;<a href=\"https://www.aliyun.com/product/oss/\" rel=\"external nofollow noopener noreferrer\" target=\"_blank\">阿里云 OSS</a>、&nbsp;<a href=\"https://cloud.tencent.com/product/cos\" rel=\"external nofollow noopener noreferrer\" target=\"_blank\">腾讯云 COS</a>、<a href=\"https://weibo.com/\" rel=\"external nofollow noopener noreferrer\" target=\"_blank\">微博</a>、<a href=\"https://github.com/settings/tokens\" rel=\"external nofollow noopener noreferrer\" target=\"_blank\">Github</a>、&nbsp;<a href=\"https://gitee.com/profile/personal_access_tokens\" rel=\"external nofollow noopener noreferrer\" target=\"_blank\">Gitee</a>、&nbsp;<a href=\"https://aws.amazon.com/cn/s3/\" rel=\"external nofollow noopener noreferrer\" target=\"_blank\">Amazon S3</a>、<a href=\"https://blog.svend.cc/upic/tutorials/custom\">自定义上传接口</a>、&hellip;</p>\r\n\r\n<h2>🚀 如何安装</h2>\r\n\r\n<h3>下载安装</h3>\r\n\r\n<h4>1.Homebrew:</h4>\r\n\r\n<pre>\r\n<code class=\"language-bash\">brew cask install upic</code></pre>\r\n\r\n<h4>2.手动</h4>\r\n\r\n<p>从&nbsp;<a href=\"https://github.com/gee1k/uPic/releases\" rel=\"external nofollow noopener noreferrer\" target=\"_blank\">Github release</a>&nbsp;下载。<br />\r\n<strong>如果访问 Github 下载困难的，可以从<a href=\"https://gitee.com/gee1k/uPic/releases\" rel=\"external nofollow noopener noreferrer\" target=\"_blank\">Gitee release</a>下载。</strong></p>\r\n\r\n<h3>检查 Finder 扩展权限</h3>\r\n\r\n<ul>\r\n	<li>\r\n	<p>1.打开 uPic</p>\r\n	</li>\r\n	<li>\r\n	<p>2.打开<code>系统偏好设置</code>&nbsp;-&nbsp;<code>扩展</code>&nbsp;-&nbsp;<code>访达扩展</code>&nbsp;确保&nbsp;<code>uPicFinderExtension</code>是勾选状态</p>\r\n\r\n	<p><br />\r\n	<a href=\"https://cdn.jsdelivr.net/gh/gee1k/oss@master/screenshot/uPic-cn/finder-extension.png\"><img src=\"https://cdn.jsdelivr.net/gh/gee1k/oss@master/screenshot/uPic-cn/finder-extension.png\" /></a></p>\r\n	</li>\r\n</ul>\r\n\r\n<h2>🕹 使用方式</h2>\r\n\r\n<table>\r\n	<thead>\r\n		<tr>\r\n			<th>功能</th>\r\n			<th>描述</th>\r\n			<th>预览</th>\r\n		</tr>\r\n	</thead>\r\n	<tbody>\r\n		<tr>\r\n			<td><strong>🖥 选择文件上传</strong></td>\r\n			<td>从<code>Finder</code>选择文件上传。<code>可设置全局快捷键</code></td>\r\n			<td><a href=\"https://cdn.jsdelivr.net/gh/gee1k/oss@master/screenshot/uPic-cn/selectFile.gif\"><img alt=\"\" src=\"https://cdn.jsdelivr.net/gh/gee1k/oss@master/screenshot/uPic-cn/selectFile.gif\" /></a></td>\r\n		</tr>\r\n		<tr>\r\n			<td><strong>⌨️ 复制文件上传</strong></td>\r\n			<td>上传已拷贝到剪切板的文件。<code>可设置全局快捷键</code></td>\r\n			<td><a href=\"https://cdn.jsdelivr.net/gh/gee1k/oss@master/screenshot/uPic-cn/pasteboard.gif\"><img alt=\"\" src=\"https://cdn.jsdelivr.net/gh/gee1k/oss@master/screenshot/uPic-cn/pasteboard.gif\" /></a></td>\r\n		</tr>\r\n		<tr>\r\n			<td><strong>📸 截图上传</strong></td>\r\n			<td>直接拉框截图上传。<code>可设置全局快捷键</code></td>\r\n			<td><a href=\"https://cdn.jsdelivr.net/gh/gee1k/oss@master/screenshot/uPic-cn/screenshot.gif\"><img alt=\"\" src=\"https://cdn.jsdelivr.net/gh/gee1k/oss@master/screenshot/uPic-cn/screenshot.gif\" /></a></td>\r\n		</tr>\r\n		<tr>\r\n			<td><strong>🖱 拖拽本地文件上传</strong></td>\r\n			<td>拖拽文件到状态栏上传</td>\r\n			<td><a href=\"https://cdn.jsdelivr.net/gh/gee1k/oss@master/screenshot/uPic-cn/dragFile.gif\"><img alt=\"\" src=\"https://cdn.jsdelivr.net/gh/gee1k/oss@master/screenshot/uPic-cn/dragFile.gif\" /></a></td>\r\n		</tr>\r\n		<tr>\r\n			<td><strong>🖱 拖拽浏览器图片上传</strong></td>\r\n			<td>从浏览器拖拽图片到状态栏上传</td>\r\n			<td><a href=\"https://cdn.jsdelivr.net/gh/gee1k/oss@master/screenshot/uPic-cn/dragFromBrowser.gif\"><img alt=\"\" src=\"https://cdn.jsdelivr.net/gh/gee1k/oss@master/screenshot/uPic-cn/dragFromBrowser.gif\" /></a></td>\r\n		</tr>\r\n		<tr>\r\n			<td><strong>📂 Finder 中右键上传</strong></td>\r\n			<td>右击文件上传</td>\r\n			<td><a href=\"https://cdn.jsdelivr.net/gh/gee1k/oss@master/screenshot/uPic-cn/contextmenu.gif\"><img alt=\"\" src=\"https://cdn.jsdelivr.net/gh/gee1k/oss@master/screenshot/uPic-cn/contextmenu.gif\" /></a></td>\r\n		</tr>\r\n		<tr>\r\n			<td><strong>⌨️ 命令行上传</strong></td>\r\n			<td>通过执行命令调用 uPic 上传文件</td>\r\n			<td><a href=\"https://cdn.jsdelivr.net/gh/gee1k/oss@master/screenshot/uPic-cn/cli.gif\"><img alt=\"\" src=\"https://cdn.jsdelivr.net/gh/gee1k/oss@master/screenshot/uPic-cn/cli.gif\" /></a></td>\r\n		</tr>\r\n	</tbody>\r\n</table>\r\n\r\n<h2>🧰 更多功能</h2>\r\n\r\n<h3>1.全局快捷键</h3>\r\n\r\n<p><a href=\"https://cdn.jsdelivr.net/gh/gee1k/oss@master/screenshot/uPic-cn/shortcuts.png\"><img src=\"https://cdn.jsdelivr.net/gh/gee1k/oss@master/screenshot/uPic-cn/shortcuts.png\" /></a></p>\r\n\r\n<h3>2. 上传历史</h3>\r\n\r\n<p><a href=\"https://cdn.jsdelivr.net/gh/gee1k/oss@master/screenshot/uPic-cn/history.png\"><img src=\"https://cdn.jsdelivr.net/gh/gee1k/oss@master/screenshot/uPic-cn/history.png\" /></a></p>\r\n\r\n<h2>📝 使用手册</h2>\r\n\r\n<ul>\r\n	<li><a href=\"https://blog.svend.cc/upic/tutorials/weibo\">uPic 图床配置教程 - 微博</a></li>\r\n	<li><a href=\"https://blog.svend.cc/upic/tutorials/upyun_uss\">uPic 图床配置教程 - 又拍云</a></li>\r\n	<li><a href=\"https://blog.svend.cc/upic/tutorials/qiniu_kodo\">uPic 图床配置教程 - 七牛云</a></li>\r\n	<li><a href=\"https://blog.svend.cc/upic/tutorials/aliyun_oss\">uPic 图床配置教程 - 阿里云</a></li>\r\n	<li><a href=\"https://blog.svend.cc/upic/tutorials/tencent_cos\">uPic 图床配置教程 - 腾讯云</a></li>\r\n	<li><a href=\"https://blog.svend.cc/upic/tutorials/baidu_bos\">uPic 图床配置教程 - 百度云</a></li>\r\n	<li><a href=\"https://blog.svend.cc/upic/tutorials/amazon_s3\">uPic 图床配置教程 - Amazon S3</a></li>\r\n	<li><a href=\"https://blog.svend.cc/upic/tutorials/github\">uPic 图床配置教程 - Github</a></li>\r\n	<li><a href=\"https://blog.svend.cc/upic/tutorials/gitee\">uPic 图床配置教程 - 码云(Gitee)</a></li>\r\n	<li><a href=\"https://blog.svend.cc/upic/tutorials/imgur\">uPic 图床配置教程 - Imgur</a></li>\r\n	<li><a href=\"https://blog.svend.cc/upic/tutorials/custom\">uPic 图床配置教程 - 自定义上传</a></li>\r\n	<li><a href=\"https://blog.svend.cc/upic/tutorials/chevereto\">uPic 图床配置教程 - Chevereto</a></li>\r\n</ul>',
        '', '2020-06-28 14:00:00', '2020-06-28 14:01:00', 115, 1, 4, 0, 0, 1);
INSERT INTO `tb_content`
VALUES (116, 'Pandas中groupby的这些用法',
        '<p><img alt=\"\" data-widget=\"image\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9tbWJpei5xcGljLmNuL21tYml6X2pwZy9wM3EyaG42ZGUyUGQ3ZEFFS0FrOVM3bXBIMlhLUVFpY0gwazR4OHE1amRPQlI3aDgzdVdpYlJ2Z0VIakNmME5Eek9GMGYwVkRuMlRNWE5lRWFDaWJSMHpVdy82NDA?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>01 如何理解pandas中的groupby操作</p>\r\n\r\n<p>groupby是pandas中用于数据分析的一个重要功能，其功能与SQL中的分组操作类似，但功能却更为强大。理解groupby的原理可参考官网给出的解释：</p>\r\n\r\n<p><img alt=\"\" data-widget=\"image\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9tbWJpei5xcGljLmNuL21tYml6X3BuZy9wM3EyaG42ZGUyUGQ3ZEFFS0FrOVM3bXBIMlhLUVFpY0hwMWM2a2tzaHhENDEwUzBhQkNmMkpGcWVyaWJESjRKS0NtUmExd2p2aWJ0dXdkeU1pY1QxOXZVcVEvNjQw?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>其中：</p>\r\n\r\n<ul>\r\n	<li>\r\n	<p>split：按照某一原则（groupby字段）进行拆分，相同属性分为一组</p>\r\n	</li>\r\n	<li>\r\n	<p>apply：对拆分后的各组执行相应的转换操作</p>\r\n	</li>\r\n	<li>\r\n	<p>combine：输出汇总转换后的各组结果</p>\r\n	</li>\r\n</ul>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<hr />\r\n<hr />\r\n<p>02 分组（split）&mdash;&mdash;groupby</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>groupby首先要指定分组原则，这也是groupby函数的第一步，其常用参数包括：</p>\r\n\r\n<ul>\r\n	<li>\r\n	<p>by，分组字段，可以是列名/series/字典/函数，常用为列名</p>\r\n	</li>\r\n	<li>\r\n	<p>axis，指定切分方向，默认为0，表示沿着行切分</p>\r\n	</li>\r\n	<li>\r\n	<p>as_index，是否将分组列名作为输出的索引，默认为True；当设置为False时相当于加了reset_index功能</p>\r\n	</li>\r\n	<li>\r\n	<p>sort，与SQL中groupby操作会默认执行排序一致，该groupby也可通过sort参数指定是否对输出结果按索引排序</p>\r\n	</li>\r\n</ul>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>另有其他参数，但很少用到不再列出。给出几个典型应用示例：</p>\r\n\r\n<p><img alt=\"\" data-widget=\"image\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9tbWJpei5xcGljLmNuL21tYml6X3BuZy9wM3EyaG42ZGUyUGQ3ZEFFS0FrOVM3bXBIMlhLUVFpY0h4NkRzVjhxYmMxMGRiOVNOMVFSeFg5Q09oVFR1V2liVE5oTjk1MVU1RTRNRkl3eTJwaWIxVURDUS82NDA?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>示例数据</p>\r\n\r\n<ul>\r\n	<li>\r\n	<p>单列作为分组字段，不设置索引</p>\r\n	</li>\r\n</ul>\r\n\r\n<p><img alt=\"\" data-widget=\"image\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9tbWJpei5xcGljLmNuL21tYml6X3BuZy9wM3EyaG42ZGUyUGQ3ZEFFS0FrOVM3bXBIMlhLUVFpY0h5dW9xRDBGaHhsdFkxME9VbnFwQ095UEhqVWRRY08ydUVtazB1a2VJUE15SEdwYnRweGY0UncvNjQw?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<ul>\r\n	<li>\r\n	<p>单列字段的转换格式作为分组字段</p>\r\n	</li>\r\n</ul>\r\n\r\n<p><img alt=\"\" data-widget=\"image\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9tbWJpei5xcGljLmNuL21tYml6X3BuZy9wM3EyaG42ZGUyUGQ3ZEFFS0FrOVM3bXBIMlhLUVFpY0h6RllPSzdZYjEwanhSblkxNEpseDRpYjZmR3VMTlNDMmNCa0NTSEEzRnZDU3llQ2lhSlp3Yjg5dy82NDA?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<ul>\r\n	<li>\r\n	<p>字典，根据索引对记录进行映射分组</p>\r\n	</li>\r\n</ul>\r\n\r\n<p><img alt=\"\" data-widget=\"image\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9tbWJpei5xcGljLmNuL21tYml6X3BuZy9wM3EyaG42ZGUyUGQ3ZEFFS0FrOVM3bXBIMlhLUVFpY0h6UnFxTUVPSmFzNll2NlNCOFVkU1FlZHZCR3RCMU5Zd3A0SDdiM3Y2dm1mRDBic0VESE9GSUEvNjQw?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<ul>\r\n	<li>\r\n	<p>函数，根据函数对索引的执行结果进行分组</p>\r\n	</li>\r\n</ul>\r\n\r\n<p><img alt=\"\" data-widget=\"image\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9tbWJpei5xcGljLmNuL21tYml6X3BuZy9wM3EyaG42ZGUyUGQ3ZEFFS0FrOVM3bXBIMlhLUVFpY0g5eU9leGZMMDl1Mm41N05VSGZJT1ZVV29jREF4Y0I1RTlLT2tRMkhLQm96MnZZaDVoeEg0dFEvNjQw?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<hr />\r\n<p>03 转换（apply）&mdash;&mdash;agg/apply/transform</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>分组之后的第二个步骤即为分组转换操作，也就是应用（apply）一定的函数得到相应的结果。常用的执行操作方式有4种：</p>\r\n\r\n<ul>\r\n	<li>\r\n	<p>直接加聚合函数，但只能实现单一功能，常用聚合函数包括：mean/sum/median/min/max/last/first等，最为简单直接的聚合方式</p>\r\n	</li>\r\n</ul>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<ul>\r\n	<li>\r\n	<p>agg(或aggregate)，执行更为丰富的聚合功能，常用列表、字典等形式作为参数</p>\r\n	</li>\r\n</ul>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>例如需要对如上数据表中两门课程分别统计平均分和最低分，则可用列表形式传参如下：</p>\r\n\r\n<p><img alt=\"\" data-widget=\"image\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9tbWJpei5xcGljLmNuL21tYml6X3BuZy9wM3EyaG42ZGUyUGQ3ZEFFS0FrOVM3bXBIMlhLUVFpY0hpYkpvWmQ3RjN3amdocmZCbHdiVzVsVWljSXJjc3lWSnZPeE55eEpwUXhsVEppYzNFdFB2SFp6SXcvNjQw?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>如果想对语文课求平均分和最低分，而数学课求平均分和最高分，则可用字典形式参数：</p>\r\n\r\n<p><img alt=\"\" data-widget=\"image\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9tbWJpei5xcGljLmNuL21tYml6X3BuZy9wM3EyaG42ZGUyUGQ3ZEFFS0FrOVM3bXBIMlhLUVFpY0gxUWVCTzRZN0R2U1pxVDBCcDB0ZzNhVVlNNmFQMmlhUzg1NmVTd3p3N2liYjk0WWhhVDdYWHlydy82NDA?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<ul>\r\n	<li>\r\n	<p>apply，除了agg丰富的可选聚合函数外，apply还可以自定义面向分组的聚合函数</p>\r\n	</li>\r\n</ul>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>这里apply函数实际上是一个应用非常广泛的转换函数，例如面向series对象，apply函数的处理粒度是series的每个元素（标量）；面向dataframe对象，apply函数的处理粒度是dataframe的一行或一列（series对象）；而现在面向groupby后的group对象，其处理粒度则是一个分组（dataframe对象）。例如，需要计算每个班级语文平均分与数学平均分之差，则用apply会是一个理想的选择：</p>\r\n\r\n<p><img alt=\"\" data-widget=\"image\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9tbWJpei5xcGljLmNuL21tYml6X3BuZy9wM3EyaG42ZGUyUGQ3ZEFFS0FrOVM3bXBIMlhLUVFpY0hvZW9RUGlibFFQNWliRWFNbGljN3hVRjlwUG5XQVZGRmtuVG1yVVY5THVraWIxdFVwcHk0YlpzYmdnLzY0MA?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<ul>\r\n	<li>\r\n	<p>transform，又一个强大的groupby利器，其与agg和apply的区别相当于SQL中窗口函数和分组聚合的区别：transform并不对数据进行聚合输出，而只是对每一行记录提供了相应聚合结果；而后两者则是聚合后的分组输出。</p>\r\n	</li>\r\n</ul>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>例如，想对比个人成绩与班级平均分，则如下操作会是首选：</p>\r\n\r\n<p><img alt=\"\" data-widget=\"image\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9tbWJpei5xcGljLmNuL21tYml6X3BuZy9wM3EyaG42ZGUyUGQ3ZEFFS0FrOVM3bXBIMlhLUVFpY0gxYmdlWmljTzd4Sk9kNzYzQzM2QzRKNmx6V1pFTm01SEhXdkxNc1dpYktlYVdoOG5HN29lUTJnZy82NDA?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>当然，这一操作也可以通过mean聚合+merge连接实现：</p>\r\n\r\n<p><img alt=\"\" data-widget=\"image\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9tbWJpei5xcGljLmNuL21tYml6X3BuZy9wM3EyaG42ZGUyUGQ3ZEFFS0FrOVM3bXBIMlhLUVFpY0hOU2M5VG9ORmNiVWRGS000Y0dVTlU1dTh6bEhCb3BqRE9CaWJ0cG04bTRjeFdVVnRORjlIb0Z3LzY0MA?x-oss-process=image/format,png\" /></p>\r\n\r\n<blockquote>\r\n<p>实际上，pandas中几乎所有需求都存在不止一种实现方式！</p>\r\n</blockquote>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<hr />\r\n<p>04 时间序列的groupby&mdash;&mdash;resample</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>再次指出，groupby相当于是按照某一规则对数据进行分组聚合，当分组的规则是时间序列时，还存在另一种特殊的分组方式&mdash;&mdash;重采样resample。理解groupby的split-apply-combine三步走处理流程，那么自然也很容易理解resample处理流程：按照时间split&mdash;&mdash;apply&mdash;&mdash;combine。同时，也正因为resample是一种特殊的分组聚合，所以groupby的4种转换操作自然也都适用于resample。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>生成以下含有时间序列的样例数据：</p>\r\n\r\n<p><img alt=\"\" data-widget=\"image\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9tbWJpei5xcGljLmNuL21tYml6X3BuZy9wM3EyaG42ZGUyUGQ3ZEFFS0FrOVM3bXBIMlhLUVFpY0hiUmwzcUxBZm8zN1Q0RHJIa1FHblFOQ20xd0lVZ3VkUFJWNHpndnlQZ0ZqTWpJM05xR25MaWJBLzY0MA?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>需统计每15天的平均分数，用resample可实现如下：</p>\r\n\r\n<p><img alt=\"\" data-widget=\"image\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9tbWJpei5xcGljLmNuL21tYml6X3BuZy9wM3EyaG42ZGUyUGQ3ZEFFS0FrOVM3bXBIMlhLUVFpY0hkYlNFc3dob3JZbmduVHZZTVpQWldHd3ZiemZrbHRpYmFUSloxN1N5SjViQlhsMVZBeEtnZXBRLzY0MA?x-oss-process=image/format,png\" /></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>当然，这是直接用了聚合函数，更复杂的例如agg、apply和transform等用法也是一样的。换句话说，resample与groupby的核心区别仅在于split阶段：前者按照时间间隔进行分组，而后者是按照定义的某种规则进行分组。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>另外，还可将groupby与resample链式使用，但仅可以是resample在groupby之后，反之则会报错。例如：</p>\r\n\r\n<p><img alt=\"\" data-widget=\"image\" src=\"https://imgconvert.csdnimg.cn/aHR0cHM6Ly9tbWJpei5xcGljLmNuL21tYml6X3BuZy9wM3EyaG42ZGUyUGQ3ZEFFS0FrOVM3bXBIMlhLUVFpY0g0QlBYb1hhbGptQW5pYjlmVk5EM1dnaWNvd3N6QjlBbVhFdHhqRGliRFYzYTV5akc5SG9HTTVOQVEvNjQw?x-oss-process=image/format,png\" /></p>\r\n\r\n<blockquote>\r\n<p>需要指出，resample等价于groupby操作一般是指下采样过程；同时，resample也支持上采样，此时需设置一定规则进行插值填充。</p>\r\n</blockquote>',
        '', '2020-07-10 01:53:00', '2020-07-10 01:53:00', 131, 1, 2, 0, 0, 1);
INSERT INTO `tb_content`
VALUES (117, 'mysql查询group_concat()数据不全导致数据被截断问题',
        '<p>查询语句如下:&nbsp;</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre data-widget=\"codeSnippet\">\r\n<code class=\"language-sql hljs\"><span class=\"hljs-keyword\">SELECT</span> 发行人, <span class=\"hljs-keyword\">GROUP_CONCAT</span>( 股票代码, <span class=\"hljs-string\">&#39;##&#39;</span>, 全称,<span class=\"hljs-string\">&#39;##&#39;</span>, 简称) <span class=\"hljs-keyword\">AS</span> bond_info \r\n<span class=\"hljs-keyword\">FROM</span> 表名</code></pre>\r\n</div>\r\n\r\n<p>查询该语句发现数据居然缺失如下:</p>\r\n\r\n<blockquote>\r\n<p>140020##2014年记账式附息（二十期）国债##14附息国债20,G140020##2014年记账式附息（二十期）国债##14附息国债20,&nbsp; 省略部分数据......&nbsp;,101424##2014年记账式附息（二十四期）国债##国债1424,<strong>140024##</strong></p>\r\n</blockquote>\r\n\r\n<p>查来查去终于发现了一个巨坑，那就是group_concat()有长度限制102400, 可能数据太长导致被截断.</p>\r\n\r\n<p>解决方法一：</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre data-widget=\"codeSnippet\">\r\n<code class=\"language-sql hljs\">windows下在my.ini加上group_concat_max_len = 102400 //自己设置的值\r\n\r\nlinux在mysql.cof中加上group_concat_max_len =102400 //自己设置的值\r\n\r\nlinux或者在my.cnf中加入如下\r\n[mysqld]\r\ngroup_concat_max_len = 4294967295（也可以为-1最大值）\r\n\r\n</code></pre>\r\n</div>\r\n\r\n<p>重启mysql服务，完美解决，</p>\r\n\r\n<p>注，mysql安装目录下没有my.ini，创建一个并加入:</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre data-widget=\"codeSnippet\">\r\n<code class=\"language-sql hljs\">group_concat_max_len = 4294967295\r\n</code></pre>\r\n</div>\r\n\r\n<p>解决方法二：(不推荐，因为数据库重启后长度会重新变回1024)</p>\r\n\r\n<div contenteditable=\"false\" tabindex=\"-1\">\r\n<pre data-widget=\"codeSnippet\">\r\n<code class=\"language-sql hljs\">//查看当前数据库的groupconcat长度\r\n<span class=\"hljs-keyword\">SHOW</span> <span class=\"hljs-keyword\">VARIABLES</span> <span class=\"hljs-keyword\">LIKE</span> <span class=\"hljs-string\">&#39;group_concat_max_len&#39;</span>; \r\n\r\n//执行以下语句修改成自己想要的长度\r\n<span class=\"hljs-keyword\">SET</span> <span class=\"hljs-keyword\">GLOBAL</span> group_concat_max_len = <span class=\"hljs-number\">102400</span>;  \r\n<span class=\"hljs-keyword\">SET</span> <span class=\"hljs-keyword\">SESSION</span> group_concat_max_len = <span class=\"hljs-number\">102400</span>;</code></pre>\r\n<img src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" /><span style=\"background:url(&quot;https://cdn.chenyinren.top/root_static/ckeditor/ckeditor/plugins/widget/images/handle.png&quot;) rgba(220, 220, 220, 0.5); display:block; left:0px; top:-15px\"><img role=\"presentation\" src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" style=\"height:15px; width:15px\" title=\"点击并拖拽以移动\" /></span></div>',
        '', '2020-07-23 01:35:00', '2020-07-23 01:35:00', 102, 1, 1, 0, 0, 1);
INSERT INTO `tb_content`
VALUES (119, 'Zeal——好用的离线 API 文档大全！',
        '<p>Zeal&nbsp;是一款离线文档浏览器，其灵感来自 OS X平台上的 Dash，目前支持 Window 和 Liunx。基于 QT5。</p>\r\n\r\n<ol>\r\n	<li>\r\n	<p>支持呼出热键。只要按下组合箭 ALT+Space 即可在任何地方显示面板，不用时可以用热键隐藏的系统托盘。</p>\r\n	</li>\r\n	<li>\r\n	<p>可同时搜索多个文档</p>\r\n	</li>\r\n	<li>\r\n	<p>不依赖网络</p>\r\n	</li>\r\n	<li>\r\n	<p>GPL 协议开放源码</p>\r\n	</li>\r\n	<li>\r\n	<p>Dash 中的文档都可以在 Zeal 中使用。</p>\r\n	</li>\r\n</ol>\r\n\r\n<p><strong>安装：</strong></p>\r\n\r\n<p>WIndows 自带二进制安装包</p>\r\n\r\n<p>Linux 需要安装 QT( &gt;= 5) 和 bsdtar。</p>\r\n\r\n<p><strong>软件截图：</strong></p>\r\n\r\n<p><img alt=\"\" src=\"http://static.oschina.net/uploads/space/2014/0115/132355_IQHW_184649.png\" style=\"height:402px; width:700px\" /></p>\r\n\r\n<p><img alt=\"\" src=\"http://static.oschina.net/uploads/space/2014/0115/132411_qXTS_184649.png\" style=\"height:300px; width:354px\" /></p>',
        '', '2020-09-14 04:39:00', '2020-09-14 04:39:00', 64, 1, 4, 0, 0, 1);
INSERT INTO `tb_content`
VALUES (120, 'Python ASGI 框架 快如闪电的异步服务器Uvicorn',
        '<h2>什么是 Uvicorn ？</h2>\r\n\r\n<p>Uvicorn 是一个闪电般快速的ASGI服务器，基于uvloop和httptools构建。</p>\r\n\r\n<p>直到最近，Python还没有为asyncio框架提供最小的低级服务器/应用程序接口。 ASGI规范填补了这一空白，意味着我们现在能够开始构建一个可用于所有asyncio框架的通用工具集。</p>\r\n\r\n<p>ASGI帮助实现一个Python Web框架生态系统，该框架在与IO绑定的上下文中实现高吞吐量方面与Node和Go竞争非常激烈。 它还提供对HTTP / 2和WebSockets的支持，WSGI无法处理。</p>\r\n\r\n<p>Uvicorn目前支持HTTP/1.1和WebSockets。 计划支持HTTP/2。</p>\r\n\r\n<h2>什么是 uvloop 和 httptools ？</h2>\r\n\r\n<p>答： uvloop 用于替换标准库 asyncio 中的事件循环，使用 Cython 实现，它非常快，可以使 asyncio 的速度提高 2-4 倍。asyncio 不用我介绍吧，写异步代码离不开它。</p>\r\n\r\n<p>httptools 是 nodejs HTTP 解析器的 Python 实现。</p>\r\n\r\n<h2>什么是 ASGI 服务器？</h2>\r\n\r\n<p>答： 异步网关协议接口，一个介于网络协议服务和 Python 应用之间的标准接口，能够处理多种通用的协议类型，包括 HTTP，HTTP2 和 WebSocket。</p>\r\n\r\n<h2>使用方法：</h2>\r\n\r\n<pre>\r\n<code class=\"language-python\">$ pip install uvicorn</code></pre>\r\n\r\n<p>创建一个文件 example.py</p>\r\n\r\n<pre>\r\n<code class=\"language-python\">async def app(scope, receive, send):\r\n    assert scope[\'type\'] == \'http\'\r\n    await send({\r\n        \'type\': \'http.response.start\',\r\n        \'status\': 200,\r\n        \'headers\': [\r\n            [b\'content-type\', b\'text/plain\'],\r\n        ]\r\n    })\r\n    await send({\r\n        \'type\': \'http.response.body\',\r\n        \'body\': b\'Hello, world!\',\r\n    })</code></pre>\r\n\r\n<p>启动 Uvicorn</p>\r\n\r\n<pre>\r\n<code class=\"language-python\">$ uvicorn example:app</code></pre>\r\n\r\n<p>你也可以不使用命令行，直接运行你的脚本也是可以的，如下：</p>\r\n\r\n<pre>\r\n<code class=\"language-python\">import uvicorn\r\n\r\nasync def app(scope, receive, send):\r\n    ...\r\n\r\nif __name__ == \"__main__\":\r\n    uvicorn.run(\"example:app\", host=\"127.0.0.1\", port=5000, log_level=\"info\")</code></pre>\r\n\r\n<p>使用命令行时，你可以使用&nbsp;<code>uvicorn --help</code>&nbsp;来获取帮助。</p>\r\n\r\n<pre>\r\n<code class=\"language-python\">Usage: uvicorn [OPTIONS] APP\r\n\r\nOptions:\r\n  --host TEXT                     Bind socket to this host.  [default:\r\n                                  127.0.0.1]\r\n  --port INTEGER                  Bind socket to this port.  [default: 8000]\r\n  --uds TEXT                      Bind to a UNIX domain socket.\r\n  --fd INTEGER                    Bind to socket from this file descriptor.\r\n  --reload                        Enable auto-reload.\r\n  --reload-dir TEXT               Set reload directories explicitly, instead\r\n                                  of using the current working directory.\r\n  --workers INTEGER               Number of worker processes. Defaults to the\r\n                                  $WEB_CONCURRENCY environment variable if\r\n                                  available. Not valid with --reload.\r\n  --loop [auto|asyncio|uvloop|iocp]\r\n                                  Event loop implementation.  [default: auto]\r\n  --http [auto|h11|httptools]     HTTP protocol implementation.  [default:\r\n                                  auto]\r\n  --ws [auto|none|websockets|wsproto]\r\n                                  WebSocket protocol implementation.\r\n                                  [default: auto]\r\n  --lifespan [auto|on|off]        Lifespan implementation.  [default: auto]\r\n  --interface [auto|asgi3|asgi2|wsgi]\r\n                                  Select ASGI3, ASGI2, or WSGI as the\r\n                                  application interface.  [default: auto]\r\n  --env-file PATH                 Environment configuration file.\r\n  --log-config PATH               Logging configuration file.\r\n  --log-level [critical|error|warning|info|debug|trace]\r\n                                  Log level. [default: info]\r\n  --access-log / --no-access-log  Enable/Disable access log.\r\n  --use-colors / --no-use-colors  Enable/Disable colorized logging.\r\n  --proxy-headers / --no-proxy-headers\r\n                                  Enable/Disable X-Forwarded-Proto,\r\n                                  X-Forwarded-For, X-Forwarded-Port to\r\n                                  populate remote address info.\r\n  --forwarded-allow-ips TEXT      Comma separated list of IPs to trust with\r\n                                  proxy headers. Defaults to the\r\n                                  $FORWARDED_ALLOW_IPS environment variable if\r\n                                  available, or \'127.0.0.1\'.\r\n  --root-path TEXT                Set the ASGI \'root_path\' for applications\r\n                                  submounted below a given URL path.\r\n  --limit-concurrency INTEGER     Maximum number of concurrent connections or\r\n                                  tasks to allow, before issuing HTTP 503\r\n                                  responses.\r\n  --backlog INTEGER               Maximum number of connections to hold in\r\n                                  backlog\r\n  --limit-max-requests INTEGER    Maximum number of requests to service before\r\n                                  terminating the process.\r\n  --timeout-keep-alive INTEGER    Close Keep-Alive connections if no new data\r\n                                  is received within this timeout.  [default:\r\n                                  5]\r\n  --ssl-keyfile TEXT              SSL key file\r\n  --ssl-certfile TEXT             SSL certificate file\r\n  --ssl-version INTEGER           SSL version to use (see stdlib ssl module\'s)\r\n                                  [default: 2]\r\n  --ssl-cert-reqs INTEGER         Whether client certificate is required (see\r\n                                  stdlib ssl module\'s)  [default: 0]\r\n  --ssl-ca-certs TEXT             CA certificates file\r\n  --ssl-ciphers TEXT              Ciphers to use (see stdlib ssl module\'s)\r\n                                  [default: TLSv1]\r\n  --header TEXT                   Specify custom default HTTP response headers\r\n                                  as a Name:Value pair\r\n  --help                          Show this message and exit.\r\n ```\r\n\r\n\r\n## 使用进程管理器\r\n\r\n使用进程管理器确保你以弹性方式运行运行多个进程，你可以执行服务器升级而不会丢弃客户端的请求。\r\n\r\n一个进程管理器将会处理套接字设置，启动多个服务器进程，监控进程活动，监听进程重启、关闭等信号。\r\n\r\nUvicorn 提供一个轻量级的方法来运行多个工作进程，比如 `--workers 4`，但并没有提供进行的监控。\r\n\r\n### 使用 Gunicorn\r\n\r\nGunicorn 是成熟的，功能齐全的服务器，Uvicorn 内部包含有 Guicorn 的 workers 类，允许你运行 ASGI 应用程序，这些 workers 继承了所有 Uvicorn 高性能的特点，并且给你使用 Guicorn 来进行进程管理。\r\n\r\n这样的话，你可能动态增加或减少进程数量，平滑地重启工作进程，或者升级服务器而无需停机。\r\n\r\n在生产环境中，Guicorn 大概是最简单的方式来管理 Uvicorn 了，生产环境部署我们推荐使用 Guicorn 和 Uvicorn 的 worker 类：\r\n\r\n```python\r\ngunicorn example:app -w 4 -k uvicorn.workers.UvicornWorker</code></pre>\r\n\r\n<p>执行上述命令将开户 4 个工作进程，其中 UvicornWorker 的实现使用 uvloop 和httptools 实现。在 PyPy 下运行，你可以使用纯 Python 实现，可以通过使用UvicornH11Worker 类来做到这一点。</p>\r\n\r\n<pre>\r\n<code class=\"language-python\">gunicorn -w 4 -k uvicorn.workers.UvicornH11Worker</code></pre>\r\n\r\n<p>Gunicorn 为 Uvicorn 提供了不同的配置选项集，但是一些配置暂不支持，如<code>--limit-concurrency</code>&nbsp;。</p>\r\n\r\n<h3>使用 Supervisor</h3>\r\n\r\n<p>Supervisor 作为进程管理器，以下两点二选一：</p>\r\n\r\n<ul>\r\n	<li>使用其文件描述符将套接字移交给 uvicorn，supervisor 始终将文件描述符置 0，并且必须在本 fcgi-program 中进行设置。</li>\r\n	<li>为每个 uvicorn 进程使用 UNIX 套接字。</li>\r\n</ul>\r\n\r\n<p>一个简单的主管配置可能看起来像这样： administratord.conf：</p>\r\n\r\n<pre>\r\n<code class=\"language-python\">[supervisord] \r\n\r\n[fcgi-program：uvicorn] \r\nsocket = tcp：// localhost：8000 \r\n命令= venv / bin / uvicorn --fd 0示例：App \r\nnumprocs = 4 \r\nprocess_name = uvicorn-％（process_num）d \r\nstdout_logfile = / dev /标准输出\r\nstdout_logfile_maxbytes = 0\r\n然后运行supervisord -n。</code></pre>\r\n\r\n<h3>使用 Circus</h3>\r\n\r\n<p>使用 Circus 与 Supervisor 很类似。配置文件 circus.ini 如下：</p>\r\n\r\n<pre>\r\n<code class=\"language-python\">[watcher:web]\r\ncmd = venv/bin/uvicorn --fd $(circus.sockets.web) example:App\r\nuse_sockets = True\r\nnumprocesses = 4\r\n\r\n[socket:web]\r\nhost = 0.0.0.0\r\nport = 8000</code></pre>\r\n\r\n<h2>与 Nginx 部署</h2>\r\n\r\n<p>Nginx 作为 Uvicorn 进程的代理并不是必须的，你可以使用 Nginx 做为负载均衡。推荐使用 Nginx 时配置请求头，如&nbsp;<code>X-Forwarded-For</code>,<code>X-Forwarded-Proto</code>，以便 Uvicorn 识别出真正的客户端信息，如 IP 地址，scheme 等。这里有一个配置文件的样例：</p>\r\n\r\n<pre>\r\n<code class=\"language-python\">http {\r\n  server {\r\n    listen 80;\r\n    client_max_body_size 4G;\r\n\r\n    server_name example.com;\r\n\r\n    location / {\r\n      proxy_set_header Host $http_host;\r\n      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\r\n      proxy_set_header X-Forwarded-Proto $scheme;\r\n      proxy_redirect off;\r\n      proxy_buffering off;\r\n      proxy_pass http://uvicorn;\r\n    }\r\n\r\n    location /static {\r\n      # path for static files\r\n      root /path/to/app/static;\r\n    }\r\n  }\r\n\r\n  upstream uvicorn {\r\n    server unix:/tmp/uvicorn.sock;\r\n  }\r\n\r\n}</code></pre>\r\n\r\n<h2>使用 HTTPS</h2>\r\n\r\n<p>使用 HTTPS 证书是必须的，推荐使用免费的 Let&#39;s Encrypt。</p>\r\n\r\n<pre>\r\n<code class=\"language-python\">$ uvicorn example:app --port 5000 --ssl-keyfile=./key.pem --ssl-certfile=./cert.pem</code></pre>\r\n\r\n<p>使用 Gunicorn 也可以直接使用证书。</p>\r\n\r\n<pre>\r\n<code class=\"language-python\">$ gunicorn --keyfile=./key.pem --certfile=./cert.pem -k uvicorn.workers.UvicornWorker example:app</code></pre>\r\n\r\n<h2>参考文档</h2>\r\n\r\n<ol>\r\n	<li><a href=\"https://link.zhihu.com/?target=https%3A//www.uvicorn.org/\" rel=\"nofollow noreferrer\" target=\"_blank\">官方文档-介绍</a>。</li>\r\n	<li><a href=\"https://link.zhihu.com/?target=https%3A//www.uvicorn.org/deployment/\" rel=\"nofollow noreferrer\" target=\"_blank\">官方文档-部署</a>。</li>\r\n</ol>',
        '', '2020-09-16 01:15:00', '2020-09-16 01:15:00', 77, 1, 4, 0, 0, 1);
INSERT INTO `tb_content`
VALUES (121, '「超级右键」Mac上最强的右键菜单工具，让你效率飞起！',
        '<h2>简介</h2>\r\n\r\n<p>我对该产品的评价只有六个字：<strong>实用、效率、快、得我心</strong></p>\r\n\r\n<h4>超级右键主要实现了：</h4>\r\n\r\n<p>Mac电脑上右键的扩展，能够新建、发送/复制文件到某个位置、快速打开常用目录、自定义文件夹图标、拷贝路径、终端/iTerm/VSCode 里进入路径、显示隐藏文件、彻底删除文件、剪切粘贴文件、百度翻译、谷歌翻译、右键截图、标注、贴图等等。</p>\r\n\r\n<p><strong>「超级右键」</strong>有一部分功能是借鉴Windows系统的，也有开发者自己新创的功能，总的来说功能完善，且使用快捷，是目前Mac上最强大的右键工具，绝对是Mac用户装机必备。</p>\r\n\r\n<h2>功能</h2>\r\n\r\n<hr />\r\n<h3>1.新建文件</h3>\r\n\r\n<p><strong>默认支持新建：</strong>TXT/RTF/XML/Word/Excel/PPT/WPS文字/WPS表格/WPS演示/Pages/Numbers/Keynote/Ai/PSD/Markdown格式的文件。</p>\r\n\r\n<p><strong>同时还支持</strong></p>\r\n\r\n<ul>\r\n	<li>用户自定义添加其他类型文件进行新建。</li>\r\n	<li>新建后自动打开文件</li>\r\n	<li>新建的时候启用弹窗，命名文件名和文件位置</li>\r\n	<li>将新建的文件类型添加到一级菜单目录</li>\r\n</ul>\r\n\r\n<p><img alt=\"\" src=\"https://cdn.sspai.com/2020/02/24/c4a86da3f4e1a3a6b582032497529ad2.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1\" /></p>\r\n\r\n<p>新建文件</p>\r\n\r\n<hr />\r\n<h3>2.复制/发动文件到指定路径</h3>\r\n\r\n<p>这个功能可以说非常的实用，以前在Mac上要转移文件的位置，很多时候要先拷贝，然后一层层的打开路径，很费事，有了超级右键，一键发动到位，很方便。</p>\r\n\r\n<p><img alt=\"\" src=\"https://cdn.sspai.com/2020/02/24/b6424ddf26f55836647bd01d207a756e.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1\" /></p>\r\n\r\n<p>复制文件到</p>\r\n\r\n<hr />\r\n<h3>3.常用目录</h3>\r\n\r\n<p><strong>「超级右键」</strong>允许用户自定义常用目录，然后使用右键快速打开，非常方便。<br />\r\n&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://cdn.sspai.com/2020/02/24/2d3a377f21a42d3e4f087eb5aeaccaeb.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1\" /></p>\r\n\r\n<p>常用目录</p>\r\n\r\n<hr />\r\n<h3>4.自定义文件夹图标</h3>\r\n\r\n<p>很多时候，你可能已经厌倦了千篇一律的蓝色文件，想给文件夹带去一点色彩，变得个性化，从视觉上好分辨一些，<strong>「超级右键」</strong>就能帮你轻松办到。</p>\r\n\r\n<p><img alt=\"\" src=\"https://cdn.sspai.com/2020/02/24/b49808c80aa6988d240ed8635e0c12a3.gif\" /></p>\r\n\r\n<p>自定义文件夹图标</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<hr />\r\n<p>&nbsp;</p>\r\n\r\n<h3>5.剪切、粘贴</h3>\r\n\r\n<p>Mac上本来是没有剪切功能的，从Windows转Mac的朋友们肯定觉得不习惯吧。<strong>「超级右键」</strong>为右键新增了剪切、粘贴功能，使用起来非常顺手。<br />\r\n&nbsp;</p>\r\n\r\n<p><img alt=\"\" src=\"https://cdn.sspai.com/2020/02/24/937b6aeeffbb757361eb4610a3a33ba9.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1\" /></p>\r\n\r\n<p>剪切、粘贴</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<hr />\r\n<p>&nbsp;</p>\r\n\r\n<h3>6.截图</h3>\r\n\r\n<p>Better 365将超级右键与其截图工具<strong>iShot</strong>进行了联动，可以使用右键调用进行截图，前提是你必须安装了iShot。</p>\r\n\r\n<p><img alt=\"\" src=\"https://cdn.sspai.com/2020/02/24/e6ca133487d8435e77fdc2a4a4d8477f.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1\" /></p>\r\n\r\n<p>右键截图</p>\r\n\r\n<p><img alt=\"\" src=\"https://cdn.sspai.com/2020/02/24/10e9728d46f3f131f74015a8b7c49b37.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1\" /></p>\r\n\r\n<p>截图</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<hr />\r\n<p>&nbsp;</p>\r\n\r\n<h3>&nbsp;</h3>\r\n\r\n<h3>7.贴图、标注</h3>\r\n\r\n<p>你还可以直接选中本地已存在的图片，将其贴图，并标记</p>\r\n\r\n<p><img alt=\"\" src=\"https://cdn.sspai.com/2020/02/24/17cdc770ce8d115fd1a3180645757bbf.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1\" /></p>\r\n\r\n<p>贴图标注</p>\r\n\r\n<p><img alt=\"\" src=\"https://cdn.sspai.com/2020/02/24/92e81f3e1f53cf6595ba3000c24b9387.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1\" /></p>\r\n\r\n<p>贴图标注</p>\r\n\r\n<h3>8.拷贝当前路径</h3>\r\n\r\n<p><strong>「超级右键」</strong>可以让你非常方便的拷贝路径，省去手码路径的麻烦。</p>\r\n\r\n<p><img alt=\"\" src=\"https://cdn.sspai.com/2020/02/24/aecadcae439b106828c1103bec249ffb.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1\" /></p>\r\n\r\n<p>拷贝当前路径</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<hr />\r\n<p>&nbsp;</p>\r\n\r\n<h3>&nbsp;</h3>\r\n\r\n<h3>9、终端、iTerm、VSCode、Sublime Text里打开</h3>\r\n\r\n<p>如果你需要在终端、等工具里打开文件、路径等，<strong>「超级右键」</strong>也将助你快人一步。</p>\r\n\r\n<p><img alt=\"\" src=\"https://cdn.sspai.com/2020/02/24/479c1a31c4e5dc723ee409477c21f598.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1\" /></p>\r\n\r\n<h3>终端、iTerm、VScode等打开<br />\r\n&nbsp;</h3>\r\n\r\n<p><br />\r\n&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<hr />\r\n<p>&nbsp;</p>\r\n\r\n<h3>&nbsp;</h3>\r\n\r\n<h3>10.显示/隐藏文件</h3>\r\n\r\n<p>你可以快速地隐藏你电脑上的文件，保护隐私，只有你知道如何显示</p>\r\n\r\n<p><img alt=\"\" src=\"https://cdn.sspai.com/2020/02/24/d1b2e32aa76d6ca56eb4bb423c020571.gif\" /></p>\r\n\r\n<p>显示/隐藏文件</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<hr />\r\n<p>&nbsp;</p>\r\n\r\n<h3>&nbsp;</h3>\r\n\r\n<h3>11.彻底删除</h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>彻底删除允许我们不经过废纸篓，直接删掉文件。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<hr />\r\n<p>&nbsp;</p>\r\n\r\n<h3>12.百度翻译、谷歌翻译、转化为二维码</h3>\r\n\r\n<p><img alt=\"\" src=\"https://cdn.sspai.com/2020/02/25/50e1177750f41680f5b2169297178e37.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1\" /></p>\r\n\r\n<p>请输入图片标题</p>\r\n\r\n<p>听我说了这么多，不去下载安装体验一把，还在等什么呢？在App Store搜索&ldquo;超级右键&rdquo;就可以免费下载啦，快让你快人一步吧！</p>\r\n\r\n<p><img alt=\"\" src=\"https://cdn.sspai.com/2020/02/25/6ce9c92234c9e054e2083cfc29ae608e.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1\" /></p>\r\n\r\n<p>请输入图片标题</p>',
        '', '2020-10-26 15:03:00', '2020-10-26 15:03:00', 75, 1, 4, 0, 0, 1);
INSERT INTO `tb_content`
VALUES (122, 'Navicat Premium 15.0.22 中文语言包',
        '<p>Navicat Premium是一个可多重连接的数据库管理工具，Navicat 的功能足以符合专业开发人员的所有需求，但是对数据库服务器的新手来说又相当容易学习。它可让你以单一程序同時连接到目前世面上所有版本的主流数据库并进行管理和操作，支持的数据库有： MySQL、SQL Server、SQLite、Oracle 及 PostgreSQL。让管理不同类型的数据库更加方便。</p>\r\n\r\n<p><img src=\"https://cdn.ch3nnn.cn/upload/2020/07/23/4900fdc3759a41d1b7c6b46675cdf0d9.png?imageMogr2/auto-orient/thumbnail/1000x/interlace/1/blur/1x0/quality/95|watermark/2/text/Q2gzbm5ubm7nmoTljZrlrqIgfOaKmOiFvuS4jeaBryDCtyDkuZDmraTkuI3nlrI=/font/6buR5L2T/fontsize/260/fill/I0ZDRkNGQw==/dissolve/75/gravity/SouthEast/dx/10/dy/10\" style=\"height:430px; width:600px\" /></p>\r\n\r\n<h2>汉化包</h2>\r\n\r\n<ul>\r\n	<li>15.0.12 汉化</li>\r\n</ul>\r\n\r\n<ol>\r\n	<li>下载&nbsp;<a href=\"https://t00y.com/file/13114864-433055695\" target=\"_blank\">链接: https://pan.baidu.com/s/1SITpWMdXfBhYlis-YL14Tg &nbsp;密码: vljg</a>中文包</li>\r\n	<li>解压复制&nbsp;<code>汉化文件夹</code>&nbsp;放到&nbsp;<code>/Applications/Navicat Premium.app/Contents/Resources</code></li>\r\n	<li>汉化完成<br />\r\n	PS:这个&nbsp;<code>zh-Hans.lproj</code>&nbsp;汉化文件是从&nbsp;<code>Navicat Premium</code>&nbsp;官方中文版提取 无毒无害</li>\r\n</ol>\r\n\r\n<ul>\r\n	<li>12.0.12 汉化</li>\r\n</ul>\r\n\r\n<ol>\r\n	<li>下载&nbsp;<a href=\"https://www.pipipan.com/fs/13114864-217250713\" target=\"_blank\">https://www.pipipan.com/fs/13114864-217250713</a>&nbsp;中文包</li>\r\n	<li>复制&nbsp;<code>汉化文件夹</code>&nbsp;放到&nbsp;<code>/Applications/Navicat Premium.app/Contents/Resources</code></li>\r\n	<li>汉化完成<br />\r\n	PS:这个&nbsp;<code>zh-Hans.lproj</code>&nbsp;汉化文件是从&nbsp;<code>Navicat Premium 12.0.12</code>&nbsp;官方中文版提取 无毒无害</li>\r\n</ol>',
        '', '2020-11-09 10:57:00', '2020-11-09 10:57:00', 131, 1, 1, 0, 0, 1);
INSERT INTO `tb_content`
VALUES (123, 'Java中静态代码块、构造代码块、构造函数、普通代码块',
        '<h3>1、静态代码块</h3>\r\n\r\n<h4>格式</h4>\r\n\r\n<p>在java类中（方法中不能存在静态代码块）使用static关键字和{}声明的代码块：</p>\r\n\r\n<pre>\r\n<code class=\"language-java\">public class CodeBlock {\r\n    static{\r\n        System.out.println(\"静态代码块\");\r\n    }\r\n}</code></pre>\r\n\r\n<h4>执行时机</h4>\r\n\r\n<p>静态代码块在类被加载的时候就运行了，而且只<span style=\"background-color:#e67e22\">加载一次</span>，并且优先于各种代码块以及构造函数。如果一个类中有多个静态代码块，会按照书写顺序依次执行。后面在比较的时候会通过具体实例来证明。</p>\r\n\r\n<h4>静态代码块的作用</h4>\r\n\r\n<p>一般情况下，如果有些代码需要在项目启动的时候就执行，这时候就需要静态代码块。比如一个项目启动需要加载的很多配置文件等资源，我们就可以都放入静态代码块中。</p>\r\n\r\n<h4>静态代码块不能存在任何方法体中</h4>\r\n\r\n<p>这个应该很好理解，首先我们要明确静态代码块是在类加载的时候就要运行了。我们分情况讨论：</p>\r\n\r\n<p>　　对于普通方法，由于普通方法是通过加载类，然后new出实例化对象，通过对象才能运行这个方法，而静态代码块只需要加载类之后就能运行了。</p>\r\n\r\n<p>　　对于静态方法，在类加载的时候，静态方法也已经加载了，但是我们必须要通过类名或者对象名才能访问，也就是说相比于静态代码块，静态代码块是主动运行的，而静态方法是被动运行的。</p>\r\n\r\n<p>　　不管是哪种方法，我们需要明确静态代码块的存在在类加载的时候就自动运行了，而放在不管是普通方法还是静态方法中，都是不能自动运行的。</p>\r\n\r\n<h4>静态代码块不能访问普通变量</h4>\r\n\r\n<p>普通变量只能通过对象来调用，是不能放在静态代码块中的</p>\r\n\r\n<h3>2、构造代码块</h3>\r\n\r\n<h4>格式</h4>\r\n\r\n<p>在java类中使用{}声明的代码块（和静态代码块的区别是少了static关键字）:</p>\r\n\r\n<pre>\r\n<code class=\"language-java\">public class CodeBlock {\r\n    static{\r\n        System.out.println(\"静态代码块\");\r\n    }\r\n    {\r\n        System.out.println(\"构造代码块\");\r\n    }\r\n}</code></pre>\r\n\r\n<h4>执行时机</h4>\r\n\r\n<p>构造代码块在创建对象时被调用，每次创建对象都会调用一次，但是优先于构造函数执行。需要注意的是，听名字我们就知道，构造代码块不是优先于构造函数执行，而是依托于构造函数，也就是说，如果你不实例化对象，构造代码块是不会执行的。怎么理解呢？我们看看下面这段代码</p>\r\n\r\n<pre>\r\n<code class=\"language-java\">public class CodeBlock {\r\n    {\r\n        System.out.println(\"构造代码块\");\r\n    }\r\n     \r\n    public CodeBlock(){\r\n        System.out.println(\"无参构造函数\");\r\n    }\r\n    public CodeBlock(String str){\r\n        System.out.println(\"有参构造函数\");\r\n    }\r\n}</code></pre>\r\n\r\n<p>我们反编译生成的class文件：</p>\r\n\r\n<p><img src=\"https://cdn.chenyinren.top/upload/2020/07/23/a2c9d4155fbd4e6d9538b0cc1808722a.png?imageMogr2/auto-orient/thumbnail/1000x/interlace/1/blur/1x0/quality/95|watermark/2/text/Q2gzbm5ubm7nmoTljZrlrqIgfOaKmOiFvuS4jeaBryDCtyDkuZDmraTkuI3nlrI=/font/6buR5L2T/fontsize/260/fill/I0ZDRkNGQw==/dissolve/75/gravity/SouthEast/dx/10/dy/10\" style=\"height:287px; width:524px\" /></p>\r\n\r\n<p>如果存在多个构造代码块，则执行顺序按照书写顺序依次执行。</p>\r\n\r\n<h4>构造代码块的作用</h4>\r\n\r\n<p>和构造函数的作用类似，都能对对象进行初始化，并且只要创建一个对象，构造代码块都会执行一次。但是反过来，构造函数则不一定每个对象建立时都执行（多个构造函数情况下，建立对象时传入的参数不同则初始化使用对应的构造函数）。</p>\r\n\r\n<p>利用每次创建对象的时候都会提前调用一次构造代码块特性，我们可以做诸如统计创建对象的次数等功能。</p>\r\n\r\n<h3>3、构造函数&nbsp;</h3>\r\n\r\n<p>1.构造函数的命名必须和类名完全相同。在java中普通函数可以和构造函数同名，但是必须带有返回值；</p>\r\n\r\n<p>2.构造函数的功能主要用于在类的对象创建时定义初始化的状态。它没有返回值，也不能用void来修饰。这就保证了它不仅什么也不用自动返回，而且根本不能有任何选择。而其他方法都有返回值，即使是void返回值。尽管方法体本身不会自动返回什么，但仍然可以让它返回一些东西，而这些东西可能是不安全的；</p>\r\n\r\n<p>3.构造函数不能被直接调用，必须通过new运算符在创建对象时才会自动调用；而一般的方法是在程序执行到它的时候被调用的；</p>\r\n\r\n<p>4.当定义一个类的时候，通常情况下都会显示该类的构造函数，并在函数中指定初始化的工作也可省略，不过Java编译器会提供一个默认的构造函数.此默认构造函数是不带参数的。而一般的方法不存在这一特点</p>\r\n\r\n<h3>4、普通代码块</h3>\r\n\r\n<p>通代码块和构造代码块的区别是，构造代码块是在类中定义的，而普通代码块是在方法体中定义的。且普通代码块的执行顺序和书写顺序一致。</p>\r\n\r\n<pre>\r\n<code class=\"language-java\">public void sayHello(){\r\n    {\r\n        System.out.println(\"普通代码块\");\r\n    }\r\n}</code></pre>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h3>5、执行顺序</h3>\r\n\r\n<p><strong>静态代码块&gt;构造代码块&gt;构造函数&gt;普通代码块</strong>　</p>\r\n\r\n<pre>\r\n<code class=\"language-java\">public class CodeBlock {\r\n    static{\r\n        System.out.println(\"静态代码块\");\r\n    }\r\n    {\r\n        System.out.println(\"构造代码块\");\r\n    }\r\n    public CodeBlock(){\r\n        System.out.println(\"无参构造函数\");\r\n    }\r\n     \r\n    public void sayHello(){\r\n        {\r\n            System.out.println(\"普通代码块\");\r\n        }\r\n    }\r\n     \r\n    public static void main(String[] args) {\r\n        System.out.println(\"执行了main方法\");\r\n         \r\n        new CodeBlock().sayHello();;\r\n        System.out.println(\"---------------\");\r\n        new CodeBlock().sayHello();;\r\n    }\r\n}</code></pre>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><strong>反编译生成的class文件：</strong></p>\r\n\r\n<p><img src=\"https://cdn.chenyinren.top/upload/2020/07/23/c93c8aff1d1c44488997bf7fd4148ac9.png?imageMogr2/auto-orient/thumbnail/1000x/interlace/1/blur/1x0/quality/95|watermark/2/text/Q2gzbm5ubm7nmoTljZrlrqIgfOaKmOiFvuS4jeaBryDCtyDkuZDmraTkuI3nlrI=/font/6buR5L2T/fontsize/260/fill/I0ZDRkNGQw==/dissolve/75/gravity/SouthEast/dx/10/dy/10\" style=\"height:476px; width:593px\" /></p>\r\n\r\n<p><strong>执行结果：</strong></p>\r\n\r\n<p>静态代码块<br />\r\n执行了main方法<br />\r\n构造代码块<br />\r\n无参构造函数<br />\r\n普通代码块<br />\r\n---------------<br />\r\n构造代码块<br />\r\n无参构造函数<br />\r\n普通代码块</p>\r\n\r\n<h3>6、父类和子类执行顺序</h3>\r\n\r\n<p>对象的初始化顺序：</p>\r\n\r\n<p>　　首先执行父类静态的内容，父类静态的内容执行完毕后，接着去执行子类的静态的内容，当子类的静态内容执行完毕之后，再去看父类有没有构造代码块，如果有就执行父类的构造代码块，父类的构造代码块执行完毕，接着执行父类的构造方法；父类的构造方法执行完毕之后，它接着去看子类有没有构造代码块，如果有就执行子类的构造代码块。子类的构造代码块执行完毕再去执行子类的构造方法。</p>\r\n\r\n<p>　　总之一句话，静态代码块内容先执行，接着执行父类构造代码块和构造方法，然后执行子类构造代码块和构造方法。</p>\r\n\r\n<p>父类：SuperClass.java</p>\r\n\r\n<pre>\r\n<code class=\"language-java\">package com.ys.extend;\r\n \r\npublic class SuperClass {\r\n    static{\r\n        System.out.println(\"父类静态代码块\");\r\n    }\r\n    {\r\n        System.out.println(\"父类构造代码块\");\r\n    }\r\n    public SuperClass(){\r\n        System.out.println(\"父类构造函数\");\r\n    }\r\n}</code></pre>\r\n\r\n<p>子类：SubClass.java</p>\r\n\r\n<pre>\r\n<code class=\"language-java\">package com.ys.extend;\r\n \r\npublic class SubClass extends SuperClass{\r\n    static{\r\n        System.out.println(\"子类静态代码块\");\r\n    }\r\n     \r\n    {\r\n        System.out.println(\"子类构造代码块\");\r\n    }\r\n     \r\n    public SubClass(){\r\n        System.out.println(\"子类构造函数\");\r\n    }\r\n     \r\n}</code></pre>\r\n\r\n<p>测试：</p>\r\n\r\n<pre>\r\n<code class=\"language-java\">public static void main(String[] args) {\r\n    SubClass sb = new SubClass();\r\n    System.out.println(\"------------\");\r\n    SubClass sb1 = new SubClass();\r\n}</code></pre>\r\n\r\n<p>打印结果：</p>\r\n\r\n<p>父类静态代码块</p>\r\n\r\n<p>子类静态代码块</p>\r\n\r\n<p>父类构造代码块</p>\r\n\r\n<p>父类构造函数</p>\r\n\r\n<p>子类构造代码块</p>\r\n\r\n<p>子类构造函数</p>\r\n\r\n<p>------------</p>\r\n\r\n<p>父类构造代码块</p>\r\n\r\n<p>父类构造函数</p>\r\n\r\n<p>子类构造代码块</p>\r\n\r\n<p>子类构造函数</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>',
        '', '2020-11-27 14:43:00', '2020-11-27 14:43:00', 90, 1, 10, 0, 0, 1);
INSERT INTO `tb_content`
VALUES (124, 'macOS 开启外接显示器 HiDPI⚡️',
        '<p><strong>对以下系统和显示器有效：</strong></p>\r\n\r\n<ul>\r\n	<li>macOS 10.12 Sierra</li>\r\n	<li>macOS 10.13 High Sierra</li>\r\n	<li>macOS 10.14 Mojave</li>\r\n	<li>macOS 10.15 Catalina</li>\r\n</ul>\r\n\r\n<ul>\r\n	<li>Dell P2416D, DisplayPort, 1920x1080 HiDPI</li>\r\n	<li>Dell P2418D, DisplayPort, 1920x1080 HiDPI</li>\r\n	<li>Acer XB241YU, HDMI, 1920x1080 HiDPI</li>\r\n</ul>\r\n\r\n<h2>0x1 准备工作：</h2>\r\n\r\n<h3>1. 打开系统HiDPI (在终端运行）</h3>\r\n\r\n<pre>\r\n<code class=\"language-bash\">sudo defaults write /Library/Preferences/com.apple.windowserver DisplayResolutionEnabled -bool YES\r\n</code></pre>\r\n\r\n<p>如果使用 4K 或更高分辨率的显示器，macOS 很可能原生支持 HiDPI，建议直接从&nbsp;<a href=\"https://wacky.one/blog/macos-hi-dpi/#rdm\">5. 下载 RDM</a>&nbsp;尝试选择 HiDPI 分辨率。如无法启用或没有合适的分辨率，再使用配置文件。</p>\r\n\r\n<h2>0x2 获得显示器信息</h2>\r\n\r\n<p>获得显示器的 VendorID 和 ProductID （制造商ID 和 产品ID），在终端运行：</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">ioreg -lw0 | grep IODisplayPrefsKey | grep -o \'/[^/]\\+\"$\'\r\n</code></pre>\r\n\r\n<p>输出大概是这样的：</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">&gt; ioreg -lw0 | grep IODisplayPrefsKey | grep -o \'/[^/]\\+\"$\'\r\n/AppleBacklightDisplay-610-a029\"\r\n/AppleDisplay-10ac-a0c4\"\r\n</code></pre>\r\n\r\n<p>这条指令的输出会有多个，注意识别你想要调整的显示器。第一条<code>AppleBacklightDisplay-610-a029</code>是MBP的内置显示屏。第二个是外接显示器。（当然，也可以合上 MBP 屏幕，这样只会输出正在使用的外接显示器）</p>\r\n\r\n<p>关注<code>AppleDisplay-**-**</code>，<code>-</code>分隔了两个十六进制数。第一个为VendorID，第二个为ProductID。以我的环境为例：VendorID为<code>10ac</code>，ProductID为<code>a0c4</code>。（机智的小伙伴发现这是一台Dell P2416D）</p>\r\n\r\n<h2>0x3 制作配置</h2>\r\n\r\n<p>水果的 plist 是 xml 变体，你可以手动写配置文件，也可以用文末的一键生成器。</p>\r\n\r\n<pre>\r\n<code class=\"language-xml\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\r\n&lt;!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\" \"http://www.apple.com/DTDs/PropertyList-1.0.dtd\"&gt;\r\n&lt;plist version=\"1.0\"&gt;\r\n&lt;dict&gt;\r\n    &lt;key&gt;DisplayProductID&lt;/key&gt;\r\n    &lt;integer&gt; **** &lt;/integer&gt;       &lt;!-- ProductID的 十进制 形式 --&gt;\r\n    &lt;key&gt;DisplayVendorID&lt;/key&gt;\r\n    &lt;integer&gt; **** &lt;/integer&gt;       &lt;!-- VendorID的 十进制 形式 --&gt;\r\n    &lt;key&gt;scale-resolutions&lt;/key&gt;\r\n    &lt;array&gt;\r\n        &lt;data&gt; **def-1** &lt;/data&gt;    &lt;!-- HiDPI定义1 --&gt;\r\n        &lt;data&gt; **def-2** &lt;/data&gt;    &lt;!-- HiDPI定义2 --&gt;\r\n    &lt;/array&gt;\r\n&lt;/dict&gt;\r\n&lt;/plist&gt;\r\n</code></pre>\r\n\r\n<p>要创建HiDPI分辨率，在<code>scale-resolutions</code>中增加两个<code>&lt;data&gt;</code>项，分别为<strong>希望得到的分辨率</strong>和<strong>缩放分辨率</strong>。例如，我想要创建1920x1080的HiDPI设置，def-1对应1920x1080，def-2对应3840x2160。</p>\r\n\r\n<p><code>&lt;data&gt;</code>内部的base64编码后的4个UInt32BE（大端存储的32位无符号整数），格式如下：</p>\r\n\r\n<table>\r\n	<thead>\r\n		<tr>\r\n			<th>&nbsp;</th>\r\n			<th>UInt32</th>\r\n			<th>UInt32</th>\r\n			<th>UInt32</th>\r\n			<th>UInt32</th>\r\n		</tr>\r\n	</thead>\r\n	<tbody>\r\n		<tr>\r\n			<td>&nbsp;</td>\r\n			<td>宽度</td>\r\n			<td>高度</td>\r\n			<td>Flag</td>\r\n			<td>Flag</td>\r\n		</tr>\r\n		<tr>\r\n			<td>十进制</td>\r\n			<td>1920</td>\r\n			<td>1080</td>\r\n			<td>&nbsp;</td>\r\n			<td>&nbsp;</td>\r\n		</tr>\r\n		<tr>\r\n			<td>十六进制</td>\r\n			<td><strong>00 00 07 80</strong></td>\r\n			<td><strong>00 00 04 38</strong></td>\r\n			<td>00 00 00 01</td>\r\n			<td>00 20 00 00</td>\r\n		</tr>\r\n	</tbody>\r\n</table>\r\n\r\n<p>我们需要修改的是宽度和高度，Flag部分不要改动。</p>\r\n\r\n<p>把上面这串二进制数进行Base64编码，可以得到：<code>AAAHgAAABDgAAAABACAAAA==</code>和<code>AAAPAAAACHAAAAABACAAAA==</code>。把这个字符串填到对应的<code>&lt;data&gt;</code>标签内。</p>\r\n\r\n<h2>0x4 拷贝配置到对应目录</h2>\r\n\r\n<pre>\r\n<code class=\"language-bash\"># OS X 10.11及以上\r\nDIR=/Library/Displays/Contents/Resources/Overrides\r\n# OS X 10.10及以下\r\nDIR=/Library/Displays/Overrides\r\n\r\n# ${VendorID} 和 ${ProductID} 为上面获得的 VendorID 和 ProductID\r\n# 比如 P2416D，下面两行分别是：VID=10ac 和 PID=a0c4\r\nVID=${VendorID}\r\nPID=${ProductID}\r\n\r\nCONF=${DIR}/DisplayVendorID-${VID}/DisplayProductID-${PID}\r\n\r\nsudo mkdir -p $( dirname ${CONF} )\r\n\r\n# 以下面生成的 P2416D 配置，下载到用户(wacky)的下载文件夹，下面一行是：\r\n# sudo cp /Users/wacky/Downloads/DisplayProductID-a0c4 ${CONF}\r\nsudo cp &lt;配置文件路径&gt; ${CONF}\r\nsudo chown root:wheel ${CONF}\r\n</code></pre>\r\n\r\n<h2>0x5 安装 Retina Display Manager</h2>\r\n\r\n<p>RDM 用来切换屏幕分辨率，在这里找安装包：<a href=\"http://avi.alkalay.net/software/RDM/\">RDM Binary Release</a></p>\r\n\r\n<p>如果使用 macOS Serria，需要允许任意来源的应用，参见：<a href=\"http://osxdaily.com/2016/09/27/allow-apps-from-anywhere-macos-gatekeeper/\">macOS安装任意来源应用</a>。</p>\r\n\r\n<h2>0x6 重启！用RDM切换分辨率</h2>\r\n\r\n<p>重启后运行 RDM，在任务栏中找到 RDM 的图标，单击打开分辨率选单。带有⚡️标识的为 HiDPI 分辨率。<br />\r\n<img alt=\"RDM Screenshot\" src=\"https://wacky.one/blog/macos-hi-dpi/RDM-screenshot.png\" /></p>\r\n\r\n<h2>存在的问题</h2>\r\n\r\n<p>用本文的方式开启 HiDPI，合上 Mac 屏幕，外接显示器黑屏。将外接显示器分辨率切换到屏幕原始分辨率后可以正常地仅使用外接显示器，原因未知。因对我的工作方式没有影响，没有继续研究下去。</p>\r\n\r\n<p>系统大版本更新后（如 High Sierra 到 Mojave），需要重新拷贝配置文件。</p>\r\n\r\n<p><a href=\"https://wacky.one/blog/macos-hi-dpi/\">转载: macOS 开启外接显示器 HiDPI</a></p>',
        '', '2020-12-01 03:05:00', '2020-12-01 03:05:00', 187, 1, 4, 0, 0, 1);
INSERT INTO `tb_content`
VALUES (125, 'PostmanCn: Postman中文版',
        '<h1>PostmanCn</h1>\r\n\r\n<p>最新版本：7.36.1</p>\r\n\r\n<p>更新时间：2020-12-18</p>\r\n\r\n<p><a href=\"https://gitee.com/hlmd/PostmanCn/releases\">点击下载</a></p>\r\n\r\n<h4>介绍</h4>\r\n\r\n<p><img src=\"https://img-blog.csdnimg.cn/20201221163244334.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:402px; width:600px\" /></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>Postman中文版 汉化 持续更新中&nbsp;&nbsp;</p>\r\n\r\n<h4>安装教程</h4>\r\n\r\n<h5>Windows</h5>\r\n\r\n<p>Postman-*-win64-中文版.zip 解压直接用</p>\r\n\r\n<p>app.zip 解压&amp;&amp;替换文件 应用程序目录/resources/app.asar</p>\r\n\r\n<h5>Mac</h5>\r\n\r\n<p><a href=\"https://www.postman.com/downloads/\" rel=\"nofollow\">Postman官网</a>下载&amp;安装Postman Mac版</p>\r\n\r\n<p><a href=\"https://gitee.com/hlmd/PostmanCn/releases\">下载 Postman-*-Mac-汉化版</a>&nbsp;app.zip</p>\r\n\r\n<p>复制到 Postman安装目录 /.../Postman.app/Contents/Resources/</p>\r\n\r\n<p>解压 替换 app目录即可</p>\r\n\r\n<h5>Linux</h5>\r\n\r\n<p>解压 替换 app目录即可</p>\r\n\r\n<p><a href=\"https://www.postman.com/downloads/\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">https://www.postman.com/downloads/</a>&nbsp;这个是Postman官网的下载页面</p>\r\n\r\n<p><a href=\"https://gitee.com/hlmd/PostmanCn/attach_files/492931/download/postman_EnToCn.zip\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">https://gitee.com/hlmd/PostmanCn/attach_files/492931/download/postman_EnToCn.zip</a>&nbsp;这个是这里的汉化的</p>',
        '', '2020-12-21 08:30:00', '2020-12-21 08:30:00', 141, 1, 4, 0, 0, 1);
INSERT INTO `tb_content`
VALUES (126, 'gRPC详解',
        '<h2>RPC 框架原理</h2>\r\n\r\n<p><strong>RPC 框架的目标就是让远程服务调用更加简单、透明</strong>，RPC 框架负责屏蔽底层的传输方式（TCP 或者 UDP）、序列化方式（XML/Json/ 二进制）和通信细节。<strong>服务调用者可以像调用本地接口一样调用远程的服务提供者，而不需要关心底层通信细节和调用过程。</strong></p>\r\n\r\n<p>RPC 框架的调用原理图如下所示：</p>\r\n\r\n<p><img alt=\"\" src=\"https://img-blog.csdnimg.cn/20200203085618177.png\" style=\"height:302px; width:541px\" /></p>\r\n\r\n<h2>gRPC是什么？</h2>\r\n\r\n<p><a href=\"https://www.grpc.io/docs/languages/python/quickstart/\">官方文档-Python</a></p>\r\n\r\n<p>gRPC是什么可以用官网的一句话来概括</p>\r\n\r\n<blockquote>\r\n<p>A high-performance, open-source universal RPC framework</p>\r\n</blockquote>\r\n\r\n<p><strong>所谓RPC(remote procedure call 远程过程调用)框架实际是提供了一套机制，使得应用程序之间可以进行通信，而且也遵从server/client模型。使用的时候客户端调用server端提供的接口就像是调用本地的函数一样。</strong>如下图所示就是一个典型的RPC结构图。</p>\r\n\r\n<p><img alt=\"概念图\" src=\"https://www.grpc.io/img/landing-2.svg\" /></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h2>gRPC有什么好处以及在什么场景下需要用gRPC</h2>\r\n\r\n<p>既然是server/client模型，那么&nbsp;我们直接用restful api不是也可以满足吗，为什么还需要RPC呢？下面我们就来看看RPC到底有哪些优势</p>\r\n\r\n<h2>gRPC vs. Restful API</h2>\r\n\r\n<p>gRPC和restful API都提供了一套通信机制，用于server/client模型通信，而且它们都使用http作为底层的传输协议(严格地说, gRPC使用的http2.0，而restful api则不一定)。不过gRPC还是有些特有的优势，如下：</p>\r\n\r\n<p>&nbsp;&nbsp;</p>\r\n\r\n<ul>\r\n	<li>gRPC可以通过protobuf来定义接口，从而可以有更加严格的接口约束条件。关于protobuf可以参见笔者之前的小文<a href=\"https://www.jianshu.com/p/b723053a86a6\" target=\"_blank\">Google Protobuf简明教程</a></li>\r\n	<li>另外，通过protobuf可以将数据序列化为二进制编码，这会大幅减少需要传输的数据量，从而大幅提高性能。</li>\r\n	<li>gRPC可以方便地支持流式通信(理论上通过http2.0就可以使用streaming模式, 但是通常web服务的restful api似乎很少这么用，通常的流式数据应用如视频流，一般都会使用专门的协议如HLS，RTMP等，这些就不是我们通常web服务了，而是有专门的服务器应用。）</li>\r\n</ul>\r\n\r\n<h2>gRPC HelloWorld实例详解</h2>\r\n\r\n<p>gRPC的使用通常包括如下几个步骤：</p>\r\n\r\n<ol>\r\n	<li>通过protobuf来定义接口和数据类型</li>\r\n	<li>编写gRPC server端代码</li>\r\n	<li>\r\n	<p>编写gRPC client端代码<br />\r\n	下面来通过一个实例来详细讲解上述的三步。<br />\r\n	下边的hello world实例完成之后，其目录结果如下：</p>\r\n	</li>\r\n</ol>\r\n\r\n<h3>定义接口和数据类型</h3>\r\n\r\n<ul>\r\n	<li>通过protobuf定义接口和数据类型</li>\r\n</ul>\r\n\r\n<pre>\r\n<code class=\"language-python\">syntax = \"proto3\";\r\n\r\npackage rpc_package;\r\n\r\n// define a service\r\nservice HelloWorldService {\r\n    // define the interface and data type\r\n    rpc SayHello (HelloRequest) returns (HelloReply) {}\r\n}\r\n\r\n// define the data type of request\r\nmessage HelloRequest {\r\n    string name = 1;\r\n}\r\n\r\n// define the data type of response\r\nmessage HelloReply {\r\n    string message = 1;\r\n}\r\n</code></pre>\r\n\r\n<ul>\r\n	<li>使用gRPC protobuf生成工具生成对应语言的库函数</li>\r\n</ul>\r\n\r\n<pre>\r\n<code class=\"language-bash\">python -m grpc_tools.protoc -I=./protos --python_out=./rpc_package --grpc_python_out=./rpc_package ./protos/user_info.proto\r\n</code></pre>\r\n\r\n<p>这个指令会自动生成rpc_package文件夹中的<code>helloworld_pb2.py</code>和<code>helloworld_pb2_grpc.py</code>，但是不会自动生成<code>__init__.py</code>文件，需要我们手动添加</p>\r\n\r\n<p>关于protobuf的详细解释请参考<a href=\"https://www.jianshu.com/p/b723053a86a6\" target=\"_blank\">Google Protobuf简明教程</a></p>\r\n\r\n<h3>gRPC server端代码</h3>\r\n\r\n<pre>\r\n<code class=\"language-python\">#!/usr/bin/env python\r\n# -*-coding: utf-8 -*-\r\n\r\nfrom concurrent import futures\r\nimport grpc\r\nimport logging\r\nimport time\r\n\r\nfrom rpc_package.helloworld_pb2_grpc import add_HelloWorldServiceServicer_to_server, \\ \r\n    HelloWorldServiceServicer\r\nfrom rpc_package.helloworld_pb2 import HelloRequest, HelloReply\r\n\r\n\r\nclass Hello(HelloWorldServiceServicer):\r\n\r\n    # 这里实现我们定义的接口\r\n    def SayHello(self, request, context):\r\n        return HelloReply(message=\'Hello, %s!\' % request.name)\r\n\r\n\r\ndef serve():\r\n    # 这里通过thread pool来并发处理server的任务\r\n    server = grpc.server(futures.ThreadPoolExecutor(max_workers=10))\r\n\r\n    # 将对应的任务处理函数添加到rpc server中\r\n    add_HelloWorldServiceServicer_to_server(Hello(), server)\r\n\r\n    # 这里使用的非安全接口，世界gRPC支持TLS/SSL安全连接，以及各种鉴权机制\r\n    server.add_insecure_port(\'[::]:50000\')\r\n    server.start()\r\n    try:\r\n        while True:\r\n            time.sleep(60 * 60 * 24)\r\n    except KeyboardInterrupt:\r\n        server.stop(0)\r\n\r\n\r\nif __name__ == \"__main__\":\r\n    logging.basicConfig()\r\n    serve()\r\n</code></pre>\r\n\r\n<h3>gRPC client端代码</h3>\r\n\r\n<pre>\r\n<code class=\"language-python\">#!/usr/bin/env python\r\n# -*- coding: utf-8 -*-\r\n\r\nfrom __future__ import print_function\r\nimport logging\r\n\r\nimport grpc\r\nfrom rpc_package.helloworld_pb2 import HelloRequest, HelloReply\r\nfrom rpc_package.helloworld_pb2_grpc import HelloWorldServiceStub\r\n\r\ndef run():\r\n    # 使用with语法保证channel自动close\r\n    with grpc.insecure_channel(\'localhost:50000\') as channel:\r\n        # 客户端通过stub来实现rpc通信\r\n        stub = HelloWorldServiceStub(channel)\r\n\r\n        # 客户端必须使用定义好的类型，这里是HelloRequest类型\r\n        response = stub.SayHello(HelloRequest(name=\'eric\'))\r\n    print (\"hello client received: \" + response.message)\r\n\r\nif __name__ == \"__main__\":\r\n    logging.basicConfig()\r\n    run()\r\n</code></pre>\r\n\r\n<h3>演示</h3>\r\n\r\n<p>先执行server端代码</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">python hello_server.py\r\n</code></pre>\r\n\r\n<p>接着执行client端代码如下：</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">➜  grpc_test python hello_client.py\r\nhello client received: Hello, eric!\r\n</code></pre>\r\n\r\n<h2>References</h2>\r\n\r\n<ul>\r\n	<li><a href=\"https://grpc.io/\" rel=\"nofollow\" target=\"_blank\">gRPC官网</a></li>\r\n	<li><a href=\"https://www.jianshu.com/p/b723053a86a6\" target=\"_blank\">Google Protobuf简明教程</a></li>\r\n</ul>',
        '', '2020-12-24 09:05:00', '2020-12-24 09:05:00', 135, 1, 10, 0, 0, 1);
INSERT INTO `tb_content`
VALUES (127, 'Django Elasticsearch DSL',
        '<p>Django Elasticsearch DSL是一个软件包，允许在elasticsearch中索引Django模型。它是作为<a href=\"https://github.com/elastic/elasticsearch-dsl-py\">Elasticsearch-dsl-py</a>的薄包装而构建的，&nbsp;因此您可以使用elasticsearch-dsl-py团队开发的所有功能。</p>\r\n\r\n<h2>功能</h2>\r\n\r\n<ul>\r\n	<li>\r\n	<p>基于<a href=\"https://github.com/elastic/elasticsearch-dsl-py\">elasticsearch-dsl-py，</a>因此您可以使用<a href=\"http://elasticsearch-dsl.readthedocs.io/en/stable/search_dsl.html\">Search</a>类进行查询。</p>\r\n	</li>\r\n	<li>\r\n	<p>Django信号接收器处于保存和删除状态，以保持Elasticsearch同步。</p>\r\n	</li>\r\n	<li>\r\n	<p>用于创建，删除，重建和填充索引的管理命令。</p>\r\n	</li>\r\n	<li>\r\n	<p>从Django模型字段中的Elasticsearch自动映射。</p>\r\n	</li>\r\n	<li>\r\n	<p>复杂字段类型支持（ObjectField，NestedField）。</p>\r\n	</li>\r\n	<li>\r\n	<p>使用并行索引快速建立索引。</p>\r\n	</li>\r\n</ul>\r\n\r\n<p><strong>要求</strong></p>\r\n\r\n<blockquote>\r\n<p>Django&gt; = 1.11</p>\r\n\r\n<p>Python 2.7、3.5、3.6、3.7</p>\r\n\r\n<ul>\r\n</ul>\r\n</blockquote>\r\n\r\n<p><strong>Elasticsearch兼容性：</strong>&nbsp;该库与5.x以后的所有Elasticsearch版本兼容，&nbsp;<strong>但是您必须使用匹配的主要版本：</strong></p>\r\n\r\n<ul>\r\n	<li>对于Elasticsearch 7.0及更高版本，请使用库的主要版本7（7.xy）。</li>\r\n	<li>对于Elasticsearch 6.0及更高版本，请使用库的主要版本6（6.xy）。</li>\r\n	<li>对于Elasticsearch 5.0和更高版本，请使用库的主要版本0.5（0.5.x）。</li>\r\n</ul>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\"># Elasticsearch 7.x\r\nelasticsearch-dsl&gt;=7.0.0,&lt;8.0.0\r\n\r\n# Elasticsearch 6.x\r\nelasticsearch-dsl&gt;=6.0.0,&lt;7.0.0\r\n\r\n# Elasticsearch 5.x\r\nelasticsearch-dsl&gt;=0.5.1,&lt;6.0.0</code></pre>\r\n</div>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>安装Django Elasticsearch DSL：</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-bash\">pip install django-elasticsearch-dsl</code></pre>\r\n</div>\r\n\r\n<p>然后添加<code>django_elasticsearch_dsl</code>到INSTALLED_APPS</p>\r\n\r\n<p>您必须<code>ELASTICSEARCH_DSL</code>在django设置中定义。</p>\r\n\r\n<p>例如：</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-bash\">ELASTICSEARCH_DSL={\r\n    \'default\': {\r\n        \'hosts\': \'localhost:9200\'\r\n    },\r\n}</code></pre>\r\n</div>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><code>ELASTICSEARCH_DSL</code>然后传递给<code>elasticsearch-dsl-py.connections.configure</code>（请参阅<a href=\"http://elasticsearch-dsl.readthedocs.io/en/stable/configuration.html#multiple-clusters\">此处</a>）。</p>\r\n\r\n<h2>声明数据索引</h2>\r\n\r\n<p>然后对于模型：</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\"># models.py\r\n\r\nclass Car(models.Model):\r\n    name = models.CharField()\r\n    color = models.CharField()\r\n    description = models.TextField()\r\n    type = models.IntegerField(choices=[\r\n        (1, \"Sedan\"),\r\n        (2, \"Truck\"),\r\n        (4, \"SUV\"),\r\n    ])</code></pre>\r\n</div>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>为了使该模型与Elasticsearch一起使用，请创建的子类<code>django_elasticsearch_dsl.Document</code>，在该类的内部创建一个以定义您的Elasticsearch索引，名称，设置等，最后使用decorator注册该类。它需要在您的应用程序目录中定义类&nbsp;。<code>class&nbsp;Index</code><code>Document</code><code>registry.register_document</code><code>Document</code><code>documents.py</code></p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\"># documents.py\r\n\r\nfrom django_elasticsearch_dsl import Document\r\nfrom django_elasticsearch_dsl.registries import registry\r\nfrom .models import Car\r\n\r\n\r\n@registry.register_document\r\nclass CarDocument(Document):\r\n    class Index:\r\n        # Name of the Elasticsearch index\r\n        name = \'cars\'\r\n        # See Elasticsearch Indices API reference for available settings\r\n        settings = {\'number_of_shards\': 1,\r\n                    \'number_of_replicas\': 0}\r\n\r\n    class Django:\r\n        model = Car # The model associated with this Document\r\n\r\n        # The fields of the model you want to be indexed in Elasticsearch\r\n        fields = [\r\n            \'name\',\r\n            \'color\',\r\n            \'description\',\r\n            \'type\',\r\n        ]\r\n\r\n        # Ignore auto updating of Elasticsearch when a model is saved\r\n        # or deleted:\r\n        # ignore_signals = True\r\n\r\n        # Don\'t perform an index refresh after every update (overrides global setting):\r\n        # auto_refresh = False\r\n\r\n        # Paginate the django queryset used to populate the index with the specified size\r\n        # (by default it uses the database driver\'s default setting)\r\n        # queryset_pagination = 5000</code></pre>\r\n</div>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h2>填充</h2>\r\n\r\n<p>要创建并填充Elasticsearch索引和映射，请使用search_index命令：</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-bash\">$ ./manage.py search_index --rebuild\r\n</code></pre>\r\n</div>\r\n\r\n<p>现在，当您执行以下操作时：</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">car = Car(\r\n    name=\"Car one\",\r\n    color=\"red\",\r\n    type=1,\r\n    description=\"A beautiful car\"\r\n)\r\ncar.save()</code></pre>\r\n</div>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>该对象也将保存在Elasticsearch中（使用信号处理程序）。</p>\r\n\r\n<h2>搜索</h2>\r\n\r\n<p>要获取elasticsearch-dsl-py<a href=\"https://django-elasticsearch-dsl.readthedocs.io/en/latest/quickstart.html#search\">搜索</a>实例，请使用：</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">s = CarDocument.search().filter(\"term\", color=\"red\")\r\n\r\n# or\r\n\r\ns = CarDocument.search().query(\"match\", description=\"beautiful\")\r\n\r\nfor hit in s:\r\n    print(\r\n        \"Car name : {}, description {}\".format(hit.name, hit.description)\r\n    )</code></pre>\r\n</div>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>前面的例子返回一个结果具体到<a href=\"http://elasticsearch-dsl.readthedocs.io/en/latest/search_dsl.html#response\">elasticsearch_dsl</a>，但它也可以将elastisearch结果转换成真正的Django的queryset的，只是知道这个成本SQL请求，检索与由elastisearch查询返回的ID的模型实例。</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">s = CarDocument.search().filter(\"term\", color=\"blue\")[:30]\r\nqs = s.to_queryset()\r\n# qs is just a django queryset and it is called with order_by to keep\r\n# the same order as the elasticsearch result.\r\nfor car in qs:\r\n    print(car.name)</code></pre>\r\n<img src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" /><img src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" style=\"height:15px; width:15px\" title=\"点击并拖拽以移动\" /></div>',
        '', '2021-01-15 02:26:00', '2021-01-15 02:26:00', 171, 1, 5, 0, 0, 1);
INSERT INTO `tb_content`
VALUES (128, 'Django gRPC 应用',
        '<p style=\"text-align:center\"><img alt=\"\" src=\"https://img-blog.csdnimg.cn/img_convert/efc4ac456f5a68b23271a3b45aa97670.png\" style=\"height:393px; width:600px\" />​</p>\r\n\r\n<p><strong>官方文档:&nbsp;<a href=\"https://djangogrpcframework.readthedocs.io/en/latest/index.html\">https://djangogrpcframework.readthedocs.io/en/latest/index.html</a></strong></p>\r\n\r\n<h2>项目设置</h2>\r\n\r\n<p>创建一个名为的新Django项目<code>quickstart</code>，然后启动一个名为的新应用&nbsp;<code>account</code>：</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-bash\"># Create a virtual environment\r\npython3 -m venv env\r\nsource env/bin/activate\r\n# Install Django and Django gRPC framework\r\npip install django\r\npip install djangorestframework\r\npip install djangogrpcframework\r\npip install grpcio\r\npip install grpcio-tools\r\n# Create a new project and a new application\r\ndjango-admin startproject quickstart\r\ncd quickstart\r\ndjango-admin startapp account</code></pre>\r\n</div>\r\n\r\n<p>现在同步数据库：</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-bash\">python manage.py migrate</code></pre>\r\n</div>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h2>更新设置</h2>\r\n\r\n<p>添加<code>django_grpc_framework</code>到<code>INSTALLED_APPS</code>，设置模块位于&nbsp;<code>quickstart/settings.py</code>：</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">INSTALLED_APPS = [\r\n    ...\r\n    \'django_grpc_framework\',\r\n]</code></pre>\r\n</div>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h2>定义原型</h2>\r\n\r\n<p>我们的第一步是定义gRPC服务和消息，在<code>quickstart/account.proto</code>旁边创建一个文件&nbsp;<code>quickstart/manage.py</code>：</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-bash\">syntax = \"proto3\";\r\n\r\npackage account;\r\n\r\nimport \"google/protobuf/empty.proto\";\r\n\r\nservice UserController {\r\n    rpc List(UserListRequest) returns (stream User) {}\r\n    rpc Create(User) returns (User) {}\r\n    rpc Retrieve(UserRetrieveRequest) returns (User) {}\r\n    rpc Update(User) returns (User) {}\r\n    rpc Destroy(User) returns (google.protobuf.Empty) {}\r\n}\r\n\r\nmessage User {\r\n    int32 id = 1;\r\n    string username = 2;\r\n    string email = 3;\r\n    repeated int32 groups = 4;\r\n}\r\n\r\nmessage UserListRequest {\r\n}\r\n\r\nmessage UserRetrieveRequest {\r\n    int32 id = 1;\r\n}</code></pre>\r\n</div>\r\n\r\n<p>或者您可以根据<code>User</code>模型自动生成它：</p>\r\n\r\n<div>&nbsp;</div>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">python manage.py generateproto --model django.contrib.auth.models.User --fields id,username,email,groups --file account.proto\r\n</code></pre>\r\n</div>\r\n\r\n<p>接下来，我们需要从<code>quickstart</code>目录生成gRPC代码，运行：</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">python -m grpc_tools.protoc --proto_path=./ --python_out=./ --grpc_python_out=./ ./account.proto\r\n</code></pre>\r\n</div>\r\n\r\n<h2>编写串行</h2>\r\n\r\n<p>然后，我们将定义一个序列化器，让我们创建一个名为的新模块&nbsp;<code>account/serializers.py</code>：</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">from django.contrib.auth.models import User\r\nfrom django_grpc_framework import proto_serializers\r\nimport account_pb2\r\n\r\n\r\nclass UserProtoSerializer(proto_serializers.ModelProtoSerializer):\r\n    class Meta:\r\n        model = User\r\n        proto_class = account_pb2.User\r\n        fields = [\'id\', \'username\', \'email\', \'groups\']</code></pre>\r\n</div>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h2>写作服务</h2>\r\n\r\n<p>现在我们编写一些服务，创建<code>account/services.py</code>：</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">from django.contrib.auth.models import User\r\nfrom django_grpc_framework import generics\r\nfrom account.serializers import UserProtoSerializer\r\n\r\n\r\nclass UserService(generics.ModelService):\r\n    \"\"\"\r\n    gRPC service that allows users to be retrieved or updated.\r\n    \"\"\"\r\n    queryset = User.objects.all().order_by(\'-date_joined\')\r\n    serializer_class = UserProtoSerializer</code></pre>\r\n</div>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h2>注册处理程序</h2>\r\n\r\n<p>好的，让我们连接gRPC处理程序，编辑<code>quickstart/urls.py</code>：</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">import account_pb2_grpc\r\nfrom account.services import UserService\r\n\r\n\r\nurlpatterns = []\r\n\r\n\r\ndef grpc_handlers(server):\r\n    account_pb2_grpc.add_UserControllerServicer_to_server(UserService.as_servicer(), server)</code></pre>\r\n</div>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>完成后，项目布局应如下所示：</p>\r\n\r\n<div>\r\n<pre style=\"margin-left:0px\">\r\n<code class=\"language-html\">.\r\n./quickstart\r\n./quickstart/asgi.py\r\n./quickstart/__init__.py\r\n./quickstart/settings.py\r\n./quickstart/urls.py\r\n./quickstart/wsgi.py\r\n./manage.py\r\n./account\r\n./account/migrations\r\n./account/migrations/__init__.py\r\n./account/services.py\r\n./account/models.py\r\n./account/serializers.py\r\n./account/__init__.py\r\n./account/apps.py\r\n./account/admin.py\r\n./account/tests.py\r\n./account.proto\r\n./account_pb2_grpc.py\r\n./account_pb2.py\r\n</code></pre>\r\n</div>\r\n\r\n<h2>拨打我们的服务</h2>\r\n\r\n<p>用开发模式启动服务器：</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-bash\">python manage.py grpcrunserver --dev</code></pre>\r\n</div>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>现在，我们可以从gRPC客户端访问我们的服务：</p>\r\n\r\n<div>\r\n<pre>\r\n<code class=\"language-python\">import grpc\r\nimport account_pb2\r\nimport account_pb2_grpc\r\n\r\n\r\nwith grpc.insecure_channel(\'localhost:50051\') as channel:\r\n    stub = account_pb2_grpc.UserControllerStub(channel)\r\n    for user in stub.List(account_pb2.UserListRequest()):\r\n        print(user, end=\'\')</code></pre>\r\n<img src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" /><img src=\"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==\" style=\"height:15px; width:15px\" title=\"点击并拖拽以移动\" /></div>\r\n\r\n<p style=\"text-align:center\">​</p>',
        '', '2021-01-25 05:40:00', '2021-01-25 05:40:00', 167, 1, 5, 0, 0, 1);
INSERT INTO `tb_content`
VALUES (129, '更换（Pypi）pip源到国内镜像',
        '<h3>pip国内的一些镜像</h3>\r\n\r\n<ul>\r\n	<li>阿里云&nbsp;<a href=\"http://mirrors.aliyun.com/pypi/simple/\" target=\"_blank\">https://mirrors.aliyun.com/pypi/simple/</a></li>\r\n	<li>中国科技大学&nbsp;<a href=\"https://pypi.mirrors.ustc.edu.cn/simple/\" target=\"_blank\">https://pypi.mirrors.ustc.edu.cn/simple/</a></li>\r\n	<li>豆瓣(douban)&nbsp;<a href=\"http://pypi.douban.com/simple/\" target=\"_blank\">https://pypi.douban.com/simple/</a></li>\r\n	<li>清华大学&nbsp;<a href=\"https://pypi.tuna.tsinghua.edu.cn/simple/\" target=\"_blank\">https://pypi.tuna.tsinghua.edu.cn/simple/</a></li>\r\n	<li>中国科学技术大学&nbsp;<a href=\"http://pypi.mirrors.ustc.edu.cn/simple/\" target=\"_blank\">https://pypi.mirrors.ustc.edu.cn/simple/</a></li>\r\n</ul>\r\n\r\n<p><strong>提示：若担心安全问题请使用HTTPS加密源</strong></p>\r\n\r\n<h3>修改源方法：</h3>\r\n\r\n<h4>临时使用：</h4>\r\n\r\n<p><strong>Linux Mac Windows 通用命令</strong></p>\r\n\r\n<p>可以在使用pip的时候在后面加上-i参数，指定pip源</p>\r\n\r\n<blockquote>\r\n<p>pip install scrapy -i&nbsp;<a href=\"https://pypi.tuna.tsinghua.edu.cn/simple\" target=\"_blank\">https://pypi.tuna.tsinghua.edu.cn/simple</a></p>\r\n</blockquote>\r\n\r\n<h4>永久修改：</h4>\r\n\r\n<p><strong>Linux:</strong></p>\r\n\r\n<p>修改 pip.conf 文件 (没有就创建一个)</p>\r\n\r\n<blockquote>\r\n<p>$HOME/.config/pip/pip.conf</p>\r\n</blockquote>\r\n\r\n<p>修改内容如下：</p>\r\n\r\n<blockquote>\r\n<p>[global]<br />\r\n<br />\r\nindex-url =&nbsp;<a href=\"https://pypi.tuna.tsinghua.edu.cn/simple12\" target=\"_blank\">https://pypi.tuna.tsinghua.edu.cn/simple12</a></p>\r\n</blockquote>\r\n\r\n<p><strong>Mac:</strong></p>\r\n\r\n<p>修改 pip.conf 文件</p>\r\n\r\n<blockquote>\r\n<p>$HOME/Library/Application Support/pip/pip.conf</p>\r\n</blockquote>\r\n\r\n<p>如果没有上面的目录,在如下目录创建 pip.conf</p>\r\n\r\n<blockquote>\r\n<p>$HOME/.config/pip/pip.conf</p>\r\n</blockquote>\r\n\r\n<p>修改内容如下：</p>\r\n\r\n<blockquote>\r\n<p>[global]<br />\r\n<br />\r\nindex-url =&nbsp;<a href=\"https://pypi.tuna.tsinghua.edu.cn/simple12\" target=\"_blank\">https://pypi.tuna.tsinghua.edu.cn/simple12</a></p>\r\n</blockquote>\r\n\r\n<p><strong>Windows:</strong></p>\r\n\r\n<p>修改 pip.conf 文件 (没有就创建一个)</p>\r\n\r\n<blockquote>\r\n<p>%APPDATA%\\pip\\pip.ini</p>\r\n</blockquote>\r\n\r\n<p>修改内容如下：</p>\r\n\r\n<blockquote>\r\n<p>[global]<br />\r\n<br />\r\nindex-url =&nbsp;<a href=\"https://pypi.tuna.tsinghua.edu.cn/simple\" target=\"_blank\">https://pypi.tuna.tsinghua.edu.cn/simple</a></p>\r\n</blockquote>\r\n\r\n<h3>修改文件后，执行命令发生错误</h3>\r\n\r\n<p>使用非HTTPS加密源（如豆瓣源），在执行命令发生错误，在命令最后加上<code>--trusted-host pypi.douban.com</code></p>\r\n\r\n<blockquote>\r\n<p>pip install django -i&nbsp;<a href=\"http://pypi.douban.com/simple\" target=\"_blank\">http://pypi.douban.com/simple</a>&nbsp;--trusted-host&nbsp;<a href=\"http://pypi.douban.com/\" target=\"_blank\">pypi.douban.com</a></p>\r\n</blockquote>',
        '', '2021-02-22 03:09:00', '2021-02-22 03:09:00', 136, 1, 2, 0, 0, 1);
INSERT INTO `tb_content`
VALUES (130, '升级了bigsur，虚拟机VMWARE打不开了',
        '<p>提示：提示物理内存不足，无法使用配置的设置开启虚拟机。</p>\r\n\r\n<p>原生应用程序和/或服务可能已锁定内存，这将阻止虚拟机启动。关闭不需要的应用程序或服务可能可以释放足够内存来启动此虚拟机。</p>\r\n\r\n<p>如果您以前能够在此主机上开启该虚拟机，请尝试重新引导此主机。重新引导主机后，可用于运行虚拟机的主机内存资源也许会比现在稍微多一些。</p>\r\n\r\n<p>解决方案：<br />\r\n使用VMWare Fusion 12</p>\r\n\r\n<p><img src=\"https://img-blog.csdnimg.cn/20210311134115323.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" /><br />\r\n官方下载地址：使用官方下载地址的话需要你自己注册一个账号，要Player的Licence的话还需要你注册一个东西，然官方就会给你一个下载链接和Licence。<br />\r\n不过安装包我已经下载好了，这里分享一下</p>\r\n\r\n<p>VMware Fusion Pro 12.1.0 中文破解版 (mac虚拟机工具)&nbsp;</p>\r\n\r\n<p>天翼云: 链接:&nbsp;https://cloud.189.cn/t/mURRF3vyaiMb&nbsp;&nbsp;&nbsp;&nbsp;密码: kit7<br />\r\n&nbsp;</p>',
        '', '2021-03-15 02:36:00', '2021-03-15 02:36:00', 108, 1, 4, 0, 0, 1);
INSERT INTO `tb_content`
VALUES (131, '规范python代码风格检查工具库',
        '<blockquote>\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;实际参与过项目开发后就能够深深体会到代码的规范对项目的重要性，这中间不仅关系着你对代码bug的修正还包括有后来的伙伴们拜读你的源码时，如果代码不规范，乱七八糟的，被小伙伴打死或者熬夜找bug事小，影响项目进度或者破坏项目结构就完蛋了</p>\r\n</blockquote>\r\n\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;通常我们的python代码都是遵循<a href=\"https://www.python.org/dev/peps/pep-0008/\" rel=\"nofollow\" target=\"_blank\">PEP8</a>的规范化格式,目的是为了保持代码的一致性、可读性。,这里给大家推荐几个常用的静态代码检查工具，大家可以酌情选择使用</p>\r\n\r\n<h2>1. pylint</h2>\r\n\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;Pylint是一个Python静态代码分析工具，它可以查找编程错误，帮助强制执行编码标准，嗅探代码异味并提供简单的重构建议。</p>\r\n\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;它具有高度可配置性，具有特殊的编译指示来控制代码中的错误和警告，以及广泛的配置文件。也可以编写自己的插件来添加自己的检查或以某种方式扩展pylint。</p>\r\n\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;缺省情况下，PyLint 启用许多规则。它具有高度可配置性，从代码内部处理程序控制它。另外，编写插件添加到自己的检查中是可能的。</p>\r\n\r\n<h3>安装</h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">pip install pylint\r\n\r\n#如果您使用的是Python 3.6+，请升级以获得对您的版本的完全支持：\r\npip install pylint --upgrade\r\n\r\n#如果要从源分发版安装，请解压缩tarball并运行以下命令\r\npython setup.py install\r\n</code></pre>\r\n\r\n<h3>文档</h3>\r\n\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;该文档位于<a href=\"http://pylint.pycqa.org/\" rel=\"nofollow\" target=\"_blank\">http://pylint.pycqa.org/</a>。</p>\r\n\r\n<h3>Pylint附带以下附加命令：</h3>\r\n\r\n<ul>\r\n	<li>pyreverse：一个UML图生成器</li>\r\n	<li>symilar：一个独立的相似性检查器</li>\r\n	<li>epylint：Emacs和Flymake兼容的Pylint</li>\r\n</ul>\r\n\r\n<h3>使用</h3>\r\n\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;pylint的各种引用以及使用方式都可以去<a href=\"http://pylint.pycqa.org/en/latest/user_guide/run.html\" rel=\"nofollow\" target=\"_blank\">文档</a>查找，这里仅介绍一下比较基础简单的示例</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<pre>\r\n<code class=\"language-python\">pylint [options] modules_or_packages\r\n</code></pre>\r\n\r\n<h3>命令行选项</h3>\r\n\r\n<table>\r\n	<thead>\r\n		<tr>\r\n			<th>参数</th>\r\n			<th>含义</th>\r\n		</tr>\r\n	</thead>\r\n	<tbody>\r\n		<tr>\r\n			<td>--version</td>\r\n			<td>显示程序的版本号并退出</td>\r\n		</tr>\r\n		<tr>\r\n			<td>-h, --help</td>\r\n			<td>显示有关命令行选项的帮助</td>\r\n		</tr>\r\n		<tr>\r\n			<td>--ignore=&lt;file[,file...]&gt;</td>\r\n			<td>将文件或目录添加到黑名单。它们应该是基本名称，而不是路径。</td>\r\n		</tr>\r\n		<tr>\r\n			<td>--output-format=&lt;format&gt;</td>\r\n			<td>选择输出格式（文本，json，自定义）。</td>\r\n		</tr>\r\n		<tr>\r\n			<td>--list-msgs</td>\r\n			<td>生成pylint的消息。</td>\r\n		</tr>\r\n	</tbody>\r\n</table>\r\n\r\n<h3>错误代码含义</h3>\r\n\r\n<ul>\r\n	<li>\r\n	<p>C：惯例，违反了编码风格标准</p>\r\n	</li>\r\n	<li>\r\n	<p>R：重构，代码非常糟糕</p>\r\n	</li>\r\n	<li>\r\n	<p>W：警告，某些 Python 特定的问题</p>\r\n	</li>\r\n	<li>\r\n	<p>E：错误，很可能是代码中的错误</p>\r\n	</li>\r\n	<li>\r\n	<p>F：致命错误，阻止 Pylint 进一步运行的错误</p>\r\n	</li>\r\n	<li>\r\n	<p>更多pylint相关可参考<a href=\"http://pylint.pycqa.org/en/latest/user_guide/run.html\" rel=\"nofollow\" target=\"_blank\">文档</a></p>\r\n	</li>\r\n</ul>\r\n\r\n<h2>2. yapf：</h2>\r\n\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;Python的大多数当前格式化程序 - 例如，autopep8和pep8ify ---用于从代码中删除lint错误。这有一些明显的局限性。例如，符合PEP 8指南的代码可能无法重新格式化。但这并不意味着代码看起来很好。</p>\r\n\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;YAPF采用不同的方法。它基于由Daniel Jasper开发的&#39;clang-format&#39;。从本质上讲，算法会获取代码并将其重新格式化为符合样式指南的最佳格式，即使原始代码没有违反样式指南。这个想法也类似于Go编程语言的&#39;gofmt&#39;工具：结束所有关于格式化的神圣战争</p>\r\n\r\n<ul>\r\n	<li>如果项目的整个代码库只是通过YAPF进行修改，只要进行修改，样式在整个项目中保持一致，并且没有必要在每次代码审查中争论风格。</li>\r\n</ul>\r\n\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;最终目标是YAPF生成的代码与程序员在遵循样式指南时编写的代码一样好。它消除了维护代码的一些苦差事。</p>\r\n\r\n<h3>安装</h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">pip install yapf\r\n</code></pre>\r\n\r\n<h3>使用</h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">yapf [-h] [-v] [-d | -i] [-r | -l START-END] [-e PATTERN]\r\n            [--style STYLE] [--style-help] [--no-local-style] [-p]\r\n            [-vv]\r\n            [files [files ...]]\r\n</code></pre>\r\n\r\n<blockquote>\r\n<p>同上，一样也可以直接跟文件进行操作</p>\r\n</blockquote>\r\n\r\n<table>\r\n	<thead>\r\n		<tr>\r\n			<th>参数</th>\r\n			<th>参数说明</th>\r\n		</tr>\r\n	</thead>\r\n	<tbody>\r\n		<tr>\r\n			<td>-h, --help</td>\r\n			<td>显示此帮助消息并退出</td>\r\n		</tr>\r\n		<tr>\r\n			<td>-v, --version</td>\r\n			<td>显示版本号并退出</td>\r\n		</tr>\r\n		<tr>\r\n			<td>-d, --diff</td>\r\n			<td>比较差异</td>\r\n		</tr>\r\n		<tr>\r\n			<td>-i, --in-place</td>\r\n			<td>对文件进行更改</td>\r\n		</tr>\r\n		<tr>\r\n			<td>-r, --recursive</td>\r\n			<td>以递归方式运行目录</td>\r\n		</tr>\r\n	</tbody>\r\n</table>\r\n\r\n<h3>示例</h3>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">#直接跟文件名（并不修改文件）\r\nyapf &lt;python file&gt;\r\n\r\n#格式化前后对比\r\n yapf -d &lt;python file&gt;\r\n\r\n#直接修改源文件\r\nyapf -i &lt;python file&gt;\r\n\r\n#导出配置文件\r\nyapf --style-help &gt; style.cfg\r\n\r\n#并发格式化多个文件，需要futures模块支持\r\nyapf -pi *.py\r\n</code></pre>\r\n\r\n<ul>\r\n	<li>\r\n	<p>更多yapf相关可参考<a href=\"https://github.com/google/yapf\" rel=\"nofollow\" target=\"_blank\">yapf</a></p>\r\n	</li>\r\n	<li>\r\n	<p>其他的此类工具还有Pyflakes，flake8等等，小编直接出到这两个常用的，更多内容大家在项目实战中应该会有更多接触</p>\r\n	</li>\r\n</ul>\r\n\r\n<p>&nbsp;</p>',
        '', '2021-03-09 06:42:00', '2021-03-09 06:43:00', 132, 1, 2, 0, 0, 1);
INSERT INTO `tb_content`
VALUES (132, 'Google 内部的 Python 代码风格指南（译）',
        '<p>这是一位朋友翻译的Google Python代码风格指南，很全面。可以作为公司的code review 标准，也可以作为自己编写代码的风格指南。希望对你有帮助。</p>\r\n\r\n<p>Translator: shendeguize@github</p>\r\n\r\n<p>Link: https://github.com/shendeguize/GooglePythonStyleGuideCN</p>\r\n\r\n<p>本翻译囿于水平，可能有不准确的地方，欢迎指出，谢谢大家</p>\r\n\r\n<h2>1、背景</h2>\r\n\r\n<p>Python是谷歌主要使用的动态语言，本风格指导列举了使用Python编程时应该做和不该做的事项(dos &amp; don&#39;ts)</p>\r\n\r\n<p>为了帮助你正确地组织代码,我们编写了一个Vim的设置文件.对于Emacs,默认设置即可.</p>\r\n\r\n<p>许多团队使用yapf自动格式工具来避免格式争议</p>\r\n\r\n<h2>2、Python语言规则</h2>\r\n\r\n<h3>2.1 Lint</h3>\r\n\r\n<p>对代码使用<code>pylint</code></p>\r\n\r\n<h4>2.1.1Definition(以下都译为定义)</h4>\r\n\r\n<p><code>pylint</code>是一个用于在Python代码中发现bug和代码风格问题的工具,，<code>pylint</code>查找那些常在非动态语言(例如C或C++)编译器中捕获的问题.由于Python是动态语言,一些警告可能不正确,不过应该非常少有错误警告.</p>\r\n\r\n<h4>2.1.2 Pros</h4>\r\n\r\n<p>能够发现一些易被遗漏的错误,类似拼写错误,调用早于声明等等.</p>\r\n\r\n<h4>2.1.3 Cons</h4>\r\n\r\n<p><code>pylint</code>并不完美,为了更好的利用工具,我们有时候需要</p>\r\n\r\n<p>a. Write around it(适配上下文风格)</p>\r\n\r\n<p>b. 压制一些警告</p>\r\n\r\n<p>c. 优化工具</p>\r\n\r\n<h4>2.1.4 Decision(以下都译为建议)</h4>\r\n\r\n<p>确保对代码应用<code>pylint</code></p>\r\n\r\n<p>如果一些警告是不合适的,就抑制这些警告,这是为了让其他警告不会被隐藏.为了压制警告,可以设置行级别的注释:</p>\r\n\r\n<pre>\r\n<code>dict = \'something awful\'  # Bad Idea... pylint: disable=redefined-builtin\r\n</code></pre>\r\n\r\n<p><code>pylint</code>警告包含标识名(<code>empty-docstring</code>),谷歌专有的警告以<code>g-</code>开头.</p>\r\n\r\n<p>如果抑制警告的原因在标识名称中表述不够清晰,请额外添加注解.</p>\r\n\r\n<p>用这种方式来抑制警告的优点是我们能够简单地找到抑制的警告并且重新访问这些警告.</p>\r\n\r\n<p>可以通过下述方式来获得<code>pylint</code>警告列表:</p>\r\n\r\n<pre>\r\n<code>pylint --list-msgs\r\n</code></pre>\r\n\r\n<p>用下述方式来获取某个特定消息的更多具体信息:</p>\r\n\r\n<pre>\r\n<code>pylint --help-msg=C6409\r\n</code></pre>\r\n\r\n<p>优先使用<code>pylint: disable</code>而非旧方法(<code>pylint: disable-msg</code>)如果要抑制由于参数未使用的警告,可以在函数开头del,并注释为什么要删除这些未使用参数,仅仅一句&quot;unused&quot;是不够的:</p>\r\n\r\n<pre>\r\n<code>def viking_cafe_order(spam, beans, eggs=None):\r\n    del beans, eggs  # Unused by vikings.\r\n    return spam + spam + spa\r\n</code></pre>\r\n\r\n<p>其他可以用来抑制警告的方式包括用<code>&#39;_&#39;</code>作为未使用参数的标识,在参数名前增加<code>&#39;unused_&#39;</code>,或者分配这些参数到<code>&#39;_&#39;</code>.这些方式是可以的,但是已经不鼓励继续使用.前两种方式会影响到通过参数名传参的调用方式,而最后一种并不能保证参数确实未被使用.</p>\r\n\r\n<h3>2.2 Imports</h3>\r\n\r\n<p>只在import包和模块的时候使用<code>import</code>,而不要应用在单独的类或函数.(这一条对于typing_module有特别的意外)</p>\r\n\r\n<h4>2.2.1 定义</h4>\r\n\r\n<p>一个模块到另一个模块之间共享代码的复用性机制</p>\r\n\r\n<h4>2.2.2 Pros</h4>\r\n\r\n<p>命名空间管理约定简单,每个标识的源都一致性地被指明了.例如<code>x.Obj</code>表示<code>Obj</code>是在模块<code>x</code>中定义的</p>\r\n\r\n<h4>2.2.3 Cons</h4>\r\n\r\n<p>模块名可能会有冲突,一些模块名可能很长,比较不方便</p>\r\n\r\n<h4>2.2.4 建议</h4>\r\n\r\n<ul>\r\n	<li>\r\n	<p><code>import&nbsp;x</code>（当<code>x</code>是包或模块）</p>\r\n	</li>\r\n	<li>\r\n	<p><code>from&nbsp;x&nbsp;import&nbsp;y</code>&nbsp;（当<code>x</code>是包前缀，<code>y</code>是不带前缀的模块名）</p>\r\n	</li>\r\n	<li>\r\n	<p><code>from&nbsp;x&nbsp;import&nbsp; y&nbsp;as&nbsp;z</code>&nbsp;（当有重复模块名<code>y</code>或<code>y</code>过长不利于引用的时候）</p>\r\n	</li>\r\n	<li>\r\n	<p><code>import&nbsp;y&nbsp;as&nbsp;z</code>&nbsp;（仅在非常通用的简写的时候使用例如<code>import numpy as np</code>）</p>\r\n	</li>\r\n</ul>\r\n\r\n<p>以<code>sound.effects.echo</code>为例:</p>\r\n\r\n<pre>\r\n<code>from sound.effects import echo...echo.EchoFilter(input, output, delay=0.7, atten=4)\r\n</code></pre>\r\n\r\n<p>不要使用相对引用，即便在同一包内，也使用完整包名import,这有助于避免无意重复import包.</p>\r\n\r\n<p>从typing module和six.moves module import不适用上述规则</p>\r\n\r\n<h3>2.3 包</h3>\r\n\r\n<p>每一模块都要从完整路径import</p>\r\n\r\n<h4>2.3.1 Pros</h4>\r\n\r\n<p>能够避免模块名冲突以及由于模块搜索路径与作者预期不符而造成的错误引用.让查找模块更简单.</p>\r\n\r\n<h4>2.3.2 Cons</h4>\r\n\r\n<p>让部署代码时有些困难,因为包架构也需要赋值,不过对于现在的部署机制而言,这其实不是问题.</p>\r\n\r\n<h4>2.3.3 建议</h4>\r\n\r\n<p>所有的新代码都要从完整包名来import模块</p>\r\n\r\n<p>import示例应该像这样:</p>\r\n\r\n<p>Yes:</p>\r\n\r\n<pre>\r\n<code># Reference absl.flags in code with the complete name (verbose).\r\n# 在代码中使用完整路径调用absl.flags\r\nimport absl.flagsfrom doctor.who import jodie\r\n\r\nFLAGS = absl.flags.FLAGS\r\n</code></pre>\r\n\r\n<pre>\r\n<code># Reference flags in code with just the module name (common).\r\n# 在代码中只用包名来调用flags\r\nfrom absl import flagsfrom doctor.who import jodie\r\n\r\nFLAGS = flags.FLAGS\r\n</code></pre>\r\n\r\n<p>No:(假设文件在<code>doctor/who</code>中,<code>jodie.py</code>也在这里)</p>\r\n\r\n<pre>\r\n<code># Unclear what module the author wanted and what will be imported.  The actual\r\n# import behavior depends on external factors controlling sys.path.\r\n# Which possible jodie module did the author intend to import?\r\n# 不清楚作者想要哪个包以及最终import的是哪个包,\r\n# 实际的import操作依赖于受到外部参数控制的sys.path\r\n# 那么哪一个可能的jodie模块是作者希望import的呢?\r\nimport jodie\r\n</code></pre>\r\n\r\n<p>不应该假设主代码所在路径被包含在<code>sys.path</code>中,即使有些时候可以work.在上一例代码中,我们应该认为<code>import jodie</code>指的是import一个叫做<code>jodie</code>的第三方包或者顶级目录中的<code>jodie</code>,而非一个当前路径的<code>jodie.py</code></p>\r\n\r\n<h3>2.4 异常</h3>\r\n\r\n<p>异常处理是允许使用的,但使用务必谨慎</p>\r\n\r\n<h4>2.4.1 定义</h4>\r\n\r\n<p>异常是一种从正常代码段控制流中跳出以处理错误或者其他异常条件的手段.</p>\r\n\r\n<h4>2.4.2 Pros</h4>\r\n\r\n<p>正常代码的控制流时不会被错误处理代码影响的.异常处理同样允许在某些情况下,控制流跳过多段代码,例如在某一步从N个嵌入函数返回结果而非强行延续错误代码.</p>\r\n\r\n<h4>2.4.3 Cons</h4>\r\n\r\n<p>可能会让控制流变的难于理解,也比较容易错过调用库函数的报错.</p>\r\n\r\n<h4>2.4.4 建议</h4>\r\n\r\n<p>异常必定遵循特定条件:</p>\r\n\r\n<ul>\r\n	<li>\r\n	<p>使用<code>raise MyError(&#39;Error message&#39;)</code>或者<code>raise MyError()</code>，不要使用两段<code>raise MyError, &#39;Error message&#39;</code></p>\r\n	</li>\r\n	<li>\r\n	<p>当内置异常类合理的时候,尽量使用内置异常.例如:抛出<code>ValueError</code>来表示一个像是违反预设前提(例如传参了一个负数给要求正数的情况)的程序错误发生.</p>\r\n	</li>\r\n</ul>\r\n\r\n<p>不要使用<code>assert</code>来片段公共结构参数值.<code>assert</code>是用来确认内部计算正确性也不是用来表示一些预期外的事件发生的.如果异常是后续处理要求的,用<code>raise</code>语句来处理,例如:</p>\r\n\r\n<p>Yes:</p>\r\n\r\n<pre>\r\n<code>def connect_to_next_port(self, minimum):\r\n\"\"\"Connects to the next available port.\r\n\r\nArgs:\r\n    minimum: A port value greater or equal to 1024.\r\n\r\nReturns:\r\n    The new minimum port.\r\n\r\nRaises:\r\n    ConnectionError: If no available port is found.\r\n\"\"\"\r\nif minimum &lt; 1024:\r\n    # Note that this raising of ValueError is not mentioned in the doc\r\n    # string\'s \"Raises:\" section because it is not appropriate to\r\n    # guarantee this specific behavioral reaction to API misuse.\r\n    # 注意抛出ValueError这件事是不在docstring中的Raises中提及, 因为这样并适合保障对于API误用的特殊反馈\r\n    raise ValueError(\'Minimum port must be at least 1024, not %d.\' % (minimum,))\r\nport = self._find_next_open_port(minimum)\r\nif not port:\r\n    raise ConnectionError(\'Could not connect to service on %d or higher.\' % (minimum,))\r\nassert port &gt;= minimum, \'Unexpected port %d when minimum was %d.\' % (port, minimum)\r\nreturn port\r\n</code></pre>\r\n\r\n<p>No:</p>\r\n\r\n<pre>\r\n<code>def connect_to_next_port(self, minimum):\r\n\"\"\"Connects to the next available port.\r\n\r\nArgs:\r\n    minimum: A port value greater or equal to 1024.\r\n\r\nReturns:\r\n    The new minimum port.\r\n\"\"\"\r\nassert minimum &gt;= 1024, \'Minimum port must be at least 1024.\'\r\nport = self._find_next_open_port(minimum)\r\nassert port is not None\r\nreturn port\r\n</code></pre>\r\n\r\n<ul>\r\n	<li>\r\n	<p>库或者包可能会定义各自的异常.当这样做的时候,必须要继承一个已经存在的异常类,异常类的名字应该以<code>Error</code>结尾,并且不应该引入重复(<code>foo.FooError</code>)</p>\r\n	</li>\r\n	<li>\r\n	<p>永远不要用捕获全部异常的<code>except:</code>语句,或者捕获<code>Exception</code>或者<code>StandardError</code>除非:</p>\r\n\r\n	<p>Python在这个方面容忍度很高,并且<code>except:</code>语句会捕获包括拼写错误,sys.exit(),Ctrl+C终止,单元测试失败和和所有你并没有想到捕获的其他异常.</p>\r\n\r\n	<ul>\r\n		<li>\r\n		<p>再次抛出这个异常</p>\r\n		</li>\r\n		<li>\r\n		<p>在程序中异常不会继续但是会被记录以及消除(例如通过保护最外层的方式保护线程不会崩溃)的地方创造一个孤立点.</p>\r\n		</li>\r\n	</ul>\r\n	</li>\r\n	<li>\r\n	<p>最精简<code>try/except</code>表达式内部的代码量,<code>try</code>代码块里的代码体量越大,月可能会在你不希望抛出异常的代码中抛出异常,进而在这种情况下,<code>try/except</code>掩盖了一个真实的异常</p>\r\n	</li>\r\n	<li>\r\n	<p>使用finally来执行代码,这些代码无论是否有异常在<code>try</code>代码块被抛出都会被执行.这在清理(即关闭文件)时非常有用.</p>\r\n	</li>\r\n	<li>\r\n	<p>当捕获了异常时,用as而不是逗号分段.</p>\r\n	</li>\r\n</ul>\r\n\r\n<pre>\r\n<code>try:\r\n    raise Error()\r\nexcept Error as error:\r\n    pass\r\n</code></pre>\r\n\r\n<h3>2.5 全局变量</h3>\r\n\r\n<p>避免全局变量</p>\r\n\r\n<h4>2.5.1 定义</h4>\r\n\r\n<p>在模块级别或者作为类属性声明的变量</p>\r\n\r\n<h4>2.5.2 Pros</h4>\r\n\r\n<p>有些时候有用</p>\r\n\r\n<h4>2.5.3 Cons</h4>\r\n\r\n<p>在import的过程中,有可能改变模块行为,因为在模块首次被引入的过程中,全局变量就已经被声明</p>\r\n\r\n<h4>2.5.4 建议</h4>\r\n\r\n<p>避免全局变量</p>\r\n\r\n<p>作为技术变量,模块级别的常量是允许并鼓励使用的.例如<code>MAX_HOLY_HANDGRENADE_COUNT = 3</code>, 常量必须由大写字母和下划线组成,参见下方命名规则</p>\r\n\r\n<p>如果需要,全局变量需要在模块级别声明,并且通过在变量名前加<code>_</code>来使其对模块内私有化.外部对模块全局变量的访问必须通过公共模块级别函数,参见下方命名规则</p>\r\n\r\n<h3>2.6 内嵌/局部/内部 类和函数</h3>\r\n\r\n<p>内嵌局部函数或类在关闭局部变量时是可以的.内部类意识可用的.(译注:这里我的理解是当内嵌局部函数或类是和局部变量在同一个封闭作用域内是可以的.)</p>\r\n\r\n<h4>2.6.1 定义</h4>\r\n\r\n<p>类可以在方法,函数,类内定义.函数可以在方法或函数内定义.内嵌函数对封闭作用域的变量具有只读访问权限.</p>\r\n\r\n<h4>2.6.2 Pros</h4>\r\n\r\n<p>允许定义只在非常有限作用域内可用的工具类或工具函数.Very ADT-y(??符合抽象数据类型要求???),通常用于实现装饰器</p>\r\n\r\n<h4>2.6.3 Cons</h4>\r\n\r\n<p>内嵌或局部类的实例是不能被pickle的,内嵌函数或类是不能被直接测试的.嵌套会让外部函数更长并且更难读懂.</p>\r\n\r\n<h4>2.6.4 建议</h4>\r\n\r\n<p>除了一些特别声明,这些内嵌/局部/内部类和函数都是可以的.避免内嵌函数或类除了需要关闭一个局部值的时候.(译者理解可能是除了将局部变量封闭在同一个作用域的情况以外).不要把一个函数转为内嵌指示为了避免访问.在这种情况下,把函数置于模块级别并在函数名前加<code>_</code>以保证测试是可以访问该函数的.</p>\r\n\r\n<h3>2.7 列表推导和生成器表达式</h3>\r\n\r\n<p>在简单情况下是可用的</p>\r\n\r\n<h4>2.7.1 定义</h4>\r\n\r\n<p>List, Dict和Set推导生成式以及生成器表达式提供了一个简明有效的方式来生成容器和迭代器而不需要传统的循环,<code>map()</code>,<code>filter()</code>或者<code>lambda表达式</code></p>\r\n\r\n<h4>2.7.2 Pros</h4>\r\n\r\n<p>简单地推导表达比其他的字典,列表或集合生成方法更加简明清晰.生成器表达式可以很有效率,因为完全避免了生成列表.</p>\r\n\r\n<h4>2.7.3 Cons</h4>\r\n\r\n<p>负载的推导表达式或生成器表达式很难读懂</p>\r\n\r\n<h4>2.7.4 建议</h4>\r\n\r\n<p>简单情况下使用时可以的.每个部分(mapping表达式,filter表达式等)都应该在一行内完成.多个for条款或者filter表达式是不允许的.当情况变得很复杂的适合就使用循环.</p>\r\n\r\n<p>Yes:</p>\r\n\r\n<pre>\r\n<code>result = [mapping_expr for value in iterable if filter_expr]\r\n\r\nresult = [{\'key\': value} for value in iterable\r\n          if a_long_filter_expression(value)]\r\n\r\nresult = [complicated_transform(x)\r\n          for x in iterable if predicate(x)]\r\n\r\ndescriptive_name = [\r\n    transform({\'key\': key, \'value\': value}, color=\'black\')\r\n    for key, value in generate_iterable(some_input)\r\n    if complicated_condition_is_met(key, value)\r\n]\r\n\r\nresult = []\r\nfor x in range(10):\r\n    for y in range(5):\r\n        if x * y &gt; 10:\r\n            result.append((x, y))\r\n\r\nreturn {x: complicated_transform(x)\r\n        for x in long_generator_function(parameter)\r\n        if x is not None}\r\n\r\nsquares_generator = (x**2 for x in range(10))\r\n\r\nunique_names = {user.name for user in users if user is not None}\r\n\r\neat(jelly_bean for jelly_bean in jelly_beans\r\n    if jelly_bean.color == \'black\')\r\n</code></pre>\r\n\r\n<p>No:</p>\r\n\r\n<pre>\r\n<code>result = [complicated_transform(\r\n          x, some_argument=x+1)\r\n          for x in iterable if predicate(x)]\r\n\r\nresult = [(x, y) for x in range(10) for y in range(5) if x * y &gt; 10]\r\n\r\nreturn ((x, y, z)\r\n        for x in range(5)\r\n        for y in range(5)\r\n        if x != y\r\n        for z in range(5)\r\n        if y != z)\r\n</code></pre>\r\n\r\n<h3>2.8 默认迭代器和运算符</h3>\r\n\r\n<p>对支持默认迭代器和云算法的类型例如列表,字典和文件等使用它们</p>\r\n\r\n<h4>2.8.1 定义</h4>\r\n\r\n<p>容器类型(例如字典,列表等)定义了的默认的迭代器和成员检查运算符.</p>\r\n\r\n<h4>Pros</h4>\r\n\r\n<p>默认迭代器和操作符是简单有效的,能够直接不需额外调用方法地表达操作.使用默认操作符的函数是通用的.能被用于任何支持这些操作的类型.</p>\r\n\r\n<h4>Cons</h4>\r\n\r\n<p>不能通过方法名来分辨类型,例如<code>has_key()</code>意味着字典,当然这也是一种优势.</p>\r\n\r\n<h4>建议</h4>\r\n\r\n<p>对于支持的类型诸如列表,字典和文件,使用默认迭代器和操作符.内置类型同样定义了迭代器方法.优先使用这些方法而非那些返回列表的方法.除非能够确定在遍历容器的过程中不会改变容器.不要使用Python 2专有迭代方法除非必要.</p>\r\n\r\n<p>Yes:</p>\r\n\r\n<pre>\r\n<code>for key in adict: ...\r\nif key not in adict: ...\r\nif obj in alist: ...\r\nfor line in afile: ...\r\nfor k, v in adict.items(): ...\r\nfor k, v in six.iteritems(adict): ...\r\n</code></pre>\r\n\r\n<p>No:</p>\r\n\r\n<pre>\r\n<code>for key in adict.keys(): ...\r\nif not adict.has_key(key): ...\r\nfor line in afile.readlines(): ...\r\nfor k, v in dict.iteritems(): ...\r\n</code></pre>\r\n\r\n<h3>2.9 生成器</h3>\r\n\r\n<p>需要时使用生成器</p>\r\n\r\n<h4>2.9.1 定义</h4>\r\n\r\n<p>生成器函数返回一个迭代器,每次执行<code>yield</code>语句的时候生成一个值.在生成一个值之后,生成器函数的运行被挂起直到需要下一个值.</p>\r\n\r\n<h4>2.9.2 Pros</h4>\r\n\r\n<p>简化代码,因为局部变量和控制流在每次调用时被保留,生成器相比于一次性生成整个一个列表值要更节省内存.</p>\r\n\r\n<h4>2.9.3 Cons</h4>\r\n\r\n<p>无</p>\r\n\r\n<h4>2.9.4 建议</h4>\r\n\r\n<p>建议使用.在生成器函数的文档字符串中使用&quot;Yields:&quot;而非&quot;Returns:&quot;</p>\r\n\r\n<h3>2.10 Lambda表达式</h3>\r\n\r\n<p>单行代码时是可以的</p>\r\n\r\n<h4>2.10.1 定义</h4>\r\n\r\n<p>lambda在一个表达式内定义了匿名函数,而不在语句里.lambda表达式常被用于定义高阶函数(例如<code>map()</code>和<code>filter()</code>)使用的回调函数或者操作符.</p>\r\n\r\n<h4>2.10.2 Pros</h4>\r\n\r\n<p>方便</p>\r\n\r\n<h4>2.10.3 Cons</h4>\r\n\r\n<p>比局部函数更难读懂和debug,匿名意味着堆栈跟踪更难懂.表达性受限因为lambda函数只包含一个表达式</p>\r\n\r\n<h4>2.10.4 建议</h4>\r\n\r\n<p>对于单行代码而言,可以使用lambda表达式.如果<code>lambda</code>表达式内的代码超过60-80个字符,最好定义成为常规的内嵌函数.</p>\r\n\r\n<p>对于一般的操作诸如乘法,使用<code>operator</code>模块内置函数而非重新定义匿名函数,例如使用<code>operator.mul</code>而非<code>lambda x,y: x * y</code></p>\r\n\r\n<h3>2.11 条件表达式</h3>\r\n\r\n<p>简单情况下可以使用.</p>\r\n\r\n<h4>2.11.1 定义</h4>\r\n\r\n<p>条件表达式(也称为三元运算符)是一种更短替代if语句的机制.例如<code>x = 1 if cond else 2</code></p>\r\n\r\n<h4>2.11.2 Pros</h4>\r\n\r\n<p>相对于if语句更短也更方便</p>\r\n\r\n<h4>2.11.3 Cons</h4>\r\n\r\n<p>比if语句可能更难读懂,当表达式很长的时候条件部分可能很难定位.</p>\r\n\r\n<h4>2.11.4 建议</h4>\r\n\r\n<p>简单情况可以使用.每个部分(真值表达式,if表达式,else表达式)必须在一行内完成.如果使用条件表达式很富的时候使用完整的if语句.</p>\r\n\r\n<p>Yes:</p>\r\n\r\n<pre>\r\n<code>one_line = \'yes\' if predicate(value) else \'no\'\r\nslightly_split = (\'yes\' if predicate(value)\r\n                  else \'no, nein, nyet\')\r\nthe_longest_ternary_style_that_can_be_done = (\r\n    \'yes, true, affirmative, confirmed, correct\'\r\n    if predicate(value)\r\n    else \'no, false, negative, nay\')\r\n</code></pre>\r\n\r\n<p>No:</p>\r\n\r\n<pre>\r\n<code>bad_line_breaking = (\'yes\' if predicate(value) else\r\n                     \'no\')portion_too_long = (\'yes\'\r\n                    if some_long_module.some_long_predicate_function(\r\n                        really_long_variable_name)\r\n                    else \'no, false, negative, nay\')\r\n</code></pre>\r\n\r\n<h3>2.12 默认参数值</h3>\r\n\r\n<p>大多数情况下都OK</p>\r\n\r\n<h4>2.12.1 定义</h4>\r\n\r\n<p>在函数参数列表的最后可以为变量设定值,例如<code>def foo(a, b=0):</code>.如果<code>foo</code>在调用时只传入一个参数,那么<code>b</code>变量就被设定为0,如果调用时传入两个参数,那么<code>b</code>就被赋予第二个参数值.</p>\r\n\r\n<h4>2.12.2 Pros</h4>\r\n\r\n<p>通常一个函数可能会有大量默认值,但是很少会有需要修改这些默认值的时候.默认值就提供了一个很简单满足上述情况的方式,而不需要为这些少见的情况重新定义很多函数.因为Python不支持重载方法或函数,默认参数是一个很简单的方式来&quot;假重载&quot;行为.</p>\r\n\r\n<h4>2.12.3 Cons</h4>\r\n\r\n<p>默认参数在模块加载时就被复制.这在参数是可变对象(例如列表或字典)时引发问题.如果函数修改了这些可变对象(例如向列表尾添加元素).默认值就被改变了.</p>\r\n\r\n<h4>2.12.4 建议</h4>\r\n\r\n<p>使用时请注意以下警告----在函数或方法定义时不要将可变对象作为默认值.</p>\r\n\r\n<p>Yes:</p>\r\n\r\n<pre>\r\n<code>def foo(a, b=None):\r\n    if b is None:\r\n        b = []\r\ndef foo(a, b: Optional[Sequence] = None):\r\n    if b is None:\r\n        b = []\r\ndef foo(a, b: Sequence = ()):  # Empty tuple OK since tuples are immutable 空元组是也不可变的\r\n    ...\r\n</code></pre>\r\n\r\n<p>No:</p>\r\n\r\n<pre>\r\n<code>def foo(a, b=[]):\r\n    ...\r\ndef foo(a, b=time.time()):  # The time the module was loaded??? 模块被加载的时间???\r\n    ...\r\ndef foo(a, b=FLAGS.my_thing):  # sys.argv has not yet been parsed... sys.argv还未被解析\r\n    ...\r\ndef foo(a, b: Mapping = {}):  # Could still get passed to unchecked code 仍可传入未检查的代码(此处翻译可能有误)\r\n    ...\r\n</code></pre>\r\n\r\n<h3>2.13 属性</h3>\r\n\r\n<p>使用属性可以通过简单而轻量级的访问器和设定器方法来访问或设定数据.</p>\r\n\r\n<h4>2.13.1 定义</h4>\r\n\r\n<p>一种装饰器调用来在计算比较轻量级时作为标准的属性访问来获取和设定一个属性的方式</p>\r\n\r\n<h4>2.13.2 Pros</h4>\r\n\r\n<p>对于简单的属性访问,减少显式的get和set方法能够提升可读性.允许惰性计算.被认为是一种Python化的方式来维护类接口.在表现上,当直接对变量的访问更合理时,允许属性绕过所需的琐碎的访问方法.</p>\r\n\r\n<h4>2.13.3 Cons</h4>\r\n\r\n<p>在Python2中必须继承于<code>object</code>,可能会隐藏像是操作符重载之类的副作用.对于子类而言,属性可能有些迷惑性.</p>\r\n\r\n<h4>2.13.4 建议</h4>\r\n\r\n<p>在通常会有简单而且轻量级的访问和设定方法的新代码里使用属性来访问或设定数据.属性在创建时被<code>@property</code>装饰,参加装饰器</p>\r\n\r\n<p>如果属性本身未被重写,带有属性的继承可能不够明晰,因而必须确保访问方法是被间接访问的,来确保子类的方法重载是被属性调用的(使用Template Method DP,译者:应是模板方法设计模式).</p>\r\n\r\n<p>Yes:</p>\r\n\r\n<pre>\r\n<code>class Square(object):\r\n    \"\"\"A square with two properties: a writable area and a read-only perimeter.\r\n\r\n    To use:\r\n    &gt;&gt;&gt; sq = Square(3)\r\n    &gt;&gt;&gt; sq.area\r\n    9\r\n    &gt;&gt;&gt; sq.perimeter\r\n    12\r\n    &gt;&gt;&gt; sq.area = 16\r\n    &gt;&gt;&gt; sq.side\r\n    4\r\n    &gt;&gt;&gt; sq.perimeter\r\n    16\r\n    \"\"\"\r\n\r\n    def __init__(self, side):\r\n        self.side = side\r\n\r\n    @property\r\n    def area(self):\r\n        \"\"\"Area of the square.\"\"\"\r\n        return self._get_area()\r\n\r\n    @area.setter\r\n    def area(self, area):\r\n        return self._set_area(area)\r\n\r\n    def _get_area(self):\r\n        \"\"\"Indirect accessor to calculate the \'area\' property.\"\"\"\r\n        return self.side ** 2\r\n\r\n    def _set_area(self, area):\r\n        \"\"\"Indirect setter to set the \'area\' property.\"\"\"\r\n        self.side = math.sqrt(area)\r\n\r\n    @property\r\n    def perimeter(self):\r\n        return self.side * 4\r\n</code></pre>\r\n\r\n<h3>2.14 True/False表达式</h3>\r\n\r\n<p>只要可能,就使用隐式False的if语句</p>\r\n\r\n<h4>2.14.1 定义</h4>\r\n\r\n<p>在布尔环境下,Python对某些值判定为False,一个快速的经验规律是所有&quot;空&quot;值都被认为是False,所以<code>0, None, [], {}, &#39;&#39;</code>的布尔值都是False</p>\r\n\r\n<h4>2.14.2 Pros</h4>\r\n\r\n<p>使用Python布尔类型的条件语句可读性更好而且更难出错,大多数情况下,这种方式也更快.</p>\r\n\r\n<h4>2.14.3 Cons</h4>\r\n\r\n<p>对于C/C++开发者而言可能有些奇怪</p>\r\n\r\n<h4>建议</h4>\r\n\r\n<p>如果可能的话,使用隐式False.例如使用<code>if foo:</code>而非<code>if foo != []:</code>下面列举了一些你应该牢记的警告:</p>\r\n\r\n<ul>\r\n	<li>\r\n	<p>使用<code>if foo is None</code>(或者<code>if foo is not None</code>)来检查<code>None</code>.例如在检查一个默认值是<code>None</code>的变量或者参数是否被赋予了其他值的时候,被赋予的其他值的布尔值可能为False.</p>\r\n	</li>\r\n	<li>\r\n	<p>不要用<code>==</code>来和布尔值为<code>False</code>的变量比较,使用<code>if not x</code>,如果需要区别<code>False</code>和<code>None</code>,那么使用链式的表达式如<code>if&nbsp;not&nbsp;x&nbsp;and&nbsp;x&nbsp;is&nbsp;not&nbsp;None</code></p>\r\n	</li>\r\n	<li>\r\n	<p>对于序列(如字符串,列表,元组),利用空序列为<code>False</code>的事实,故而相应地使用<code>if seq:</code>和<code>if not seq:</code>而非<code>if len(seq)</code>或<code>if not len(seq):</code>.</p>\r\n	</li>\r\n	<li>\r\n	<p>在处理整数时,隐式的False可能会引入更多风险(例如意外地将<code>None</code>和0进行了相同的处理)你可以用一个已知是整形(并且不是<code>len()</code>的结果)的值和整数0比较.</p>\r\n	</li>\r\n</ul>\r\n\r\n<p>Yes:</p>\r\n\r\n<pre>\r\n<code>if not users:\r\n    print(\'no users\')\r\n\r\nif foo == 0:\r\n    self.handle_zero()\r\n\r\nif i % 10 == 0:\r\n    self.handle_multiple_of_ten()\r\n\r\ndef f(x=None):\r\n    if x is None:\r\n        x = []\r\n</code></pre>\r\n\r\n<p>No:</p>\r\n\r\n<pre>\r\n<code>if len(users) == 0:\r\n    print(\'no users\')\r\n\r\nif foo is not None and not foo:\r\n    self.handle_zero()\r\n\r\nif not i % 10:\r\n    self.handle_multiple_of_ten()\r\n\r\ndef f(x=None):\r\n    x = x or []\r\n</code></pre>\r\n\r\n<h3>2.15 弃用的语言特性</h3>\r\n\r\n<p>尽可能利用字符串方法而非<code>string</code>模块.使用函数调用语法而非<code>apply</code>.在函数参数本就是一个行内匿名函数的时候,使用列表推导表达式和for循环而非<code>filter</code>和<code>map</code></p>\r\n\r\n<h4>2.15.1 定义</h4>\r\n\r\n<p>当前Python版本提供了人们普遍更倾向的构建方式.</p>\r\n\r\n<h4>2.15.2 建议</h4>\r\n\r\n<p>我们不使用任何不支持这些特性的Python版本,因而没有理由不使用新方式.</p>\r\n\r\n<p>Yes:</p>\r\n\r\n<pre>\r\n<code>words = foo.split(\':\')\r\n\r\n[x[1] for x in my_list if x[2] == 5]\r\n\r\nmap(math.sqrt, data)    # Ok. No inlined lambda expression. 可以,没有行内的lambda表达式\r\n\r\nfn(*args, **kwargs)\r\n</code></pre>\r\n\r\n<p>No:</p>\r\n\r\n<pre>\r\n<code>words = string.split(foo, \':\')\r\n\r\nmap(lambda x: x[1], filter(lambda x: x[2] == 5, my_list))\r\n\r\napply(fn, args, kwargs)\r\n</code></pre>\r\n\r\n<h3>2.16 词法作用域</h3>\r\n\r\n<p>可以使用</p>\r\n\r\n<h4>2.16.1 定义</h4>\r\n\r\n<p>一个内嵌Python函数可以引用在闭包命名空间内定义的变量,但是不能对其复制.变量绑定是解析到使用词法作用域的,即基于静态程序文本.任何对块内命名的赋值都会让Python将对于这个命名的引用都作为局部变量,即使在使用先于赋值的情况下也是.如果有全局声明,这个命名就会被认为是全局变量.</p>\r\n\r\n<p>一个使用这个特性的例子是:</p>\r\n\r\n<pre>\r\n<code>def get_adder(summand1):\r\n    \"\"\"Returns a function that adds numbers to a given number.\"\"\"\r\n    def adder(summand2):\r\n        return summand1 + summand2\r\n\r\n    return adder\r\n</code></pre>\r\n\r\n<h4>2.16.2 Pros</h4>\r\n\r\n<p>经常可以让代码更简明优雅,尤其会让有经验的Lisp和Scheme(以及Haskell和ML还有其他)的程序要很舒服.</p>\r\n\r\n<h4>2.16.3 Cons</h4>\r\n\r\n<p>可能会导致令人迷惑的bug例如这个基于PEP-0227的例子.</p>\r\n\r\n<pre>\r\n<code>i = 4\r\ndef foo(x):\r\n    def bar():\r\n        print(i, end=\'\')\r\n    # ...\r\n    # A bunch of code here\r\n    # ...\r\n    for i in x:  # Ah, i *is* local to foo, so this is what bar sees i对于foo来说是局部变量,所以在这里就是bar函数所获取的值\r\n        print(i, end=\'\')\r\n    bar()\r\n</code></pre>\r\n\r\n<p>所以<code>foo([1, 2, 3])</code>会打印<code>1 2 3 3</code>而非<code>1 2 3 4</code>.</p>\r\n\r\n<h4>2.16.4 建议</h4>\r\n\r\n<p>可以使用</p>\r\n\r\n<h3>2.17 函数和方法装饰器</h3>\r\n\r\n<p>在明显有好处时,谨慎明智的使用，避免<code>@staticmethod</code>，控制使用<code>@classmethod</code></p>\r\n\r\n<h4>2.17.1 定义</h4>\r\n\r\n<p>函数和方法装饰器(也就是<code>@</code>记号).一个常见的装饰器是<code>@property</code>,用于将普通方法转换成动态计算属性.然而装饰器语法也允许用户定义装饰器,尤其对于一些函数<code>my_decorator</code>如下:</p>\r\n\r\n<pre>\r\n<code>class C(object):\r\n    @my_decorator\r\n    def method(self):\r\n        # method body ...\r\n</code></pre>\r\n\r\n<p>是等效于</p>\r\n\r\n<pre>\r\n<code>class C(object):\r\n    def method(self):\r\n        # method body ...\r\n    method = my_decorator(method)\r\n</code></pre>\r\n\r\n<h4>2.17.2 Pros</h4>\r\n\r\n<p>能够优雅的对方法进行某种转换,而该转换可能减少一些重复代码并保持不变性等等.</p>\r\n\r\n<h4>2.17.3 Cons</h4>\r\n\r\n<p>装饰器可以对函数的参数和返回值任意操作,导致非常隐形的操作行为.此外,装饰器在import的时候就被执行,装饰器代码的实效可能非常难恢复.</p>\r\n\r\n<h4>2.17.4 建议</h4>\r\n\r\n<p>在有明显好处的地方谨慎地使用装饰器.装饰器应该和函数遵守相同的import和命名指导规则.装饰器的文档应该清晰地声明该函数为装饰器函数.并且要为装饰器函数编写单元测试.</p>\r\n\r\n<p>避免装饰器自身对外部的依赖,(如不要依赖于文件,socket,数据库连接等等),这是由于在装饰器运行的时候(在import时,可能从<code>pydoc</code>或其他工具中)这些外部依赖可能不可用.一个被传入有效参数并调用的装饰器应该(尽可能)保证在任何情况下都可用.</p>\r\n\r\n<p>装饰器是一种特殊的&quot;顶级代码&quot;,参见main</p>\r\n\r\n<p>永远不要使用<code>@staticmethod</code>,除非不得不整合一个API到一个已有的库,应该写一个模块等级的函数.</p>\r\n\r\n<p>只在写一个命名的构造器或者一个类特定的,修改必要的全局状态(例如进程缓存等)的流程时使用<code>@classmethod</code>.</p>\r\n\r\n<h3>2.18 线程</h3>\r\n\r\n<p>不要依赖于内建类型的原子性</p>\r\n\r\n<p>尽管Python内置数据类型例如字典等似乎有原子性操作,仍有一些罕见情况下,他们是非原子的(比如,如果<code>__hash__</code>或者<code>__eq__</code>被实现为Python方法),就不应该依赖于这些类型的原子性.也不应该依赖于原子变量赋值(因为这依赖于字典)</p>\r\n\r\n<p>优先使用Queue模块的<code>Queue</code>类来作为线程之间通讯数据的方式.此外,要是用threading模块和其locking primitives(锁原语).了解条件变量的合理用法以便于使用<code>threading.Condition</code>而非使用更低级的锁.</p>\r\n\r\n<h3>2.19 过于强大的特性</h3>\r\n\r\n<p>尽量避免使用</p>\r\n\r\n<h4>2.19.1 定义</h4>\r\n\r\n<p>Python是一种非常灵活的语言并且提供了很多新奇的特性,诸如定制元类,访问字节码,动态编译,动态继承,对象父类重定义,import hacks,反射(例如一些对于<code>getattr()</code>的应用),系统内置的修改等等.</p>\r\n\r\n<h4>2.19.2 Pros</h4>\r\n\r\n<p>这些是非常强大的语言特性,可以让程序更紧凑</p>\r\n\r\n<h4>2.19.3 Cons</h4>\r\n\r\n<p>使用这些新特性是很诱人的.但是并不绝对必要,它们很难读很难理解.也很难debug那些在底层使用了不常见的特性的代码.对于原作者而言可能不是这样,但是再次看代码的时候,可能比更长但是更直接的代码要难.</p>\r\n\r\n<h4>2.19.4 定义</h4>\r\n\r\n<p>避免在代码中使用这些特性.</p>\r\n\r\n<p>内部使用这些特性的标准库和类是可以使用的(例如<code>abc.ABCMeta</code>,<code>collections.namedtuple</code>,和<code>enum</code>)</p>\r\n\r\n<h3>2.20 新版本Python: Python3 和从<code>__future__</code>import</h3>\r\n\r\n<p>Python3已经可用了(译者:目前Python2已经不受支持了),尽管不是每个项目都准备好使用Python3,所有的代码应该兼容Python3并且在可能的情况下在Python3的环境下测试.</p>\r\n\r\n<h4>2.20.1 定义</h4>\r\n\r\n<p>Python3是Python的重大改变,尽管现有代码通常是Python2.7写成的,但可以做一些简单的事情来让代码更加明确地表达其意图,从而可以让代码更好地在Python3下运行而不用调整.</p>\r\n\r\n<h4>2.20.2 Pros</h4>\r\n\r\n<p>在考虑Python3编写的代码更清晰明确，一旦所有依赖已就绪，就可以更容易在Python3环境下运行.</p>\r\n\r\n<h4>2.20.3 Cons</h4>\r\n\r\n<p>一些人会认为默认样板有些丑,import实际不需要的特性到模块中是不常见的.</p>\r\n\r\n<h4>2.20.4 建议</h4>\r\n\r\n<p>from future imports</p>\r\n\r\n<p>鼓励使用<code>from __future__ import</code>语句.所有新代码都应该包含下述代码,而现有代码应该被更新以尽可能兼容:</p>\r\n\r\n<pre>\r\n<code>from __future__ import absolute_import\r\nfrom __future__ import division\r\nfrom __future__ import print_function\r\n</code></pre>\r\n\r\n<p>如果你不太熟悉这些,详细阅读这些:绝对import,新的<code>/</code>除法行为,和<code>print</code>函数</p>\r\n\r\n<p>请勿省略或移除这些import,即使在模块中他们没有在使用,除非代码只用于Python3.最好总是在所有的文档中都有从future的import,来保证不会在有人使用在后续编辑时遗忘.</p>\r\n\r\n<p>有其他的<code>from __future__</code>import语句,看喜好使用.我们的建议中不包含<code>unicode_literals</code>因为其并无明显优势,这是由于隐式默认的编码转换导致其在Python2.7内很多地方被引入了,必要时,大多数代码最好显式的使用<code>b&#39;&#39;</code>和<code>u&#39;&#39;</code>btyes和unicode字符串表示.(译者:这段翻译可能不准确)</p>\r\n\r\n<p>The six, future, or past libraries</p>\r\n\r\n<p>当项目需要支持Python2和3时,根据需求使用six,future和past.</p>\r\n\r\n<h3>2.21 带有类型注释的代码</h3>\r\n\r\n<p>可以根据PEP-484对Python3代码进行类型注释,并且在build时用类型检查工具例如pytype进行类型检查.</p>\r\n\r\n<p>类型注释可以在源码中或stub pyi file中.只要可能,注释就应写在源代码中.对于第三方或拓展模块使用pyi文件.</p>\r\n\r\n<h4>2.21.1 定义</h4>\r\n\r\n<p>类型注释(也称为&quot;类型提示&quot;)是用于函数或方法参数和返回值的:</p>\r\n\r\n<pre>\r\n<code>def func(a: int) -&gt; List[int]:\r\n</code></pre>\r\n\r\n<p>你也可以声明用一个单独的注释来声明变量的类型:</p>\r\n\r\n<pre>\r\n<code>a = SomeFunc()  # type: SomeType\r\n</code></pre>\r\n\r\n<h4>2.21.2 Pros</h4>\r\n\r\n<p>类型注释提升代码的可读性和可维护性,类型检查会将很多运行错误转化为构建错误,也减少了使用过于强力特性的能力.</p>\r\n\r\n<h4>2.21.3 Cons</h4>\r\n\r\n<p>需要不断更新类型声明,对于认为有效的代码可能会报类型错误,使用类型检查可能减少使用过于强力特性的能力.</p>\r\n\r\n<h4>2.21.4 建议</h4>\r\n\r\n<p>强烈鼓励在更新代码的时候进行Python类型分析.在对公共API进行补充和修改时,包括python类型声明并通过构建系统中的pytype进行检查.对Python来说静态类型检查比较新,我们承认,一些意料外的副作用(例如错误推断的类型)可能拒绝一些项目的使用.这种情况下,鼓励作者适当地增加一个带有TODO或到bug描述当前不接搜的类型注释的链接到BUILD文件或者在代码内.</p>\r\n\r\n<h2>3、Python代码风格规范</h2>\r\n\r\n<h3>3.1 分号</h3>\r\n\r\n<p>不要在行尾加分号，也不要用分号把两行语句合并到一行</p>\r\n\r\n<h3>3.2 行长度</h3>\r\n\r\n<p>最大行长度是<em>80个字符</em></p>\r\n\r\n<p>超出80字符的明确例外:</p>\r\n\r\n<ul>\r\n	<li>\r\n	<p>长import</p>\r\n	</li>\r\n	<li>\r\n	<p>注释中的：URL,路径,flags等</p>\r\n	</li>\r\n	<li>\r\n	<p>不包含空格不方便分行的模块级别的长字符串常量</p>\r\n	</li>\r\n	<li>\r\n	<p>pylint的diable注释使用(如<code># pylint: disable=invalid-name</code>)</p>\r\n	</li>\r\n</ul>\r\n\r\n<p>不要使用反斜杠连接,除非对于需要三层或以上的上下文管理器<code>with</code>语句</p>\r\n\r\n<p>利用Python的implicit line joining inside parentheses, brackets and braces(隐式行连接方法--括号连接,包括<code>(), [], {}</code>).如果必要的话,也可在表达式外面额外添加一对括号.</p>\r\n\r\n<p>Yes:</p>\r\n\r\n<pre>\r\n<code>foo_bar(self, width, height, color=\'black\', design=None, x=\'foo\',\r\n        emphasis=None, highlight=0)\r\n\r\nif (width == 0 and height == 0 and\r\n    color == \'red\' and emphasis == \'strong\'):\r\n</code></pre>\r\n\r\n<p>当字符串不能在一行内完成时,使用括号来隐式连接行:</p>\r\n\r\n<pre>\r\n<code>x = (\'This will build a very long long \'\r\n     \'long long long long long long string\')\r\n</code></pre>\r\n\r\n<p>在注释内,如有必要,将长URL放在其本行内:</p>\r\n\r\n<p>Yes:</p>\r\n\r\n<pre>\r\n<code># See details at\r\n# http://www.example.com/us/developer/documentation/api/content/v2.0/csv_file_name_extension_full_specification.html\r\n</code></pre>\r\n\r\n<p>No:</p>\r\n\r\n<pre>\r\n<code># See details at\r\n# http://www.example.com/us/developer/documentation/api/content/\\\r\n# v2.0/csv_file_name_extension_full_specification.html\r\n</code></pre>\r\n\r\n<p>在定义一个表达式超过三行或更多的<code>with</code>语句时,可以使用反斜杠来分行.对于两行表达式,使用嵌套<code>with</code>语句:</p>\r\n\r\n<p>Yes:</p>\r\n\r\n<pre>\r\n<code>with very_long_first_expression_function() as spam, \\\r\n     very_long_second_expression_function() as beans, \\\r\n     third_thing() as eggs:\r\n    place_order(eggs, beans, spam, beans)\r\n\r\nwith very_long_first_expression_function() as spam:\r\n    with very_long_second_expression_function() as beans:\r\n        place_order(beans, spam)\r\n</code></pre>\r\n\r\n<p>No:</p>\r\n\r\n<pre>\r\n<code>with VeryLongFirstExpressionFunction() as spam, \\\r\n     VeryLongSecondExpressionFunction() as beans:\r\n    PlaceOrder(eggs, beans, spam, beans)\r\n</code></pre>\r\n\r\n<p>注意上述例子中的缩进,具体参看缩进</p>\r\n\r\n<p>在其他一行超过80字符的情况下,而且yapf自动格式工具也不能使分行符合要求时,允许超过80字符限制.</p>\r\n\r\n<h3>3.3 括号</h3>\r\n\r\n<p>括号合理使用</p>\r\n\r\n<p>尽管不必要,但是可以在元组外加括号.再返回语句或者条件语句中不要使用括号,除非是用于隐式的连接行或者指示元组.</p>\r\n\r\n<p>Yes:</p>\r\n\r\n<pre>\r\n<code>if foo:\r\n    bar()\r\nwhile x:\r\n    x = bar()\r\nif x and y:\r\n    bar()\r\nif not x:\r\n    bar()\r\n# For a 1 item tuple the ()s are more visually obvious than the comma.\r\nonesie = (foo,)\r\nreturn foo\r\nreturn spam, beans\r\nreturn (spam, beans)\r\nfor (x, y) in dict.items(): ...\r\n</code></pre>\r\n\r\n<p>No:</p>\r\n\r\n<pre>\r\n<code>if (x):\r\n    bar()\r\nif not(x):\r\n    bar()\r\nreturn (foo)\r\n</code></pre>\r\n\r\n<h3>3.4 缩进</h3>\r\n\r\n<p>缩进用4个空格</p>\r\n\r\n<p>缩进代码段不要使用制表符,或者混用制表符和空格.如果连接多行,多行应垂直对齐,或者再次4空格缩进(这个情况下首行括号后应该不包含代码).</p>\r\n\r\n<p>Yes:</p>\r\n\r\n<pre>\r\n<code># Aligned with opening delimiter\r\n# 和opening delimiter对齐(译者理解是分隔符的入口,例如三种括号,字符串引号等)\r\nfoo = long_function_name(var_one, var_two,\r\n                         var_three, var_four)\r\nmeal = (spam,\r\n        beans)\r\n\r\n# Aligned with opening delimiter in a dictionary\r\nfoo = {\r\n    long_dictionary_key: value1 +\r\n                         value2,\r\n    ...\r\n}\r\n\r\n# 4-space hanging indent; nothing on first line\r\n# 缩进4个空格,首行括号后无内容\r\nfoo = long_function_name(\r\n    var_one, var_two, var_three,\r\n    var_four)\r\nmeal = (\r\n    spam,\r\n    beans)\r\n\r\n# 4-space hanging indent in a dictionary\r\nfoo = {\r\n    long_dictionary_key:\r\n        long_dictionary_value,\r\n    ...\r\n}\r\n</code></pre>\r\n\r\n<p>No:</p>\r\n\r\n<pre>\r\n<code># Stuff on first line forbidden\r\n# 首行不允许有内容\r\nfoo = long_function_name(var_one, var_two,\r\n    var_three, var_four)\r\nmeal = (spam,\r\n    beans)\r\n\r\n# 2-space hanging indent forbidden\r\nfoo = long_function_name(\r\n  var_one, var_two, var_three,\r\n  var_four)\r\n\r\n# No hanging indent in a dictionary\r\nfoo = {\r\n    long_dictionary_key:\r\n    long_dictionary_value,\r\n    ...\r\n}\r\n</code></pre>\r\n\r\n<h4>3.4.1 关于尾后逗号</h4>\r\n\r\n<p>关于在一序列元素中的尾号逗号,只推荐在容器结束符号<code>]</code>,<code>)</code>或者<code>}</code>和最后元素不在同一行时使用.尾后逗号的存在也被用作我们Python代码自动格式化工具yapf的提示,在<code>,</code>最后元素之后出现的时候来自动调整容器元素到每行一个元素.</p>\r\n\r\n<p>Yes:</p>\r\n\r\n<pre>\r\n<code>golomb3 = [0, 1, 3]\r\ngolomb4 = [\r\n    0,\r\n    1,\r\n    4,\r\n    6,\r\n]\r\n</code></pre>\r\n\r\n<p>No:</p>\r\n\r\n<pre>\r\n<code>golomb4 = [\r\n    0,\r\n    1,\r\n    4,\r\n    6\r\n]\r\n</code></pre>\r\n\r\n<h3>3.5 空行</h3>\r\n\r\n<p>在顶级定义(函数或类)之间要间隔两行.在方法定义之间以及<code>class</code>所在行与第一个方法之间要空一行,<code>def</code>行后无空行,在函数或方法内你认为合适地方可以使用单空行.</p>\r\n\r\n<h3>3.6 空格</h3>\r\n\r\n<p>遵守标准的空格和标点排版规则.</p>\r\n\r\n<p>括号<code>()</code>,<code>[]</code>,<code>{}</code>内部不要多余的空格.</p>\r\n\r\n<p>Yes:</p>\r\n\r\n<pre>\r\n<code>spam(ham[1], {eggs: 2}, [])\r\n</code></pre>\r\n\r\n<p>No:</p>\r\n\r\n<pre>\r\n<code>spam( ham[ 1 ], { eggs: 2 }, [ ] )\r\n</code></pre>\r\n\r\n<p>逗号、分号、冒号前不要空格,但是在后面要加空格,除非是在行尾.</p>\r\n\r\n<p>Yes:</p>\r\n\r\n<pre>\r\n<code>if x == 4:\r\n    print(x, y)\r\nx, y = y, x\r\n</code></pre>\r\n\r\n<p>No:</p>\r\n\r\n<pre>\r\n<code>if x == 4 :\r\n    print(x , y)\r\nx , y = y , x\r\n</code></pre>\r\n\r\n<p>在函数调用括号的前,索引切片括号前都不加空格.</p>\r\n\r\n<p>Yes:</p>\r\n\r\n<pre>\r\n<code>spam(1)\r\ndict[\'key\'] = list[index]\r\n</code></pre>\r\n\r\n<p>No:</p>\r\n\r\n<pre>\r\n<code>spam (1)\r\ndict [\'key\'] = list [index]\r\n</code></pre>\r\n\r\n<p>行尾不要加空格.</p>\r\n\r\n<p>在赋值(<code>=</code>),比较(<code>==</code>,<code>&lt;</code>,<code>&gt;</code>,<code>!=</code>,<code>&lt;&gt;</code>,<code>&lt;=</code>,<code>&gt;=</code>,<code>in</code>,<code>not in</code>,<code>is</code>,<code>is not</code>),布尔符号(<code>and</code>,<code>or</code>,<code>not</code>)前后都加空格.视情况在算术运算符(<code>+</code>,<code>-</code>,<code>*</code>,<code>/</code>,<code>//</code>,<code>%</code>,<code>**</code>,<code>@</code>),前后加空格</p>\r\n\r\n<p>Yes:</p>\r\n\r\n<pre>\r\n<code>x == 1\r\n</code></pre>\r\n\r\n<p>No:</p>\r\n\r\n<pre>\r\n<code>x&lt;1\r\n</code></pre>\r\n\r\n<p>在关键字名参数传递或定义默认参数值的时候不要在<code>=</code>前后加空格,只有一个例外:当类型注释存在时在定义默认参数值时<code>=</code>前后加空格</p>\r\n\r\n<p>Yes:</p>\r\n\r\n<pre>\r\n<code>def complex(real, imag=0.0): return Magic(r=real, i=imag)\r\ndef complex(real, imag: float = 0.0): return Magic(r=real, i=imag)\r\n</code></pre>\r\n\r\n<p>No:</p>\r\n\r\n<pre>\r\n<code>def complex(real, imag = 0.0): return Magic(r = real, i = imag)\r\ndef complex(real, imag: float=0.0): return Magic(r = real, i = imag)\r\n</code></pre>\r\n\r\n<p>不要用空格来做无必要的对齐,因为这会在维护时带来不必要的负担(对于<code>:</code>.<code>#</code>,<code>=</code>等等).</p>\r\n\r\n<p>Yes:</p>\r\n\r\n<pre>\r\n<code>foo = 1000  # comment\r\nlong_name = 2  # comment that should not be aligned\r\ndictionary = {\r\n    \'foo\': 1,\r\n    \'long_name\': 2,\r\n}\r\n</code></pre>\r\n\r\n<p>No:</p>\r\n\r\n<pre>\r\n<code>foo       = 1000  # comment\r\nlong_name = 2     # comment that should not be aligned\r\n\r\ndictionary = {\r\n    \'foo\'      : 1,\r\n    \'long_name\': 2,\r\n}\r\n</code></pre>\r\n\r\n<h3>3.7 Shebang</h3>\r\n\r\n<p>大部分<code>.py</code>文件不需要从<code>#!</code>行来开始.根据PEP-394,程序的主文件应该以<code>#!/usr/bin/python2</code>或<code>#!/usr/bin/python3</code>起始</p>\r\n\r\n<p>这行被用于帮助内核找到Python解释器,但是在导入模块时会被Python忽略/只在会被直接运行的文件里有必要写.</p>\r\n\r\n<h3>3.8 注释和文档字符串</h3>\r\n\r\n<p>确保使用正确的模块,函数,方法的文档字符串和行内注释.</p>\r\n\r\n<h4>3.8.1 文档字符串</h4>\r\n\r\n<p>Python使用<em>文档字符串</em>来为代码生成文档.文档字符串是包,模块,类或函数的首个语句.这些字符串能够自动被<code>__doc__</code>成员方法提取并且被<code>pydoc</code>使用.(尝试在你的模块上运行<code>pydoc</code>来看看具体是什么).文档字符串使用三重双引号<code>&quot;&quot;&quot;</code>(根据PEP-257).文档字符串应该这样组织:一行总结(或整个文档字符串只有一行)并以句号,问好或感叹号结尾.随后是一行空行,随后是文档字符串,并与第一行的首个引号位置相对齐.更多具体格式规范如下.</p>\r\n\r\n<h4>3.8.2 模块</h4>\r\n\r\n<p>每个文件都应包含许可模板.选择合适的许可模板用于项目(例如Apache 2.0,BSD,LGPL,GPL)</p>\r\n\r\n<p>文档应该以文档字符串开头,并描述模块的内容和使用方法.</p>\r\n\r\n<pre>\r\n<code>\"\"\"A one line summary of the module or program, terminated by a period.\r\n\r\nLeave one blank line.  The rest of this docstring should contain an\r\noverall description of the module or program.  Optionally, it may also\r\ncontain a brief description of exported classes and functions and/or usage\r\nexamples.\r\n\r\n  Typical usage example:\r\n\r\n  foo = ClassFoo()\r\n  bar = foo.FunctionBar()\r\n\"\"\"\r\n</code></pre>\r\n\r\n<h4>3.8.3 函数和方法</h4>\r\n\r\n<p>在本节,&quot;函数&quot;所指包括方法,函数或者生成器.</p>\r\n\r\n<p>函数应有文档字符串,除非符合以下所有条件:</p>\r\n\r\n<ul>\r\n	<li>\r\n	<p>外部不可见</p>\r\n	</li>\r\n	<li>\r\n	<p>非常短</p>\r\n	</li>\r\n	<li>\r\n	<p>简明</p>\r\n	</li>\r\n</ul>\r\n\r\n<p>文档字符串应该包含足够的信息以在无需阅读函数代码的情况下调用函数.文档字符串应该是叙事体(<code>&quot;&quot;&quot;Fetches rows from a Bigtable.&quot;&quot;&quot;</code>)的而非命令式的(<code>&quot;&quot;&quot;Fetch rows from a Bigtable.&quot;&quot;&quot;</code>),除了<code>@property</code>(应与attribute使用同样的风格).文档字符串应描述函数的调用语法和其意义,而非实现.对比较有技巧的地方,在代码中使用注释更合适.</p>\r\n\r\n<p>覆写了基类的方法可有简单的文档字符串向读者指示被覆写方法的文档字符串例如<code>&quot;&quot;&quot;See base class.&quot;&quot;&quot;</code>.这是因为没必要在很多地方重复已经在基类的文档字符串中存在的文档.不过如果覆写的方法行为实际上与被覆写方法不一致,或者需要提供细节(例如文档中表明额外的副作用),覆写方法的文档字符串至少要提供这些差别.</p>\r\n\r\n<p>一个函数的不同方面应该在特定对应的分节里写入文档,这些分节如下.每一节都由以冒号结尾的一行开始, 每一节除了首行外,都应该以2或4个空格缩进并在整个文档内保持一致(译者建议4个空格以维持整体一致).如果函数名和签名足够给出足够信息并且能够刚好被一行文档字符串所描述,那么可以忽略这些节.</p>\r\n\r\n<p><em>Args:</em></p>\r\n\r\n<p>列出每个参数的名字.名字后应有为冒号和空格,后跟描述.如果描述太长不能够在80字符的单行内完成.那么分行并缩进2或4个空格且与全文档一致(译者同样建议4个空格)</p>\r\n\r\n<p>描述应该包含参数所要求的类型,如果代码不包含类型注释的话.如果函数容许<code>*foo</code>(不定长度参数列表)或<code>**bar</code>(任意关键字参数).那么就应该在文档字符串中列举为<code>*foo</code>和<code>**bar</code>.</p>\r\n\r\n<p><em>Returns:(或对于生成器是Yields:)</em></p>\r\n\r\n<p>描述返回值的类型和含义.如果函数至少返回None,这一小节不需要.如果文档字符串以Returns或者Yields开头(例如<code>&quot;&quot;&quot;Returns row from Bigtable as a tuple of strings.&quot;&quot;&quot;</code>)或首句足够描述返回值的情况下这一节可忽略.</p>\r\n\r\n<p><em>Raises:</em></p>\r\n\r\n<p>列出所有和接口相关的异常.对于违反文档要求而抛出的异常不应列出.(因为这会矛盾地使得违反接口要求的行为成为接口的一部分)</p>\r\n\r\n<pre>\r\n<code>def fetch_bigtable_rows(big_table, keys, other_silly_variable=None):\r\n    \"\"\"Fetches rows from a Bigtable.\r\n\r\n    Retrieves rows pertaining to the given keys from the Table instance\r\n    represented by big_table.  Silly things may happen if\r\n    other_silly_variable is not None.\r\n\r\n    Args:\r\n        big_table: An open Bigtable Table instance.\r\n        keys: A sequence of strings representing the key of each table row\r\n            to fetch.\r\n        other_silly_variable: Another optional variable, that has a much\r\n            longer name than the other args, and which does nothing.\r\n\r\n    Returns:\r\n        A dict mapping keys to the corresponding table row data\r\n        fetched. Each row is represented as a tuple of strings. For\r\n        example:\r\n\r\n        {\'Serak\': (\'Rigel VII\', \'Preparer\'),\r\n         \'Zim\': (\'Irk\', \'Invader\'),\r\n         \'Lrrr\': (\'Omicron Persei 8\', \'Emperor\')}\r\n\r\n        If a key from the keys argument is missing from the dictionary,\r\n        then that row was not found in the table.\r\n\r\n    Raises:\r\n        IOError: An error occurred accessing the bigtable.Table object.\r\n    \"\"\"\r\n</code></pre>\r\n\r\n<h4>3.8.4 类</h4>\r\n\r\n<p>类定义下一行应为描述这个类的文档字符串.如果类有公共属性,应该在文档字符串中的<code>Attributes</code>节中注明,并且和函数的<code>Args</code>一节风格统一.</p>\r\n\r\n<pre>\r\n<code>class SampleClass(object):\r\n    \"\"\"Summary of class here.\r\n\r\n    Longer class information....\r\n    Longer class information....\r\n\r\n    Attributes:\r\n        likes_spam: A boolean indicating if we like SPAM or not.\r\n        eggs: An integer count of the eggs we have laid.\r\n    \"\"\"\r\n\r\n    def __init__(self, likes_spam=False):\r\n        \"\"\"Inits SampleClass with blah.\"\"\"\r\n        self.likes_spam = likes_spam\r\n        self.eggs = 0\r\n\r\n    def public_method(self):\r\n        \"\"\"Performs operation blah.\"\"\"\r\n</code></pre>\r\n\r\n<h4>3.8.5 块注释和行注释</h4>\r\n\r\n<p>最后要在代码中注释的地方是代码技巧性的部分.如果你将要在下次code review中揭示代码.应该现在就添加注释.在复杂操作开始前,注释几行.对于不够明晰的代码在行尾注释.</p>\r\n\r\n<pre>\r\n<code># We use a weighted dictionary search to find out where i is in\r\n# the array.  We extrapolate position based on the largest num\r\n# in the array and the array size and then do binary search to\r\n# get the exact number.\r\nif i &amp; (i-1) == 0:  # True if i is 0 or a power of 2.\r\n</code></pre>\r\n\r\n<p>为了提升易读性,行注释应该至少在代码2个空格后,并以<code>#</code>后接至少1个空格开始注释部分.</p>\r\n\r\n<p>另外,不要描述代码,假定阅读代码的人比你更精通Python(他只是不知道你试图做什么).</p>\r\n\r\n<h4>3.8.6 标点,拼写和语法</h4>\r\n\r\n<p>注意标点,拼写和语法,写得好的注释要比写得差的好读.</p>\r\n\r\n<p>注释应当是和叙事性文本一样可读,并具有合适的大小写和标点.在许多情况下,完整的句子要比破碎的句子更可读.更简短的注释如行尾的注释有时会不太正式,但是应该全篇保持风格一致.</p>\r\n\r\n<p>尽管被代码审核人员指出在应该使用分号的地方使用了逗号是很令人沮丧的,将源代码维护在高度清楚可读的程度是很重要的.合适的标点,拼写和语法能够帮助达到这个目标.</p>\r\n\r\n<h3>3.9 类</h3>\r\n\r\n<p>如果类并非从其他基类继承而来,那么就要明确是从<code>object</code>继承而来,即便内嵌类也是如此.</p>\r\n\r\n<p>Yes:</p>\r\n\r\n<pre>\r\n<code>class SampleClass(object):\r\n    pass\r\n\r\nclass OuterClass(object):\r\n    class InnerClass(object):\r\n        pass\r\n\r\nclass ChildClass(ParentClass):\r\n    \"\"\"Explicitly inherits from another class already.\"\"\"\r\n</code></pre>\r\n\r\n<p>No:</p>\r\n\r\n<pre>\r\n<code>class SampleClass:\r\n    pass\r\n\r\nclass OuterClass:\r\n    class InnerClass:\r\n        pass\r\n</code></pre>\r\n\r\n<p>从<code>object</code>类继承保证了属性能够在Python2正确运行并且保护代码在Python3下出现潜在的不兼容.这样也定义了object包括<code>__new__</code>,<code>__init__</code>,<code>__delattr__</code>,<code>__getattribute__</code>,<code>__setattr__</code>,<code>__hash__</code>,<code>__repr__</code>,和<code>__str__</code>等默认特殊方法的实现.</p>\r\n\r\n<h3>3.10 字符串</h3>\r\n\r\n<p>使用<code>format</code>或<code>%</code>来格式化字符串,即使参数都是字符串对象,也要考虑使用<code>+</code>还是<code>%</code>及<code>format</code>.</p>\r\n\r\n<p>Yes:</p>\r\n\r\n<pre>\r\n<code>x = a + b\r\nx = \'%s, %s!\' % (imperative, expletive)\r\nx = \'{}, {}\'.format(first, second)\r\nx = \'name: %s; score: %d\' % (name, n)\r\nx = \'name: {}; score: {}\'.format(name, n)\r\nx = f\'name: {name}; score: {n}\'  # Python 3.6+\r\n</code></pre>\r\n\r\n<p>No:</p>\r\n\r\n<pre>\r\n<code>employee_table = \'&lt;table&gt;\'\r\nfor last_name, first_name in employee_list:\r\n    employee_table += \'&lt;tr&gt;&lt;td&gt;%s, %s&lt;/td&gt;&lt;/tr&gt;\' % (last_name, first_name)\r\nemployee_table += \'&lt;/table&gt;\'\r\n</code></pre>\r\n\r\n<p>避免使用<code>+</code>和<code>+=</code>操作符来在循环内累加字符串,因为字符串是不可变对象.这会造成不必要的临时变量导致运行时间以四次方增长而非线性增长.应将每个字符串都记入一个列表并使用<code>&#39;&#39;.join</code>来将列表在循环结束后连接(或将每个子字符串写入<code>io.BytesIO</code>缓存)</p>\r\n\r\n<p>Yes:</p>\r\n\r\n<pre>\r\n<code>items = [\'&lt;table&gt;\']\r\nfor last_name, first_name in employee_list:\r\n    items.append(\'&lt;tr&gt;&lt;td&gt;%s, %s&lt;/td&gt;&lt;/tr&gt;\' % (last_name, first_name))\r\nitems.append(\'&lt;/table&gt;\')\r\nemployee_table = \'\'.join(items)\r\n</code></pre>\r\n\r\n<p>No:</p>\r\n\r\n<pre>\r\n<code>employee_table = \'&lt;table&gt;\'\r\nfor last_name, first_name in employee_list:\r\n    employee_table += \'&lt;tr&gt;&lt;td&gt;%s, %s&lt;/td&gt;&lt;/tr&gt;\' % (last_name, first_name)\r\nemployee_table += \'&lt;/table&gt;\'\r\n</code></pre>\r\n\r\n<p>在同一个文件内,字符串引号要一致,选择<code>&#39;&#39;</code>或者<code>&quot;&quot;</code>并且不要改变.对于需要避免<code>\\\\</code>转义的时候,可以更改.</p>\r\n\r\n<p>Yes:</p>\r\n\r\n<pre>\r\n<code>Python(\'Why are you hiding your eyes?\')\r\nGollum(\"I\'m scared of lint errors.\")\r\nNarrator(\'\"Good!\" thought a happy Python reviewer.\')\r\n</code></pre>\r\n\r\n<p>No:</p>\r\n\r\n<pre>\r\n<code>Python(\"Why are you hiding your eyes?\")\r\nGollum(\'The lint. It burns. It burns us.\')\r\nGollum(\"Always the great lint. Watching. Watching.\")\r\n</code></pre>\r\n\r\n<p>多行字符串多行字符串优先使用&quot;&quot;&quot;而非<code>&#39;&#39;&#39;</code>,当且只当对所有非文档字符串的多行字符串都是用<code>&#39;&#39;&#39;</code>而且对正常字符串都使用<code>&#39;</code>时才可使用三单引号.docstring不论如何必须使用<code>&quot;&quot;&quot;</code></p>\r\n\r\n<p>多行字符串和其余代码的缩进方式不一致.如果需要避免在字符串中插入额外的空格,要么使用单行字符串连接或者带有<code>textwarp.dedent()</code>的多行字符串来移除每行的起始空格.</p>\r\n\r\n<p>No:</p>\r\n\r\n<pre>\r\n<code>long_string = \"\"\"This is pretty ugly.\r\nDon\'t do this.\r\n\"\"\"\r\n</code></pre>\r\n\r\n<p>Yes:</p>\r\n\r\n<pre>\r\n<code>long_string = \"\"\"This is fine if your use case can accept\r\n    extraneous leading spaces.\"\"\"\r\n\r\nlong_string = (\"And this is fine if you can not accept\\n\" +\r\n               \"extraneous leading spaces.\")\r\n\r\nlong_string = (\"And this too is fine if you can not accept\\n\"\r\n               \"extraneous leading spaces.\")\r\n\r\nimport textwrap\r\n\r\nlong_string = textwrap.dedent(\"\"\"\\\r\n    This is also fine, because textwrap.dedent()\r\n    will collapse common leading spaces in each line.\"\"\")\r\n</code></pre>\r\n\r\n<h3>3.11 文件和socket</h3>\r\n\r\n<p>当使用结束后显式地关闭文件或socket.</p>\r\n\r\n<p>不必要地打开文件，socket或其他类似文件的对象有很多弊端：</p>\r\n\r\n<ul>\r\n	<li>\r\n	<p>他们可能会消耗有限的系统资源,例如文件描述符.如果在使用没有即使归还系统,处理很多这样对象的代码可能会浪费掉很多不应浪费的资源.</p>\r\n	</li>\r\n	<li>\r\n	<p>保持一个文件可能会阻止其他操作诸如移动或删除.</p>\r\n	</li>\r\n	<li>\r\n	<p>被程序共享的文件和socket可能会无意中在逻辑上已被关闭的情况下仍被读写.如果实际上已经关闭,试图读写的操作会抛出异常,这样就可以立即发现问题.</p>\r\n	</li>\r\n</ul>\r\n\r\n<p>此外,当文件或socket在文件对象被销毁的同时被自动关闭的时候,是不可能将文件的生命周期和文件状态绑定的:</p>\r\n\r\n<ul>\r\n	<li>\r\n	<p>不能保证何时会真正将文件对象销毁.不同的Python解释器使用的内存管理技术不同,例如延时垃圾处理可能会让对象的生命周期被无限期延长.</p>\r\n	</li>\r\n	<li>\r\n	<p>可能导致意料之外地对文件对象的引用,例如在全局变量或者异常回溯中,可能会让文件对象比预计的生命周期更长.</p>\r\n	</li>\r\n</ul>\r\n\r\n<p>推荐使用with语句管理文件:</p>\r\n\r\n<pre>\r\n<code>with open(\"hello.txt\") as hello_file:\r\n    for line in hello_file:\r\n        print(line)\r\n</code></pre>\r\n\r\n<p>对于类似文件的对象,如果不支持with语句的可以使用<code>contextlib.closing()</code>:</p>\r\n\r\n<pre>\r\n<code>import contextlib\r\n\r\nwith contextlib.closing(urllib.urlopen(\"http://www.python.org/\")) as front_page:\r\n    for line in front_page:\r\n        print(line)\r\n</code></pre>\r\n\r\n<h3>3.12 &nbsp;TODO注释</h3>\r\n\r\n<p>对于下述情况使用<code>TODO</code>注释:临时的,短期的解决方案或者足够好但是不完美的解决方案.</p>\r\n\r\n<p><code>TODO</code>注释以全部大写的字符串<code>TODO</code>开头,并带有写入括号内的姓名,email地址,或其他可以标识负责人或者包含关于问题最佳描述的issue.随后是这里做什么的说明.</p>\r\n\r\n<p>有统一风格的<code>TODO</code>的目的是为了方便搜索并了解如何获取更多相关细节.<code>TODO</code>并不是保证被提及者会修复问题.因此在创建<code>TODO</code>注释的时候,基本上都是给出你的名字.</p>\r\n\r\n<pre>\r\n<code># TODO(kl@gmail.com): Use a \"*\" here for string repetition.\r\n# TODO(Zeke) Change this to use relations.\r\n</code></pre>\r\n\r\n<p>如果<code>TODO</code>注释形式为&quot;未来某个时间点会做什么事&quot;的格式,确保要么给出一个非常具体的时间点(例如&quot;将于2009年11月前修复&quot;)或者给出一个非常具体的事件(例如&quot;当所有客户端都能够处理XML响应时就移除此代码&quot;).</p>\r\n\r\n<h3>3.13 import格式</h3>\r\n\r\n<p>imports应该在不同行.例如:</p>\r\n\r\n<p>Yes:</p>\r\n\r\n<pre>\r\n<code>import os\r\nimport sys\r\n</code></pre>\r\n\r\n<p>No:</p>\r\n\r\n<pre>\r\n<code>import os, sys\r\n</code></pre>\r\n\r\n<p>import应集中放在文件顶部,在模块注释和docstring后面,模块globals和常量前面.应按照从最通用到最不通用的顺序排列分组:</p>\r\n\r\n<ol>\r\n	<li>\r\n	<p>Python未来版本import语句,例如:</p>\r\n\r\n	<blockquote>\r\n	<pre>\r\n<code>from __future__ import absolute_import\r\nfrom __future__ import division\r\nfrom __future__ import print_function\r\n</code></pre>\r\n	</blockquote>\r\n\r\n	<blockquote>\r\n	<p>更多信息参看上文</p>\r\n	</blockquote>\r\n	</li>\r\n	<li>\r\n	<p>Python标准基础库import,例如:</p>\r\n\r\n	<blockquote>\r\n	<pre>\r\n<code>import sys\r\n</code></pre>\r\n	</blockquote>\r\n	</li>\r\n	<li>\r\n	<p>第三方库或包的import,例如:</p>\r\n\r\n	<blockquote>\r\n	<pre>\r\n<code>import tensorflow as tf\r\n</code></pre>\r\n	</blockquote>\r\n	</li>\r\n	<li>\r\n	<p>代码库内子包import,例如:</p>\r\n\r\n	<blockquote>\r\n	<pre>\r\n<code>from otherproject.ai import mind\r\n</code></pre>\r\n	</blockquote>\r\n	</li>\r\n	<li>\r\n	<p>此条已弃用:和当前文件是同一顶级子包专用的import,例如:</p>\r\n\r\n	<blockquote>\r\n	<pre>\r\n<code>from myproject.backend.hgwells import time_machine\r\n</code></pre>\r\n	</blockquote>\r\n\r\n	<p>在旧版本的谷歌Python代码风格指南中实际上是这样做的.但是现在不再需要了.**新的代码风格不再受此困扰.**简单的将专用的子包import和其他子包import同一对待即可.</p>\r\n	</li>\r\n</ol>\r\n\r\n<p>在每个组内按照每个模块的完整包路径的字典序忽略大小写排序.可以根据情况在每个节质检增加空行.</p>\r\n\r\n<pre>\r\n<code>import collectionsimport queueimport sys\r\n\r\nfrom absl import appfrom absl import flagsimport bs4import cryptographyimport tensorflow as tf\r\n\r\nfrom book.genres import scififrom myproject.backend.hgwells import time_machinefrom myproject.backend.state_machine import main_loopfrom otherproject.ai import bodyfrom otherproject.ai import mindfrom otherproject.ai import soul\r\n\r\n# Older style code may have these imports down here instead:\r\n# 旧版本代码风格可能会采用下述import方式\r\n# from myproject.backend.hgwells import time_machine\r\n# from myproject.backend.state_machine import main_loop\r\n</code></pre>\r\n\r\n<h3>3.14 语句</h3>\r\n\r\n<p>每行只有一条语句.</p>\r\n\r\n<p>不过如果测试语句和结果能够在一行内放下,就可以放在一行内.但是不允许将<code>try</code>/<code>except</code>语句和对应内容放于一行,因为<code>try</code>或者<code>except</code>都不能在一行内完成.对于没有else的if语句可以将<code>if</code>和对应内容合并到一行.</p>\r\n\r\n<p>Yes:</p>\r\n\r\n<pre>\r\n<code>if foo: bar(foo)\r\n</code></pre>\r\n\r\n<p>No:</p>\r\n\r\n<pre>\r\n<code>if foo: bar(foo)\r\nelse:   baz(foo)\r\n\r\ntry:               bar(foo)\r\nexcept ValueError: baz(foo)\r\n\r\ntry:\r\n    bar(foo)\r\nexcept ValueError: baz(foo)\r\n</code></pre>\r\n\r\n<h3>3.15 访问</h3>\r\n\r\n<p>对于琐碎又不太重要的访问函数,应用公共变量来替代访问函数,以避免额外的程序调用消耗,当添加了更多函数功能时,使用<code>property</code>来保持连续性</p>\r\n\r\n<p>此外,如果访问过于复杂,或者访问变量的消耗过大,应该使用诸如<code>get_foo()</code>和<code>set_foo()</code>之类的函数式访问(参考命名指南).如果过去的访问方式是通过属性,新访问函数不要绑定到property上,这样使用property的旧方式就会失效,使用者就会知道函数有变化.</p>\r\n\r\n<h3>3.16 命名</h3>\r\n\r\n<p><code>module_name</code>,<code>package_name</code>,<code>ClassName</code>,<code>method_name</code>,<code>ExceptionName</code>,<code>function_name</code>,<code>GLOBAL_CONSTANT_NAME</code>,<code>global_var_name</code>,<code>instance_var_name</code>,<code>function_parameter_name</code>,<code>local_var_name</code>.</p>\r\n\r\n<p>命名函数名,变量名,文件名应该是描述性的,避免缩写,尤其避免模糊或对读者不熟悉的缩写.并且不要通过删减单词内的字母来缩短.</p>\r\n\r\n<p>使用<code>.py</code>作为文件拓展名,不要使用横线.</p>\r\n\r\n<h4>3.16.1 要避免的名字：</h4>\r\n\r\n<ul>\r\n	<li>\r\n	<p>单字符名字,除非是计数或迭代元素,e可以作为Exception捕获识别名来使用..</p>\r\n	</li>\r\n	<li>\r\n	<p><code>-</code>横线,不应出现在任何包名或模块名内</p>\r\n	</li>\r\n	<li>\r\n	<p><code>__double_leading_and_trailing_underscore__</code>首尾都双下划线的名字,这种名字是python的内置保留名字</p>\r\n	</li>\r\n</ul>\r\n\r\n<h4>3.16.4 命名约定</h4>\r\n\r\n<ul>\r\n	<li>\r\n	<p>internal表示仅模块内可用、或者类内保护的或者私有的</p>\r\n	</li>\r\n	<li>\r\n	<p>单下划线(<code>_</code>)开头表示是被保护的(<code>from module import *</code>不会import).双下划线(<code>__</code>也就是&quot;dunder&quot;)开头的实例变量或者方法表示类内私有(使用命名修饰).我们不鼓励使用,因为这会对可读性和可测试性有削弱二期<code>并非真正</code>的私有.</p>\r\n	</li>\r\n	<li>\r\n	<p>相关的类和顶级函数放在同一个模块内,不必像是Java一样要一个类放在一个模块里.</p>\r\n	</li>\r\n	<li>\r\n	<p>对类名使用大写字母(如CapWords)开头的单词,命名,模块名应该使用小写加下划线的方式.尽管有一些旧的模块命名方式是大写字母的(如CapWords.py),现在不鼓励这样做了,因为在模块刚好是从某个类命名出发的时候可能会令人迷惑(例如是选择<code>import StringIO</code>还是<code>from StringIO import StringIO</code>?)</p>\r\n	</li>\r\n	<li>\r\n	<p>在<em>unittest</em>方法中可能是<code>test</code>开头来分割名字的组成部分,即使这些组成部分是使用大写字母驼峰式的.这种方式是可以的：<code>test&lt;MethodUnderTest&gt;_&lt;state&gt;</code>例如<code>testPop_EmptyStack</code>,对于命名测试方法没有明确的正确方法.</p>\r\n	</li>\r\n</ul>\r\n\r\n<h4>3.16.3 文件名</h4>\r\n\r\n<p>文件拓展名必须为<code>.py</code>,不可以包含<code>-</code>.这保证了能够被正常import和单元测试.如果希望一个可执行文件不需要拓展名就可以被调用,那么建立一个软连接或者一个简单的bash打包脚本包括<code>exec &quot;$0.py&quot; &quot;$@&quot;</code>.</p>\r\n\r\n<h4>3.16.4 Guido的指导建议</h4>\r\n\r\n<table>\r\n	<thead>\r\n		<tr>\r\n			<th>类型</th>\r\n			<th>公共</th>\r\n			<th>内部</th>\r\n		</tr>\r\n	</thead>\r\n	<tbody>\r\n		<tr>\r\n			<td>包</td>\r\n			<td><code>lower_with_under</code></td>\r\n			<td>&nbsp;</td>\r\n		</tr>\r\n		<tr>\r\n			<td>模块</td>\r\n			<td><code>lower_with_under</code></td>\r\n			<td><code>_lower_with_under</code></td>\r\n		</tr>\r\n		<tr>\r\n			<td>类</td>\r\n			<td><code>CapWords</code></td>\r\n			<td><code>_CapWords</code></td>\r\n		</tr>\r\n		<tr>\r\n			<td>异常</td>\r\n			<td><code>CapWords</code></td>\r\n			<td>&nbsp;</td>\r\n		</tr>\r\n		<tr>\r\n			<td>函数</td>\r\n			<td><code>lower_with_under()</code></td>\r\n			<td><code>_lower_with_under()</code></td>\r\n		</tr>\r\n		<tr>\r\n			<td>全局/类常量</td>\r\n			<td><code>CAPS_WITH_UNDER</code></td>\r\n			<td><code>_CAPS_WITH_UNDER</code></td>\r\n		</tr>\r\n		<tr>\r\n			<td>全局/类变量</td>\r\n			<td><code>lower_with_under</code></td>\r\n			<td><code>_lower_with_under</code></td>\r\n		</tr>\r\n		<tr>\r\n			<td>实例变量</td>\r\n			<td><code>lower_with_under</code></td>\r\n			<td><code>_lower_with_under</code>(受保护)</td>\r\n		</tr>\r\n		<tr>\r\n			<td>方法名</td>\r\n			<td><code>lower_with_under()</code></td>\r\n			<td><code>_lower_with_under()</code>(受保护)</td>\r\n		</tr>\r\n		<tr>\r\n			<td>函数/方法参数</td>\r\n			<td><code>lower_with_under</code></td>\r\n			<td>&nbsp;</td>\r\n		</tr>\r\n		<tr>\r\n			<td>局部变量</td>\r\n			<td><code>lower_with_under</code></td>\r\n			<td>&nbsp;</td>\r\n		</tr>\r\n	</tbody>\r\n</table>\r\n\r\n<p>尽管Python支持通过双下划线<code>__</code>(即&quot;dunder&quot;)来私有化.不鼓励这样做.优先使用单下划线.单下划线更易于打出来、易读、易于小的单元测试调用.Lint的警告关注受保护成员的无效访问.</p>\r\n\r\n<h3>3.17 Main</h3>\r\n\r\n<p>即便是一个用做脚本的py文件也应该是可以被import的,而只用于import时,也不应有执行了主函数的副作用.主函数的功能应该被放在<code>main()</code>里.</p>\r\n\r\n<p>在Python中,<code>pydoc</code>和单元测试要求模块是可import的.所以代码在主程序执行前应进行<code>if __name__ == &#39;__main__&#39;:</code>检查,以防止模块在import时被执行.</p>\r\n\r\n<pre>\r\n<code>def main():\r\n    ...\r\n\r\nif __name__ == \'__main__\':\r\n    main()\r\n</code></pre>\r\n\r\n<p>所有顶级代码在模块被import时执行.因而要小心不要调用函数,创建对象或者执行其他在执行<code>pydoc</code>时不应该被执行的操作.</p>\r\n\r\n<h3>3.18 函数长度</h3>\r\n\r\n<p>优先写小而专一的函数.</p>\r\n\r\n<p>长函数有时候是合适的,故而函数长度没有固定的限制.但是超过40行的时候就要考虑是否要在不影响程序结构的前提下分解函数.</p>\r\n\r\n<p>尽管长函数现在运行的很好,但是在之后的时间里其他人修改函数并增加新功能的时候可能会引入新的难以发现的bug,保持函数的简短,这样有利于其他人读懂和修改代码.</p>\r\n\r\n<p>在处理一些代码时,可能会发现有些函数长而且复杂.不要畏惧调整现有代码,如果处理这个函数非常困难,如难以对报错debug或者希望在几个不同的上下文中使用它,那么请将函数拆解成若干个更小更可控的片段.</p>\r\n\r\n<h3>3.19 类型注释</h3>\r\n\r\n<h4>3.19.1 基本规则</h4>\r\n\r\n<ul>\r\n	<li>\r\n	<p>熟悉PEP-484</p>\r\n	</li>\r\n	<li>\r\n	<p>在方法中,只在必要时给<code>self</code>或者<code>cls</code>增加合适的类型信息.例如<code>@classmethod def create(cls: Type[T]) -&gt; T: return cls()</code></p>\r\n	</li>\r\n	<li>\r\n	<p>如果其他变量或返回类型不定,使用<code>Any</code></p>\r\n	</li>\r\n	<li>\r\n	<p>不需要注释每个函数</p>\r\n\r\n	<ul>\r\n		<li>\r\n		<p>至少需要注明公共接口</p>\r\n		</li>\r\n		<li>\r\n		<p>使用类型检查来在安全性和声明清晰性以及灵活性之间平衡</p>\r\n		</li>\r\n		<li>\r\n		<p>标注容易因类型相关而抛出异常的代码(previous bugs or complexity,此处译者认为是与上一条一致,平衡安全性和复杂性)</p>\r\n		</li>\r\n		<li>\r\n		<p>标注难理解的代码</p>\r\n		</li>\r\n		<li>\r\n		<p>标注类型稳定的代码,成熟稳定的代码可以都进行标注而不会影响其灵活性</p>\r\n		</li>\r\n	</ul>\r\n	</li>\r\n</ul>\r\n\r\n<h4>3.19.2 分行</h4>\r\n\r\n<p>遵循现有的缩进规范</p>\r\n\r\n<p>标注类型后,函数签名多数都要是&quot;每行一个参数&quot;.</p>\r\n\r\n<pre>\r\n<code>def my_method(self,\r\n              first_var: int,\r\n              second_var: Foo,\r\n              third_var: Optional[Bar]) -&gt; int:\r\n  ...\r\n</code></pre>\r\n\r\n<p>优先在变量之间换行,而非其他地方(如变量名和类型注释之间).如果都能放在一行内,就放在一行.</p>\r\n\r\n<pre>\r\n<code>def my_method(self, first_var: int) -&gt; int:\r\n  ...\r\n</code></pre>\r\n\r\n<p>如果函数名,一直到最后的参数以及返回类型注释放在一行过长,那么分行并缩进4个空格.</p>\r\n\r\n<pre>\r\n<code>def my_method(\r\n    self, first_var: int) -&gt; Tuple[MyLongType1, MyLongType1]:\r\n  ...\r\n</code></pre>\r\n\r\n<p>当返回值类型不能和最后一个参数放入同一行,比较好的处理方式是将参数分行并缩进4个空格,右括号和返回值类型换行并和<code>def</code>对齐.</p>\r\n\r\n<pre>\r\n<code>def my_method(\r\n    self, other_arg: Optional[MyLongType]\r\n) -&gt; Dict[OtherLongType, MyLongType]:\r\n  ...\r\n</code></pre>\r\n\r\n<p>pylint允许您将右括号移动到新行并与左括号对齐,但这不太容易理解.</p>\r\n\r\n<p>No:</p>\r\n\r\n<pre>\r\n<code>def my_method(self,\r\n              other_arg: Optional[MyLongType]\r\n             ) -&gt; Dict[OtherLongType, MyLongType]:\r\n  ...\r\n</code></pre>\r\n\r\n<p>就像上面的例子一样,尽量不要分割类型注释,不过有时类型注释太长无法放入一行,(那就尽量让子注释不要被分割).</p>\r\n\r\n<pre>\r\n<code>def my_method(\r\n    self,\r\n    first_var: Tuple[List[MyLongType1],\r\n                     List[MyLongType2]],\r\n    second_var: List[Dict[\r\n        MyLongType3, MyLongType4]]) -&gt; None:\r\n  ...\r\n</code></pre>\r\n\r\n<p>如果某个命名和类型太长了,考虑使用别名.如果没有其他解决方案,在冒号后分行缩进4个空格.</p>\r\n\r\n<p>Yes:</p>\r\n\r\n<pre>\r\n<code>def my_function(\r\n    long_variable_name:\r\n        long_module_name.LongTypeName,\r\n) -&gt; None:\r\n  ...\r\n</code></pre>\r\n\r\n<p>No:</p>\r\n\r\n<pre>\r\n<code>def my_function(\r\n    long_variable_name: long_module_name.\r\n        LongTypeName,) -&gt; None:\r\n  ...\r\n</code></pre>\r\n\r\n<h4>3.19.3 前置声明</h4>\r\n\r\n<p>如果需要同一模块内还未定义的类名,例如需要类声明内部的类,或者需要在后续代码中定义的类,那么使用类名的字符串来代替.</p>\r\n\r\n<pre>\r\n<code>class MyClass(object):\r\n\r\n  def __init__(self,\r\n               stack: List[\"MyClass\"]) -&gt; None:\r\n</code></pre>\r\n\r\n<h4>3.19.4 默认值</h4>\r\n\r\n<p>参考PEP-008,只有在同时需要类型注释和默认值的时候在<code>=</code>前后都加空格</p>\r\n\r\n<p>Yes:</p>\r\n\r\n<pre>\r\n<code>def func(a: int = 0) -&gt; int:\r\n  ...\r\n</code></pre>\r\n\r\n<p>No:</p>\r\n\r\n<pre>\r\n<code>def func(a:int=0) -&gt; int:\r\n  ...\r\n</code></pre>\r\n\r\n<h4>3.19.5 NoneType</h4>\r\n\r\n<p>在Python系统中<code>NoneType</code>是一等类型,为了方便输入,<code>None</code>是<code>NoneType</code>的别名.如果一个参数可以是<code>None</code>,那么就需要声明!可以使用<code>Union</code>,但如果只有一个其他类型,那么使用<code>Optional</code>.</p>\r\n\r\n<p>显式地使用<code>Optional</code>而非隐式地.PEP 484的早期版本容许<code>a: Text = None</code>被解释为<code>a: Optional[Text] = None</code>.但现在已经不推荐这样使用了.</p>\r\n\r\n<p>Yes:</p>\r\n\r\n<pre>\r\n<code>def func(a: Optional[Text], b: Optional[Text] = None) -&gt; Text:\r\n  ...\r\ndef multiple_nullable_union(a: Union[None, Text, int]) -&gt; Text\r\n  ...\r\n</code></pre>\r\n\r\n<p>No:</p>\r\n\r\n<pre>\r\n<code>def nullable_union(a: Union[None, Text]) -&gt; Text:\r\n  ...\r\ndef implicit_optional(a: Text = None) -&gt; Text:\r\n  ...\r\n</code></pre>\r\n\r\n<h4>3.19.6 类型别名</h4>\r\n\r\n<p>可以对复杂类型声明别名,别名的名称应为CapWorded,如果只用于当前模块,应加下划线私有化.</p>\r\n\r\n<p>例如,如果带有模块名的类型名过长:</p>\r\n\r\n<pre>\r\n<code>_ShortName = module_with_long_name.TypeWithLongName\r\nComplexMap = Mapping[Text, List[Tuple[int, int]]]\r\n</code></pre>\r\n\r\n<p>其他示例是复杂的嵌套类型和一个函数的多个返回变量（作为元组）.</p>\r\n\r\n<h4>3.19.7 忽略类型检查</h4>\r\n\r\n<p>可以通过增加特殊行注释<code># type: ignore</code>来禁止类型检查.</p>\r\n\r\n<p><code>pytype</code>对于明确的报错有关闭选项(类似于lint):</p>\r\n\r\n<pre>\r\n<code># pytype: disable=attribute-error\r\n</code></pre>\r\n\r\n<h4>3.19.8 对变量注释类型</h4>\r\n\r\n<p>对变量标注类型如果内部变量很难或者不可能指向,可以使用下述方式：</p>\r\n\r\n<p><em>类型注释</em>:</p>\r\n\r\n<p>在行尾增加以<code># type</code>开头的注释</p>\r\n\r\n<pre>\r\n<code>a = SomeUndecoratedFunction()  # type: Foo\r\n</code></pre>\r\n\r\n<p><em>注释绑定</em>:</p>\r\n\r\n<p>在变量名和赋值之间用冒号和类型注明,和函数参数一致.</p>\r\n\r\n<pre>\r\n<code>a: Foo = SomeUndecoratedFunction()\r\n</code></pre>\r\n\r\n<h4>3.19.9 元组和列表</h4>\r\n\r\n<p>不像是列表只能包含单一类型,元组可以既只有一种重复类型或者一组不同类型的元素,后者常用于函数返回.</p>\r\n\r\n<pre>\r\n<code>a = [1, 2, 3]  # type: List[int]\r\nb = (1, 2, 3)  # type: Tuple[int, ...]\r\nc = (1, \"2\", 3.5)  # type: Tuple[int, Text, float]\r\n</code></pre>\r\n\r\n<h4>3.19.10 TypeVars</h4>\r\n\r\n<p>Python是有泛型的,工厂函数<code>TypeVar</code>是通用的使用方式.</p>\r\n\r\n<p>例子:</p>\r\n\r\n<pre>\r\n<code>from typing import List, TypeVar\r\nT = TypeVar(\"T\")\r\n...\r\ndef next(l: List[T]) -&gt; T:\r\n  return l.pop()\r\n</code></pre>\r\n\r\n<p>TypeVar可以约束类型:</p>\r\n\r\n<pre>\r\n<code>AddableType = TypeVar(\"AddableType\", int, float, Text)\r\ndef add(a: AddableType, b: AddableType) -&gt; AddableType:\r\n    return a + b\r\n</code></pre>\r\n\r\n<p>在<code>typing</code>模块预定义好的类型变量是<code>AnyStr</code>,用于针对字符串可以是<code>bytes</code>也可为<code>unicode</code>并且保持一致的多个类型注释.</p>\r\n\r\n<pre>\r\n<code>from typing import AnyStr\r\ndef check_length(x: AnyStr) -&gt; AnyStr:\r\n  if len(x) &lt;= 42:\r\n    return x\r\n  raise ValueError()\r\n</code></pre>\r\n\r\n<h4>3.19.11 字符串类型</h4>\r\n\r\n<p>注释字符串的合适类型是基于Python版本的.</p>\r\n\r\n<p>对于只有Python3的代码,使用<code>str</code>,<code>Text</code>可以用但是在选择上保持一致.</p>\r\n\r\n<p>对于Python2兼容的代码,用<code>Text</code>,在一些很罕见的情况下,<code>str</code>可能可用.当在不同Python版本之间返回值类型不同的时候通常是为了照顾兼容性.避免使用<code>unicode</code>,因为Python3中不存在.</p>\r\n\r\n<p>No:</p>\r\n\r\n<pre>\r\n<code>def py2_code(x: str) -&gt; unicode:\r\n  ...\r\n</code></pre>\r\n\r\n<p>对于处理二进制数据的代码,请使用<code>bytes</code>.</p>\r\n\r\n<p>Yes:</p>\r\n\r\n<pre>\r\n<code>def deals_with_binary_data(x: bytes) -&gt; bytes:\r\n  ...\r\n</code></pre>\r\n\r\n<p>对于Python2兼容,处理文本数据(Python中<code>str</code>或<code>unicode</code>,Python3中<code>str</code>)的代码,使用<code>Text</code>.对于只有Python3的代码,优先使用<code>str</code>.</p>\r\n\r\n<pre>\r\n<code>from typing import Text\r\n...\r\ndef py2_compatible(x: Text) -&gt; Text:\r\n  ...\r\ndef py3_only(x: str) -&gt; str:\r\n  ...\r\n</code></pre>\r\n\r\n<p>如果既可以是byte也可以是文本,那么使用<code>Union</code>和合适的文本类型.</p>\r\n\r\n<pre>\r\n<code>from typing import Text, Union\r\n...\r\ndef py2_compatible(x: Union[bytes, Text]) -&gt; Union[bytes, Text]:\r\n  ...\r\ndef py3_only(x: Union[bytes, str]) -&gt; Union[bytes, str]:\r\n  ...\r\n</code></pre>\r\n\r\n<p>如果一个函数中所有的字符串类型始终一致,例如前文例子中返回值类型和参数类型是一致的,那么使用<code>AnyStr</code></p>\r\n\r\n<p>像这样写能够简化代码向Python3的迁移过程.</p>\r\n\r\n<h4>3.19.12 typing的import</h4>\r\n\r\n<p>对于从<code>typing</code>模块import的类,要import类本身.明确的允许在一行内从<code>typing</code>模块import多个特定的类,如</p>\r\n\r\n<pre>\r\n<code>from typing import Any, Dict, Optional\r\n</code></pre>\r\n\r\n<p>这种从<code>typing</code>模块import的方式会向命名空间内增加额外项,<code>typing</code>中的任何命名都应该和关键字同等对待并且不在你的Python代码中定义,typed or not(译者推测文无论是否引入).如果和已有的命名冲突,使用<code>import x as y</code>来import.</p>\r\n\r\n<pre>\r\n<code>from typing import Any as AnyType\r\n</code></pre>\r\n\r\n<h4>3.19.13 条件import</h4>\r\n\r\n<p>只在运行时一定要避免进行类型检查的情况下使用条件import.不鼓励使用这种模式.鼓励使用其他替代方式诸如重构代码以容许顶级import.</p>\r\n\r\n<p>只用于类型注释的import可以被归于<code>if TYPE_CHECKING:</code>代码块中.</p>\r\n\r\n<ul>\r\n	<li>\r\n	<p>条件import的类型应被视为字符串引用,以和Python3.6兼容(在Python3.6中,注释表达式实际上被赋值的).</p>\r\n	</li>\r\n	<li>\r\n	<p>只有单独用于类型注释的实例才能在这里定义,包括了别名.否则将会报运行错误因为在运行时这些模块不会被引用.</p>\r\n	</li>\r\n	<li>\r\n	<p>代码块应该紧跟在正常import后面.</p>\r\n	</li>\r\n	<li>\r\n	<p>在类型import后不应有空行</p>\r\n	</li>\r\n	<li>\r\n	<p>按照正常import顺序对这一块代码进行排序</p>\r\n	</li>\r\n</ul>\r\n\r\n<pre>\r\n<code>import typing\r\nif typing.TYPE_CHECKING:\r\n    import sketch\r\ndef f(x: \"sketch.Sketch\"): ...\r\n</code></pre>\r\n\r\n<h4>3.19.14 循环依赖</h4>\r\n\r\n<p>由于类型检查引发的循环依赖是一种code smell(代码异味),这样的代码应当被重构.尽管技术上是可以保留循环引用的.build system(系统)不允许这样做因为每个模块都要依赖于其他模块.</p>\r\n\r\n<p>将造成循环依赖的模块替换为<code>Any</code>并赋予一个有意义的别名并使用从这个模块导入的真实类名(因为任何<code>Any</code>的属性都是<code>Any</code>).别名的定义用和最后一行import用一行空行分隔.</p>\r\n\r\n<pre>\r\n<code>from typing import Any\r\n\r\nsome_mod = Any  # some_mod.py imports this module.\r\n...\r\n\r\ndef my_method(self, var: some_mod.SomeType) -&gt; None:\r\n  ...\r\n</code></pre>\r\n\r\n<h4>3.19.15 &nbsp;泛型</h4>\r\n\r\n<p>当注释的时候,优先泛型类型专有类型参数,否则泛型的参数会被认为是<code>Any</code>.</p>\r\n\r\n<pre>\r\n<code>def get_names(employee_ids: List[int]) -&gt; Dict[int, Any]:\r\n  ...\r\n</code></pre>\r\n\r\n<pre>\r\n<code># These are both interpreted as get_names(employee_ids: List[Any]) -&gt; Dict[Any, Any]\r\ndef get_names(employee_ids: list) -&gt; Dict:\r\n  ...\r\n\r\ndef get_names(employee_ids: List) -&gt; Dict:\r\n  ...\r\n</code></pre>\r\n\r\n<p>如果泛型最佳的参数类型是<code>Any</code>也将其显式地表示出来.但是在很多情况下<code>TypeVar</code>可能更合适.</p>\r\n\r\n<pre>\r\n<code>def get_names(employee_ids: List[Any]) -&gt; Dict[Any, Text]:\r\n\"\"\"Returns a mapping from employee ID to employee name for given IDs.\"\"\"\r\n</code></pre>\r\n\r\n<pre>\r\n<code>T = TypeVar(\'T\')\r\ndef get_names(employee_ids: List[T]) -&gt; Dict[T, Text]:\r\n\"\"\"Returns a mapping from employee ID to employee name for given IDs.\"\"\"</code></pre>\r\n\r\n<h2>4、最后的话</h2>\r\n\r\n<p>如果你在编辑代码,花几分钟看看现有代码然后决定好要使用哪种风格.如果现有代码在所有算术运算符两侧都加了空格,那么你也应该如此.如果现有的注释用井号组成了包围框,那么你的注释也应如此.</p>\r\n\r\n<p>有代码风格指南的目的是有一个编程的共识,这样人们能够集中在内容而非形式上.我们将通用的代码风格指南公布于此这样人们就能了解这个共识(译者:有巴别塔的意味.)但是各自的代码风格也很重要.如果你添加的代码与原有代码看起来完全不一致，就会打乱读者的阅读节奏，避免这样。</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>来自：Why GitHub? &nbsp;</p>\r\n\r\n<p>链接：https://github.com/shendeguize/GooglePythonStyleGuideCN</p>',
        '', '2021-05-26 01:21:00', '2021-05-26 01:21:00', 46, 1, 2, 0, 0, 1);
INSERT INTO `tb_content`
VALUES (133, '[ 推荐 ] - mac精品软件汇总',
        '<p><a href=\"https://www.macwk.com/\" target=\"_blank\">MacWk - 精品mac软件下载</a></p>\r\n\r\n<p><img src=\"https://cdn.ch3nnn.cn/upload/2021/06/01/5e0462871d694f69b330d6cf813aad55.png\" style=\"height:301px; width:600px\" /></p>\r\n\r\n<p><a href=\"https://xclient.info/s/\" target=\"_blank\">应用 - 精品MAC应用分享</a></p>\r\n\r\n<p><img src=\"https://cdn.ch3nnn.cn/upload/2021/06/15/72293a377b2b48e39e67b0e01768ac4b.png?imageMogr2/auto-orient/thumbnail/1000x/interlace/1/blur/1x0/quality/95|watermark/2/text/Q2gzbm5ubm7nmoTljZrlrqIgfOaKmOiFvuS4jeaBryDCtyDkuZDmraTkuI3nlrI=/font/6buR5L2T/fontsize/260/fill/I0ZDRkNGQw==/dissolve/75/gravity/SouthEast/dx/10/dy/10\" style=\"height:324px; width:600px\" /></p>',
        '', '2021-06-15 02:19:00', '2021-06-22 03:13:00', 38, 1, 8, 0, 0, 1);
INSERT INTO `tb_content`
VALUES (134, 'Mac Pycharm 打不开的解决方法(亲测有效)',
        '<p>不废话,直接进入主题:</p>\r\n\r\n<ol>\r\n	<li>打开访达,切到应用程序,找到<code>Pycharm.app</code>,右键-&gt;显示包内容,打开<code>Contents/MacOS/</code></li>\r\n	<li>打开终端,cd 到<code>Contents/MacOS/</code>目录,直接将<code>MacOS</code>文件夹拖到终端里面,就会显示该文件件的全路径,然后cd进去.</li>\r\n	<li>执行该文件夹下的<code>pycharm</code>文件,即:<code>./pycharm</code>,之后可以在终端看到输出的信息, 如果没问题会直接打开 <code>Pycharm</code></li>\r\n</ol>\r\n\r\n<p>解决方法:</p>\r\n\r\n<ol>\r\n	<li>在终端cd 到,这个文件夹下有一个<code>pycharm.vmoptions</code>的文件,我们需要将这个文件删除.</li>\r\n	<li>终端执行 <code>rm -f pycharm.vmoptions</code></li>\r\n	<li>重新打开即可.</li>\r\n</ol>\r\n\r\n<p>说明：<br />\r\n<code>cd 到Application Support时 提示找不到路径的问题</code><br />\r\n原因：<code>/Application Support/</code> 这个地方<code>Application</code> 和 <code>Support</code> 中间有一个空格，需要转义。</p>\r\n\r\n<p>正确的为：<br />\r\n<code>cd /Users/{替换成自己的用户名}/Library/Application\\ Support/JetBrains/PyCharm2020.1/PyCharm2020.1/</code> 这个路径根据安装版本的不同路径会有所不同。</p>',
        '', '2021-07-05 09:28:00', '2021-07-05 09:28:00', 15, 1, 8, 0, 0, 1);
INSERT INTO `tb_content`
VALUES (135, 'Github标星34K+Star，这款开源项目助你秒建Git服务！',
        '<blockquote>\r\n<p>以前使用Gitlab搭建过Git服务，如果服务器配置低的话启动和访问都会特别慢。最近发现了Gogs这个开源项目，安装方便，特别轻量级，推荐给大家！</p>\r\n</blockquote>\r\n\r\n<h2><a href=\"http://www.macrozheng.com/#/reference/gogs_start?id=%e6%8e%a8%e8%8d%90%e8%af%ad\">推荐语</a></h2>\r\n\r\n<p>一款极易搭建的自助Git服务，特别轻量级，推荐给大家！</p>\r\n\r\n<h2><a href=\"http://www.macrozheng.com/#/reference/gogs_start?id=gogs%e7%ae%80%e4%bb%8b\">Gogs简介</a></h2>\r\n\r\n<p>Gogs是一款极易搭建的自助Git服务，使用Go语言开发，只要Go语言支持的平台它都支持，包括Linux、Mac OS X、Windows以及ARM平台。Gogs对系统硬件要求极低，你甚至可以在树莓派上搭建它。</p>\r\n\r\n<p>项目地址：<a href=\"https://github.com/gogs/gogs\" rel=\"noopener\" target=\"_blank\">https://github.com/gogs/gogs</a></p>\r\n\r\n<h2><a href=\"http://www.macrozheng.com/#/reference/gogs_start?id=%e5%ae%89%e8%a3%85\">安装</a></h2>\r\n\r\n<blockquote>\r\n<p>Gogs在Docker环境下的安装非常简单，只需要两个命令即可，推荐使用该方式来进行安装。</p>\r\n</blockquote>\r\n\r\n<ul>\r\n	<li>首先我们需要先下载Gogs的Docker镜像；</li>\r\n</ul>\r\n\r\n<pre>\r\n<code>docker pull gogs/gogs</code>Copy to clipboardErrorCopied</pre>\r\n\r\n<ul>\r\n	<li>下载完成后使用<code>docker run</code>命令即可运行服务；</li>\r\n</ul>\r\n\r\n<pre>\r\n<code>docker run -p 10022:22 -p 10080:3000 --name=gogs \\\r\n-v /mydata/gogs:/data  \\\r\n-d gogs/gogs</code>Copy to clipboardErrorCopied</pre>\r\n\r\n<ul>\r\n	<li>这里我们说下命令中值得注意的地方，<code>10022</code>对应的是Gogs的SSH服务端口，<code>10080</code>对应的使用Gogs的HTTP服务端口，我们还将容器的数据目录挂载到了宿主机的<code>/mydata/gogs</code>目录下，这样就算我们重新创建容器数据也不会丢失。</li>\r\n</ul>\r\n\r\n<h2><a href=\"http://www.macrozheng.com/#/reference/gogs_start?id=%e9%85%8d%e7%bd%ae\">配置</a></h2>\r\n\r\n<ul>\r\n	<li>\r\n	<p>安装完成后，我们第一次访问Gogs服务会显示一个设置页面，访问地址：<a href=\"http://192.168.5.19:10080/\" rel=\"noopener\" target=\"_blank\">http://192.168.5.19:10080/</a></p>\r\n	</li>\r\n	<li>\r\n	<p>数据库设置，这里我们直接使用内置的<code>SQLite3</code>数据库即可，使用其他的需要自行搭建数据库；</p>\r\n	</li>\r\n</ul>\r\n\r\n<p><img src=\"https://cdn.ch3nnn.cn/upload/2021/07/02/353398c25df244cfb5c273e05b4c8717.png?imageMogr2/auto-orient/thumbnail/1000x/interlace/1/blur/1x0/quality/95|watermark/2/text/Q2gzbm5ubm7nmoTljZrlrqIgfOaKmOiFvuS4jeaBryDCtyDkuZDmraTkuI3nlrI=/font/6buR5L2T/fontsize/260/fill/I0ZDRkNGQw==/dissolve/75/gravity/SouthEast/dx/10/dy/10\" style=\"height:192px; width:600px\" /><img alt=\"\" src=\"http://www.macrozheng.com/images/gogs_start_01.png\" /><img alt=\"\" src=\"http://www.macrozheng.com/images/gogs_start_01.png\" /></p>\r\n\r\n<ul>\r\n	<li>应用基本设置，主要修改域名、SSH端口号和应用URL即可。</li>\r\n	<li><img src=\"https://cdn.ch3nnn.cn/upload/2021/07/02/c1c4936ed1184085a60c7b1c567bb7b4.png?imageMogr2/auto-orient/thumbnail/1000x/interlace/1/blur/1x0/quality/95|watermark/2/text/Q2gzbm5ubm7nmoTljZrlrqIgfOaKmOiFvuS4jeaBryDCtyDkuZDmraTkuI3nlrI=/font/6buR5L2T/fontsize/260/fill/I0ZDRkNGQw==/dissolve/75/gravity/SouthEast/dx/10/dy/10\" style=\"height:515px; width:600px\" /></li>\r\n</ul>\r\n\r\n<p><img alt=\"\" src=\"http://www.macrozheng.com/images/gogs_start_02.png\" /></p>\r\n\r\n<h2><a href=\"http://www.macrozheng.com/#/reference/gogs_start?id=%e4%bd%bf%e7%94%a8\">使用</a></h2>\r\n\r\n<h3><a href=\"http://www.macrozheng.com/#/reference/gogs_start?id=%e6%b3%a8%e5%86%8c\">注册</a></h3>\r\n\r\n<ul>\r\n	<li>配置好以后会直接跳转到登录界面，首先注册一个帐户；</li>\r\n</ul>\r\n\r\n<p><img src=\"https://cdn.ch3nnn.cn/upload/2021/07/02/8c04efbec38f4ba0b160201de9fe2e6b.png?imageMogr2/auto-orient/thumbnail/1000x/interlace/1/blur/1x0/quality/95|watermark/2/text/Q2gzbm5ubm7nmoTljZrlrqIgfOaKmOiFvuS4jeaBryDCtyDkuZDmraTkuI3nlrI=/font/6buR5L2T/fontsize/260/fill/I0ZDRkNGQw==/dissolve/75/gravity/SouthEast/dx/10/dy/10\" style=\"height:428px; width:600px\" /><img alt=\"\" src=\"http://www.macrozheng.com/images/gogs_start_03.png\" /></p>\r\n\r\n<ul>\r\n	<li>注册完成后，登录即可进入控制面板页面。</li>\r\n	<li><img src=\"https://cdn.ch3nnn.cn/upload/2021/07/02/98c5b485a2244a6cb9b24fd433ff92e2.png?imageMogr2/auto-orient/thumbnail/1000x/interlace/1/blur/1x0/quality/95|watermark/2/text/Q2gzbm5ubm7nmoTljZrlrqIgfOaKmOiFvuS4jeaBryDCtyDkuZDmraTkuI3nlrI=/font/6buR5L2T/fontsize/260/fill/I0ZDRkNGQw==/dissolve/75/gravity/SouthEast/dx/10/dy/10\" style=\"height:217px; width:600px\" /></li>\r\n</ul>\r\n\r\n<p><img alt=\"\" src=\"http://www.macrozheng.com/images/gogs_start_04.png\" /></p>\r\n\r\n<h3><a href=\"http://www.macrozheng.com/#/reference/gogs_start?id=%e5%88%9b%e5%bb%ba%e4%bb%93%e5%ba%93\">创建仓库</a></h3>\r\n\r\n<ul>\r\n	<li>直接使用我的仓库右侧的加号即可创建仓库，简单设置下仓库名称和可见性来完成创建；</li>\r\n</ul>\r\n\r\n<p><img alt=\"\" src=\"http://www.macrozheng.com/images/gogs_start_05.png\" /><img src=\"https://cdn.ch3nnn.cn/upload/2021/07/02/64ad3cc9a46649568192393fe36e6625.png?imageMogr2/auto-orient/thumbnail/1000x/interlace/1/blur/1x0/quality/95|watermark/2/text/Q2gzbm5ubm7nmoTljZrlrqIgfOaKmOiFvuS4jeaBryDCtyDkuZDmraTkuI3nlrI=/font/6buR5L2T/fontsize/260/fill/I0ZDRkNGQw==/dissolve/75/gravity/SouthEast/dx/10/dy/10\" style=\"height:496px; width:600px\" /></p>\r\n\r\n<ul>\r\n	<li>创建成功后直接使用克隆地址即可克隆该仓库；</li>\r\n</ul>\r\n\r\n<p><img alt=\"\" src=\"http://www.macrozheng.com/images/gogs_start_06.png\" /><img src=\"https://cdn.ch3nnn.cn/upload/2021/07/02/653c0aea561a4910b9e5821c8052d98d.png?imageMogr2/auto-orient/thumbnail/1000x/interlace/1/blur/1x0/quality/95|watermark/2/text/Q2gzbm5ubm7nmoTljZrlrqIgfOaKmOiFvuS4jeaBryDCtyDkuZDmraTkuI3nlrI=/font/6buR5L2T/fontsize/260/fill/I0ZDRkNGQw==/dissolve/75/gravity/SouthEast/dx/10/dy/10\" style=\"height:434px; width:600px\" /></p>\r\n\r\n<ul>\r\n	<li>我们可以直接使用IDEA的Git检出功能；</li>\r\n</ul>\r\n\r\n<p><img src=\"https://cdn.ch3nnn.cn/upload/2021/07/02/79b6c325222847abb4914354c4d09c06.png?imageMogr2/auto-orient/thumbnail/1000x/interlace/1/blur/1x0/quality/95|watermark/2/text/Q2gzbm5ubm7nmoTljZrlrqIgfOaKmOiFvuS4jeaBryDCtyDkuZDmraTkuI3nlrI=/font/6buR5L2T/fontsize/260/fill/I0ZDRkNGQw==/dissolve/75/gravity/SouthEast/dx/10/dy/10\" style=\"height:554px; width:600px\" /><img alt=\"\" src=\"http://www.macrozheng.com/images/gogs_start_07.png\" /></p>\r\n\r\n<ul>\r\n	<li>检出完成后，加入我们的代码直接提交、推送，在Gogs里面就可以看到我们提交的代码了。</li>\r\n</ul>\r\n\r\n<p><img alt=\"\" src=\"http://www.macrozheng.com/images/gogs_start_08.png\" /><img src=\"https://cdn.ch3nnn.cn/upload/2021/07/02/2cb90e1a6d674b74b9be06db5970ec55.png?imageMogr2/auto-orient/thumbnail/1000x/interlace/1/blur/1x0/quality/95|watermark/2/text/Q2gzbm5ubm7nmoTljZrlrqIgfOaKmOiFvuS4jeaBryDCtyDkuZDmraTkuI3nlrI=/font/6buR5L2T/fontsize/260/fill/I0ZDRkNGQw==/dissolve/75/gravity/SouthEast/dx/10/dy/10\" style=\"height:307px; width:600px\" /></p>\r\n\r\n<h3><a href=\"http://www.macrozheng.com/#/reference/gogs_start?id=%e5%b7%a5%e5%8d%95%e7%ae%a1%e7%90%86\">工单管理</a></h3>\r\n\r\n<ul>\r\n	<li>这里的工单管理，有点类似Github上面的Issue的功能，我们可以通过<code>创建工单</code>按钮来创建；</li>\r\n</ul>\r\n\r\n<p><img src=\"https://cdn.ch3nnn.cn/upload/2021/07/02/94e6d362a1d74ec484c6c1bece80003e.png?imageMogr2/auto-orient/thumbnail/1000x/interlace/1/blur/1x0/quality/95|watermark/2/text/Q2gzbm5ubm7nmoTljZrlrqIgfOaKmOiFvuS4jeaBryDCtyDkuZDmraTkuI3nlrI=/font/6buR5L2T/fontsize/260/fill/I0ZDRkNGQw==/dissolve/75/gravity/SouthEast/dx/10/dy/10\" style=\"height:577px; width:600px\" /></p>\r\n\r\n<ul>\r\n	<li>输入我们的标题、内容和标签以后即可创建；</li>\r\n</ul>\r\n\r\n<p><img alt=\"\" src=\"http://www.macrozheng.com/images/gogs_start_10.png\" /><img src=\"https://cdn.ch3nnn.cn/upload/2021/07/02/f96232baa1c3418ababa67a405a4acb8.png?imageMogr2/auto-orient/thumbnail/1000x/interlace/1/blur/1x0/quality/95|watermark/2/text/Q2gzbm5ubm7nmoTljZrlrqIgfOaKmOiFvuS4jeaBryDCtyDkuZDmraTkuI3nlrI=/font/6buR5L2T/fontsize/260/fill/I0ZDRkNGQw==/dissolve/75/gravity/SouthEast/dx/10/dy/10\" style=\"height:396px; width:600px\" /></p>\r\n\r\n<ul>\r\n	<li>创建完成后显示效果如下。</li>\r\n</ul>\r\n\r\n<p><img src=\"https://cdn.ch3nnn.cn/upload/2021/07/02/de43c3f2c8c044909b9359f31080f8e0.png?imageMogr2/auto-orient/thumbnail/1000x/interlace/1/blur/1x0/quality/95|watermark/2/text/Q2gzbm5ubm7nmoTljZrlrqIgfOaKmOiFvuS4jeaBryDCtyDkuZDmraTkuI3nlrI=/font/6buR5L2T/fontsize/260/fill/I0ZDRkNGQw==/dissolve/75/gravity/SouthEast/dx/10/dy/10\" style=\"height:196px; width:600px\" /><img alt=\"\" src=\"http://www.macrozheng.com/images/gogs_start_11.png\" /></p>\r\n\r\n<h3><a href=\"http://www.macrozheng.com/#/reference/gogs_start?id=%e6%b7%bb%e5%8a%a0%e7%94%a8%e6%88%b7\">添加用户</a></h3>\r\n\r\n<ul>\r\n	<li>有时候管理员需要新建一些帐户来协作开发，此时我们只要点击<code>头像-&gt;管理面板-&gt;用户管理</code>即可打开用户管理界面；</li>\r\n</ul>\r\n\r\n<p><img alt=\"\" src=\"http://www.macrozheng.com/images/gogs_start_12.png\" /></p>\r\n\r\n<ul>\r\n	<li>然后点击<code>创建新的帐户</code>，输入相关信息即可完成创建。</li>\r\n</ul>\r\n\r\n<p><img alt=\"\" src=\"http://www.macrozheng.com/images/gogs_start_13.png\" /></p>\r\n\r\n<h3><a href=\"http://www.macrozheng.com/#/reference/gogs_start?id=%e7%ae%a1%e7%90%86%e5%8d%8f%e4%bd%9c%e8%80%85\">管理协作者</a></h3>\r\n\r\n<ul>\r\n	<li>创建完成后，我们可以在仓库页面的<code>仓库设置</code>中打开<code>管理协作者</code>功能；</li>\r\n</ul>\r\n\r\n<p><img alt=\"\" src=\"http://www.macrozheng.com/images/gogs_start_14.png\" /></p>\r\n\r\n<ul>\r\n	<li>之后通过输入协作者账户，点击<code>增加新的协作者</code>并设置好权限即可，这样协作者就可以访问并向该仓库提交代码了。</li>\r\n</ul>\r\n\r\n<p><img alt=\"\" src=\"http://www.macrozheng.com/images/gogs_start_15.png\" /></p>\r\n\r\n<h3><a href=\"http://www.macrozheng.com/#/reference/gogs_start?id=%e8%bf%81%e7%a7%bb%e5%a4%96%e9%83%a8%e4%bb%93%e5%ba%93\">迁移外部仓库</a></h3>\r\n\r\n<ul>\r\n	<li>Gogs还提供了从外部仓库迁移代码的功能，通过头像左侧的加号，然后选择<code>迁移外部仓库</code>即可；</li>\r\n</ul>\r\n\r\n<p><img alt=\"\" src=\"http://www.macrozheng.com/images/gogs_start_16.png\" /></p>\r\n\r\n<ul>\r\n	<li>这里以迁移Gitee上的<code>mall</code>项目为例，项目地址：<a href=\"http://gitee.com/macrozheng/mall\" rel=\"noopener\" target=\"_blank\">http://gitee.com/macrozheng/mall</a></li>\r\n</ul>\r\n\r\n<p><img alt=\"\" src=\"http://www.macrozheng.com/images/gogs_start_17.png\" /></p>\r\n\r\n<ul>\r\n	<li>迁移成功后就可以在Gogs里面看到<code>mall</code>项目了！</li>\r\n</ul>\r\n\r\n<p><img alt=\"\" src=\"http://www.macrozheng.com/images/gogs_start_18.png\" /></p>\r\n\r\n<h2><a href=\"http://www.macrozheng.com/#/reference/gogs_start?id=gogs-vs-gitlab\">Gogs VS Gitlab</a></h2>\r\n\r\n<blockquote>\r\n<p>之前有写过一篇<a href=\"https://mp.weixin.qq.com/s/6GyYlR9lpVcjgYmHMYLi0w\" rel=\"noopener\" target=\"_blank\">《10分钟搭建自己的Git仓库》</a>，使用的是Gitlab，下面对比下Gogs和Gitlab在安装使用过程中的优缺点，仅代表个人观点。</p>\r\n</blockquote>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<table>\r\n	<thead>\r\n		<tr>\r\n			<th>比较方面</th>\r\n			<th>Gogs</th>\r\n			<th>Gitlab</th>\r\n		</tr>\r\n	</thead>\r\n	<tbody>\r\n		<tr>\r\n			<td>Docker镜像大小</td>\r\n			<td>44MB</td>\r\n			<td>836MB</td>\r\n		</tr>\r\n		<tr>\r\n			<td>启动速度</td>\r\n			<td>很快，几秒</td>\r\n			<td>很慢，机器配置不好要10分钟</td>\r\n		</tr>\r\n		<tr>\r\n			<td>配置要求</td>\r\n			<td>很低，树莓派都可以</td>\r\n			<td>很高，吃内存，吃CPU</td>\r\n		</tr>\r\n		<tr>\r\n			<td>访问速度</td>\r\n			<td>够快</td>\r\n			<td>机器配置好也还可以</td>\r\n		</tr>\r\n		<tr>\r\n			<td>功能</td>\r\n			<td>功能较少</td>\r\n			<td>功能很丰富</td>\r\n		</tr>\r\n	</tbody>\r\n</table>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p>转载:&nbsp;http://www.macrozheng.com/#/reference/gogs_start</p>',
        '', '2021-07-06 09:01:00', '2021-07-06 09:01:00', 14, 1, 4, 0, 0, 1);
INSERT INTO `tb_content`
VALUES (136, '性能测试——Jmeter（ Mac & Cent OS )',
        '<h2>&nbsp;JMeter介绍&nbsp;</h2>\r\n\r\n<blockquote>\r\n<p>Apache JMeter是Apache组织开发的基于Java的压力测试工具。用于对软件做压力测试，它最初被设计用于Web应用测试，但后来扩展到其他测试领域。 它可以用于测试静态和动态资源，例如静态文件、小程序、CGI 脚本、Java 对象、数据库、FTP服务器等等</p>\r\n</blockquote>\r\n\r\n<h2>JMeter安装</h2>\r\n\r\n<p>在终端输入以下代码进行安装</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">brew install jmeter</code></pre>\r\n\r\n<p>然后输入以下代码打开jmeter;或者直接找到/usr/local/bin文件夹,然后单击jmeter打开</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">open /usr/local/bin/jmeter</code></pre>\r\n\r\n<p>终端执行出现下图内容则安装成功</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">jmeter -v </code></pre>\r\n\r\n<p><img alt=\"\" src=\"https://img-blog.csdnimg.cn/20210707135532253.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:174px; width:600px\" /></p>\r\n\r\n<h2>启动JMeter&nbsp;</h2>\r\n\r\n<ul>\r\n	<li>执行<code>jmeter</code>，将启动JMeter，在终端会有如下输出:</li>\r\n	<li><img alt=\"\" src=\"https://img-blog.csdnimg.cn/20210707135659489.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:375px; width:600px\" /></li>\r\n	<li>可操作菜单Options =&gt; Choose Language =&gt; Chinese 进行中文语言的切换：<br />\r\n	<img alt=\"\" src=\"https://img-blog.csdnimg.cn/20210707135816548.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:307px; width:600px\" /></li>\r\n</ul>\r\n\r\n<h2>创建测试计划</h2>\r\n\r\n<ul>\r\n	<li>右键Test plan 选择线程组&nbsp;</li>\r\n</ul>\r\n\r\n<h2><img alt=\"\" src=\"https://img-blog.csdnimg.cn/20210707140020765.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:361px; width:600px\" /></h2>\r\n\r\n<ul>\r\n	<li>填写3000线程数</li>\r\n</ul>\r\n\r\n<p><img alt=\"\" src=\"https://img-blog.csdnimg.cn/20210707140129151.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:375px; width:600px\" /></p>\r\n\r\n<ul>\r\n	<li>右键线程组找到HTTP请求</li>\r\n</ul>\r\n\r\n<p><img alt=\"\" src=\"https://img-blog.csdnimg.cn/20210707140216938.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:529px; width:600px\" /></p>\r\n\r\n<ul>\r\n	<li>填写HTTP请求 GET&nbsp; 测试域名&nbsp;<a href=\"https://ch3nnn.cn/\">https://ch3nnn.cn/</a></li>\r\n</ul>\r\n\r\n<p><img alt=\"\" src=\"https://img-blog.csdnimg.cn/2021070714031567.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:375px; width:600px\" /></p>\r\n\r\n<ul>\r\n	<li>右键线程组找到响应断言</li>\r\n</ul>\r\n\r\n<p><img alt=\"\" src=\"https://img-blog.csdnimg.cn/20210707140538758.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:485px; width:600px\" /></p>\r\n\r\n<ul>\r\n	<li>选择响应代码&nbsp; 填写200 成功状态码</li>\r\n</ul>\r\n\r\n<p><img alt=\"\" src=\"https://img-blog.csdnimg.cn/20210707140640829.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:375px; width:600px\" /></p>\r\n\r\n<ul>\r\n	<li>右键找到察看结果树</li>\r\n</ul>\r\n\r\n<p><img alt=\"\" src=\"https://img-blog.csdnimg.cn/20210707140752125.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:605px; width:600px\" /></p>\r\n\r\n<p>点击启动</p>\r\n\r\n<p><img alt=\"\" src=\"https://img-blog.csdnimg.cn/20210707141038398.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:375px; width:600px\" /></p>\r\n\r\n<ul>\r\n	<li>点击保存，测试计划创建完成</li>\r\n	<li><img alt=\"\" src=\"https://img-blog.csdnimg.cn/20210707141140641.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:412px; width:600px\" /></li>\r\n</ul>\r\n\r\n<h2>运行测试计划</h2>\r\n\r\n<p>执行命令</p>\r\n\r\n<pre>\r\n<code class=\"language-bash\">jmeter -n -t ./察看结果树.jmx -l result.txt -e -o report\r\n\r\n\r\n# Test_plan.jmx：测试计划文件\r\n# result.txt：测试记录\r\n# report：测试报告保存目录</code></pre>\r\n\r\n<p>输出如下则执行成功</p>\r\n\r\n<p>进入至report目录，用浏览器打开index.html</p>\r\n\r\n<p><img alt=\"\" src=\"https://img-blog.csdnimg.cn/20210707141402177.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA2NDE4NQ==,size_16,color_FFFFFF,t_70\" style=\"height:297px; width:600px\" /></p>\r\n\r\n<p>&nbsp;</p>\r\n',
        '', '2021-07-06 16:00:00', '2021-07-06 16:00:00', 11111111, 14, 2, 1, 1, 0);
COMMIT;

-- ----------------------------
-- Table structure for tb_content_tag
-- ----------------------------
DROP TABLE IF EXISTS `tb_content_tag`;
CREATE TABLE `tb_content_tag`
(
    `id`      int(11) NOT NULL AUTO_INCREMENT,
    `post_id` int(11) NOT NULL,
    `tag_id`  int(11) NOT NULL,
    PRIMARY KEY (`id`) USING BTREE,
    UNIQUE KEY `tb_content_tag_post_id_tag_id_16557d03_uniq` (`post_id`, `tag_id`) USING BTREE,
    KEY `tb_content_tag_tag_id_352b4345_fk_tb_tag_id` (`tag_id`) USING BTREE,
    CONSTRAINT `tb_content_tag_post_id_1b23bf86_fk_tb_content_id` FOREIGN KEY (`post_id`) REFERENCES `tb_content` (`id`),
    CONSTRAINT `tb_content_tag_tag_id_352b4345_fk_tb_tag_id` FOREIGN KEY (`tag_id`) REFERENCES `tb_tag` (`id`)
) ENGINE = InnoDB
  AUTO_INCREMENT = 100
  DEFAULT CHARSET = utf8;

-- ----------------------------
-- Records of tb_content_tag
-- ----------------------------
BEGIN;
INSERT INTO `tb_content_tag`
VALUES (7, 52, 1);
INSERT INTO `tb_content_tag`
VALUES (99, 92, 2);
INSERT INTO `tb_content_tag`
VALUES (8, 103, 11);
INSERT INTO `tb_content_tag`
VALUES (1, 114, 10);
INSERT INTO `tb_content_tag`
VALUES (5, 116, 2);
INSERT INTO `tb_content_tag`
VALUES (4, 116, 9);
INSERT INTO `tb_content_tag`
VALUES (6, 117, 1);
INSERT INTO `tb_content_tag`
VALUES (9, 119, 10);
INSERT INTO `tb_content_tag`
VALUES (10, 120, 2);
INSERT INTO `tb_content_tag`
VALUES (11, 120, 10);
INSERT INTO `tb_content_tag`
VALUES (12, 121, 10);
INSERT INTO `tb_content_tag`
VALUES (13, 122, 1);
INSERT INTO `tb_content_tag`
VALUES (14, 123, 13);
INSERT INTO `tb_content_tag`
VALUES (15, 124, 10);
INSERT INTO `tb_content_tag`
VALUES (16, 125, 10);
INSERT INTO `tb_content_tag`
VALUES (17, 126, 2);
INSERT INTO `tb_content_tag`
VALUES (18, 126, 13);
INSERT INTO `tb_content_tag`
VALUES (19, 127, 2);
INSERT INTO `tb_content_tag`
VALUES (20, 127, 5);
INSERT INTO `tb_content_tag`
VALUES (21, 127, 14);
INSERT INTO `tb_content_tag`
VALUES (22, 128, 2);
INSERT INTO `tb_content_tag`
VALUES (23, 128, 5);
INSERT INTO `tb_content_tag`
VALUES (24, 129, 2);
INSERT INTO `tb_content_tag`
VALUES (25, 130, 10);
INSERT INTO `tb_content_tag`
VALUES (26, 131, 2);
INSERT INTO `tb_content_tag`
VALUES (27, 132, 2);
INSERT INTO `tb_content_tag`
VALUES (28, 133, 10);
INSERT INTO `tb_content_tag`
VALUES (29, 134, 2);
INSERT INTO `tb_content_tag`
VALUES (30, 135, 10);
INSERT INTO `tb_content_tag`
VALUES (95, 136, 3);
INSERT INTO `tb_content_tag`
VALUES (96, 136, 4);
INSERT INTO `tb_content_tag`
VALUES (97, 136, 5);
INSERT INTO `tb_content_tag`
VALUES (98, 136, 6);
COMMIT;

-- ----------------------------
-- Table structure for tb_friend_link
-- ----------------------------
DROP TABLE IF EXISTS `tb_friend_link`;
CREATE TABLE `tb_friend_link`
(
    `id`          int(11)      NOT NULL AUTO_INCREMENT,
    `site_name`   varchar(100) NOT NULL,
    `site_domain` varchar(200) NOT NULL,
    PRIMARY KEY (`id`) USING BTREE
) ENGINE = InnoDB
  AUTO_INCREMENT = 5
  DEFAULT CHARSET = utf8;

-- ----------------------------
-- Records of tb_friend_link
-- ----------------------------
BEGIN;
INSERT INTO `tb_friend_link`
VALUES (1, 'BigYoung小站', 'https://bigyoung.cn/');
INSERT INTO `tb_friend_link`
VALUES (2, '彭于晏济南分晏的记事本', 'http://39.99.177.189/');
INSERT INTO `tb_friend_link`
VALUES (3, 'syh blog', 'http://www.shiyh.top');
INSERT INTO `tb_friend_link`
VALUES (4, 'Hokyee Jau', 'http://hokyeejau.tech/');
COMMIT;

-- ----------------------------
-- Table structure for tb_menu
-- ----------------------------
DROP TABLE IF EXISTS `tb_menu`;
CREATE TABLE `tb_menu`
(
    `id`        int(11) NOT NULL AUTO_INCREMENT COMMENT 'id',
    `name`      varchar(255) DEFAULT NULL COMMENT '菜单名称',
    `url`       varchar(255) DEFAULT NULL COMMENT '路由',
    `parent_id` int(11)      DEFAULT NULL COMMENT '父类菜单id',
    `sort`      int(11)      DEFAULT NULL COMMENT '排序',
    `icon`      varchar(255) DEFAULT NULL COMMENT '图标',
    PRIMARY KEY (`id`)
) ENGINE = InnoDB
  AUTO_INCREMENT = 5
  DEFAULT CHARSET = utf8mb4 COMMENT ='菜单表';

-- ----------------------------
-- Records of tb_menu
-- ----------------------------
BEGIN;
INSERT INTO `tb_menu`
VALUES (1, '用户管理', '', 0, 9999, 'mdi mdi-account');
INSERT INTO `tb_menu`
VALUES (2, '系统管理', NULL, 0, 9999, 'mdi mdi-settings');
INSERT INTO `tb_menu`
VALUES (3, '文章管理', '/admin/article/list', 2, 1, 'mdi mdi-book-open');
INSERT INTO `tb_menu`
VALUES (4, '菜单管理', '/admin/menu/list', 2, 2, 'mdi mdi-menu');
COMMIT;

-- ----------------------------
-- Table structure for tb_tag
-- ----------------------------
DROP TABLE IF EXISTS `tb_tag`;
CREATE TABLE `tb_tag`
(
    `id`   int(11)     NOT NULL AUTO_INCREMENT,
    `name` varchar(70) NOT NULL,
    PRIMARY KEY (`id`) USING BTREE
) ENGINE = InnoDB
  AUTO_INCREMENT = 17
  DEFAULT CHARSET = utf8;

-- ----------------------------
-- Records of tb_tag
-- ----------------------------
BEGIN;
INSERT INTO `tb_tag`
VALUES (1, 'mysql');
INSERT INTO `tb_tag`
VALUES (2, 'Python');
INSERT INTO `tb_tag`
VALUES (3, '网络安全');
INSERT INTO `tb_tag`
VALUES (4, 'vps');
INSERT INTO `tb_tag`
VALUES (5, 'Django');
INSERT INTO `tb_tag`
VALUES (6, '爬虫');
INSERT INTO `tb_tag`
VALUES (7, 'Flask');
INSERT INTO `tb_tag`
VALUES (8, '数据');
INSERT INTO `tb_tag`
VALUES (9, 'pandas');
INSERT INTO `tb_tag`
VALUES (10, 'Liunx');
INSERT INTO `tb_tag`
VALUES (11, '前端');
INSERT INTO `tb_tag`
VALUES (12, 'RabbitMQ');
INSERT INTO `tb_tag`
VALUES (13, 'Java');
INSERT INTO `tb_tag`
VALUES (14, 'ElasticSearch');
INSERT INTO `tb_tag`
VALUES (15, 'Docker');
INSERT INTO `tb_tag`
VALUES (16, 'Nginx');
COMMIT;

-- ----------------------------
-- Table structure for user_user
-- ----------------------------
DROP TABLE IF EXISTS `user_user`;
CREATE TABLE `user_user`
(
    `id`           int(11)      NOT NULL AUTO_INCREMENT,
    `password`     varchar(128) NOT NULL,
    `last_login`   datetime(6) DEFAULT NULL,
    `is_superuser` tinyint(1)   NOT NULL,
    `username`     varchar(150) NOT NULL,
    `first_name`   varchar(30)  NOT NULL,
    `last_name`    varchar(150) NOT NULL,
    `email`        varchar(254) NOT NULL,
    `is_staff`     tinyint(1)   NOT NULL,
    `is_active`    tinyint(1)   NOT NULL,
    `date_joined`  datetime(6)  NOT NULL,
    `nickname`     varchar(30) DEFAULT NULL,
    `text`         longtext     NOT NULL,
    `link`         varchar(200) NOT NULL,
    `avatar_url`   varchar(100) NOT NULL,
    PRIMARY KEY (`id`) USING BTREE,
    UNIQUE KEY `username` (`username`) USING BTREE
) ENGINE = InnoDB
  AUTO_INCREMENT = 20
  DEFAULT CHARSET = utf8;

-- ----------------------------
-- Records of user_user
-- ----------------------------
BEGIN;
INSERT INTO `user_user`
VALUES (1, 'pbkdf2_sha256$180000$MhJkAhQn4gg8$huUoCP7wKj8CfU7ID1A8H5b4A7mBJ1VFOoBTK5V/e7o=',
        '2021-07-15 01:50:33.637462', 1, 'chen', '', '', 'chen@chen.com', 1, 1, '2020-06-18 08:42:00.000000', 'ch3n',
        '<p>&gt;&gt;我叫陈通 现坐标：帝都.&nbsp; 对自己的技术栈认为: 好像什么都懂一点, 但又感觉什么都不会. 来自南方的某个小城市.</p>\r\n\r\n<h2><strong>联系作者</strong></h2>\r\n\r\n<ul>\r\n	<li>电子邮箱：chen.yinren@163.com</li>\r\n	<li>微信好友二维码：&nbsp;</li>\r\n</ul>\r\n\r\n<div class=\"comments-link\"><img src=\"https://cdn.ch3nnn.cn/upload/2021/06/15/a1fec2bcfea74793af722048174ff2c0.png?imageMogr2/auto-orient/thumbnail/1000x/interlace/1/blur/1x0/quality/95|watermark/2/text/Q2gzbm5ubm7nmoTljZrlrqIgfOaKmOiFvuS4jeaBryDCtyDkuZDmraTkuI3nlrI=/font/6buR5L2T/fontsize/260/fill/I0ZDRkNGQw==/dissolve/75/gravity/SouthEast/dx/10/dy/10\" style=\"box-shadow:none; height:160px; width:200px\" /></div>\r\n\r\n<h2><strong>关于本站</strong></h2>\r\n\r\n<p><!--StartFragment--></p>\r\n\r\n<p>主要基于 django + mysql + redis + es + nginx 搭建，采用docker容器化方式部署。网站用到的很多技术其实并非必须，但是我做这个网站的目的是为了把所学的东西都运用起来。</p>\r\n\r\n<h2><strong>主要功能</strong>：</h2>\r\n\r\n<ul>\r\n	<li>docker容器化部署。</li>\r\n	<li>文章，页面，分类目录，标签的添加，删除，编辑等。文章及页面支持富文本编辑，支持代码高亮。</li>\r\n	<li>侧边栏功能，搜索入口, 最新文章，最多阅读，标签云,&nbsp; 游客当地天气温度等。</li>\r\n	<li>采用elasticsearch支持文章全文搜索, 关键字纠正,&nbsp; 高亮, 标题前缀建议。</li>\r\n	<li>完整的评论功能。</li>\r\n	<li>采用Redis缓存，支持缓存自动刷新。</li>\r\n	<li>SEO功能，新建文章等会自动通知Google和百度。</li>\r\n	<li>自定义存储系统, 集成CDN加速功能。</li>\r\n	<li>实现全站静态化处理。</li>\r\n	<li>适配移动端页面和PC端页面。</li>\r\n</ul>\r\n\r\n<hr />\r\n<h2><strong>更新日志</strong></h2>\r\n\r\n<h2>v2.1</h2>\r\n\r\n<p><strong>2020/04/24</strong></p>\r\n\r\n<p>主要修复和优化新增了如下功能:</p>\r\n\r\n<ul>\r\n	<li>实现页面静态化</li>\r\n	<li>优化将搜索替换为es搜索引擎</li>\r\n	<li>自定义存储系统实现cdn加速</li>\r\n	<li>优化分页功能</li>\r\n	<li>界面调整。</li>\r\n</ul>\r\n\r\n<h2>v2.0</h2>\r\n\r\n<p><strong>2020/02/17</strong><br />\r\n这个版本将服务器从阿里云迁移到腾讯云。 主要修复和优化了如下功能:</p>\r\n\r\n<ul>\r\n	<li>实现Docker-compose 编排。</li>\r\n	<li>实现网站页面缓存</li>\r\n	<li>增加文章归档功能</li>\r\n	<li>移动端和PC端页面适配</li>\r\n	<li>增加游客实时当地天气情况</li>\r\n</ul>\r\n\r\n<h2>v1.4</h2>\r\n\r\n<p><strong>2019/12/20</strong></p>\r\n\r\n<p>这个版本记录一次服务器被黑。 主要疏忽大意, 吸取教训.&nbsp;&nbsp;总结如下:</p>\r\n\r\n<blockquote>\r\n<p>为了实现网站缓存, 起了Docker的redis容器,&nbsp;&nbsp;没有修改默认端口和无用户认证, 测试完忘记关掉安全组. 导致黑客通过redis获得服务器权限, 在Docker起了挖矿服务, 阿里云发送服务器异常邮件, 发现CPU飙到99%。</p>\r\n</blockquote>\r\n\r\n<ul>\r\n	<li>修复: 排查修改服务默认端口, 开放指定安全组</li>\r\n	<li>修复:&nbsp;ALLOWED_HOSTS 限定请求中的host值，以防止黑客构造包来发送请求</li>\r\n</ul>\r\n\r\n<h2>v1.3</h2>\r\n\r\n<p><strong>2019/09/25</strong></p>\r\n\r\n<p>主要优化修复新增了如下几个问题：</p>\r\n\r\n<ul>\r\n	<li>增加: simpleui django-admin主题</li>\r\n	<li>增加: 首页看板娘插件</li>\r\n	<li>增加:&nbsp;站长统计为百度统计</li>\r\n	<li>增加: sitemap网站地图</li>\r\n	<li>优化: 首页部分搜索不显示内容情况</li>\r\n</ul>\r\n\r\n<h2>v1.2</h2>\r\n\r\n<p><strong>2019/04/07</strong></p>\r\n\r\n<p>主要新增如下几个功能：</p>\r\n\r\n<ul>\r\n	<li>新增文章内容代码块高亮, 图片上传</li>\r\n	<li>新增css, js代码压缩</li>\r\n	<li>新增评论功能</li>\r\n	<li>从Markdown改为富文本编辑器</li>\r\n	<li>将侧边栏-标签云改为随机动态</li>\r\n</ul>\r\n\r\n<h2>v1.1</h2>\r\n\r\n<p><strong>2018/09/12</strong></p>\r\n\r\n<p>主要优化修复了如下几个问题：</p>\r\n\r\n<ul>\r\n	<li>修复了部分界面跳转错误</li>\r\n	<li>添加搜索功能</li>\r\n	<li>去掉部分无用代码</li>\r\n	<li>修复菜单bug无选中高亮</li>\r\n</ul>\r\n\r\n<h2>v1.0</h2>\r\n\r\n<p><strong>2018/06/01</strong></p>\r\n\r\n<p>终于实现第一个版本了，主要完成了如下功能&nbsp;:</p>\r\n\r\n<ul>\r\n	<li>博客文章功能</li>\r\n	<li>分类目录，文章标签功能</li>\r\n	<li>侧边栏</li>\r\n	<li>这个版本暂时还只是预发布版本，功能等还不是很完善，待后续改进</li>\r\n</ul>',
        'https://ch3nnn.cn/', 'chen/');
INSERT INTO `user_user`
VALUES (11, '!FFlJkBzDsRr8Y3IHKrFvQr1cib4y3bKeitDxpjh6', '2021-03-20 13:30:06.331271', 0, '陳陳陳通', '陳陳陳通', '', '', 0, 1,
        '2020-06-18 09:12:42.887532', NULL, '', '', 'avatar/user/default_2.jpeg');
INSERT INTO `user_user`
VALUES (12, '!gMuEG4kXqD6uRvBm4S102Oap6t2Q5W5Clys1WYBR', '2020-06-18 09:29:28.325225', 0, 'dapang-Gao', '', '', '', 0,
        1, '2020-06-18 09:29:28.228152', NULL, '', '', 'avatar/user/default_2.jpeg');
INSERT INTO `user_user`
VALUES (13, 'pbkdf2_sha256$180000$MhJkAhQn4gg8$huUoCP7wKj8CfU7ID1A8H5b4A7mBJ1VFOoBTK5V/e7o=',
        '2020-06-27 11:04:12.471251', 0, 'wzjfto', '', '', 'wzjfto@qq.com', 0, 1, '2020-06-27 11:04:12.279873', NULL,
        '', '', 'avatar/user/default_2.jpeg');
INSERT INTO `user_user`
VALUES (14, '!hSJj06XoHtvjrIhG77UcfvXEl2uSbahhsXsElfHL', '2020-06-27 11:48:54.732434', 0, '不会撸码程序猿', '不会撸码程序猿', '', '',
        0, 1, '2020-06-27 11:48:54.691755', NULL, '', '', 'avatar/user/default_0.jpeg');
INSERT INTO `user_user`
VALUES (15, '!MjHr78sI2ikkiuDs6HcuhTW8peW0kBZzPHcueOpQ', '2021-05-21 01:15:51.004317', 0, 'ct437383389', 'Ch3nnnnnnnnn',
        '', '', 0, 1, '2020-07-05 04:23:53.011292', NULL, '', '', 'avatar/user/default_2.jpeg');
INSERT INTO `user_user`
VALUES (16, '!HpxPDdNPKNJ1AbAiUmZ7VObEnTJfhepHbVBsuytQ', '2020-07-17 07:04:36.134736', 0, '猫竹_', '猫竹_', '', '', 0, 1,
        '2020-07-17 07:04:36.063617', NULL, '', '', 'avatar/user/default_1.jpeg');
INSERT INTO `user_user`
VALUES (17, '!Ljd9VrlfI40QKEfvVZ0tef7tCutPMseECX9ROf6O', '2020-07-17 07:11:44.523690', 0, '开尔文木每', '开尔文木每', '', '', 0,
        1, '2020-07-17 07:11:44.445374', NULL, '', '', 'avatar/user/default_0.jpeg');
INSERT INTO `user_user`
VALUES (18, '!7si36rbwt1IXjbUB31Ye3h8ov4IAZO2oT5qCrlLd', '2020-10-16 07:23:41.969208', 0, '指针AI', '指针AI', '', '', 0, 1,
        '2020-10-16 07:22:07.921892', NULL, '', '', 'avatar/user/default_1.jpeg');
INSERT INTO `user_user`
VALUES (19, '!9KTw9g3uJwF8jF8sntWswvIqwAWyjB7MKQyEQgYf', '2021-04-01 07:17:55.963131', 0, '一个杭州男孩儿', '一个杭州男孩儿', '', '',
        0, 1, '2021-04-01 07:17:55.885686', NULL, '', '', 'avatar/user/default_0.jpeg');
COMMIT;

-- ----------------------------
-- Table structure for user_user_groups
-- ----------------------------
DROP TABLE IF EXISTS `user_user_groups`;
CREATE TABLE `user_user_groups`
(
    `id`       int(11) NOT NULL AUTO_INCREMENT,
    `user_id`  int(11) NOT NULL,
    `group_id` int(11) NOT NULL,
    PRIMARY KEY (`id`) USING BTREE,
    UNIQUE KEY `user_user_groups_user_id_group_id_bb60391f_uniq` (`user_id`, `group_id`) USING BTREE,
    KEY `user_user_groups_group_id_c57f13c0_fk_auth_group_id` (`group_id`) USING BTREE,
    CONSTRAINT `user_user_groups_group_id_c57f13c0_fk_auth_group_id` FOREIGN KEY (`group_id`) REFERENCES `auth_group` (`id`),
    CONSTRAINT `user_user_groups_user_id_13f9a20d_fk_user_user_id` FOREIGN KEY (`user_id`) REFERENCES `user_user` (`id`)
) ENGINE = InnoDB
  DEFAULT CHARSET = utf8;

-- ----------------------------
-- Records of user_user_groups
-- ----------------------------
BEGIN;
COMMIT;

-- ----------------------------
-- Table structure for user_user_user_permissions
-- ----------------------------
DROP TABLE IF EXISTS `user_user_user_permissions`;
CREATE TABLE `user_user_user_permissions`
(
    `id`            int(11) NOT NULL AUTO_INCREMENT,
    `user_id`       int(11) NOT NULL,
    `permission_id` int(11) NOT NULL,
    PRIMARY KEY (`id`) USING BTREE,
    UNIQUE KEY `user_user_user_permissions_user_id_permission_id_64f4d5b8_uniq` (`user_id`, `permission_id`) USING BTREE,
    KEY `user_user_user_permi_permission_id_ce49d4de_fk_auth_perm` (`permission_id`) USING BTREE,
    CONSTRAINT `user_user_user_permi_permission_id_ce49d4de_fk_auth_perm` FOREIGN KEY (`permission_id`) REFERENCES `auth_permission` (`id`),
    CONSTRAINT `user_user_user_permissions_user_id_31782f58_fk_user_user_id` FOREIGN KEY (`user_id`) REFERENCES `user_user` (`id`)
) ENGINE = InnoDB
  DEFAULT CHARSET = utf8;

-- ----------------------------
-- Records of user_user_user_permissions
-- ----------------------------
BEGIN;
COMMIT;

SET FOREIGN_KEY_CHECKS = 1;
